--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





--****************************************************************
-- NOTE: This database name must be changed in MANY places in 
--	this script. Please search and change.
--****************************************************************

PRINT 'FROM SetDB.sql';
PRINT 'Attached to DATABASE ' + DB_NAME () ;
DECLARE @CurrDB AS nvarchar (250) = DB_NAME () ;
DECLARE @MSQL AS nvarchar (250) = 'USE ' + @CurrDB;
EXEC (@MSQL) ;
GO



--***************************************************************
--***************************************************************

GO
PRINT 'Creating udfGetCurrentIP';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.objects
			 WHERE name = 'udfGetCurrentIP') 
	BEGIN
		DROP FUNCTION
			 udfGetCurrentIP;
	END;
GO
CREATE FUNCTION dbo.udfGetCurrentIP () 
RETURNS varchar (255) 
AS
	 BEGIN

		 --*********************************************************
		 --WDM 03.21.2009 Get the IP address of the current client.
		 --Used to track a DBA/Developer IP address when change is 
		 --applied to a table or view.
		 --*********************************************************

		 DECLARE @IP_Address varchar (254) ;
		 SELECT
				@IP_Address = client_net_address
		   FROM sys.dm_exec_connections
		   WHERE Session_id = @@SPID;
		 RETURN @IP_Address;
	 END;

--Same as above
--SELECT CONVERT(char(15), CONNECTIONPROPERTY('client_net_address'))

GO
PRINT 'Created udfGetCurrentIP';
GO


--***************************************************************
--***************************************************************


GO
PRINT 'Creating TRIGGER trgSchemaMonitor.';
GO
IF EXISTS (SELECT
				  name
				  FROM sys.triggers
				  WHERE name = 'trgSchemaMonitor') 
	BEGIN
		PRINT 'DISABELING TRIGGER trgSchemaMonitor.';
		DECLARE @S nvarchar (200) ;
		SET @S = 'DISABLE TRIGGER trgSchemaMonitor ON DATABASE';
		EXEC (@S) ;
	END;
GO
PRINT 'Creating trgSchemaMonitor for #44945';
PRINT 'Dropping trgSchemaMonitor if it exists';
IF EXISTS (SELECT
				  name
				  FROM sys.triggers
				  WHERE name = 'trgSchemaMonitor') 
	BEGIN
		PRINT 'Dropping trgSchemaMonitor';
		DROP TRIGGER
			 trgSchemaMonitor ON DATABASE;
	END;
GO

--print('CHANGING to the instrument DB.');
--GO
--use instrument
--go

PRINT 'FQN: trgSchemaMonitor.SQL';
PRINT 'Processing trgSchemaMonitor.sql';
GO

--if exists(Select name from sys.triggers where name = 'trgSchemaMonitor')
--BEGIN
--	drop trigger trgSchemaMonitor ;
--	print('TRIGGER trgSchemaMonitor found and removed, continuing.');
--END
--go

IF EXISTS (SELECT
				  name
				  FROM sys.tables
				  WHERE name = 'SchemaChangeMonitor') 
	BEGIN
		DROP TABLE
			 dbo.SchemaChangeMonitor;
		PRINT 'Table SchemaChangeMonitor found, continuing.';
	END;
GO
SET ANSI_NULLS ON;
SET ANSI_PADDING ON;
SET ANSI_WARNINGS ON;
SET ARITHABORT ON;
SET CONCAT_NULL_YIELDS_NULL ON;
SET NUMERIC_ROUNDABORT OFF;

--WDM

SET QUOTED_IDENTIFIER ON;
IF NOT EXISTS (SELECT
					  name
					  FROM sys.tables
					  WHERE name = 'SchemaChangeMonitor') 
	BEGIN
		PRINT 'Creating table SchemaChangeMonitor.';

		--drop TABLE SchemaChangeMonitor 
		--go

		CREATE TABLE dbo.SchemaChangeMonitor (
					 PostTime datetime2 (7) NULL
				   , DB_User nvarchar (254) NULL
				   , IP_Address nvarchar (254) NULL
				   , CUR_User nvarchar (254) NULL
				   , Event nvarchar (254) NULL
				   , TSQL nvarchar (max) NULL
				   , OBJ nvarchar (254) NULL
				   , RowNbr int IDENTITY (1, 1) 
								NOT NULL
				   , ServerName nvarchar (254) NULL) ;

	--ON [PRIMARY] TEXTIMAGE_ON [PRIMARY];
	--ALTER TABLE dbo.SchemaChangeMonitor
	--ADD
	--			CONSTRAINT DF_SchemaChangeMonitor_ServerName DEFAULT @@servername FOR ServerName;
	--CREATE NONCLUSTERED INDEX PI_SchemaChangeMonitor ON dbo.SchemaChangeMonitor (OBJ ASC) ;
	--GRANT SELECT ON [dbo].[SchemaChangeMonitor] TO [platformuser_dev] ;
	--GRANT INSERT ON [dbo].[SchemaChangeMonitor] TO [platformuser_dev] ;
	--REVOKE DELETE ON [dbo].[SchemaChangeMonitor] TO [platformuser_dev] ;
	--REVOKE UPDATE ON [dbo].[SchemaChangeMonitor] TO [platformuser_dev] ;

	END;
GO
IF EXISTS (SELECT
				  name
				  FROM sys.tables
				  WHERE name = 'SchemaMonitorObjectName') 
	BEGIN
		PRINT 'Table SchemaMonitorObjectName FOUND, continuing.';
	END;
IF NOT EXISTS (SELECT
					  name
					  FROM sys.tables
					  WHERE name = 'SchemaMonitorObjectName') 
	BEGIN
		PRINT 'Creating table SchemaMonitorObjectName';
		SET ANSI_NULLS ON;
		SET ANSI_PADDING ON;
		SET ANSI_WARNINGS ON;
		SET ARITHABORT ON;
		SET CONCAT_NULL_YIELDS_NULL ON;
		SET NUMERIC_ROUNDABORT OFF;
		SET QUOTED_IDENTIFIER ON;

		--drop TABLE dbo.SchemaMonitorObjectName
		--go

		CREATE TABLE dbo.SchemaMonitorObjectName (
					 ObjectName nvarchar (254) 
				   , ObjectType nvarchar (25)) ;
		CREATE UNIQUE CLUSTERED INDEX PKI_SchemaMonitorObjectName ON dbo.SchemaMonitorObjectName (ObjectName ASC, ObjectType ASC) ;
	END;
GO
IF EXISTS (SELECT
				  name
				  FROM sys.tables
				  WHERE name = 'SchemaMonitorObjectNotify') 
	BEGIN
		PRINT 'Table SchemaMonitorObjectNotify NOT FOUND, continuing.';
	END;
IF NOT EXISTS (SELECT
					  name
					  FROM sys.tables
					  WHERE name = 'SchemaMonitorObjectNotify') 
	BEGIN		
		SET ANSI_NULLS ON;
		SET ANSI_PADDING ON;
		SET ANSI_WARNINGS ON;
		SET ARITHABORT ON;
		SET CONCAT_NULL_YIELDS_NULL ON;
		SET NUMERIC_ROUNDABORT OFF;
		SET QUOTED_IDENTIFIER ON;
		CREATE TABLE dbo.SchemaMonitorObjectNotify (
					 EmailAddr nvarchar (254)) ;
		CREATE UNIQUE CLUSTERED INDEX PCI_SchemaMonitorObjectNotify ON dbo.SchemaMonitorObjectNotify (EmailAddr ASC) ;

		--GRANT SELECT ON [dbo].SchemaMonitorObjectNotify TO [platformuser_dev] ;
		--GRANT INSERT ON [dbo].SchemaMonitorObjectNotify TO [platformuser_dev] ;
		--REVOKE DELETE ON [dbo].SchemaMonitorObjectNotify TO [platformuser_dev] ;
		--REVOKE UPDATE ON [dbo].SchemaMonitorObjectNotify TO [platformuser_dev] ;		

		INSERT INTO dbo.SchemaMonitorObjectNotify (
					EmailAddr) 
		VALUES
			 ('wdalemiller@gmail.com') ;
	END;
GO
PRINT 'Creating view_SchemaChangeMonitor';
GO

--DROP TRIGGER trgSchemaMonitor on DATABASE
--disable TRIGGER trgSchemaMonitor on DATABASE
--enable TRIGGER trgSchemaMonitor on DATABASE

IF EXISTS (SELECT
				  name
				  FROM sys.views
				  WHERE name = 'view_SchemaChangeMonitor') 
	BEGIN
		PRINT 'Creating view_SchemaChangeMonitor, continuing';
		DROP VIEW
			 view_SchemaChangeMonitor;
	END;
GO
CREATE VIEW view_SchemaChangeMonitor
AS SELECT
		  PostTime
		, DB_User
		, IP_Address
		, CUR_User
		, Event
		, TSQL
		, OBJ
		  FROM SchemaChangeMonitor;
GO

--GRANT SELECT ON  [dbo].view_SchemaChangeMonitor TO [platformuser_dev] ;
--GRANT INSERT ON  [Schema].[Table] TO [User] ;
--REVOKE DELETE ON  [Schema].[Table] TO [User] ;
--REVOKE UPDATE ON  [Schema].[Table] TO [User] ;

PRINT 'Created view_SchemaChangeMonitor';
GO
IF EXISTS (SELECT
				  name
				  FROM sys.triggers
				  WHERE name = 'trgSchemaMonitor') 
	BEGIN
		PRINT 'creating trgSchemaMonitor';
		DROP TRIGGER
			 trgSchemaMonitor;
	END;
GO
PRINT 'Updating trgSchemaMonitor';
GO

--disable TRIGGER dbo.trgSchemaMonitor database

DECLARE @DB nvarchar (100) = (SELECT
									 DB_NAME ()) ;
PRINT 'Current DB: ' + @DB;
IF @DB = 'KenticoCMS_QA'
	BEGIN
		DECLARE @I int = 0;
		SET @i = (SELECT
						 COUNT (*) 
						 FROM SchemaMonitorObjectNotify
						 WHERE EmailAddr = 'John.Croft@hfit.com') ;
		IF @i = 0
			BEGIN
				INSERT INTO dbo.SchemaMonitorObjectNotify (
							EmailAddr) 
				VALUES
					 ('John.Croft@hfit.com') ;
			END;
		ELSE
			BEGIN
				PRINT 'Croft already exists in GREEN.';
			END;
		GRANT SELECT ON dbo.view_SchemaDiff TO JCroft;
		GRANT SELECT ON dbo.view_SchemaChangeMonitor TO JCroft;
		PRINT 'Added John Croft to the Schema Monitor system.';
	END;
GO
CREATE TRIGGER trgSchemaMonitor ON DATABASE
	FOR DDL_DATABASE_LEVEL_EVENTS
AS
SET ANSI_NULLS ON;
SET ANSI_PADDING ON;
SET ANSI_WARNINGS ON;
SET ARITHABORT ON;
SET CONCAT_NULL_YIELDS_NULL ON;
SET NUMERIC_ROUNDABORT OFF;
SET QUOTED_IDENTIFIER ON;
DECLARE @data xml;
DECLARE @IPADDR nvarchar (254) ;
DECLARE @CUR_User nvarchar (254) ;
SET @CUR_User = SYSTEM_USER;
SET @IPADDR = (SELECT
					  CONVERT (nvarchar (254) , CONNECTIONPROPERTY ('client_net_address'))) ;
SET @data = EVENTDATA () ;
SET NOCOUNT ON;
INSERT INTO SchemaChangeMonitor (
			PostTime
		  , DB_User
		  , IP_Address
		  , CUR_User
		  , OBJ
		  , Event
		  , TSQL) 
VALUES
	 (GETDATE () , CONVERT (nvarchar (254) , CURRENT_USER) , @IPADDR, @CUR_User, @data.value ('(/EVENT_INSTANCE/ObjectName)[1]', 'nvarchar(254)') , @data.value ('(/EVENT_INSTANCE/EventType)[1]', 'nvarchar(254)') , @data.value ('(/EVENT_INSTANCE/TSQLCommand)[1]', 'nvarchar(max)')) ;

--THIS WILL DELETE records older than 90 days.
--delete from SchemaChangeMonitor where PostTime < getdate() - 90 ;

SET NOCOUNT OFF;
GO

--grant execute on trgSchemaMonitor to PUBLIC ;
--go
--grant execute on sp_SchemaMonitorReport to platformuser_dev ; 
--GO

DISABLE TRIGGER
 trgSchemaMonitor ON DATABASE;
PRINT '********************************************************************';
PRINT 'DATABASE trgSchemaMonitor HAS BEEN DISABLED       ******************';
PRINT '********************************************************************';
PRINT 'Processed trgSchemaMonitor.sql';

GO
PRINT 'FQN: SchemaChangeMonitor_rptData.SQL';
PRINT 'Creating SchemaChangeMonitor_rptData table';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.tables
			 WHERE name = 'SchemaChangeMonitor_rptData') 
	BEGIN
		DROP TABLE
			 dbo.SchemaChangeMonitor_rptData;
	END;
IF NOT EXISTS (SELECT
					  name
				 FROM sys.tables
				 WHERE name = 'SchemaChangeMonitor_rptData') 
	BEGIN
		CREATE TABLE dbo.SchemaChangeMonitor_rptData (
					 label nvarchar (254) NOT NULL
				   , sText nvarchar (max) NOT NULL
				   , DisplayOrder int NOT NULL
				   , RowNbr int NOT NULL) ;
	END;
GO
PRINT 'Created SchemaChangeMonitor_rptData table';
GO


GO
PRINT 'Creating the AUDIT tables.';
GO

--CreateDdlAuditTables

IF NOT EXISTS (SELECT
					  name

			   --FROM tempdb.dbo.sysobjects

				 FROM sysobjects
				 WHERE ID = OBJECT_ID (N'TBL_DIFF1')) 
	BEGIN
		CREATE TABLE dbo.TBL_DIFF1 (
					 table_name sysname NOT NULL
				   , COLUMN_NAME sysname NULL
				   , DATA_TYPE nvarchar (254) NULL
				   , CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
				   , table_name2 sysname NULL
				   , DATA_TYPE2 nvarchar (254) NULL
				   , COLUMN_NAME2 sysname NULL
				   , CHARACTER_MAXIMUM_LENGTH2 int NULL
				   , NOTE varchar (max) NULL
				   , CreateDate datetime2 (7) NULL
										 DEFAULT GETDATE () 
				   , RowNbr int IDENTITY) ;
	END;
GO
PRINT 'Created AUDIT table TBL_DIFF1 of 4.';
GO
IF NOT EXISTS (SELECT
					  name

			   --FROM tempdb.dbo.sysobjects

				 FROM sysobjects
				 WHERE ID = OBJECT_ID (N'TBL_DIFF2')) 
	BEGIN
		CREATE TABLE dbo.TBL_DIFF2 (
					 table_name sysname NOT NULL
				   , COLUMN_NAME sysname NULL
				   , DATA_TYPE nvarchar (254) NULL
				   , CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
				   , table_name2 sysname NULL
				   , DATA_TYPE2 nvarchar (254) NULL
				   , COLUMN_NAME2 sysname NULL
				   , CHARACTER_MAXIMUM_LENGTH2 int NULL
				   , NOTE varchar (max) NULL
				   , CreateDate datetime2 (7) NULL
										 DEFAULT GETDATE () 
				   , RowNbr int IDENTITY) ;
	END;
GO
PRINT 'Created AUDIT table TBL_DIFF2 of 4.';
GO
IF NOT EXISTS (SELECT
					  name

			   --FROM tempdb.dbo.sysobjects

				 FROM sysobjects
				 WHERE ID = OBJECT_ID (N'TBL_DIFF3')) 
	BEGIN
		CREATE TABLE dbo.TBL_DIFF3 (
					 table_name sysname NOT NULL
				   , COLUMN_NAME sysname NULL
				   , DATA_TYPE nvarchar (254) NULL
				   , CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
				   , table_name2 sysname NULL
				   , DATA_TYPE2 nvarchar (254) NULL
				   , COLUMN_NAME2 sysname NULL
				   , CHARACTER_MAXIMUM_LENGTH2 int NULL
				   , NOTE varchar (max) 
				   , CreateDate datetime2 (7) DEFAULT GETDATE () 
				   , RowNbr int IDENTITY) ;
	END;
GO
PRINT 'Created AUDIT table TBL_DIFF3 of 4.';
GO
IF NOT EXISTS (SELECT
					  name

			   --FROM tempdb.dbo.sysobjects

				 FROM sysobjects
				 WHERE ID = OBJECT_ID (N'TBL_DIFF4')) 
	BEGIN
		CREATE TABLE dbo.TBL_DIFF4 (
					 table_name sysname NOT NULL
				   , COLUMN_NAME sysname NULL
				   , DATA_TYPE nvarchar (254) NULL
				   , CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
				   , table_name2 sysname NULL
				   , DATA_TYPE2 nvarchar (254) NULL
				   , COLUMN_NAME2 sysname NULL
				   , CHARACTER_MAXIMUM_LENGTH2 int NULL
				   , NOTE varchar (max) 
				   , CreateDate datetime2 (7) DEFAULT GETDATE () 
				   , RowNbr int IDENTITY) ;
	END;
GO
PRINT 'Created AUDIT table TBL_DIFF4 of 4.';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.views
			 WHERE name = 'view_SchemaDiff') 
	BEGIN
		DROP VIEW
			 view_SchemaDiff;
		PRINT 'Removed view_SchemaDiff.';
	END;
GO
PRINT 'Created view_SchemaDiff.';
GO
CREATE VIEW view_SchemaDiff
AS
	 SELECT
			*
	   FROM TBL_DIFF1
	 UNION
	 SELECT
			*
	   FROM TBL_DIFF2
	 UNION
	 SELECT
			*
	   FROM TBL_DIFF3;
GO
PRINT 'Create View view_SchemaChangeMonitor';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.views
			 WHERE name = 'view_SchemaChangeMonitor') 
	BEGIN
		DROP VIEW
			 view_SchemaChangeMonitor;
	END;
GO
CREATE VIEW view_SchemaChangeMonitor
AS
	 SELECT
			PostTime
		  , DB_User
		  , IP_Address
		  , CUR_User
		  , Event
		  , TSQL
		  , OBJ
		  , RowNbr
	   FROM SchemaChangeMonitor;
GO
PRINT 'Created View view_SchemaChangeMonitor';
GO
PRINT 'Create View SchemaChangeMonitor_rptData';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.views
			 WHERE name = 'view_SchemaChangeMonitor_rptData ') 
	BEGIN
		DROP VIEW
			 view_SchemaChangeMonitor_rptData;
	END;
GO
CREATE VIEW view_SchemaChangeMonitor_rptData
AS
	 SELECT
			label
		  , sText
		  , DisplayOrder
		  , RowNbr
	   FROM dbo.SchemaChangeMonitor_rptData;
GO
PRINT 'Created View view_SchemaChangeMonitor_rptData ';
PRINT 'AUDIT Tables created successfully';
GO



--exec sp_SchemaMonitorReport
GO
Print('FQN: sp_SchemaMonitorReport.SQL');
print ('Creating procedure sp_SchemaMonitorReport ') ;
GO

if exists(select name from sys.objects where name = 'sp_SchemaMonitorReport')
BEGIN 
	drop procedure sp_SchemaMonitorReport ;
END
GO

CREATE proc [dbo].[sp_SchemaMonitorReport]
as
BEGIN
	--print('Start') ;

	truncate table SchemaChangeMonitor_rptData ;

	declare deltas cursor for 
		SELECT PostTime, DB_User, IP_Address, CUR_User, Event, TSQL, OBJ, RowNbr
		FROM     SchemaChangeMonitor
		where PostTime between getdate()-1 and getdate()
		and [Event] in (select [Event] from SchemaChangeMonitorEvent)
		ORDER BY OBJ, PostTime ;
	
	declare @PostTime datetime ;
	declare @DB_User nvarchar(254) ;
	declare @IP_Address nvarchar(254) ;
	declare @CUR_User nvarchar(254) ;
	declare @Event nvarchar(254) ;
	declare @TSQL nvarchar(max) ;
	declare @OBJ nvarchar(254) ;
	declare @DisplayOrder int ;
	declare @RowNbr int ;
	declare @DOrder int ;

	declare @onerecipient varchar(254) ;
	declare @allrecipients varchar(max) = '' ;
	declare @fromDate varchar(254) = cast(getdate()-1 as varchar(254)) ;
	declare @toDate varchar(254) = cast(getdate() as varchar(254)) ;
	declare @subj varchar(254) = 'Schema Mods between ' + @fromDate + ' and ' + @toDate ;

	open deltas;
	fetch next from deltas into @PostTime, @DB_User, @IP_Address, @CUR_User, @Event, @TSQL, @OBJ, @RowNbr ;
	while (@@fetch_status=0)
	begin
			set @DOrder = 1 ; 
			insert into SchemaChangeMonitor_rptData (label,sText,DisplayOrder,RowNbr) 
				values ('OBJ',@OBJ,@DOrder,@RowNbr);
			set @DOrder = 2  ; 
			insert into SchemaChangeMonitor_rptData (label,sText,DisplayOrder,RowNbr) 
				values ('Event',@Event,@DOrder,@RowNbr);
			set @DOrder = 3  ; 
			insert into SchemaChangeMonitor_rptData (label,sText,DisplayOrder,RowNbr) 
				values ('TSQL',@TSQL,@DOrder,@RowNbr);

			set @DOrder = @DOrder +1  ; 
			insert into SchemaChangeMonitor_rptData (label,sText,DisplayOrder,RowNbr) 
				values ('PostTime',@PostTime,@DOrder,@RowNbr);
			set @DOrder = @DOrder +1  ; 
			insert into SchemaChangeMonitor_rptData (label,sText,DisplayOrder,RowNbr) 
				values ('IP_Address',@IP_Address,@DOrder,@RowNbr);
			set @DOrder = @DOrder +1  ; 
			insert into SchemaChangeMonitor_rptData (label,sText,DisplayOrder,RowNbr) 
				values ('DB_User',@DB_User,@DOrder,@RowNbr);
			set @DOrder = @DOrder +1  ; 
			insert into SchemaChangeMonitor_rptData (label,sText,DisplayOrder,RowNbr) 
				values ('CUR_User',@CUR_User,@DOrder,@RowNbr);
			set @DOrder = @DOrder +1  ; 
			insert into SchemaChangeMonitor_rptData (label,sText,DisplayOrder,RowNbr) 
				values ('END','******************************',@DOrder,@RowNbr);

			fetch next from deltas into @PostTime, @DB_User, @IP_Address, @CUR_User, @Event, @TSQL, @OBJ, @RowNbr ;
	end
	close deltas;
	deallocate deltas;

	declare getemails cursor for 
		select EmailAddr from SchemaMonitorObjectNotify ;

	open getemails;
	fetch next from getemails into @onerecipient;
	while (@@fetch_status=0)
	begin
			set @allrecipients = @allrecipients + @onerecipient+';'
			fetch next from getemails into @onerecipient;
	end
	close getemails;
	deallocate getemails;

	declare @CURRSVR as nvarchar(254) = '' ;
	set @CURRSVR = @@servername ;
	declare @ModifiedObjects as nvarchar(max) = 'Server: ' +@CURRSVR + CHAR(13)+CHAR(10) + '- The following DB Objects have been modified within the last 24 hours:'+ CHAR(13)+CHAR(10) ;
	declare @sText as nvarchar(max) ;
	declare getObjs cursor for 
		select distinct sText from view_SchemaChangeMonitor_rptData where label = 'OBJ' 
			group by sText
			order by sText;
	open getObjs;
	fetch next from getObjs into @sText;
	while (@@fetch_status=0)
	begin
			set @ModifiedObjects = @ModifiedObjects + CHAR(13)+CHAR(10) + @sText ;
			fetch next from getObjs into @sText;
	end
	close getObjs;
	deallocate getObjs;

	set @ModifiedObjects = @ModifiedObjects + CHAR(13)+CHAR(10) + ' '  ;
	set @ModifiedObjects = @ModifiedObjects + CHAR(13)+CHAR(10) + '_______________________________________________________'  + CHAR(13)+CHAR(10) ;
	set @ModifiedObjects = @ModifiedObjects +  'The Following Views can be used to review the changes:' + CHAR(13)+CHAR(10) + ' '  ;
	set @ModifiedObjects = @ModifiedObjects +  '    view_SchemaChangeMonitor_rptData' + CHAR(13)+CHAR(10) + ' '  ;
	set @ModifiedObjects = @ModifiedObjects +  '    view_SchemaChangeMonitor' + CHAR(13)+CHAR(10) + ' '  ;


	print (@ModifiedObjects) ;

	print ('Report Sent To: ' + @allrecipients);

		EXEC msdb..sp_send_dbmail
		  @profile_name = 'databaseBot',
		  @recipients = @allrecipients,
		  @subject = @subj,
		  @body = @ModifiedObjects,
		  @execute_query_database = 'msdb',
		  --@query = 'SELECT distinct OBJ, Event, CUR_User, IP_Address, TSQL FROM KenticoCMS_DEV..SchemaChangeMonitor where PostTime between getdate()- 1 and getdate()'
		  --@query = 'select ltrim(rtrim(label)), ltrim(rtrim(sText)), DisplayOrder, RowNbr from KenticoCMS_DEV..SchemaChangeMonitor_rptData'
		  @query = NULL
		  
END

GO
print ('Created sp_SchemaMonitorReport') ;
GO

GO
PRINT 'FQN: SchemaChangeMonitorEvent.SQL';
PRINT 'createing SchemaChangeMonitorEvent table';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.tables
			 WHERE name = 'SchemaChangeMonitorEvent') 
	BEGIN
		DROP TABLE
			 dbo.SchemaChangeMonitorEvent;
	END;
GO
IF NOT EXISTS (SELECT
					  name
				 FROM sys.tables
				 WHERE name = 'SchemaChangeMonitorEvent') 
	BEGIN
		CREATE TABLE dbo.SchemaChangeMonitorEvent (
					 Event nvarchar (254) NULL,) ;
		INSERT INTO SchemaChangeMonitorEvent (
					Event) 
		VALUES
			   ('DROP_VIEW') ;
		INSERT INTO SchemaChangeMonitorEvent (
					Event) 
		VALUES
			   ('ALTER_TABLE') ;
		INSERT INTO SchemaChangeMonitorEvent (
					Event) 
		VALUES
			   ('CREATE_TABLE') ;
		INSERT INTO SchemaChangeMonitorEvent (
					Event) 
		VALUES
			   ('ALTER_VIEW') ;
		INSERT INTO SchemaChangeMonitorEvent (
					Event) 
		VALUES
			   ('CREATE_VIEW') ;
		INSERT INTO SchemaChangeMonitorEvent (
					Event) 
		VALUES
			   ('DROP_TABLE') ;
		INSERT INTO SchemaChangeMonitorEvent (
					Event) 
		VALUES
			   ('RENAME') ;
	END;
GO
PRINT 'created SchemaChangeMonitorEvent table';
GO

GO
PRINT 'FQN: SchemaChangeMonitor.SQL';
PRINT 'Creating SchemaChangeMonitor table';
GO
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
SET ARITHABORT ON
SET CONCAT_NULL_YIELDS_NULL ON
SET NUMERIC_ROUNDABORT OFF
SET QUOTED_IDENTIFIER ON
IF EXISTS (SELECT
				  name
			 FROM sys.tables
			 WHERE name = 'SchemaChangeMonitor') 
	BEGIN
		PRINT 'DROP SchemaChangeMonitor table';
		DROP TABLE
			 dbo.SchemaChangeMonitor;
	END;
IF NOT EXISTS (SELECT
					  name
				 FROM sys.tables
				 WHERE name = 'SchemaChangeMonitor') 
	BEGIN
		
CREATE TABLE [dbo].[SchemaChangeMonitor](
	[PostTime] [datetime2](7) NULL,
	[DB_User] [nvarchar](254) NULL,
	[IP_Address] [nvarchar](254) NULL,
	[CUR_User] [nvarchar](254) NULL,
	[Event] [nvarchar](254) NULL,
	[TSQL] [nvarchar](max) NULL,
	[OBJ] [nvarchar](254) NULL,
	[RowNbr] [int] IDENTITY(1,1) NOT NULL,
	[ServerName] [nvarchar](254) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY] ;

ALTER TABLE [dbo].[SchemaChangeMonitor] ADD  CONSTRAINT [DF_SchemaChangeMonitor_ServerName]  DEFAULT (@@servername) FOR [ServerName];

	END;
GO
GO
PRINT 'Created SchemaChangeMonitor table';
GO


--drop table [TBL_DIFF1] ;
--drop table [TBL_DIFF2] ;
--drop table [TBL_DIFF3] ;
--drop table [TBL_DIFF4] ;

GO
PRINT 'Processing Proc_EDW_Compare_Tables';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.procedures
			 WHERE name = 'Proc_EDW_Compare_Tables') 
	BEGIN
		PRINT 'Updating Proc_EDW_Compare_Tables';
		DROP PROCEDURE
			 Proc_EDW_Compare_Tables;
	END;
GO
CREATE PROCEDURE Proc_EDW_Compare_Tables (@LinkedSVR AS nvarchar (254) 
										, @LinkedDB AS nvarchar (254) 
										, @LinkedTBL AS nvarchar (254) 
										, @CurrDB AS nvarchar (254) 
										, @CurrTBL AS nvarchar (254) 
										, @NewRun AS int) 
AS
	 BEGIN
		 PRINT 'Comparing: ' + @LinkedSVR + ' : ' + @LinkedDB + ' : ' + @LinkedTBL;
		 PRINT 'TO: ' + @CurrDB + ' : ' + @CurrTBL;
		 DECLARE @ParmDefinition AS nvarchar (max) ;
		 DECLARE @retval int = 0;
		 DECLARE @S AS nvarchar (254) = '';
		 DECLARE @SVR AS varchar (254) = @LinkedSVR;
		 DECLARE @iCnt AS int;
		 DECLARE @iRetval AS int = 0;
		 DECLARE @Note AS nvarchar (max) = '';
		 SET @S = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ';
		 SET @ParmDefinition = N'@TgtSVR nvarchar(254), @retval bit OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;
		 IF @iCnt = 1
			 BEGIN EXEC master.sys.sp_dropserver @LinkedSVR, 'droplogins'
			 END;
		 EXEC sp_addlinkedserver @LinkedSVR, 'SQL Server';
		 SET @S = 'select @retval = count(*) from [' + @LinkedSVR + '].[' + @LinkedDB + '].sys.tables where NAME = @TgtTBL ';
		 SET @ParmDefinition = N'@TgtTBL nvarchar(254), @retval int OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtTBL = @LinkedTBL, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;

		 --print ('Step01');

		 IF @iCnt = 0
			 BEGIN
				 PRINT @LinkedTBL + ' : Table does not exist on server ' + @LinkedSVR + ' in database ' + @LinkedDB + '.';
				 DECLARE @SSQL AS nvarchar (max) = '';
				 DECLARE @msg AS nvarchar (max) = '';
				 SET @msg = @LinkedTBL + ' : Table does not exist on server ' + @LinkedSVR + ' in database ' + @LinkedDB + '.';
				 SET @SSQL = 'INSERT INTO TBL_DIFF1 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
				 SET @SSQL = @SSQL + 'VALUES ( ';
				 SET @SSQL = @SSQL + '''' + @CurrTBL + ''', null, null , null, null ,null,null, null, ''' + @msg + ''' ';
				 SET @SSQL = @SSQL + ')';
				 EXEC (@SSQL) ;
				 RETURN;
			 END;

		 --set @S  = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ' ;
		 --set @ParmDefinition  = N'@TgtSVR nvarchar(254), @retval bit OUTPUT' ;
		 --exec sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT ;
		 --set @iCnt = (select @iRetval) ;
		 --IF (@iCnt = 1)
		 --	EXEC master.sys.sp_dropserver @LinkedSVR,'droplogins'  ;
		 --print ('Step02');

		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF1')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF1 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) NULL
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF2')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF2 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) NULL
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF3')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF3 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2(7) DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF4')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF4 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2(7) DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF @NewRun = 1
			 BEGIN
				 truncate TABLE TBL_DIFF1;
				 truncate TABLE TBL_DIFF2;
				 truncate TABLE TBL_DIFF3;
			 END;
		 DECLARE @MySQL AS nvarchar (max) ;
		 SET @MySQL = 'INSERT INTO TBL_DIFF1 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySql + 'select c1.table_name, c1.COLUMN_NAME, c1.DATA_TYPE , cast (c1.CHARACTER_MAXIMUM_LENGTH as nvarchar(254)) as CHARACTER_MAXIMUM_LENGTH, c2.table_name as table_name2 ,c2.DATA_TYPE as DATA_TYPE2 ,c2.COLUMN_NAME as COLUMN_NAME2, c2.CHARACTER_MAXIMUM_LENGTH as CHARACTER_MAXIMUM_LENGTH2, ''Data Types or Data Length Differ'' ';
		 SET @MySQL = @MySQL + 'from [' + @LinkedSVR + '].[' + @LinkedDB + '].[INFORMATION_SCHEMA].[COLUMNS] c1 ';
		 SET @MySQL = @MySQL + 'left join ' + @CurrDB + '.[INFORMATION_SCHEMA].[COLUMNS] c2 on c1.TABLE_NAME = c2.TABLE_NAME ';
		 SET @MySQL = @MySQL + 'where c1.TABLE_NAME= ''' + @LinkedTBL + ''' and c2.TABLE_NAME = ''' + @CurrTBL + ''' ';
		 SET @MySQL = @MySQL + 'and C1.column_name = c2.column_name ';
		 SET @MySQL = @MySQL + 'and ((c1.data_type <> c2.DATA_TYPE) ';
		 SET @MySQL = @MySQL + '		OR (c1.data_type = c2.DATA_TYPE AND c1.CHARACTER_MAXIMUM_LENGTH <> c2.CHARACTER_MAXIMUM_LENGTH))';
		 EXEC (@MySql) ;

		 --print ('Step05');

		 SET @MySQL = '';
		 SET @MySQL = 'INSERT INTO TBL_DIFF2 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySQL + 'SELECT c1.TABLE_NAME, c1.COLUMN_NAME, c1.DATA_TYPE, ''' + @CurrDB + ''' as DBNAME, ''MISSING'' as C1, ''NA'' as C2 , ''NA'' as C3, 0 as I1, ''Column ''+c1.COLUMN_NAME+'' Missing in: ' + @CurrDB + ' / ' + @CurrTBL + ' ''  ';
		 SET @MySQL = @MySQL + ' FROM  [' + @LinkedSVR + '].[' + @LinkedDB + '].INFORMATION_SCHEMA.COLUMNS AS c1 ';
		 SET @MySQL = @MySQL + ' WHERE  C1.table_name = ''' + @CurrTBL + ''' ';
		 SET @MySQL = @MySQL + ' 	AND c1.column_name not in ';
		 SET @MySQL = @MySQL + ' 	(select column_name from ' + @CurrDB + '.INFORMATION_SCHEMA.columns C2 where C2.table_name = ''' + @LinkedTBL + ''') ';
		 EXEC (@MySql) ;

		 --print ('Step06');

		 SET @MySQL = 'INSERT INTO TBL_DIFF3 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySQL + 'SELECT c1.TABLE_NAME, c1.COLUMN_NAME, c1.DATA_TYPE, ''' + @LinkedDB + ''' as DBNAME, ''MISSING'' as C1, ''NA'' as C2, ''NA'' as C3, -1 as I1, ''Column ''+c1.COLUMN_NAME+'' Missing in: ' + @LinkedDB + ' / ' + @LinkedTBL + ' ''  ';
		 SET @MySQL = @MySQL + ' FROM [' + @CurrDB + '].INFORMATION_SCHEMA.COLUMNS as C1 ';
		 SET @MySQL = @MySQL + ' WHERE  C1.table_name = ''' + @CurrTBL + ''' ';
		 SET @MySQL = @MySQL + ' AND c1.column_name not in ';
		 SET @MySQL = @MySQL + ' (select column_name from [' + @LinkedSVR + '].[' + @LinkedDB + '].INFORMATION_SCHEMA.columns C2 where C2.table_name = ''' + @LinkedTBL + ''') ';
		 EXEC (@MySql) ;

		 --print ('Step07');

		 SET @S = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ';
		 SET @ParmDefinition = N'@TgtSVR nvarchar(254), @retval bit OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;
		 IF @iCnt = 1
			 BEGIN EXEC master.sys.sp_dropserver @LinkedSVR, 'droplogins'
			 END;

		 --print ('Step08');

		 IF NOT EXISTS (SELECT
							   name
						  FROM sys.views
						  WHERE name = 'view_SchemaDiff') 
			 BEGIN
				 DECLARE @sTxt AS nvarchar (max) = '';
				 SET @sTxt = @sTxt + 'Create view view_SchemaDiff AS ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF1 ';
				 SET @sTxt = @sTxt + 'union ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF2  ';
				 SET @sTxt = @sTxt + 'union ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF3  ';
				 EXEC (@sTxt) ;
				 PRINT 'Created view view_SchemaDiff.';
			 END;

		 --Select * from TBL_DIFF1 
		 --union
		 --Select * from TBL_DIFF2 
		 --union
		 --Select * from TBL_DIFF3 

		 PRINT 'To see "deltas" - select * from view_SchemaDiff';
		 PRINT '_________________________________________________';
	 END;
GO
PRINT 'Created Proc_EDW_Compare_Tables';
GO

	
--drop table [TBL_DIFF1] ;
--drop table [TBL_DIFF2] ;
--drop table [TBL_DIFF3] ;
--drop table [TBL_DIFF4] ;

GO
PRINT 'Creating Proc_EDW_Compare_Views';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.procedures
			 WHERE name = 'Proc_EDW_Compare_Views') 
	BEGIN
		DROP PROCEDURE
			 Proc_EDW_Compare_Views;
	END;
GO
CREATE PROCEDURE Proc_EDW_Compare_Views (@LinkedSVR AS nvarchar (254) 
									   , @LinkedDB AS nvarchar (254) 
									   , @LinkedVIEW AS nvarchar (254) 
									   , @CurrDB AS nvarchar (254) 
									   , @CurrVIEW AS nvarchar (254) 
									   , @NewRun AS int) 
AS
	 BEGIN
		 DECLARE @ParmDefinition AS nvarchar (max) ;
		 DECLARE @retval int = 0;
		 DECLARE @S AS nvarchar (250) = '';
		 DECLARE @SVR AS varchar (254) = @LinkedSVR;
		 DECLARE @iCnt AS int;
		 DECLARE @iRetval AS int = 0;
		 DECLARE @Note AS nvarchar (max) = '';
		 SET @S = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ';
		 SET @ParmDefinition = N'@TgtSVR nvarchar(254), @retval bit OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;
		 IF @iCnt = 1
			 BEGIN EXEC master.sys.sp_dropserver @LinkedSVR, 'droplogins'
			 END;
		 EXEC sp_addlinkedserver @LinkedSVR, 'SQL Server';
		 SET @S = 'select @retval = count(*) from [' + @LinkedSVR + '].[' + @LinkedDB + '].sys.views where NAME = @TgtVIEW ';
		 SET @ParmDefinition = N'@TgtVIEW nvarchar(254), @retval int OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtVIEW = @LinkedVIEW, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;

		 --print ('Step01');

		 IF @iCnt = 0
			 BEGIN
				 PRINT @LinkedVIEW + ' : VIEW does not exist on server ' + @LinkedSVR + ' in database ' + @LinkedDB + '.';
				 DECLARE @SSQL AS nvarchar (max) = '';
				 DECLARE @msg AS nvarchar (max) = '';
				 SET @msg = @LinkedVIEW + ' : VIEW does not exist on server ' + @LinkedSVR + ' in database ' + @LinkedDB + '.';
				 SET @SSQL = 'INSERT INTO TBL_DIFF1 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
				 SET @SSQL = @SSQL + 'VALUES ( ';
				 SET @SSQL = @SSQL + '''' + @CurrVIEW + ''', null, null , null, null ,null,null, null, ''' + @msg + ''' ';
				 SET @SSQL = @SSQL + ')';
				 EXEC (@SSQL) ;
				 RETURN;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF1')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF1 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF2')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF2 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF3')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF3 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF4')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF4 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF @NewRun = 1
			 BEGIN
				 truncate TABLE TBL_DIFF1;
				 truncate TABLE TBL_DIFF2;
				 truncate TABLE TBL_DIFF3;
			 END;
		 DECLARE @MySQL AS nvarchar (max) ;
		 SET @MySQL = 'INSERT INTO TBL_DIFF1 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySql + 'select c1.table_name, c1.COLUMN_NAME, c1.DATA_TYPE , cast (c1.CHARACTER_MAXIMUM_LENGTH as nvarchar(254)) as CHARACTER_MAXIMUM_LENGTH, c2.table_name as table_name2 ,c2.DATA_TYPE as DATA_TYPE2 ,c2.COLUMN_NAME as COLUMN_NAME2, c2.CHARACTER_MAXIMUM_LENGTH as CHARACTER_MAXIMUM_LENGTH2, ''Data Types or Data Length Differ'' ';
		 SET @MySQL = @MySQL + 'from [' + @LinkedSVR + '].[' + @LinkedDB + '].[INFORMATION_SCHEMA].[COLUMNS] c1 ';
		 SET @MySQL = @MySQL + 'left join ' + @CurrDB + '.[INFORMATION_SCHEMA].[COLUMNS] c2 on c1.TABLE_NAME = c2.TABLE_NAME ';
		 SET @MySQL = @MySQL + 'where c1.TABLE_NAME= ''' + @LinkedVIEW + ''' and c2.TABLE_NAME = ''' + @CurrVIEW + ''' ';
		 SET @MySQL = @MySQL + 'and C1.column_name = c2.column_name ';
		 SET @MySQL = @MySQL + 'and ((c1.data_type <> c2.DATA_TYPE) ';
		 SET @MySQL = @MySQL + '		OR (c1.data_type = c2.DATA_TYPE AND c1.CHARACTER_MAXIMUM_LENGTH <> c2.CHARACTER_MAXIMUM_LENGTH))';
		 EXEC (@MySql) ;

		 --print ('Step05');

		 SET @MySQL = '';
		 SET @MySQL = 'INSERT INTO TBL_DIFF2 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySQL + 'SELECT c1.TABLE_NAME, c1.COLUMN_NAME, c1.DATA_TYPE, ''' + @CurrDB + ''' as DBNAME, ''MISSING'' as C1, ''NA'' as C2 , ''NA'' as C3, 0 as I1, ''Column ''+c1.COLUMN_NAME+'' Missing in: ' + @CurrDB + '/' + @CurrVIEW + ' ''  ';
		 SET @MySQL = @MySQL + ' FROM  [' + @LinkedSVR + '].[' + @LinkedDB + '].INFORMATION_SCHEMA.COLUMNS AS c1 ';
		 SET @MySQL = @MySQL + ' WHERE  C1.table_name = ''' + @CurrVIEW + ''' ';
		 SET @MySQL = @MySQL + ' 	AND c1.column_name not in ';
		 SET @MySQL = @MySQL + ' 	(select column_name from ' + @CurrDB + '.INFORMATION_SCHEMA.columns C2 where C2.table_name = ''' + @LinkedVIEW + ''') ';
		 PRINT @MySql;
		 EXEC (@MySql) ;

		 --print ('Step06');

		 SET @MySQL = 'INSERT INTO TBL_DIFF3 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySQL + 'SELECT c1.TABLE_NAME, c1.COLUMN_NAME, c1.DATA_TYPE, ''' + @LinkedDB + ''' as DBNAME, ''MISSING'' as C1, ''NA'' as C2, ''NA'' as C3, -1 as I1, ''Column ''+c1.COLUMN_NAME+'' Missing in: ' + @LinkedDB + '/' + @LinkedVIEW + ' ''  ';
		 SET @MySQL = @MySQL + ' FROM [' + @CurrDB + '].INFORMATION_SCHEMA.COLUMNS as C1 ';
		 SET @MySQL = @MySQL + ' WHERE  C1.table_name = ''' + @CurrVIEW + ''' ';
		 SET @MySQL = @MySQL + ' AND c1.column_name not in ';
		 SET @MySQL = @MySQL + ' (select column_name from [' + @LinkedSVR + '].[' + @LinkedDB + '].INFORMATION_SCHEMA.columns C2 where C2.table_name = ''' + @LinkedVIEW + ''') ';
		 EXEC (@MySql) ;

		 --print ('Step07');

		 SET @S = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ';
		 SET @ParmDefinition = N'@TgtSVR nvarchar(254), @retval bit OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;
		 IF @iCnt = 1
			 BEGIN EXEC master.sys.sp_dropserver @LinkedSVR, 'droplogins'
			 END;

		 --print ('Step08');

		 IF NOT EXISTS (SELECT
							   name
						  FROM sys.views
						  WHERE name = 'view_SchemaDiff') 
			 BEGIN
				 DECLARE @sTxt AS nvarchar (max) = '';
				 SET @sTxt = @sTxt + 'Create view view_SchemaDiff AS ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF1 ';
				 SET @sTxt = @sTxt + 'union ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF2  ';
				 SET @sTxt = @sTxt + 'union ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF3  ';
				 EXEC (@sTxt) ;
				 PRINT 'Created view view_SchemaDiff.';
			 END;

		 --Select * from TBL_DIFF1 
		 --union
		 --Select * from TBL_DIFF2 
		 --union
		 --Select * from TBL_DIFF3 

		 PRINT 'To see "deltas" - select * from view_SchemaDiff';
		 PRINT '_________________________________________________';

	 --print ('Step09');

	 END;
GO
PRINT 'Created Proc_EDW_Compare_Views';
GO

GO
PRINT 'Creating Proc_EDW_Compare_MASTER';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.procedures
			 WHERE name = 'Proc_EDW_Compare_MASTER') 
	BEGIN
		DROP PROCEDURE
			 Proc_EDW_Compare_MASTER;
	END;
GO
CREATE PROC Proc_EDW_Compare_MASTER (@LinkedSVR AS nvarchar (254) 
								   , @LinkedDB AS nvarchar (254) 
								   , @CurrDB AS nvarchar (254)) 
AS
	 BEGIN
		 DECLARE @LinkedVIEW AS nvarchar (254) ;
		 DECLARE @CurrVIEW AS nvarchar (254) ;
		 DECLARE @NewRun AS int = 0;
		 SET @LinkedVIEW = 'SchemaChangeMonitor';
		 SET @CurrVIEW = 'SchemaChangeMonitor';
		 SET @NewRun = 1;
		 SET @LinkedVIEW = 'CMS_Class';
		 SET @CurrVIEW = 'CMS_Class';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @NewRun = 0;
		 SET @LinkedVIEW = 'CMS_Document';
		 SET @CurrVIEW = 'CMS_Document';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'CMS_Site';
		 SET @CurrVIEW = 'CMS_Site';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'CMS_Tree';
		 SET @CurrVIEW = 'CMS_Tree';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'CMS_User';
		 SET @CurrVIEW = 'CMS_User';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'CMS_UserSettings';
		 SET @CurrVIEW = 'CMS_UserSettings';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'CMS_UserSite';
		 SET @CurrVIEW = 'CMS_UserSite';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'COM_SKU';
		 SET @CurrVIEW = 'COM_SKU';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'EDW_HealthAssessment';
		 SET @CurrVIEW = 'EDW_HealthAssessment';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'EDW_HealthAssessmentDefinition';
		 SET @CurrVIEW = 'EDW_HealthAssessmentDefinition';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_Account';
		 SET @CurrVIEW = 'HFit_Account';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_Coaches';
		 SET @CurrVIEW = 'HFit_Coaches';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_Company';
		 SET @CurrVIEW = 'HFit_Company';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_Goal';
		 SET @CurrVIEW = 'HFit_Goal';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_GoalOutcome';
		 SET @CurrVIEW = 'HFit_GoalOutcome';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HACampaign';
		 SET @CurrVIEW = 'HFit_HACampaign';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentMatrixQuestion';
		 SET @CurrVIEW = 'HFit_HealthAssesmentMatrixQuestion';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentModule';
		 SET @CurrVIEW = 'HFit_HealthAssesmentModule';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentMultipleChoiceQuestion';
		 SET @CurrVIEW = 'HFit_HealthAssesmentMultipleChoiceQuestion';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentPredefinedAnswer';
		 SET @CurrVIEW = 'HFit_HealthAssesmentPredefinedAnswer';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentRiskArea';
		 SET @CurrVIEW = 'HFit_HealthAssesmentRiskArea';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentRiskCategory';
		 SET @CurrVIEW = 'HFit_HealthAssesmentRiskCategory';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentUserAnswers';
		 SET @CurrVIEW = 'HFit_HealthAssesmentUserAnswers';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentUserModule';
		 SET @CurrVIEW = 'HFit_HealthAssesmentUserModule';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentUserQuestion';
		 SET @CurrVIEW = 'HFit_HealthAssesmentUserQuestion';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentUserQuestionGroupResults';
		 SET @CurrVIEW = 'HFit_HealthAssesmentUserQuestionGroupResults';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentUserRiskArea';
		 SET @CurrVIEW = 'HFit_HealthAssesmentUserRiskArea';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentUserRiskCategory';
		 SET @CurrVIEW = 'HFit_HealthAssesmentUserRiskCategory';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssesmentUserStarted';
		 SET @CurrVIEW = 'HFit_HealthAssesmentUserStarted';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssessment';
		 SET @CurrVIEW = 'HFit_HealthAssessment';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_HealthAssessmentFreeForm';
		 SET @CurrVIEW = 'HFit_HealthAssessmentFreeForm';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_LKP_Frequency';
		 SET @CurrVIEW = 'HFit_LKP_Frequency';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_LKP_GoalStatus';
		 SET @CurrVIEW = 'HFit_LKP_GoalStatus';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_LKP_RewardLevelType';
		 SET @CurrVIEW = 'HFit_LKP_RewardLevelType';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_LKP_RewardTrigger';
		 SET @CurrVIEW = 'HFit_LKP_RewardTrigger';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_LKP_RewardTriggerParameterOperator';
		 SET @CurrVIEW = 'HFit_LKP_RewardTriggerParameterOperator';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_LKP_RewardType';
		 SET @CurrVIEW = 'HFit_LKP_RewardType';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_LKP_UnitOfMeasure';
		 SET @CurrVIEW = 'HFit_LKP_UnitOfMeasure';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'hfit_ppteligibility';
		 SET @CurrVIEW = 'hfit_ppteligibility';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardActivity';
		 SET @CurrVIEW = 'HFit_RewardActivity';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardException';
		 SET @CurrVIEW = 'HFit_RewardException';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardGroup';
		 SET @CurrVIEW = 'HFit_RewardGroup';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardLevel';
		 SET @CurrVIEW = 'HFit_RewardLevel';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardProgram';
		 SET @CurrVIEW = 'HFit_RewardProgram';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardsAwardUserDetail';
		 SET @CurrVIEW = 'HFit_RewardsAwardUserDetail';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardsUserActivityDetail';
		 SET @CurrVIEW = 'HFit_RewardsUserActivityDetail';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardsUserLevelDetail';
		 SET @CurrVIEW = 'HFit_RewardsUserLevelDetail';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardTrigger';
		 SET @CurrVIEW = 'HFit_RewardTrigger';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_RewardTriggerParameter';
		 SET @CurrVIEW = 'HFit_RewardTriggerParameter';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_Tobacco_Goal';
		 SET @CurrVIEW = 'HFit_Tobacco_Goal';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFIT_Tracker';
		 SET @CurrVIEW = 'HFIT_Tracker';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerBloodPressure';
		 SET @CurrVIEW = 'HFit_TrackerBloodPressure';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerBloodSugarAndGlucose';
		 SET @CurrVIEW = 'HFit_TrackerBloodSugarAndGlucose';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerBMI';
		 SET @CurrVIEW = 'HFit_TrackerBMI';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerBodyFat';
		 SET @CurrVIEW = 'HFit_TrackerBodyFat';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerBodyMeasurements';
		 SET @CurrVIEW = 'HFit_TrackerBodyMeasurements';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerCardio';
		 SET @CurrVIEW = 'HFit_TrackerCardio';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerCholesterol';
		 SET @CurrVIEW = 'HFit_TrackerCholesterol';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerCollectionSource';
		 SET @CurrVIEW = 'HFit_TrackerCollectionSource';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerDailySteps';
		 SET @CurrVIEW = 'HFit_TrackerDailySteps';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerFlexibility';
		 SET @CurrVIEW = 'HFit_TrackerFlexibility';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerFruits';
		 SET @CurrVIEW = 'HFit_TrackerFruits';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerHbA1c';
		 SET @CurrVIEW = 'HFit_TrackerHbA1c';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerHeight';
		 SET @CurrVIEW = 'HFit_TrackerHeight';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerHighFatFoods';
		 SET @CurrVIEW = 'HFit_TrackerHighFatFoods';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerHighSodiumFoods';
		 SET @CurrVIEW = 'HFit_TrackerHighSodiumFoods';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerInstance_Tracker';
		 SET @CurrVIEW = 'HFit_TrackerInstance_Tracker';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerMealPortions';
		 SET @CurrVIEW = 'HFit_TrackerMealPortions';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerMedicalCarePlan';
		 SET @CurrVIEW = 'HFit_TrackerMedicalCarePlan';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerRegularMeals';
		 SET @CurrVIEW = 'HFit_TrackerRegularMeals';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerRestingHeartRate';
		 SET @CurrVIEW = 'HFit_TrackerRestingHeartRate';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerShots';
		 SET @CurrVIEW = 'HFit_TrackerShots';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerSitLess';
		 SET @CurrVIEW = 'HFit_TrackerSitLess';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerSleepPlan';
		 SET @CurrVIEW = 'HFit_TrackerSleepPlan';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerStrength';
		 SET @CurrVIEW = 'HFit_TrackerStrength';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerStress';
		 SET @CurrVIEW = 'HFit_TrackerStress';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerStressManagement';
		 SET @CurrVIEW = 'HFit_TrackerStressManagement';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerSugaryDrinks';
		 SET @CurrVIEW = 'HFit_TrackerSugaryDrinks';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerSugaryFoods';
		 SET @CurrVIEW = 'HFit_TrackerSugaryFoods';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerTests';
		 SET @CurrVIEW = 'HFit_TrackerTests';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerTobaccoFree';
		 SET @CurrVIEW = 'HFit_TrackerTobaccoFree';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerVegetables';
		 SET @CurrVIEW = 'HFit_TrackerVegetables';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerWater';
		 SET @CurrVIEW = 'HFit_TrackerWater';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerWeight';
		 SET @CurrVIEW = 'HFit_TrackerWeight';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_TrackerWholeGrains';
		 SET @CurrVIEW = 'HFit_TrackerWholeGrains';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'HFit_UserGoal';
		 SET @CurrVIEW = 'HFit_UserGoal';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'Tracker_EDW_Metadata';
		 SET @CurrVIEW = 'Tracker_EDW_Metadata';
		 EXEC Proc_EDW_Compare_Tables @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'View_CMS_Tree_Joined';
		 SET @CurrVIEW = 'View_CMS_Tree_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_CMS_Tree_Joined_Linked';
		 SET @CurrVIEW = 'VIEW_CMS_Tree_Joined_Linked';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_CMS_Tree_Joined_Regular';
		 SET @CurrVIEW = 'VIEW_CMS_Tree_Joined_Regular';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_COM_SKU';
		 SET @CurrVIEW = 'VIEW_COM_SKU';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_ClientCompany';
		 SET @CurrVIEW = 'VIEW_EDW_ClientCompany';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_Coaches';
		 SET @CurrVIEW = 'VIEW_EDW_Coaches';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_CoachingDefinition';
		 SET @CurrVIEW = 'VIEW_EDW_CoachingDefinition';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_CoachingDetail';
		 SET @CurrVIEW = 'VIEW_EDW_CoachingDetail';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HAassessment';
		 SET @CurrVIEW = 'VIEW_EDW_HAassessment';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HADefinition';
		 SET @CurrVIEW = 'VIEW_EDW_HADefinition';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HealthAssesment';
		 SET @CurrVIEW = 'VIEW_EDW_HealthAssesment';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HealthAssesmentAnswers';
		 SET @CurrVIEW = 'VIEW_EDW_HealthAssesmentAnswers';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HealthAssesmentClientView';
		 SET @CurrVIEW = 'VIEW_EDW_HealthAssesmentClientView';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HealthAssesmentDeffinition';
		 SET @CurrVIEW = 'VIEW_EDW_HealthAssesmentDeffinition';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HealthAssesmentDeffinitionCustom';
		 SET @CurrVIEW = 'VIEW_EDW_HealthAssesmentDeffinitionCustom';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HealthAssesmentQuestions';
		 SET @CurrVIEW = 'VIEW_EDW_HealthAssesmentQuestions';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HealthAssessment_Staged';
		 SET @CurrVIEW = 'VIEW_EDW_HealthAssessment_Staged';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_HealthAssessmentDefinition_Staged';
		 SET @CurrVIEW = 'VIEW_EDW_HealthAssessmentDefinition_Staged';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_Participant';
		 SET @CurrVIEW = 'VIEW_EDW_Participant';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_RewardAwardDetail';
		 SET @CurrVIEW = 'VIEW_EDW_RewardAwardDetail';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_RewardsDefinition';
		 SET @CurrVIEW = 'VIEW_EDW_RewardsDefinition';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_RewardTriggerParameters';
		 SET @CurrVIEW = 'VIEW_EDW_RewardTriggerParameters';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_RewardUserDetail';
		 SET @CurrVIEW = 'VIEW_EDW_RewardUserDetail';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_ScreeningsFromTrackers';
		 SET @CurrVIEW = 'VIEW_EDW_ScreeningsFromTrackers';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_TrackerCompositeDetails';
		 SET @CurrVIEW = 'VIEW_EDW_TrackerCompositeDetails';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_TrackerMetadata';
		 SET @CurrVIEW = 'VIEW_EDW_TrackerMetadata';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_TrackerShots';
		 SET @CurrVIEW = 'VIEW_EDW_TrackerShots';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_EDW_TrackerTests';
		 SET @CurrVIEW = 'VIEW_EDW_TrackerTests';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_Goal_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_Goal_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_HACampaign_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_HACampaign_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_HealthAssesmentMatrixQuestion_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_HealthAssesmentMatrixQuestion_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_HealthAssesmentModule_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_HealthAssesmentModule_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_HealthAssesmentMultipleChoiceQuestion_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_HealthAssesmentMultipleChoiceQuestion_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_HealthAssesmentPredefinedAnswer_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_HealthAssesmentPredefinedAnswer_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_HealthAssesmentRiskArea_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_HealthAssesmentRiskArea_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_HealthAssesmentRiskCategory_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_HealthAssesmentRiskCategory_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_HealthAssessment_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_HealthAssessment_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_HealthAssessmentFreeForm_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_HealthAssessmentFreeForm_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_RewardActivity_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_RewardActivity_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_RewardGroup_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_RewardGroup_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_RewardLevel_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_RewardLevel_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_RewardProgram_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_RewardProgram_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_RewardTrigger_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_RewardTrigger_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_RewardTriggerParameter_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_RewardTriggerParameter_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SET @LinkedVIEW = 'VIEW_HFit_Tobacco_Goal_Joined';
		 SET @CurrVIEW = 'VIEW_HFit_Tobacco_Goal_Joined';
		 EXEC Proc_EDW_Compare_Views @LinkedSVR, @LinkedDB, @LinkedVIEW, @CurrDB, @CurrVIEW, @NewRun;

		 --GO

		 SELECT
				*
		   FROM view_SchemaDiff;
	 END;
GO
PRINT 'CREATED Proc_EDW_Compare_MASTER';
GO 




GO
PRINT 'FQN: Create_Job_SchemaMonitorReport.SQL';
PRINT 'Processing Job SchemaMonitorReport (wdm)';
GO
GO
IF EXISTS (SELECT
				  job_id
			 FROM msdb.dbo.sysjobs_view
			 WHERE name = N'SchemaMonitorReport') 
	BEGIN EXEC msdb.dbo.sp_delete_job @job_name = N'SchemaMonitorReport', @delete_unused_schedule = 1;
	END;
GO

/**********************************************************************************
***** Object:  Job [SchemaMonitorReport]    Script Date: 2/24/2015 2:23:59 PM *****
**********************************************************************************/

declare @DB as nvarchar(254) = DB_NAME() ;

BEGIN TRANSACTION;
DECLARE @ReturnCode int;
SELECT
	   @ReturnCode = 0;

/***********************************************************************************************
***** Object:  JobCategory [[Uncategorized (Local)]]]    Script Date: 2/24/2015 2:24:00 PM *****
***********************************************************************************************/

IF NOT EXISTS (SELECT
					  name
				 FROM msdb.dbo.syscategories
				 WHERE name = N'[Uncategorized (Local)]'
				   AND category_class = 1) 
	BEGIN EXEC @ReturnCode = msdb.dbo.sp_add_category @class = N'JOB', @type = N'LOCAL', @name = N'[Uncategorized (Local)]';
		IF @@ERROR <> 0
		OR @ReturnCode <> 0
			BEGIN
				GOTO QuitWithRollback
			END;
	END;
DECLARE @jobId binary (16) ;
EXEC @ReturnCode = msdb.dbo.sp_add_job @job_name = N'SchemaMonitorReport', @enabled = 1, @notify_level_eventlog = 2, @notify_level_email = 0, @notify_level_netsend = 0, @notify_level_page = 0, @delete_level = 0, @description = N'No description available.', @category_name = N'[Uncategorized (Local)]', @owner_login_name = N'sa', @job_id = @jobId OUTPUT;
IF @@ERROR <> 0
OR @ReturnCode <> 0
	BEGIN
		GOTO QuitWithRollback
	END;

/**********************************************************************************************
***** Object:  Step [execute sp_SchemaMonitorReport]    Script Date: 2/24/2015 2:24:01 PM *****
**********************************************************************************************/

EXEC @ReturnCode = msdb.dbo.sp_add_jobstep @job_id = @jobId, @step_name = N'execute sp_SchemaMonitorReport', @step_id = 1, @cmdexec_success_code = 0, @on_success_action = 1, @on_success_step_id = 0, @on_fail_action = 2, @on_fail_step_id = 0, @retry_attempts = 0, @retry_interval = 0, @os_run_priority = 0, @subsystem = N'TSQL', @command = N'exec sp_SchemaMonitorReport', @database_name = @DB, @flags = 0;
IF @@ERROR <> 0
OR @ReturnCode <> 0
	BEGIN
		GOTO QuitWithRollback
	END;
EXEC @ReturnCode = msdb.dbo.sp_update_job @job_id = @jobId, @start_step_id = 1;
IF @@ERROR <> 0
OR @ReturnCode <> 0
	BEGIN
		GOTO QuitWithRollback
	END;
EXEC @ReturnCode = msdb.dbo.sp_add_jobschedule @job_id = @jobId, @name = N'SchemaMonitorReport Schedule', @enabled = 1, @freq_type = 4, @freq_interval = 1, @freq_subday_type = 1, @freq_subday_interval = 0, @freq_relative_interval = 0, @freq_recurrence_factor = 0, @active_start_date = 20141017, @active_end_date = 99991231, @active_start_time = 220000, @active_end_time = 235959, @schedule_uid = N'd64376a9-39f9-4344-b403-5526b03d70d7';
IF @@ERROR <> 0
OR @ReturnCode <> 0
	BEGIN
		GOTO QuitWithRollback
	END;
EXEC @ReturnCode = msdb.dbo.sp_add_jobschedule @job_id = @jobId, @name = N'SchemaMonitorReport Schedule', @enabled = 1, @freq_type = 4, @freq_interval = 1, @freq_subday_type = 1, @freq_subday_interval = 0, @freq_relative_interval = 0, @freq_recurrence_factor = 0, @active_start_date = 20141017, @active_end_date = 99991231, @active_start_time = 220000, @active_end_time = 235959, @schedule_uid = N'37dd0949-b104-47c6-864c-2df7b166d28f';
IF @@ERROR <> 0
OR @ReturnCode <> 0
	BEGIN
		GOTO QuitWithRollback
	END;
EXEC @ReturnCode = msdb.dbo.sp_add_jobserver @job_id = @jobId, @server_name = N'(local)';
IF @@ERROR <> 0
OR @ReturnCode <> 0
	BEGIN
		GOTO QuitWithRollback
	END;
COMMIT TRANSACTION;
GOTO EndSave;
QuitWithRollback:
IF @@TRANCOUNT > 0
	BEGIN
		ROLLBACK TRANSACTION
	END;
EndSave:
GO

--DECLARE @CurrDB AS nvarchar (250) = (SELECT TOP 1
--											CurrDB
--									   FROM #SMR_CurrDB) ;
--DECLARE @MSQL AS nvarchar (250) = 'USE ' + @CurrDB;
--EXEC (@MSQL) ;
PRINT 'Switched back to DB ' + DB_NAME () ;
GO
PRINT 'Job SchemaMonitorReport created.';
GO

print (' ' );
print ('Processing complete - please check for errors.' );--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





/***********************************************************
Copyright @ DMA Limited, June 2012, all rights reserved.
FIND a top level view's nested tables and views using a CTE.
Author: W. Dale Miller
Description:
  A recursive CTE requires four elements in order to work properly.
  Anchor query (runs once and the results seed the Recursive query)
  Recursive query (runs multiple times and is the criteria for the remaining results)
  UNION ALL statement to bind the Anchor and Recursive queries together.
  INNER JOIN statement to bind the Recursive query to the results of the CTE.
***********************************************************/


/***************************************************************
exec proc_GetViewBaseTables 'view_EDW_HealthAssesment'
exec proc_GetViewBaseTablesExpanded 'view_EDW_HealthAssesment'
exec proc_GetViewBaseTables 'View_EDW_HealthAssesmentQuestions'
exec proc_GetViewBaseTables 'view_EDW_BioMetrics'
exec proc_GetViewBaseTables 'view_EDW_TrackerCompositeDetails'
***************************************************************/

go

if exists (select name from sys.procedures where name = 'proc_GetViewBaseTables')
BEGIN
    drop procedure proc_GetViewBaseTables ;
END

GO
create procedure proc_GetViewBaseTables (@tgtView as nvarchar(100))
as 
begin
WITH mycte
    AS (SELECT 
               --TU.view_name
             TU.Table_Name
             , IST.TABLE_TYPE
               FROM
                    INFORMATION_SCHEMA.VIEW_TABLE_USAGE AS TU WITH (NOLOCK) 
                        JOIN INFORMATION_SCHEMA.tables AS IST
                            ON IST.TABLE_NAME = TU.TABLE_NAME
          WHERE view_name = @tgtView

        UNION ALL

        SELECT 
             --  ISV.view_name
             ISV.Table_Name
             , IST.TABLE_TYPE
               FROM
                    INFORMATION_SCHEMA.VIEW_TABLE_USAGE AS ISV
                        JOIN INFORMATION_SCHEMA.tables AS IST
                            ON IST.TABLE_NAME = ISV.TABLE_NAME
                        INNER JOIN mycte
                            ON ISV.view_name = mycte.table_name
    ) 

    SELECT DISTINCT  table_name, table_type
           FROM mycte
      ORDER BY
               table_name;
end 

go


if exists (select name from sys.procedures where name = 'proc_GetViewBaseTablesExpanded')
BEGIN
    drop procedure proc_GetViewBaseTablesExpanded ;
END
go
--exec proc_GetViewBaseTablesExpanded 'view_EDW_HealthAssesment'
create procedure proc_GetViewBaseTablesExpanded (@tgtView as nvarchar(100))
as 
begin
WITH mycte
    AS (SELECT 
               TU.view_name
             , TU.Table_Name
             , IST.TABLE_TYPE
               FROM
                    INFORMATION_SCHEMA.VIEW_TABLE_USAGE AS TU WITH (NOLOCK) 
                        JOIN INFORMATION_SCHEMA.tables AS IST
                            ON IST.TABLE_NAME = TU.TABLE_NAME
          WHERE view_name = @tgtView

        UNION ALL

        SELECT 
               ISV.view_name
             , ISV.Table_Name
             , IST.TABLE_TYPE
               FROM
                    INFORMATION_SCHEMA.VIEW_TABLE_USAGE AS ISV
                        JOIN INFORMATION_SCHEMA.tables AS IST
                            ON IST.TABLE_NAME = ISV.TABLE_NAME
                        INNER JOIN mycte
                            ON ISV.view_name = mycte.table_name
    ) 

    SELECT DISTINCT view_name, table_name, table_type
           FROM mycte
      ORDER BY
               view_name, table_name;
end 

go


GO
PRINT 'Creating table HFit_LKP_GoalCloseReason for SR-47923 ';
GO

-- 01.02.2014 (WDM) added column HFUG.CloseReasonLKPID in order to satisfy Story #47923

IF EXISTS (SELECT name
			 FROM sys.tables
			 WHERE name = 'HFit_LKP_GoalCloseReason') 
	BEGIN
		PRINT 'Dropping table HFit_LKP_GoalCloseReason';
		DROP TABLE dbo.HFit_LKP_GoalCloseReason;
	END;
GO
CREATE TABLE dbo.HFit_LKP_GoalCloseReason (
	ItemID int IDENTITY (1, 1) NOT NULL, 
	CloseReasonID int NOT NULL, 
	CloseReason varchar (250) NOT NULL, 
	ItemCreatedBy int NULL, 
	ItemCreatedWhen datetime2 (7) NULL, 
	ItemModifiedBy int NULL, 
	ItemModifiedWhen datetime2 (7) NULL, 
	ItemOrder int NULL, 
	ItemGUID uniqueidentifier NOT NULL, 
	CONSTRAINT PK_HFit_LKP_GoalCloseReason PRIMARY KEY CLUSTERED (CloseReasonID ASC) 
		WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) 
		ON [PRIMARY]) 
ON [PRIMARY];
GO
SET ANSI_PADDING OFF;
GO
ALTER TABLE dbo.HFit_LKP_GoalCloseReason
ADD CONSTRAINT DEFAULT_HFit_LKP_GoalCloseReason_ItemGUID DEFAULT '00000000-0000-0000-0000-000000000000' FOR ItemGUID;
GO
IF NOT EXISTS (SELECT name
				 FROM sys.indexes
				 WHERE name = 'CI_HFit_LKP_GoalCloseReason') 
	BEGIN
		PRINT 'Creating index [CI_HFit_LKP_GoalCloseReason]';
		CREATE UNIQUE NONCLUSTERED INDEX CI_HFit_LKP_GoalCloseReason ON dbo.HFit_LKP_GoalCloseReason (CloseReasonID ASC) INCLUDE (CloseReason) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ;
	END;
GO
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (0, 'Not Set', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (1, 'Achieved Personal target', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (2, 'Change In Tx Plan', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (3, 'Setback', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (4, 'Not Interested', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (5, 'Not Eligible', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (6, 'Program Period End', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
GO
--SELECT * FROM HFit_LKP_GoalCloseReason;
GO
PRINT 'Created HFit_LKP_GoalCloseReason';
GO--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
print ('FROM Create_HFit_LKP_TrackerVendor_Table.SQL') ;

if not exists (select name from sys.tables where name = 'HFit_LKP_TrackerVendor')
BEGIN
print ('Creating table [HFit_LKP_TrackerVendor]') ;
CREATE TABLE [dbo].[HFit_LKP_TrackerVendor](
	[ItemID] [int] IDENTITY(1,1) NOT NULL,
	[VendorName] [varchar](32) NOT NULL,
	[ItemCreatedBy] [int] NULL,
	[ItemCreatedWhen] [datetime2] (7)  NULL,
	[ItemModifiedBy] [int] NULL,
	[ItemModifiedWhen] [datetime2] (7)  NULL,
	[ItemOrder] [int] NULL,
	[ItemGUID] [uniqueidentifier] NOT NULL,
 CONSTRAINT [PK_HFit_LKP_TrackerVendor] PRIMARY KEY CLUSTERED 
(
	[ItemID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] ;

ALTER TABLE [dbo].[HFit_LKP_TrackerVendor] ADD  CONSTRAINT [DEFAULT_HFit_LKP_TrackerVendor_ItemGUID]  DEFAULT ('00000000-0000-0000-0000-000000000000') FOR [ItemGUID];

insert into HFit_LKP_TrackerVendor ([VendorName]) values ('crossover');
insert into HFit_LKP_TrackerVendor ([VendorName]) values ('meds');
insert into HFit_LKP_TrackerVendor ([VendorName]) values ('labcorp');
insert into HFit_LKP_TrackerVendor ([VendorName]) values ('quest_diag');
insert into HFit_LKP_TrackerVendor ([VendorName]) values ('staywell');
insert into HFit_LKP_TrackerVendor ([VendorName]) values ('walgreens_health');
insert into HFit_LKP_TrackerVendor ([VendorName]) values ('supervalu');

END
GO
--select * from HFit_LKP_TrackerVendor
print ('CREATED table [HFit_LKP_TrackerVendor]') ;
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;






GO

Print ('From SynchronizeTrackerTables.SQL') ;
Print ('BEGIN Synchronize Tracker Tables') ;
GO

SET NOEXEC OFF;
SET ANSI_WARNINGS ON;
SET XACT_ABORT ON;
SET IMPLICIT_TRANSACTIONS OFF;
SET ARITHABORT ON;
SET NOCOUNT ON;
SET QUOTED_IDENTIFIER ON;
SET NUMERIC_ROUNDABORT OFF;
SET CONCAT_NULL_YIELDS_NULL ON;
SET ANSI_NULLS ON;
SET ANSI_PADDING ON;
GO

-- Add Default Constraint DEFAULT_HFit_TrackerSugaryDrinks_EventDate to [dbo].[HFit_TrackerSugaryDrinks]
-- Verify Column VendorID to [dbo].[HFit_TrackerBodyFat]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerBodyFat]';
GO
If NOT exists (select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME = 'HFit_TrackerBodyFat' and COLUMN_NAME = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerBodyFat ADD VendorID int NULL;
END 
GO

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerBMI]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerBMI' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerBMI ADD VendorID int NULL;
END
GO
-- Verify Column VendorID to [dbo].[HFit_TrackerBloodSugarAndGlucose]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerBloodSugarAndGlucose]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerBloodSugarAndGlucose' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerBloodSugarAndGlucose ADD VendorID int NULL;
END
GO

-- Verify Column IncludeTime to [dbo].[HFit_TrackerBloodSugarAndGlucose]

PRINT 'Verify Column IncludeTime to [dbo].[HFit_TrackerBloodSugarAndGlucose]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerBloodSugarAndGlucose' and column_name = 'IncludeTime')
BEGIN
ALTER TABLE dbo.HFit_TrackerBloodSugarAndGlucose ADD IncludeTime bit NOT NULL CONSTRAINT DEFAULT_HFit_TrackerBloodSugarAndGlucose_IncludeTime DEFAULT 0;
END
GO
-- Verify Column VendorID to [dbo].[HFit_TrackerBloodPressure]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerBloodPressure]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerBloodPressure' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerBloodPressure ADD VendorID int NULL;
END
GO

-- Verify Column IncludeTime to [dbo].[HFit_TrackerBloodPressure]

PRINT 'Verify Column IncludeTime to [dbo].[HFit_TrackerBloodPressure]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerBloodPressure' and column_name = 'IncludeTime')
BEGIN
ALTER TABLE dbo.HFit_TrackerBloodPressure ADD IncludeTime bit NOT NULL CONSTRAINT DEFAULT_HFit_TrackerBloodPressure_IncludeTime DEFAULT 0;
END
GO

-- Verify Column VendorID to [dbo].[HFit_TrackerCholesterol]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerCholesterol]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerCholesterol' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerCholesterol ADD VendorID int NULL;
END
GO

-- Create Index idx_HFit_TrackerCholesterol_UserIDEventDate on [dbo].[HFit_TrackerCholesterol]

PRINT 'Create Index idx_HFit_TrackerCholesterol_UserIDEventDate on [dbo].[HFit_TrackerCholesterol]';
GO
if not exists (select name from sys.indexes where name = 'idx_HFit_TrackerCholesterol_UserIDEventDate')
BEGIN
CREATE NONCLUSTERED INDEX idx_HFit_TrackerCholesterol_UserIDEventDate ON dbo.HFit_TrackerCholesterol (EventDate, UserID) ;
END
GO

-- Verify Column VendorID to [dbo].[HFit_TrackerBodyMeasurements]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerBodyMeasurements]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerBodyMeasurements' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerBodyMeasurements ADD VendorID int NULL;
END
GO

-- Verify Column VendorID to [dbo].[HFit_TrackerHbA1c]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerHbA1c]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerHbA1c' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerHbA1c ADD VendorID int NULL;
END
GO
-- Verify Column VendorID to [dbo].[HFit_TrackerHeight]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerHeight]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerHeight' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerHeight ADD VendorID int NULL;
END
GO
-- Verify Column VendorID to [dbo].[HFit_TrackerTests]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerTests]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerTests' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerTests ADD VendorID int NULL;
END
GO

-- Verify Column VendorID to [dbo].[HFit_TrackerWeight]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerWeight]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerWeight' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerWeight ADD VendorID int NULL;
END
GO

-- Verify Column IncludeTime to [dbo].[HFit_TrackerWeight]

PRINT 'Verify Column IncludeTime to [dbo].[HFit_TrackerWeight]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerWeight' and column_name = 'IncludeTime')
BEGIN
ALTER TABLE dbo.HFit_TrackerWeight ADD IncludeTime bit NOT NULL CONSTRAINT DEFAULT_HFit_TrackerWeight_IncludeTime DEFAULT 0;
END
GO

-- Verify Column VendorID to [dbo].[HFit_TrackerRestingHeartRate]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerRestingHeartRate]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerRestingHeartRate' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerRestingHeartRate ADD VendorID int NULL;
END
GO
-- Verify Column IncludeTime to [dbo].[HFit_TrackerRestingHeartRate]

PRINT 'Verify Column IncludeTime to [dbo].[HFit_TrackerRestingHeartRate]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerRestingHeartRate' and column_name = 'IncludeTime')
BEGIN
ALTER TABLE dbo.HFit_TrackerRestingHeartRate ADD IncludeTime bit NOT NULL CONSTRAINT DEFAULT_HFit_TrackerRestingHeartRate_IncludeTime DEFAULT 0;
END
GO

-- Verify Column VendorID to [dbo].[HFit_TrackerShots]

PRINT 'Verify Column VendorID to [dbo].[HFit_TrackerShots]';
GO
if NOT EXISTS (Select COLUMN_NAME from information_schema.COLUMNS where table_name = 'HFit_TrackerShots' and column_name = 'VendorID')
BEGIN
ALTER TABLE dbo.HFit_TrackerShots ADD VendorID int NULL;
END
GO

---- Create Foreign Key FK_HFit_TrackerBloodPressure_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBloodPressure]

--PRINT 'Create Foreign Key FK_HFit_TrackerBloodPressure_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBloodPressure]';
--GO
--if NOT EXISTS (Select name from sys.objects where name = 'FK_HFit_TrackerBloodPressure_HFit_LKP_TrackerVendor')
--BEGIN
--ALTER TABLE dbo.HFit_TrackerBloodPressure
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerBloodPressure_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerBloodPressure CHECK CONSTRAINT FK_HFit_TrackerBloodPressure_HFit_LKP_TrackerVendor;
--END
--GO

---- Create Foreign Key FK_HFit_TrackerBloodSugarAndGlucose_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBloodSugarAndGlucose]

--PRINT 'Create Foreign Key FK_HFit_TrackerBloodSugarAndGlucose_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBloodSugarAndGlucose]';
--GO
--if NOT EXISTS (Select name from sys.objects where name = 'FK_HFit_TrackerBloodSugarAndGlucose_HFit_LKP_TrackerVendor')
--BEGIN
--ALTER TABLE dbo.HFit_TrackerBloodSugarAndGlucose
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerBloodSugarAndGlucose_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerBloodSugarAndGlucose CHECK CONSTRAINT FK_HFit_TrackerBloodSugarAndGlucose_HFit_LKP_TrackerVendor;
--END
--GO

---- Create Foreign Key FK_HFit_TrackerBMI_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBMI]

--PRINT 'Create Foreign Key FK_HFit_TrackerBMI_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBMI]';
--GO
--if NOT EXISTS (Select name from sys.objects where name = 'FK_HFit_TrackerBMI_HFit_LKP_TrackerVendor')
--BEGIN
--ALTER TABLE dbo.HFit_TrackerBMI
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerBMI_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerBMI CHECK CONSTRAINT FK_HFit_TrackerBMI_HFit_LKP_TrackerVendor;
--END
--GO

---- Create Foreign Key FK_HFit_TrackerBodyFat_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBodyFat]

--PRINT 'Create Foreign Key FK_HFit_TrackerBodyFat_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBodyFat]';
--GO
--ALTER TABLE dbo.HFit_TrackerBodyFat
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerBodyFat_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerBodyFat CHECK CONSTRAINT FK_HFit_TrackerBodyFat_HFit_LKP_TrackerVendor;
--GO

---- Create Foreign Key FK_HFit_TrackerBodyMeasurements_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBodyMeasurements]

--PRINT 'Create Foreign Key FK_HFit_TrackerBodyMeasurements_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerBodyMeasurements]';
--GO
--ALTER TABLE dbo.HFit_TrackerBodyMeasurements
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerBodyMeasurements_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerBodyMeasurements CHECK CONSTRAINT FK_HFit_TrackerBodyMeasurements_HFit_LKP_TrackerVendor;
--GO

---- Create Foreign Key FK_HFit_TrackerCholesterol_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerCholesterol]

--PRINT 'Create Foreign Key FK_HFit_TrackerCholesterol_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerCholesterol]';
--GO
--ALTER TABLE dbo.HFit_TrackerCholesterol
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerCholesterol_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerCholesterol CHECK CONSTRAINT FK_HFit_TrackerCholesterol_HFit_LKP_TrackerVendor;
--GO

---- Create Foreign Key FK_HFit_TrackerHBA1C_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerHbA1c]

--PRINT 'Create Foreign Key FK_HFit_TrackerHBA1C_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerHbA1c]';
--GO
--ALTER TABLE dbo.HFit_TrackerHbA1c
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerHBA1C_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerHbA1c CHECK CONSTRAINT FK_HFit_TrackerHBA1C_HFit_LKP_TrackerVendor;
--GO
---- Create Foreign Key FK_HFit_TrackerHeight_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerHeight]

--PRINT 'Create Foreign Key FK_HFit_TrackerHeight_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerHeight]';
--GO
--ALTER TABLE dbo.HFit_TrackerHeight
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerHeight_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerHeight CHECK CONSTRAINT FK_HFit_TrackerHeight_HFit_LKP_TrackerVendor;
--GO

---- Create Foreign Key FK_HFit_TrackerRestingHeartRate_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerRestingHeartRate]

--PRINT 'Create Foreign Key FK_HFit_TrackerRestingHeartRate_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerRestingHeartRate]';
--GO
--ALTER TABLE dbo.HFit_TrackerRestingHeartRate
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerRestingHeartRate_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerRestingHeartRate CHECK CONSTRAINT FK_HFit_TrackerRestingHeartRate_HFit_LKP_TrackerVendor;
--GO

---- Create Foreign Key FK_HFit_TrackerShots_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerShots]

--PRINT 'Create Foreign Key FK_HFit_TrackerShots_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerShots]';
--GO
--ALTER TABLE dbo.HFit_TrackerShots
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerShots_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerShots CHECK CONSTRAINT FK_HFit_TrackerShots_HFit_LKP_TrackerVendor;
--GO

---- Create Foreign Key FK_HFit_TrackerTests_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerTests]

--PRINT 'Create Foreign Key FK_HFit_TrackerTests_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerTests]';
--GO
--ALTER TABLE dbo.HFit_TrackerTests
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerTests_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerTests CHECK CONSTRAINT FK_HFit_TrackerTests_HFit_LKP_TrackerVendor;
--GO

---- Create Foreign Key FK_HFit_TrackerWeight_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerWeight]

--PRINT 'Create Foreign Key FK_HFit_TrackerWeight_HFit_LKP_TrackerVendor on [dbo].[HFit_TrackerWeight]';
--GO
--ALTER TABLE dbo.HFit_TrackerWeight
--		WITH CHECK
--ADD CONSTRAINT FK_HFit_TrackerWeight_HFit_LKP_TrackerVendor FOREIGN KEY (VendorID) REFERENCES dbo.HFit_LKP_TrackerVendor (ItemID) ;
--ALTER TABLE dbo.HFit_TrackerWeight CHECK CONSTRAINT FK_HFit_TrackerWeight_HFit_LKP_TrackerVendor;
--GO

GO

Print ('COMPLETED Synchronize Tracker Tables') ;

--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




GO
print ('FROM Create_HFit_LKP_EDW_RejectMPI_Table.sql') ;
PRINT 'Creating table HFit_LKP_EDW_RejectMPI for CR47516';
GO

-- 01.02.2014 (WDM) added column HFUG.CloseReasonLKPID in order to satisfy Story #47923

IF EXISTS (SELECT name
			 FROM sys.tables
			 WHERE name = 'HFit_LKP_EDW_RejectMPI') 
	BEGIN
		PRINT 'Dropping table HFit_LKP_EDW_RejectMPI';
		DROP TABLE dbo.HFit_LKP_EDW_RejectMPI;
	END;
GO

CREATE TABLE dbo.HFit_LKP_EDW_RejectMPI (
	ItemID int IDENTITY (1, 1) NOT NULL, 
	RejectMPICode int NOT NULL,
	RejectUserGUID uniqueidentifier NULL, 
	ItemCreatedBy int NULL, 
	ItemCreatedWhen datetime2  (7) NULL, 
	ItemModifiedBy int NULL, 
	ItemModifiedWhen datetime2 (7) NULL, 
	ItemOrder int NULL, 
	ItemGUID uniqueidentifier NOT NULL, 
	CONSTRAINT PK_HFit_LKP_EDW_RejectMPI PRIMARY KEY CLUSTERED (ItemID) 
		WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) 
		ON [PRIMARY]) 
ON [PRIMARY];
GO
SET ANSI_PADDING OFF;
GO
ALTER TABLE dbo.HFit_LKP_EDW_RejectMPI
ADD CONSTRAINT DEFAULT_HFit_LKP_EDW_RejectMPI_ItemGUID DEFAULT newid() FOR ItemGUID;
GO

IF NOT EXISTS (SELECT name
				 FROM sys.indexes
				 WHERE name = 'PI_HFit_LKP_EDW_RejectMPI_MPI_GUID') 
	BEGIN
		PRINT 'Creating index [PI_HFit_LKP_EDW_RejectMPI_MPI_GUID]';
		CREATE UNIQUE NONCLUSTERED INDEX [PI_HFit_LKP_EDW_RejectMPI_MPI_GUID] ON [dbo].[HFit_LKP_EDW_RejectMPI]
			(
				[RejectMPICode] ASC,
				[RejectUserGUID] ASC
			)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
	END;
GO

if exists (select name from sys.objects where name = 'proc_AddRejectMPI')
begin 
	DROP PROCEDURE proc_AddRejectMPI ;
END
go
PRINT 'CREATING proc_AddRejectMPI ';
go

create proc proc_AddRejectMPI  (@MpiToReject as int)
as 
BEGIN	
	INSERT INTO [dbo].[HFit_LKP_EDW_RejectMPI]
           (
				[RejectMPICode],ItemCreatedWhen, ItemModifiedWhen
           )
     VALUES
           (
				@MpiToReject, getdate(),getdate()
		   );
END
go
PRINT 'INSERTING ROW proc_AddRejectMPI ';
exec proc_AddRejectMPI -991100
GO
--select * from [HFit_LKP_EDW_RejectMPI]
--GO
PRINT 'CREATING proc_DelRejectMPI ';
go
if exists (select name from sys.objects where name = 'proc_DelRejectMPI')
begin 
	DROP PROCEDURE proc_DelRejectMPI ;
END
go

create proc proc_DelRejectMPI  (@MpiToReject as int)
as 
BEGIN	
	delete from [dbo].[HFit_LKP_EDW_RejectMPI] where RejectMPICode = @MpiToReject ;
END
go
PRINT 'DELETING ROW proc_DelRejectMPI ';
exec proc_DelRejectMPI -991100
GO
--select * from [HFit_LKP_EDW_RejectMPI]
--GO

PRINT 'CREATED PROC proc_AddRejectMPI';
PRINT 'CREATED PROC proc_DelRejectMPI';
PRINT 'CREATED table HFit_LKP_EDW_RejectMPI for CR47516 ';
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




--	select Table_NAme, Column_NAme, Data_Type, CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, NUMERIC_SCALE FROM Information_Schema.Columns where CHARACTER_MAXIMUM_LENGTH < 0 Order by Data_Type
--where Table_Name = 'HFit_CoachingTermsAndConditionsSettings' ;

--	select * FROM Information_Schema.Columns where Table_Name = 'EDW_TEST_DEL' ;
--	select Column_Name, Data_Type, CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, NUMERIC_SCALE FROM Information_Schema.Columns where Table_Name = 'EDW_TEST_DEL' ;
--	select Column_Name, Data_Type, CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, NUMERIC_SCALE FROM Information_Schema.Columns where Table_Name = 'HFit_CoachingTermsAndConditionsSettings' ;

IF EXISTS (SELECT name
			 FROM sys.objects
			 WHERE name = 'Proc_Attach_Delete_Audit') 
	BEGIN
		DROP PROCEDURE Proc_Attach_Delete_Audit;
	END;
GO

CREATE PROCEDURE Proc_Attach_Delete_Audit (
	   @Tbl AS nvarchar (500)) 
AS
	 BEGIN

/**************************************************************
This procedure will copy a table and recreate it using only the
raw column data types to recreate the MIRROR table. No defaults, 
identities, or constraints are copied over. All columns are 
defined as NULLABLE. This new table has the parent table's name
with a suffix of "_DelAudit".

A column "RowDeletionDate" is added to the new table and is 
defaulted to getdate(). An index is applied to this column so
that max perfomance can be acheived when pulling a particular
datetime.

A trigger is added to the parent table using the parent name 
plus a suffix of "_DelTRIG". This trigger only fires when a 
delete operation is completed. It then copies the deleted rows
into the "_DelAudit" table.
**************************************************************/

/***************************
Declare the needed variables
***************************/

		 --DECLARE @Tbl AS nvarchar (500) = 'EDW_TEST_DEL';
		 DECLARE @Trktbl AS nvarchar (500) = '';
		 DECLARE @Deltriggername AS nvarchar (500) = '';
		 DECLARE @Mysql AS nvarchar (2000) = '';
		 DECLARE @CreateDDL AS nvarchar (max) = '';
		 DECLARE @SelectCOLS AS nvarchar (max) = '';

		 DECLARE @Colname AS nvarchar (254) = '';
		 DECLARE @Dtype AS nvarchar (254) = '';
		 DECLARE @CHARACTER_MAXIMUM_LENGTH AS INT;
		 DECLARE @NUMERIC_PRECISION AS INT;
		 DECLARE @NUMERIC_SCALE AS INT;

/*****************
Set initial values
*****************/

		 SET @Trktbl = @Tbl + '_DelAudit';
		 SET @Deltriggername = @Tbl + '_DelTRIG';

		 IF EXISTS (SELECT Name
					  FROM Sys.Tables
					  WHERE Name = @Trktbl) 
			 BEGIN
				 PRINT 'Dropping table ' + @Trktbl;
				 SET @Mysql = 'DROP TABLE ' + @Trktbl;
				 EXEC Sp_Executesql @Mysql;
				 PRINT 'Dropped table ' + @Trktbl;
			 END;

		 IF OBJECT_ID (@Deltriggername , 'TR') IS NOT NULL
			 BEGIN
				 PRINT 'Dropping TRIGGER ' + @Deltriggername;
				 SET @Mysql = 'DROP TRIGGER ' + @Deltriggername;
				 EXEC Sp_Executesql @Mysql;
			 END;

		 SET @CreateDDL = 'CREATE TABLE ' + @Trktbl + '(';
		 DECLARE Col_Cursor CURSOR
			 FOR SELECT Column_Name, Data_Type, CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, NUMERIC_SCALE
				   FROM Information_Schema.Columns
				   WHERE Table_Name = @Tbl;
		 OPEN Col_Cursor;
		 FETCH Next FROM Col_Cursor INTO @Colname , @Dtype, @CHARACTER_MAXIMUM_LENGTH, @NUMERIC_PRECISION, @NUMERIC_SCALE ;

		 WHILE @@Fetch_Status = 0
			 BEGIN
				 SET @SelectCOLS = @SelectCOLS + QUOTENAME (@Colname) + ',' ;
				 SET @CreateDDL = @CreateDDL + QUOTENAME (@Colname) + ' ' + QUOTENAME (@Dtype) ;
				 IF (@Dtype = 'float' )
				 BEGIN
					PRINT ('FLOAT DDL: ' + @CreateDDL);		 
				 END
				 ELSE IF (@Dtype = 'int' OR @Dtype = 'bigint' OR @Dtype = 'tinyint' OR @Dtype = 'smallint')
				 BEGIN
					PRINT (@Dtype + ': INT DDL: ' + @CreateDDL);		 
				 END
				 ELSE IF (@Dtype = 'nvarchar' OR  @Dtype = 'varchar')
				 BEGIN
					PRINT (@Dtype + ' DDL: ' + @CreateDDL);		 
					IF (@CHARACTER_MAXIMUM_LENGTH = -1)	 
						SET @CreateDDL = @CreateDDL + '(max) ';
					ELSE
						SET @CreateDDL = @CreateDDL + '(' + cast(@CHARACTER_MAXIMUM_LENGTH as nvarchar(50)) + ') ';
				 END
				 ELSE IF (@Dtype = 'varbinary')
				 BEGIN
					PRINT (@Dtype + ' DDL: ' + @CreateDDL);		 
					IF (@CHARACTER_MAXIMUM_LENGTH = -1)	 
						SET @CreateDDL = @CreateDDL + '(max) ';
					ELSE
						SET @CreateDDL = @CreateDDL + '(' + cast(@CHARACTER_MAXIMUM_LENGTH as nvarchar(50)) + ') ';
				 END
				 ELSE IF (@CHARACTER_MAXIMUM_LENGTH is not null)
				 BEGIN
					PRINT ('00 - DDL: ' + @CreateDDL);		 
					SET @CreateDDL = @CreateDDL + '(' + cast(@CHARACTER_MAXIMUM_LENGTH as nvarchar(50)) + ') ' ;
				 END
				 ELSE IF (@NUMERIC_PRECISION is not null AND @NUMERIC_SCALE is not null)
				 BEGIN
					PRINT ('01 - DDL: ' + @CreateDDL);		 
					SET @CreateDDL = @CreateDDL + '(' + cast(@NUMERIC_PRECISION as nvarchar(50)) + ', ' +cast(@NUMERIC_SCALE as nvarchar(50)) + ') ' ;
				 END
				 ELSE IF (@NUMERIC_PRECISION is not null AND @NUMERIC_SCALE is null)
				 BEGIN
					PRINT ('02 - DDL: ' + @CreateDDL);		 
					SET @CreateDDL = @CreateDDL + '(' + cast(@NUMERIC_PRECISION as nvarchar(50)) + ', ' +cast(@NUMERIC_SCALE as nvarchar(50)) + ') ' ;
				 END
				 ELSE IF (@CHARACTER_MAXIMUM_LENGTH is not null)
				 BEGIN
					PRINT ('03 - DDL: ' + @CreateDDL);	
					IF (@CHARACTER_MAXIMUM_LENGTH = -1)	 
						SET @CreateDDL = @CreateDDL + '(max) ';
					ELSE
						SET @CreateDDL = @CreateDDL + '(' + cast(@CHARACTER_MAXIMUM_LENGTH as nvarchar(50)) + ') ';
				 END
				 ELSE 
				 BEGIN
					PRINT ('04 - DDL: ' + @CreateDDL);		 
				 END
				 
				 SET @CreateDDL = @CreateDDL + ' NULL, ';
				 -- PRINT ('05 - DDL: ' + @CreateDDL);		 
				 
				 FETCH Next FROM Col_Cursor INTO @Colname , @Dtype, @CHARACTER_MAXIMUM_LENGTH, @NUMERIC_PRECISION, @NUMERIC_SCALE ;
				 /*
				 --TURN On these statements when needed to track individual items.
				 print (@Colname) ;
				 print (@Dtype) ;
				 print ( @CHARACTER_MAXIMUM_LENGTH) ;
				 print ( @NUMERIC_PRECISION) ;
				 print ( @NUMERIC_SCALE ) ;
				 */
			 END;

		 CLOSE Col_Cursor;
		 DEALLOCATE Col_Cursor;

		 --Strip off the last COMMA

		 SET @SelectCOLS = RTRIM (@SelectCOLS) ;
		 SET @CreateDDL = RTRIM (@CreateDDL) ;
		 SET @CreateDDL = LEFT (@CreateDDL , LEN (@CreateDDL) - 1) ;
		 SET @CreateDDL = @CreateDDL + ')';

		 PRINT ('____________________________________________________________');		 
		 PRINT ('1 - Creating table ' + @Trktbl);		 
		 PRINT ('2- DLL: ' );
		 PRINT ('3- ' + @CreateDDL);

		 EXEC Sp_Executesql @CreateDDL;
		 PRINT ('____________________________________________________________');		 

		 IF EXISTS (SELECT Name
					  FROM Sys.Tables
					  WHERE Name = @Trktbl) 
			 BEGIN
				 SET @Mysql = 'alter table ' + @Trktbl + ' add RowDeletionDate datetime default getdate() ';
				 EXEC Sp_Executesql @Mysql;
				 PRINT 'Added RowDeletionDate: ';
			 END;

		 SET @CreateDDL = 'CREATE NONCLUSTERED INDEX [PI_' + @Trktbl + '] ON [' + @Trktbl + '] ';
		 SET @CreateDDL = @CreateDDL + '(';
		 SET @CreateDDL = @CreateDDL + '	[RowDeletionDate] ASC ';
		 SET @CreateDDL = @CreateDDL + ')';
		 EXEC Sp_Executesql @CreateDDL;
		 PRINT 'Added RowDeletionDate INDEX ';

		 SET @CreateDDL = '';
		 SET @CreateDDL = @CreateDDL + 'CREATE TRIGGER ' + @Tbl + '_DelTRIG ';
		 SET @CreateDDL = @CreateDDL + '    ON ' + @Tbl;
		 SET @CreateDDL = @CreateDDL + '    FOR DELETE ';
		 SET @CreateDDL = @CreateDDL + 'AS ';
		 SET @CreateDDL = @CreateDDL + '	INSERT INTO ' + @Trktbl + ' SELECT '+@SelectCOLS+' getdate() from deleted ';
		 EXEC Sp_Executesql @CreateDDL;
		 PRINT 'Added ' + @Tbl + ' TRIGGER';
		 print (@CreateDDL) ;

		 declare @viewname as nvarchar(250) = '' ;
		 set @viewname = 'view_EDW_' + @Tbl + '_DelAudit ';
		 if exists(Select name from sys.views where name = @viewname)
		 BEGIN
			set @Mysql = 'drop view ' + @viewname ;
			EXEC Sp_Executesql @Mysql;
			print ('Dropped existing view ' + @viewname) ;
		 END

		 SET @CreateDDL = '';
		 SET @CreateDDL = @CreateDDL + 'CREATE VIEW view_EDW_' + @Tbl + '_DelAudit ';
		 SET @CreateDDL = @CreateDDL + 'AS ';
		 SET @CreateDDL = @CreateDDL + ' SELECT * from ' + @Trktbl;
		 EXEC Sp_Executesql @CreateDDL;
		 PRINT 'Added VIEW: ' + @viewname ;
		 print (@CreateDDL) ;
	 END;

GO

--*********************************************************
--TEST THE PROC
--*********************************************************
if exists (select name from sys.tables where name = 'Edw_Test_Del')
BEGIN
	DROP TABLE Edw_Test_Del;
END
GO

CREATE TABLE Dbo.Edw_Test_Del (Todaydate datetime2 (7) NULL
							 , Rowidnbr int IDENTITY (1 , 1) 
											NOT NULL
							 , Tguid uniqueidentifier NULL
							 , DecVal decimal (10,2)
							 ,FloatVal float
							 ,charVal char(50)
							 ,nvcVal nvarchar(1000)
							 ,vcVal varchar(1000)) ;

GO

ALTER TABLE Dbo.Edw_Test_Del
ADD CONSTRAINT Df_Edw_Test_Del_Todaydate DEFAULT GETDATE () FOR Todaydate;
GO

ALTER TABLE Dbo.Edw_Test_Del
ADD CONSTRAINT Df_Edw_Test_Del_Tguid DEFAULT NEWID () FOR Tguid;
GO

EXEC Proc_Attach_Delete_Audit 'EDW_TEST_DEL';
--EXEC Proc_Attach_Delete_Audit 'HFit_CoachingTermsAndConditionsSettings';
--EXEC Proc_Attach_Delete_Audit 'HFit_CoachingHealthInterest';
--EXEC Proc_Attach_Delete_Audit 'OM_Contact';
GO

INSERT INTO Edw_Test_Del (Tguid, DecVal, charVal, nvcVal, vcVal, FloatVal) 
VALUES
	   (NEWID (), 600.238, 'DMiller', 'DMiller', 'DMiller', 126.3345 ) ;
INSERT INTO Edw_Test_Del (Tguid, DecVal, charVal, nvcVal, vcVal, FloatVal)   
VALUES
	   (NEWID (), 500.23, 'DMiller', 'DMiller', 'DMiller', 226.3345 ) ;
INSERT INTO Edw_Test_Del (Tguid, DecVal, charVal, nvcVal, vcVal, FloatVal)   
VALUES
	   (NEWID (), 400.23, 'DMiller', 'DMiller', 'DMiller', 326.3345 ) ;
INSERT INTO Edw_Test_Del (Tguid, DecVal, charVal, nvcVal, vcVal, FloatVal)   
VALUES
	   (NEWID (), 300.23, 'DMiller', 'DMiller', 'DMiller', 426.3345 ) ;
INSERT INTO Edw_Test_Del (Tguid, DecVal, charVal, nvcVal, vcVal, FloatVal)   
VALUES
	   (NEWID (), 200.23, 'DMiller', 'DMiller', 'DMiller', 526.3345 ) ;
INSERT INTO Edw_Test_Del (Tguid, DecVal, charVal, nvcVal, vcVal, FloatVal)   
VALUES
	   (NEWID (), 100.23, 'DMiller', 'DMiller', 'DMiller', 626.3345 ) ;

DELETE FROM Edw_Test_Del
  WHERE Tguid IN (SELECT TOP 1 Tguid
					FROM Edw_Test_Del
					ORDER BY Tguid DESC) ;

--DELETE FROM Edw_Test_Del WHERE DEcVal > 200

--SELECT * FROM Edw_Test_Del;
--SELECT * FROM Edw_Test_Del_DelAudit;
--select * from view_EDW_EDW_TEST_DEL_DelAudit ;

if exists (select name from sys.tables where name = 'Edw_Test_Del')
BEGIN
	print ('DROP TABLE Edw_Test_Del') ;
	DROP TABLE Edw_Test_Del;
END
GO
if exists (select name from sys.tables where name = 'Edw_Test_Del_DelAudit')
BEGIN
	print ('DROP TABLE Edw_Test_Del_DelAudit') ;
	DROP TABLE Edw_Test_Del_DelAudit;
END
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;






GO
PRINT 'Processing view_EDW_HealthAssesment';
GO

IF EXISTS (SELECT
                  name
                  FROM sys.views
             WHERE name = 'view_EDW_HealthAssesment') 
    BEGIN
        DROP VIEW
             view_EDW_HealthAssesment;
    END;
GO
--select top 100 * from [view_EDW_HealthAssesment]
CREATE VIEW dbo.view_EDW_HealthAssesment
AS
--********************************************************************************************************
--7/15/2014 17:19 min. 46,750 Rows DEV
--7/15/2014 per Mark Turner
--HAModuleDocumentID is on its way out, so is - 
--Module - RiskCategory - RiskArea - Question - Answer 
--all the "DocumentID" fields are deprecated and replaced by corresponding NodeGUID fields
--8/7/2014 - Executed in DEV with GUID changes and returned 51K Rows in 00:43:10.
--8/8/2014 - Generated corrected view in DEV
-- Verified last mod date available to EDW 9.10.2014

--09.08.2014: John Croft and I working together, realized there is a deficit in the ability 
--of the EDW to recognize changes to database records based on the last modified date of a row. 
--The views that we are currently using in the database or deeply nested. This means that 
--several base tables are involved in building a single view of data.

--09.30.2014: Verified with John Croft that he does want this view to return multi-languages.
--
--The views were initially designed to recognize a date change based on a record change very 
--high in the data hierarchy, the CMS Tree level which is the top most level. However, John 
--and I recognize that data can change at any level in the hierarchy and those changes must be 
--recognized as well. Currently, that is not the case. With the new modification to the views, 
--changes in CMS documents and base tables will filter up through the hierarchy and the EDW load 
--process will be able to realize that a change in this rows data may affect and intrude into 
--the warehouse.

-- 10.01.2014 - Reviewed by Mark and Dale for use of the GUIDS
-- 10.01.2014 - Reviewed by Mark and Dale for use of Joins and fixed two that were incorrect (Thanks to Mark)

-- 10.23.2014 - (WDM) added two columns for the EDW HAPaperFlg / HATelephonicFlg
--			HAPaperFlg is whether the question was reveived electronically or on paper
--			HATelephonicFlg is whether the question was reveived by telephone or not

-- FIVE Pieces needed per John C. 10.16.2014
--	Document GUID -> HealthAssesmentUserStartedNodeGUID
--	Module GUID -> Module -> HAUserModule.HAModuleNodeGUID
--	Category GUID -> Category
--	RiskArea Node Guid -> RiskArea 
--	Question Node Guid -> Question
--	Answer Node Guid -> Answer 

--   10.30.2014 : Sowmiya 
--   The following are the possible values allowed in the HAStartedMode and HACompletedMode columns of the Hfit_HealthAssesmentUserStarted table
--      Unknown = 0, 
--       Paper = 1,  // Paper HA
--       Telephonic = 2, // Telephonic HA
--       Online = 3, // Online HA
--       Ipad = 4 // iPAD
-- 08/07/2014 - (WDM) as HAModuleDocumentID	--WDM 10.02.2014 place holder for EDW ETL per John C., Added back per John C. 10.16.2014
-- 09/30/2014 - (WDM) as HAModuleDocumentID	--Mark and Dale use NodeGUID instead of Doc GUID
--WDM 10.02.2014 place holder for EDW ETL
--Per John C. 10.16.2014 requested that this be put back into the view.	
--11.05.2014 - Changed from CMS_TREE Joined to View_HFit_HealthAssessment_Joined Mark T. / Dale M.
-- 11.05.2014 - Mark T. / Dale M. needed to get the Document for the user : ADDED inner join View_HFit_HealthAssessment_Joined as VHAJ on VHAJ.DocumentID = VHCJ.HealthAssessmentID
-- 11.05.2014 - removed the Distinct - may find it necessary to put it back as duplicates may be there. But the server resources required to do this may not be avail on P5.
--11.05.2014 - Mark T. / Dale M. removed the link to View_CMS_Tree_Joined and replaced with View_HFit_HealthAssessment_Joined
--inner join View_CMS_Tree_Joined as VCTJ on VCTJ.NodeGUID = HAUserModule.HAModuleNodeGUID
--	and VCTJ.DocumentCulture = 'en-US'	--10.01.2014 put here to match John C. req. for language agnostic.
-- 12.02.2014 - (wdm)Found that the view was being overwritten between Prod 1 and the copy of Prod 5 / Prod 1. Found a script inside a job on PRod 5 that reverted the view to a previous state. Removed the script and the view migrates correctly (d. miller and m. kimenski)
-- 12.02.2014 - (wdm) Found DUPS in Prod 1 and Prod 2, none in Prod 3. 
-- 12.17.2014 - Added two columns requested by the EDW team as noted by comments next to each column.
-- 12.29.2014 - Stripped HTML out of Title #47619
-- 12.31.2014 - Eliminated negative MPI's in response to CR47516 
-- 01.02.2014 - Tested the removal of negative MPI's in response to CR47516 
--01.27.2015 (WDM) #48941 - Add Client Identifier to View_EDW_Eligibility
--	   In analyzing this requirement, found that the PPT.ClientID is nvarchar (alphanumeric)
--	   and Hfit_Client.ClientID is integer. A bit of a domain/naming issue.
--	   This is NOT needed as the data is already contained in columns [AccountID] and [AccountCD]
--	   NOTE: Added the column [AccountName], just in case it were to be needed later.
--02.04.2015 (WDM) #48828 added:
--	    [HAUserStarted].[HACampaignNodeGUID], VCJ.BiometricCampaignStartDate
--	   , VCJ.BiometricCampaignEndDate, VCJ.CampaignStartDate
--	   , VCJ.CampaignEndDate, VCJ.Name as CampaignName, HACampaignID
-- PER John C. 2.6.2015 - Please comment out all columns except the GUID in the Assesment view.  It will reduce the amount of data coming through the delta process.  Thank you
--, [VHCJ].BiometricCampaignStartDate
--, [VHCJ].BiometricCampaignEndDate
--, [VHCJ].CampaignStartDate
--, [VHCJ].CampaignEndDate
--, [VHCJ].Name as CampaignName 
--, [VHCJ].HACampaignID

/*
--the below are need in this view 
, HACampaign.BiometricCampaignStartDate
, HACampaign.BiometricCampaignEndDate
, HACampaign.CampaignStartDate
, HACampaign.CampaignEndDate
, HACampaign.Name

or only the 
select * from HAUserStarted
, HACampaign.NodeGuid as CampaignNodeGuid
*/

--02.05.2015 Ashwin and I reviewed and approved
--********************************************************************************************************

SELECT
       HAUserStarted.ItemID AS UserStartedItemID
     , VHAJ.NodeGUID AS HealthAssesmentUserStartedNodeGUID
     , HAUserStarted.UserID
     , CMSUser.UserGUID
     , UserSettings.HFitUserMpiNumber
     , CMSSite.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , ACCT.AccountName
     , HAUserStarted.HAStartedDt
     , HAUserStarted.HACompletedDt
     , HAUserModule.ItemID AS UserModuleItemId
     , HAUserModule.CodeName AS UserModuleCodeName
     , HAUserModule.HAModuleNodeGUID
     , VHAJ.NodeGUID AS CMSNodeGuid
     , NULL AS HAModuleVersionID
     , HARiskCategory.ItemID AS UserRiskCategoryItemID
     , HARiskCategory.CodeName AS UserRiskCategoryCodeName
     , HARiskCategory.HARiskCategoryNodeGUID						--WDM 8/7/2014 as HARiskCategoryDocumentID
     , NULL AS HARiskCategoryVersionID			--WDM 10.02.2014 place holder for EDW ETL
     , HAUserRiskArea.ItemID AS UserRiskAreaItemID
     , HAUserRiskArea.CodeName AS UserRiskAreaCodeName
     , HAUserRiskArea.HARiskAreaNodeGUID							--WDM 8/7/2014 as HARiskAreaDocumentID
     , NULL AS HARiskAreaVersionID			--WDM 10.02.2014 place holder for EDW ETL
     , HAUserQuestion.ItemID AS UserQuestionItemID
     , dbo.udf_StripHTML (HAQuestionsView.Title) AS Title			--WDM 47619 12.29.2014
     , HAUserQuestion.HAQuestionNodeGUID	AS HAQuestionGuid		--WDM 9.2.2014	This is a repeat field but had to stay to match the previous view - this is the NODE GUID and matches to the definition file to get the question. This tells you the question, language agnostic.
     , HAUserQuestion.CodeName AS UserQuestionCodeName
     , NULL AS HAQuestionDocumentID	--WDM 10.1.2014 - this is GOING AWAY 		--WDM 10.02.2014 place holder for EDW ETL
     , NULL AS HAQuestionVersionID			--WDM 10.1.2014 - this is GOING AWAY - no versions across environments 		--WDM 10.02.2014 place holder for EDW ETL
     , HAUserQuestion.HAQuestionNodeGUID		--WDM 10.01.2014	Left this in place to preserve column structure.		
     , HAUserAnswers.ItemID AS UserAnswerItemID
     , HAUserAnswers.HAAnswerNodeGUID								--WDM 8/7/2014 as HAAnswerDocumentID
     , NULL AS HAAnswerVersionID		--WDM 10.1.2014 - this is GOING AWAY - no versions across environments		--WDM 10.02.2014 place holder for EDW ETL
     , HAUserAnswers.CodeName AS UserAnswerCodeName
     , HAUserAnswers.HAAnswerValue
     , HAUserModule.HAModuleScore
     , HARiskCategory.HARiskCategoryScore
     , HAUserRiskArea.HARiskAreaScore
     , HAUserQuestion.HAQuestionScore
     , HAUserAnswers.HAAnswerPoints
     , HAUserQuestionGroupResults.PointResults
     , HAUserAnswers.UOMCode
     , HAUserStarted.HAScore
     , HAUserModule.PreWeightedScore AS ModulePreWeightedScore
     , HARiskCategory.PreWeightedScore AS RiskCategoryPreWeightedScore
     , HAUserRiskArea.PreWeightedScore AS RiskAreaPreWeightedScore
     , HAUserQuestion.PreWeightedScore AS QuestionPreWeightedScore
     , HAUserQuestionGroupResults.CodeName AS QuestionGroupCodeName
     , CASE
           WHEN HAUserAnswers.ItemCreatedWhen = HAUserAnswers.ItemModifiedWhen
               THEN 'I'
           ELSE 'U'
       END AS ChangeType
     , HAUserAnswers.ItemCreatedWhen
     , HAUserAnswers.ItemModifiedWhen
     , HAUserQuestion.IsProfessionallyCollected

     , HARiskCategory.ItemModifiedWhen AS HARiskCategory_ItemModifiedWhen
     , HAUserRiskArea.ItemModifiedWhen AS HAUserRiskArea_ItemModifiedWhen
     , HAUserQuestion.ItemModifiedWhen AS HAUserQuestion_ItemModifiedWhen
     , HAUserAnswers.ItemModifiedWhen AS HAUserAnswers_ItemModifiedWhen
     , HAUserStarted.HAPaperFlg
     , HAUserStarted.HATelephonicFlg
     , HAUserStarted.HAStartedMode		--12.11.2014 WDM Sowmiya and dale talked and decided to implement this column 12.17.2014 - Added 
     , HAUserStarted.HACompletedMode	--12.11.2014 WDM Sowmiya and dale talked and decided to implement this column 12.17.2014 - Added 

     , VHCJ.DocumentCulture AS DocumentCulture_VHCJ
     , HAQuestionsView.DocumentCulture AS DocumentCulture_HAQuestionsView
     , HAUserStarted.HACampaignNodeGUID AS CampaignNodeGUID
       FROM
            dbo.HFit_HealthAssesmentUserStarted AS HAUserStarted
                INNER JOIN dbo.CMS_User AS CMSUser
                    ON HAUserStarted.UserID = CMSUser.UserID
                INNER JOIN dbo.CMS_UserSettings AS UserSettings
                    ON UserSettings.UserSettingsUserID = CMSUser.UserID
                   AND HFitUserMpiNumber >= 0
                   AND HFitUserMpiNumber IS NOT NULL -- (WDM) CR47516 
                INNER JOIN dbo.CMS_UserSite AS UserSite
                    ON CMSUser.UserID = UserSite.UserID
                INNER JOIN dbo.CMS_Site AS CMSSite
                    ON UserSite.SiteID = CMSSite.SiteID
                INNER JOIN dbo.HFit_Account AS ACCT
                    ON ACCT.SiteID = CMSSite.SiteID
                INNER JOIN dbo.HFit_HealthAssesmentUserModule AS HAUserModule
                    ON HAUserStarted.ItemID = HAUserModule.HAStartedItemID
                INNER JOIN View_HFit_HACampaign_Joined AS VHCJ
                    ON VHCJ.NodeGUID = HAUserStarted.HACampaignNodeGUID
                   AND VHCJ.NodeSiteID = UserSite.SiteID
                   AND VHCJ.DocumentCulture = 'en-US'
                INNER JOIN View_HFit_HealthAssessment_Joined AS VHAJ
                    ON VHAJ.DocumentID = VHCJ.HealthAssessmentID
                INNER JOIN dbo.HFit_HealthAssesmentUserRiskCategory AS HARiskCategory
                    ON HAUserModule.ItemID = HARiskCategory.HAModuleItemID
                INNER JOIN dbo.HFit_HealthAssesmentUserRiskArea AS HAUserRiskArea
                    ON HARiskCategory.ItemID = HAUserRiskArea.HARiskCategoryItemID
                INNER JOIN dbo.HFit_HealthAssesmentUserQuestion AS HAUserQuestion
                    ON HAUserRiskArea.ItemID = HAUserQuestion.HARiskAreaItemID
                INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS HAQuestionsView
                    ON HAUserQuestion.HAQuestionNodeGUID = HAQuestionsView.NodeGUID
                   AND HAQuestionsView.DocumentCulture = 'en-US'
                LEFT OUTER JOIN dbo.HFit_HealthAssesmentUserQuestionGroupResults AS HAUserQuestionGroupResults
                    ON HAUserRiskArea.ItemID = HAUserQuestionGroupResults.HARiskAreaItemID
                INNER JOIN dbo.HFit_HealthAssesmentUserAnswers AS HAUserAnswers
                    ON HAUserQuestion.ItemID = HAUserAnswers.HAQuestionItemID
	   WHERE UserSettings.HFitUserMpiNumber NOT IN (
        SELECT
               RejectMPICode
               FROM HFit_LKP_EDW_RejectMPI) ;
GO

PRINT 'Processed view_EDW_HealthAssesment';
GO
--  
--  
GO
PRINT '***** FROM: view_EDW_HealthAssesment.sql';
GO 


--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
print('***** FROM: view_EDW_CoachingDetail.sql'); 
go

print ('Processing: view_EDW_CoachingDetail ') ;
go

if exists(select NAME from sys.indexes where NAME = 'CI2_View_CMS_Tree_Joined_Regular')
BEGIN
    print ('ANALYZING index CI2_View_CMS_Tree_Joined_Regular');
	drop index View_CMS_Tree_Joined_Regular.CI2_View_CMS_Tree_Joined_Regular;
END
GO

if not exists(select NAME from sys.indexes where NAME = 'CI2_View_CMS_Tree_Joined_Regular')
BEGIN
    print ('Updating index CI2_View_CMS_Tree_Joined_Regular');

	SET ARITHABORT ON
	SET CONCAT_NULL_YIELDS_NULL ON
	SET QUOTED_IDENTIFIER ON
	SET ANSI_NULLS ON
	SET ANSI_PADDING ON
	SET ANSI_WARNINGS ON
	SET NUMERIC_ROUNDABORT OFF

	CREATE NONCLUSTERED INDEX [CI2_View_CMS_Tree_Joined_Regular] ON [dbo].[View_CMS_Tree_Joined_Regular]
(
	[ClassName] ASC,
	[DocumentForeignKeyValue],
	[DocumentCulture] ASC
)
INCLUDE ( 	[NodeID], [NodeGUID]) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

END
GO


if exists(select TABLE_NAME from INFORMATION_SCHEMA.VIEWS where TABLE_NAME = 'view_EDW_CoachingDetail')
BEGIN
	drop view view_EDW_CoachingDetail ;
END
GO

--GRANT SELECT
--	ON [dbo].[[view_EDW_CoachingDetail]]
--	TO [EDWReader_PRD]
--GO

/* TEST Queries
select * from [view_EDW_CoachingDetail]
select * from [view_EDW_CoachingDetail] where CloseReasonLKPID != 0
select count(*) from [view_EDW_CoachingDetail]
*/

create VIEW [dbo].[view_EDW_CoachingDetail]
AS
--********************************************************************************************
--8/7/2014 - added and commented out DocumentGuid in case needed later
--8/8/2014 - Generated corrected view in DEV (WDM)
-- Verified last mod date available to EDW 9.10.2014
-- 01.02.2014 (WDM) added column HFUG.CloseReasonLKPID in order to satisfy Story #47923
-- 01.06.2014 (WDM) Tested with team B and found that the data was being returned. Stipulating that 
--					we converted the inner join to left outer join dbo.HFit_GoalOutcome. This 
--					allows data to be returned with the meaning that if NULL HFGO.EvaluationDate
--					is returned, the GOAL may exist without any input/update from the coach or
--					PPT
-- 01.07.2014 (WDM) This also takes care of 47976
--********************************************************************************************
	SELECT	DISTINCT
		HFUG.ItemID
		, HFUG.ItemGUID
		, GJ.GoalID
		, HFUG.UserID
		, cu.UserGUID
		, cus.HFitUserMpiNumber
		, cs.SiteGUID
		, hfa.AccountID
		, hfa.AccountCD
		, hfa.AccountName
		, HFUG.IsCreatedByCoach
		, HFUG.BaselineAmount
		, HFUG.GoalAmount
		, Null As DocumentID
		, HFUG.GoalStatusLKPID
		, HFLGS.GoalStatusLKPName
		, HFUG.EvaluationStartDate
		, HFUG.EvaluationEndDate
		, HFUG.GoalStartDate
		, HFUG.CoachDescription
		, HFGO.EvaluationDate
		, HFGO.Passed
		, HFGO.WeekendDate
		, CASE	WHEN CAST(HFUG.ItemCreatedWhen AS DATE) = CAST(HFUG.ItemModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, HFUG.ItemCreatedWhen
		, HFUG.ItemModifiedWhen
		, GJ.NodeGUID
		, HFUG.CloseReasonLKPID
		, GRC.CloseReason

	FROM
		dbo.HFit_UserGoal AS HFUG WITH ( NOLOCK )
	INNER JOIN (
					SELECT
						VHFGJ.GoalID
						, VHFGJ.NodeID
						, VHFGJ.NodeGUID
						, VHFGJ.DocumentCulture
						, VHFGJ.DocumentGuid
						, VHFGJ.DocumentModifiedWhen	--WDM added 9.10.2014
					FROM
						dbo.View_HFit_Goal_Joined AS VHFGJ WITH ( NOLOCK )
					UNION ALL
					SELECT
						VHFTGJ.GoalID
						, VHFTGJ.NodeID
						, VHFTGJ.NodeGUID
						, VHFTGJ.DocumentCulture
						, VHFTGJ.DocumentGuid
						, VHFTGJ.DocumentModifiedWhen	--WDM added 9.10.2014
					FROM
						dbo.View_HFit_Tobacco_Goal_Joined AS VHFTGJ WITH ( NOLOCK )
				) AS GJ ON hfug.NodeID = gj.NodeID and GJ.DocumentCulture = 'en-us'		
	left outer join dbo.HFit_GoalOutcome AS HFGO WITH ( NOLOCK ) ON HFUG.ItemID = HFGO.UserGoalItemID	
	INNER JOIN dbo.HFit_LKP_GoalStatus AS HFLGS WITH ( NOLOCK ) ON HFUG.GoalStatusLKPID = HFLGS.GoalStatusLKPID	
	INNER JOIN dbo.CMS_User AS CU WITH ( NOLOCK ) ON HFUG.UserID = cu.UserID
	INNER JOIN dbo.CMS_UserSettings AS CUS WITH ( NOLOCK ) ON CU.UserGUID = CUS.UserSettingsUserGUID
	INNER JOIN dbo.CMS_UserSite AS CUS2 WITH ( NOLOCK ) ON cu.UserID = CUS2.UserID	
	INNER JOIN dbo.CMS_Site AS CS WITH ( NOLOCK ) ON CUS2.SiteID = CS.SiteID
	INNER JOIN dbo.HFit_Account AS HFA WITH ( NOLOCK ) ON cs.SiteID = hfa.SiteID
	left outer join HFit_LKP_GoalCloseReason as GRC on GRC.CloseReasonID = HFUG.CloseReasonLKPID
GO

  --  
  --  
GO 
print('***** Created: view_EDW_CoachingDetail'); 
GO 

--Testing History
--1.1.2015: WDM Tested table creation, data entry, and view join
--Testing Criteria
--select * from HFit_LKP_GoalCloseReason
--select * from view_EDW_CoachingDetail
--select * from view_EDW_CoachingDetail where userid in (13470, 107, 13299) and CloseReasonLKPID != 0 
--select * from view_EDW_CoachingDetail where UserGUID = '9C7F1657-8568-4D5D-A797-C6AEEA86834F'
--select * from view_EDW_CoachingDetail where EvaluationDate is null 
--select * from view_EDW_CoachingDetail  where HFitUserMpiNumber in (6238677) and CloseReasonLKPID != 0 
--select * from HFit_UserGoal where UserGUID = '9C7F1657-8568-4D5D-A797-C6AEEA86834F'
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





print ('Processing: view_EDW_HealthAssesmentDeffinition ' + cast(getdate() as nvarchar(50))) ;
go

--select count(*) from view_EDW_HealthAssesmentDeffinition

if exists(select TABLE_NAME from INFORMATION_SCHEMA.VIEWS where TABLE_NAME = 'view_EDW_HealthAssesmentDeffinition')
BEGIN
	drop view view_EDW_HealthAssesmentDeffinition ;
END
GO

create VIEW [dbo].[view_EDW_HealthAssesmentDeffinition] 
AS
SELECT distinct 
--**************************************************************************************************************
--NOTE: The column DocumentModifiedWhen comes from the CMS_TREE join - it was left 
--		unchanged when other dates added for the Last Mod Date additions. 
--		Therefore, the 'ChangeType' was left dependent upon this date only. 09.12.2014 (wdm)
--*****************************************************************************************************************************************************
--Test Queries:
--select * from view_EDW_HealthAssesmentDeffinition where AnsDocumentGuid is not NULL
--Changes:
--WDM - 6/25/2014
--Query was returning a NULL dataset. Found that it is being caused by the AccountCD join.
--Worked with Shane to discover the CMS Tree had been modified.
--Modified the code so that reads it reads the CMS tree correctly - working.
--7/14/2014 1:29 time to run - 79024 rows - DEV
--7/14/2014 0:58 time to run - 57472 rows - PROD1
--7/15/2014 - Query was returning NodeName of 'Campaigns' only
--	Found the issue in view View_HFit_HACampaign_Joined. Documented the change in the view.
--7/16/2014 - Full Select: Using a DocumentModifiedWhen filter 00:17:28 - Record Cnt: 793,520
--8/7/2014 - Executed in DEV with GUID changes and returned 1.13M Rows in 23:14.
--8/8/2014 - Executed in DEV with GUID changes, new views, and returned 1.13M Rows in 20:16.
--8/8/2014 - Generated corrected view in DEV
--8/12/2014 - John C. explained that Account Code and Site Guid are not needed, NULLED
--				them out. With them in the QRY, returned 43104 rows, with them nulled
--				out, returned 43104 rows. Using a DISTINCT, 28736 rows returned and execution
--				time doubled approximately.
--				Has to add a DISTINCT to all the queries - .
--				Original Query 0:25 @ 43104
--				Original Query 0:46 @ 28736 (distinct)
--				Filter added - VHFHAQ.DocumentCulture 0:22 @ 14368
--				Filter added - and VHFHARCJ.DocumentCulture = 'en-us'	 0:06 @ 3568
--				Filter added - and VHFHARAJ.DocumentCulture = 'en-us'	 0:03 @ 1784
--8/12/2014 - Applied the language filters with John C. and performance improved, as expected,
--				such that when running the view in QA: 
--8/12/2014 - select * from [view_EDW_HealthAssesmentDeffinition] where DocumentModifiedWhen between '2000-11-14' and 
--				'2014-11-15' now runs exceptionally fast
--08/12/2014 - ProdStaging 00:21:52 @ 2442
--08/12/2014 - ProdStaging 00:21:09 @ 13272 (UNION ALL   --UNION)
--08/12/2014 - ProdStaging 00:21:37 @ 13272 (UNION ONLY)
--08/12/2014 - ProdStaging 00:06:26 @ 1582 (UNION ONLY & Select Filters Added for Culture)
--08/12/2014 - ProdStaging 00:10:07 @ 6636 (UNION ALL   --UNION) and all selected
--08/12/2014 - ProdStaging added PI PI_View_CMS_Tree_Joined_Regular_DocumentCulture: 00:2:34 @ 6636 
--08/12/2014 - DEV 00:00:58 @ 3792
--09.11.2014 - (wdm) added the needed date fields to help EDW in determining the last mod date of a row.
--10.01.2014 - Dale and Mark reworked this view to use NodeGUIDS and eliminated the CMS_TREE View from participating as 
--				well as Site and Account data
--11.25.2014 - (wdm) added multi-select column capability. The values can be 0,1, NULL
--12.29.2014 - (wdm) Added HTML stripping to two columns #47619, the others mentioned already had stripping applied
--12.31.2014 - (wdm) Started the review to apply CR-47517: Eliminate Matrix Questions with NULL Answer GUID's
--01.07.2014 - (wdm) 47619 The Health Assessment Definition interface view contains HTML tags - corrected with udf_StripHTML
--************************************************************************************************************************************************************
		NULL as SiteGUID --cs.SiteGUID								--WDM 08.12.2014 per John C.
		, NULL as AccountCD	 --, HFA.AccountCD						--WDM 08.07.2014 per John C.
		, HA.NodeID AS HANodeID										--WDM 08.07.2014
		, HA.NodeName AS HANodeName									--WDM 08.07.2014
		--, HA.DocumentID AS HADocumentID								--WDM 08.07.2014 commented out and left in place for history
		, NULL AS HADocumentID										--WDM 08.07.2014; 09.29.2014: Mark and Dale discussed that NODEGUID should be used such that the multi-language/culture is not a problem.
		, HA.NodeSiteID AS HANodeSiteID								--WDM 08.07.2014
		, HA.DocumentPublishedVersionHistoryID AS HADocPubVerID		--WDM 08.07.2014
		, dbo.udf_StripHTML(VHFHAMJ.Title) AS ModTitle              --WDM 47619
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText              --WDM 47619
		, VHFHAMJ.NodeGuid AS ModDocGuid	--, VHFHAMJ.DocumentID AS ModDocID	--WDM 08.07.2014	M&D 10.01.2014
		, VHFHAMJ.Weight AS ModWeight
		, VHFHAMJ.IsEnabled AS ModIsEnabled
		, VHFHAMJ.CodeName AS ModCodeName
		, VHFHAMJ.DocumentPublishedVersionHistoryID AS ModDocPubVerID
		, dbo.udf_StripHTML(VHFHARCJ.Title) AS RCTitle              --WDM 47619
		, VHFHARCJ.Weight AS RCWeight
		, VHFHARCJ.NodeGuid AS RCDocumentGUID	--, VHFHARCJ.DocumentID AS RCDocumentID	--WDM 08.07.2014	M&D 10.01.2014
		, VHFHARCJ.IsEnabled AS RCIsEnabled
		, VHFHARCJ.CodeName AS RCCodeName
		, VHFHARCJ.DocumentPublishedVersionHistoryID AS RCDocPubVerID
		, dbo.udf_StripHTML(VHFHARAJ.Title) AS RATytle              --WDM 47619
		, VHFHARAJ.Weight AS RAWeight
		, VHFHARAJ.NodeGuid AS RADocumentGuid	--, VHFHARAJ.DocumentID AS RADocumentID	--WDM 08.07.2014	M&D 10.01.2014
		, VHFHARAJ.IsEnabled AS RAIsEnabled
		, VHFHARAJ.CodeName AS RACodeName
		, VHFHARAJ.ScoringStrategyID AS RAScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID AS RADocPubVerID
		, VHFHAQ.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ.Title,4000)) AS QuesTitle              --WDM 47619
		, VHFHAQ.Weight AS QuesWeight
		, VHFHAQ.IsRequired AS QuesIsRequired

		--, VHFHAQ.DocumentGuid AS QuesDocumentGuid	--, VHFHAQ.DocumentID AS QuesDocumentID	--WDM 08.07.2014	M&D 10.01.2014
		, VHFHAQ.NodeGuid AS QuesDocumentGuid	--, VHFHAQ.DocumentID AS QuesDocumentID	--WDM 08.07.2014
		
		, VHFHAQ.IsEnabled AS QuesIsEnabled
		, left(VHFHAQ.IsVisible,4000) AS QuesIsVisible
		, VHFHAQ.IsStaging AS QuesIsSTaging
		, VHFHAQ.CodeName AS QuestionCodeName
		, VHFHAQ.DocumentPublishedVersionHistoryID AS QuesDocPubVerID
		, VHFHAA.Value AS AnsValue
		, VHFHAA.Points AS AnsPoints
		, VHFHAA.NodeGuid AS AnsDocumentGuid		--ref: #47517
		, VHFHAA.IsEnabled AS AnsIsEnabled
		, VHFHAA.CodeName AS AnsCodeName
		, VHFHAA.UOM AS AnsUOM
		, VHFHAA.DocumentPublishedVersionHistoryID AS AnsDocPUbVerID
		, CASE	WHEN CAST(HA.DocumentCreatedWhen AS DATE) = CAST(HA.DocumentModifiedWhen AS DATE)
			THEN 'I'
			ELSE 'U'
		END AS ChangeType
		, HA.DocumentCreatedWhen
		, HA.DocumentModifiedWhen
		, HA.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014 ADDED TO the returned Columns
		, HA.NodeGUID as HANodeGUID
		--, NULL as SiteLastModified
		, NULL as SiteLastModified
		--, NULL as Account_ItemModifiedWhen
		, NULL as Account_ItemModifiedWhen
		--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, NULL as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
		, HAMCQ.AllowMultiSelect
		, 'SID01' as LocID
	 FROM
		--dbo.View_CMS_Tree_Joined AS VCTJ
		--INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		--INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		--INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 
 
		View_HFit_HealthAssessment_Joined as HA WITH (NOLOCK) 
		INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID		
		INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID
			
		left outer join [View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined] as HAMCQ 
			on VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = 'en-US'
	where VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and HA.DocumentCulture = 'en-us'		--WDM 08.12.2014	
		AND VHFHAA.NodeGuid is not null		--ref: #47517

UNION ALL   --UNION
--WDM Retrieve Matrix Level 1 Question Group
	SELECT distinct
		NULL as SiteGUID --cs.SiteGUID		--WDM 08.12.2014
		, NULL as AccountCD	 --, HFA.AccountCD												--WDM 08.07.2014
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, NULL AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, dbo.udf_StripHTML(VHFHAMJ.Title)              --WDM 47619
		, dbo.udf_StripHTML(left(left(VHFHAMJ.IntroText,4000),4000)) AS IntroText              --WDM 47619
		, VHFHAMJ.NodeGuid
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARCJ.Title)              --WDM 47619
		, VHFHARCJ.Weight
		, VHFHARCJ.NodeGuid
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARAJ.Title)              --WDM 47619
		, VHFHARAJ.Weight
		, VHFHARAJ.NodeGuid
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ2.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ2.Title,4000)) AS QuesTitle              --WDM 47619
		, VHFHAQ2.Weight
		, VHFHAQ2.IsRequired
		, VHFHAQ2.NodeGuid
		, VHFHAQ2.IsEnabled
		, left(VHFHAQ2.IsVisible,4000)
		, VHFHAQ2.IsStaging
		, VHFHAQ2.CodeName AS QuestionCodeName
       --,VHFHAQ2.NodeAliasPath
		, VHFHAQ2.DocumentPublishedVersionHistoryID
		, VHFHAA2.Value
		, VHFHAA2.Points
		, VHFHAA2.NodeGuid		--ref: #47517
		, VHFHAA2.IsEnabled
		, VHFHAA2.CodeName
		, VHFHAA2.UOM
       --,VHFHAA2.NodeAliasPath
		, VHFHAA2.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(HA.DocumentCreatedWhen AS DATE) = CAST(HA.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, HA.DocumentCreatedWhen
		, HA.DocumentModifiedWhen
		, HA.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
	 
		, NULL as SiteLastModified
		, NULL as Account_ItemModifiedWhen
		--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, NULL as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
		, HAMCQ.AllowMultiSelect
		, 'SID02' as LocID
	FROM
 --dbo.View_CMS_Tree_Joined AS VCTJ
		--INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		--INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		--INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 
 
View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) 
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID	
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID
--matrix level 1 questiongroup
	INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
	INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID		
	left outer join [View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined] as HAMCQ 
			on VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = 'en-US'
where VHFHAQ.DocumentCulture = 'en-us'	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	
		and VHFHARAJ.DocumentCulture = 'en-us'	
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and HA.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND VHFHAA2.NodeGuid is not null		--ref: #47517

UNION ALL   --UNION
--WDM Retrieve Branching Level 1 Question and Matrix Level 1 Question Group
	SELECT distinct
		NULL as SiteGUID --cs.SiteGUID		--WDM 08.12.2014
		, NULL as AccountCD	 --, HFA.AccountCD												--WDM 08.07.2014
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, NULL AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, dbo.udf_StripHTML(VHFHAMJ.Title)
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.NodeGuid
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARCJ.Title)
		, VHFHARCJ.Weight
		, VHFHARCJ.NodeGuid
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARAJ.Title)
		, VHFHARAJ.Weight
		, VHFHARAJ.NodeGuid
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ3.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ3.Title,4000)) AS QuesTitle
		, VHFHAQ3.Weight
		, VHFHAQ3.IsRequired
		, VHFHAQ3.NodeGuid
		, VHFHAQ3.IsEnabled
		, left(VHFHAQ3.IsVisible,4000)
		, VHFHAQ3.IsStaging
		, VHFHAQ3.CodeName AS QuestionCodeName
       --,VHFHAQ3.NodeAliasPath
		, VHFHAQ3.DocumentPublishedVersionHistoryID
		, VHFHAA3.Value
		, VHFHAA3.Points
		, VHFHAA3.NodeGuid		--ref: #47517
		, VHFHAA3.IsEnabled
		, VHFHAA3.CodeName
		, VHFHAA3.UOM
       --,VHFHAA3.NodeAliasPath
		, VHFHAA3.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(HA.DocumentCreatedWhen AS DATE) = CAST(HA.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, HA.DocumentCreatedWhen
		, HA.DocumentModifiedWhen
		, HA.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 
		, NULL as SiteLastModified
		, NULL as Account_ItemModifiedWhen
		--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, NULL as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
		, HAMCQ.AllowMultiSelect
		, 'SID03' as LocID
FROM
 --dbo.View_CMS_Tree_Joined AS VCTJ
		--INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		--INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		--INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 
 
View_HFit_HealthAssessment_Joined HA WITH (NOLOCK)
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

--matrix level 1 questiongroup
--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

--Branching Level 1 Question 
	INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
	LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID
	left outer join [View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined] as HAMCQ 
			on VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = 'en-US'
where VHFHAQ.DocumentCulture = 'en-us'	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	
		and VHFHARAJ.DocumentCulture = 'en-us'	
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and HA.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND VHFHAA3.NodeGuid is not null		--ref: #47517

UNION ALL   --UNION
--WDM Retrieve Branching Level 1 Question and Matrix Level 2 Question Group
	SELECT distinct
		NULL as SiteGUID --cs.SiteGUID		--WDM 08.12.2014
		, NULL as AccountCD	 --, HFA.AccountCD												--WDM 08.07.2014
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, NULL AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, dbo.udf_StripHTML(VHFHAMJ.Title)
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.NodeGuid
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARCJ.Title)
		, VHFHARCJ.Weight
		, VHFHARCJ.NodeGuid
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARAJ.Title)
		, VHFHARAJ.Weight
		, VHFHARAJ.NodeGuid
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ7.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ7.Title,4000)) AS QuesTitle
		, VHFHAQ7.Weight
		, VHFHAQ7.IsRequired
		, VHFHAQ7.NodeGuid
		, VHFHAQ7.IsEnabled
		, left(VHFHAQ7.IsVisible,4000)
		, VHFHAQ7.IsStaging
		, VHFHAQ7.CodeName AS QuestionCodeName
       --,VHFHAQ7.NodeAliasPath
		, VHFHAQ7.DocumentPublishedVersionHistoryID
		, VHFHAA7.Value
		, VHFHAA7.Points
		, VHFHAA7.NodeGuid		--ref: #47517
		, VHFHAA7.IsEnabled
		, VHFHAA7.CodeName
		, VHFHAA7.UOM
       --,VHFHAA7.NodeAliasPath
		, VHFHAA7.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(HA.DocumentCreatedWhen AS DATE) = CAST(HA.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, HA.DocumentCreatedWhen
		, HA.DocumentModifiedWhen
		, HA.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 
		, NULL as SiteLastModified
		, NULL as Account_ItemModifiedWhen
		--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, NULL as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
		, HAMCQ.AllowMultiSelect
		, 'SID04' as LocID
FROM
 --dbo.View_CMS_Tree_Joined AS VCTJ
		--INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		--INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		--INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 
 
View_HFit_HealthAssessment_Joined HA WITH (NOLOCK)
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

--matrix level 1 questiongroup
--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

--Branching Level 1 Question 
	INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
--LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

--Matrix Level 2 Question Group
	INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
	INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID
	left outer join [View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined] as HAMCQ 
			on VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = 'en-US'
where VHFHAQ.DocumentCulture = 'en-us'	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	
		and VHFHARAJ.DocumentCulture = 'en-us'	
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and HA.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND VHFHAA7.NodeGuid is not null		--ref: #47517

UNION ALL   --UNION
	--****************************************************
	--WDM 6/25/2014 Retrieve the Branching level 1 Question Group
	--THE PROBLEM LIES HERE in this part of query : 1:40 minute
	-- Added two perf indexes to the first query: 25 Sec
	--****************************************************
	SELECT distinct
		NULL as SiteGUID --cs.SiteGUID		--WDM 08.12.2014
		, NULL as AccountCD	 --, HFA.AccountCD												--WDM 08.07.2014
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, NULL AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, dbo.udf_StripHTML(VHFHAMJ.Title)
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.NodeGuid
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARCJ.Title)
		, VHFHARCJ.Weight
		, VHFHARCJ.NodeGuid
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARAJ.Title)
		, VHFHARAJ.Weight
		, VHFHARAJ.NodeGuid
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ8.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ8.Title,4000)) AS QuesTitle
		, VHFHAQ8.Weight
		, VHFHAQ8.IsRequired
		, VHFHAQ8.NodeGuid
		, VHFHAQ8.IsEnabled
		, left(VHFHAQ8.IsVisible,4000)
		, VHFHAQ8.IsStaging
		, VHFHAQ8.CodeName AS QuestionCodeName
       --,VHFHAQ8.NodeAliasPath
		, VHFHAQ8.DocumentPublishedVersionHistoryID
		, VHFHAA8.Value
		, VHFHAA8.Points
		, VHFHAA8.NodeGuid		--ref: #47517
		, VHFHAA8.IsEnabled
		, VHFHAA8.CodeName
		, VHFHAA8.UOM
       --,VHFHAA8.NodeAliasPath
		, VHFHAA8.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(HA.DocumentCreatedWhen AS DATE) = CAST(HA.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, HA.DocumentCreatedWhen
		, HA.DocumentModifiedWhen
		, HA.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
	
		, NULL as SiteLastModified
		, NULL as Account_ItemModifiedWhen
		--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, NULL as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
		, HAMCQ.AllowMultiSelect
		, 'SID05' as LocID
FROM
 --dbo.View_CMS_Tree_Joined AS VCTJ
		--INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		--INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		--INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 
 
View_HFit_HealthAssessment_Joined HA WITH (NOLOCK)
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

			--matrix level 1 questiongroup
			--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
			--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

			--Branching Level 1 Question 
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
			--LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

			--Matrix Level 2 Question Group
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
			INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

			--Matrix branching level 1 question group
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
			INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID
			left outer join [View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined] as HAMCQ 
			on VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = 'en-US'
where VHFHAQ.DocumentCulture = 'en-us'	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	
		and VHFHARAJ.DocumentCulture = 'en-us'	
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and HA.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND VHFHAA8.NodeGuid is not null		--ref: #47517

UNION ALL   --UNION
	--****************************************************
	--WDM 6/25/2014 Retrieve the Branching level 2 Question Group
	--THE PROBLEM LIES HERE in this part of query : 1:48  minutes
	--With the new indexes: 29 Secs
	--****************************************************
	SELECT distinct
		NULL as SiteGUID --cs.SiteGUID		--WDM 08.12.2014
		, NULL as AccountCD	 --, HFA.AccountCD												--WDM 08.07.2014
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, NULL AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, dbo.udf_StripHTML(VHFHAMJ.Title)
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.NodeGuid
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARCJ.Title)
		, VHFHARCJ.Weight
		, VHFHARCJ.NodeGuid
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARAJ.Title)
		, VHFHARAJ.Weight
		, VHFHARAJ.NodeGuid
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ4.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ4.Title,4000)) AS QuesTitle
		, VHFHAQ4.Weight
		, VHFHAQ4.IsRequired
		, VHFHAQ4.NodeGuid
		, VHFHAQ4.IsEnabled
		, left(VHFHAQ4.IsVisible,4000)
		, VHFHAQ4.IsStaging
		, VHFHAQ4.CodeName AS QuestionCodeName
       --,VHFHAQ4.NodeAliasPath
		, VHFHAQ4.DocumentPublishedVersionHistoryID
		, VHFHAA4.Value
		, VHFHAA4.Points
		, VHFHAA4.NodeGuid		--ref: #47517
		, VHFHAA4.IsEnabled
		, VHFHAA4.CodeName
		, VHFHAA4.UOM
       --,VHFHAA4.NodeAliasPath
		, VHFHAA4.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(HA.DocumentCreatedWhen AS DATE) = CAST(HA.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, HA.DocumentCreatedWhen
		, HA.DocumentModifiedWhen
		, HA.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 
		, NULL as SiteLastModified
		, NULL as Account_ItemModifiedWhen
		--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, NULL as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
		, HAMCQ.AllowMultiSelect
		, 'SID06' as LocID
FROM
 --dbo.View_CMS_Tree_Joined AS VCTJ
		--INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		--INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		--INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 
 
View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) 
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

			--matrix level 1 questiongroup
			--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
			--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

			--Branching Level 1 Question 
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
			LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

			--Matrix Level 2 Question Group
			--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
			--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

			--Matrix branching level 1 question group
			--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
			--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

			--Branching level 2 Question Group
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
			INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID
			left outer join [View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined] as HAMCQ 
			on VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = 'en-US'
where VHFHAQ.DocumentCulture = 'en-us'	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	
		and VHFHARAJ.DocumentCulture = 'en-us'	
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and HA.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND VHFHAA4.NodeGuid is not null		--ref: #47517

UNION ALL   --UNION
--WDM 6/25/2014 Retrieve the Branching level 3 Question Group
	SELECT distinct
		NULL as SiteGUID --cs.SiteGUID		--WDM 08.12.2014
		, NULL as AccountCD	 --, HFA.AccountCD												--WDM 08.07.2014
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, NULL AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, dbo.udf_StripHTML(VHFHAMJ.Title)
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.NodeGuid
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARCJ.Title)
		, VHFHARCJ.Weight
		, VHFHARCJ.NodeGuid
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARAJ.Title)
		, VHFHARAJ.Weight
		, VHFHARAJ.NodeGuid
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ5.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ5.Title,4000)) AS QuesTitle
		, VHFHAQ5.Weight
		, VHFHAQ5.IsRequired
		, VHFHAQ5.NodeGuid
		, VHFHAQ5.IsEnabled
		, left(VHFHAQ5.IsVisible,4000)
		, VHFHAQ5.IsStaging
		, VHFHAQ5.CodeName AS QuestionCodeName
       --,VHFHAQ5.NodeAliasPath
		, VHFHAQ5.DocumentPublishedVersionHistoryID
		, VHFHAA5.Value
		, VHFHAA5.Points
		, VHFHAA5.NodeGuid		--ref: #47517
		, VHFHAA5.IsEnabled
		, VHFHAA5.CodeName
		, VHFHAA5.UOM
       --,VHFHAA5.NodeAliasPath
		, VHFHAA5.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(HA.DocumentCreatedWhen AS DATE) = CAST(HA.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, HA.DocumentCreatedWhen
		, HA.DocumentModifiedWhen
		, HA.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 
		, NULL as SiteLastModified
		, NULL as Account_ItemModifiedWhen
		--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, NULL as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
		, HAMCQ.AllowMultiSelect
		, 'SID07' as LocID
FROM
--dbo.View_CMS_Tree_Joined AS VCTJ
		--INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		--INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		--INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 
 
View_HFit_HealthAssessment_Joined HA WITH (NOLOCK)  
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

		--matrix level 1 questiongroup
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

		--Branching Level 1 Question 
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

		--Matrix Level 2 Question Group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

		--Matrix branching level 1 question group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

		--Branching level 2 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

		--Branching level 3 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ5 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA5 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID
		left outer join [View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined] as HAMCQ 
			on VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = 'en-US'
where VHFHAQ.DocumentCulture = 'en-us'	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	
		and VHFHARAJ.DocumentCulture = 'en-us'	
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and HA.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND VHFHAA5.NodeGuid is not null		--ref: #47517

UNION ALL   --UNION
--WDM 6/25/2014 Retrieve the Branching level 4 Question Group
	SELECT distinct
		NULL as SiteGUID --cs.SiteGUID		--WDM 08.12.2014
		, NULL as AccountCD	 --, HFA.AccountCD												--WDM 08.07.2014
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, NULL AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, dbo.udf_StripHTML(VHFHAMJ.Title)
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.NodeGuid
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARCJ.Title)
		, VHFHARCJ.Weight
		, VHFHARCJ.NodeGuid
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARAJ.Title)
		, VHFHARAJ.Weight
		, VHFHARAJ.NodeGuid
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ6.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ6.Title,4000)) AS QuesTitle
		, VHFHAQ6.Weight
		, VHFHAQ6.IsRequired
		, VHFHAQ6.NodeGuid
		, VHFHAQ6.IsEnabled
		, left(VHFHAQ6.IsVisible,4000)
		, VHFHAQ6.IsStaging
		, VHFHAQ6.CodeName AS QuestionCodeName
       --,VHFHAQ6.NodeAliasPath
		, VHFHAQ6.DocumentPublishedVersionHistoryID
		, VHFHAA6.Value
		, VHFHAA6.Points
		, VHFHAA6.NodeGuid		--ref: #47517
		, VHFHAA6.IsEnabled
		, VHFHAA6.CodeName
		, VHFHAA6.UOM
       --,VHFHAA6.NodeAliasPath
		, VHFHAA6.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(HA.DocumentCreatedWhen AS DATE) = CAST(HA.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, HA.DocumentCreatedWhen
		, HA.DocumentModifiedWhen
		, HA.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 
		, NULL as SiteLastModified
		, NULL as Account_ItemModifiedWhen
		--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, NULL as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
		, HAMCQ.AllowMultiSelect
		, 'SID08' as LocID
FROM
  --dbo.View_CMS_Tree_Joined AS VCTJ
		--INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		--INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		--INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 
 
View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) 
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

		--matrix level 1 questiongroup
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

		--Branching Level 1 Question 
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

		--Matrix Level 2 Question Group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

		--Matrix branching level 1 question group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

		--Branching level 2 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

		--Branching level 3 Question Group
		--select count(*) from dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ5 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA5 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID

		--Branching level 4 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ6 ON VHFHAA5.NodeID = VHFHAQ6.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA6 ON VHFHAQ6.NodeID = VHFHAA6.NodeParentID
		left outer join [View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined] as HAMCQ 
			on VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = 'en-US'
where  VHFHAQ.DocumentCulture = 'en-us'	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	
		and VHFHARAJ.DocumentCulture = 'en-us'	
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and HA.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND VHFHAA6.NodeGuid is not null		--ref: #47517

UNION ALL   --UNION
	--WDM 6/25/2014 Retrieve the Branching level 5 Question Group
	SELECT distinct
		NULL as SiteGUID --cs.SiteGUID		--WDM 08.12.2014
		, NULL as AccountCD	 --, HFA.AccountCD												--WDM 08.07.2014
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, NULL AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, dbo.udf_StripHTML(VHFHAMJ.Title)
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.NodeGuid
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARCJ.Title)
		, VHFHARCJ.Weight
		, VHFHARCJ.NodeGuid
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, dbo.udf_StripHTML(VHFHARAJ.Title)
		, VHFHARAJ.Weight
		, VHFHARAJ.NodeGuid
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ9.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ9.Title,4000)) AS QuesTitle
		, VHFHAQ9.Weight
		, VHFHAQ9.IsRequired
		, VHFHAQ9.NodeGuid
		, VHFHAQ9.IsEnabled
		, left(VHFHAQ9.IsVisible,4000)
		, VHFHAQ9.IsStaging
		, VHFHAQ9.CodeName AS QuestionCodeName
       --,VHFHAQ9.NodeAliasPath
		, VHFHAQ9.DocumentPublishedVersionHistoryID
		, VHFHAA9.Value
		, VHFHAA9.Points
		, VHFHAA9.NodeGuid		--ref: #47517
		, VHFHAA9.IsEnabled
		, VHFHAA9.CodeName
		, VHFHAA9.UOM
       --,VHFHAA9.NodeAliasPath
		, VHFHAA9.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(HA.DocumentCreatedWhen AS DATE) = CAST(HA.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, HA.DocumentCreatedWhen
		, HA.DocumentModifiedWhen
		, HA.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 
		, NULL as SiteLastModified
		, NULL as Account_ItemModifiedWhen
		--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, NULL as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
		, HAMCQ.AllowMultiSelect
		, 'SID09' as LocID
FROM

--dbo.View_CMS_Tree_Joined AS VCTJ
		--INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		--INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		--INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 
 
View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) 
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

		--matrix level 1 questiongroup
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

		--Branching Level 1 Question 
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

		--Matrix Level 2 Question Group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

		--Matrix branching level 1 question group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

		--Branching level 2 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

		--Branching level 3 Question Group
		--select count(*) from dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ5 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA5 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID

		--Branching level 4 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ6 ON VHFHAA5.NodeID = VHFHAQ6.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA6 ON VHFHAQ6.NodeID = VHFHAA6.NodeParentID

		--Branching level 5 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ9 ON VHFHAA6.NodeID = VHFHAQ9.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA9 ON VHFHAQ9.NodeID = VHFHAA9.NodeParentID
		left outer join [View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined] as HAMCQ 
			on VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = 'en-US'
	where  VHFHAQ.DocumentCulture = 'en-us'	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	
		and VHFHARAJ.DocumentCulture = 'en-us'	
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and HA.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND VHFHAA9.NodeGuid is not null		--ref: #47517

GO

print ('Processed: view_EDW_HealthAssesmentDeffinition ') ;
go
  --  
  --  
GO 
print('***** FROM: view_EDW_HealthAssesmentDeffinition.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Processing: view_EDW_RewardUserDetail ';
GO

--IF NOT EXISTS (SELECT
--					  name
--				 FROM sys.indexes
--				 WHERE name = 'CI_HFit_RewardsUserActivityDetail_Activity') 
--	BEGIN
--		CREATE NONCLUSTERED INDEX CI_HFit_RewardsUserActivityDetail_Activity ON dbo.HFit_RewardsUserActivityDetail (ActivityNodeID) INCLUDE (
--			   UserID
--			 , ActivityVersionID
--			 , ActivityPointsEarned
--			 , ActivityCompletedDt
--			 , ItemModifiedWhen) ;
--	END;
--GO

IF EXISTS (SELECT
                  NAME
                  FROM sys.VIEWS
             WHERE NAME = 'view_EDW_RewardUserDetail') 
    BEGIN
        DROP VIEW
             view_EDW_RewardUserDetail;
    END;
GO

/*************************************************
 TESTS
select top 1000 * from [view_EDW_RewardUserDetail]
select count(*) from [view_EDW_RewardUserDetail]
select * from [view_EDW_RewardUserDetail]
Where VHFRPJ_DocumentCulture <> 'en-us'
			AND VHFRGJ_DocumentCulture <> 'en-us'
			AND VHFRLJ_DocumentCulture <> 'en-us'
			AND VHFRAJ_DocumentCulture <> 'en-us'
			AND VHFRTJ_DocumentCulture <> 'en-us'
select top 1000 * from [view_EDW_RewardUserDetail]
select count(*) from [view_EDW_RewardUserDetail]
*************************************************/

CREATE VIEW dbo.view_EDW_RewardUserDetail
AS

--**************************************************************************************************************************************************
--select * from [view_EDW_RewardUserDetail] where ItemModifiedWhen between '2000-11-14' and '2014-11-15'
--select * from [view_EDW_RewardUserDetail] where ItemModifiedWhen between '2014-05-12' and '2014-05-13' 
--8/7/2014 - added and commented out DocumentGuid and NodeGuid in case needed later
--8/08/2014 - Generated corrected view in DEV (WDM)
--8/12/2014 - Performance Issue - 00:06:49 @ 258502
--8/12/2014 - Performance Issue - Add PI01_view_EDW_RewardUserDetail
--8/12/2014 - Performance Issue - 00:03:46 @ 258502
--8/12/2014 - Performance Issue - Add PI02_view_EDW_RewardUserDetail
--8/12/2014 - Performance Issue - 00:03:45 @ 258502
--8/19/2014 - (WDM) Added where clause to make the query return english data only.	
--09.11.2014 : (wdm) Verified last mod date available to EDW - RewardsUserActivity_ItemModifiedWhen
--				RewardExceptionModifiedDate, RewardTrigger_DocumentModifiedWhen. Warned Laura this might create many dups.
--11.14.2014 : (wdm) The dups have surfaced. The combination of  HFRUAD.ActivityCompletedDt, 
--				HFRUAD.ItemModifiedWhen, HFRE.ItemModifiedWhen, HFRUAD.ItemModifiedWhen, VHFRTJ.DocumentModifiedWhen has exposed
--				tens of thousands of semi-redundant rows. Today, I commented these dates out and added a distinct and went from \
--				returning more than 100,000 rows for a given MPI and Client to 4 rows. I left in place the original dates of 
--				HFRULD.ItemCreatedWhen and HFRULD.ItemModifiedWhen. This gives us whether it is an insert or update. If multiple 
--				dates are used to determine changes, then it will be necessary to use a DATE filter to bring back only the 
--				rows indicating a change.
--11.18.2014 : (wdm) Found a USERID qualifier missing on the join of HFit_RewardsUserActivityDetail. Added this qualifier to USERID
--				and the view now appears to be functioning correctly returning about 160K rows in 2.5 minutes. The DISTINCT clause
--				made no difference in the number of returned rows, so it was removed and the execution time of the query was cut in half.
--11.18.2014 (wdm) added this filter so that only USER Detail was returned.
--01.01.2015 (WDM) added left outer join HFit_LKP_RewardActivity AND VHFRAJ.RewardActivityLKPName to the view - reference CR-47520
--01.01.2015 (WDM) Tested modifications - reference CR-47520
--02.17.2015 (WDM) and (SR) - modified the indexes and moved the where into a join to force the execution plan to modifiy itself. The 
--				view would not run in several hours since the deployment of this past Friday. Now, runs in a few minutes (less than 2).
-- 03.03.2015 Reviewed by nathan and dale and changes made as noted within.
--			ADDED THE FOLLOWING:
--				VHFRAJ.NodeGuid as RewardActivityGUID	--(03.03.2015 dale/nathan corrected)
--				VHFRPJ.DocumentGuid 	--(03.03.2015 dale/nathan corrected)
--				VHFRPJ.NodeGuid		--as RewardProgramGUID	--(03.03.2015 dale/nathan corrected)
--				VHFRGJ.NodeGuid	as RewardGroupGUID	--(03.03.2015 dale/nathan corrected)
--				VHFRTJ.NodeGuid AS RewardTriggerGUID	--(03.03.2015 dale/nathan corrected)
--03.19.2015 : by request of the EDW team, removed all columns not specificially requested
--			 and verified that was the request before initiating. The commented out columns
--			 were removed as a the solution to this request. 
--03.26.2015 : RewardGroupGUID removed per Shankar
--03.26.2015 : RewardExceptionModifiedDate Removed per Shankar
--03.12.2015 : WDM - modified view for change tracking implementation
--**************************************************************************************************************************************************

SELECT DISTINCT
       cu.UserGUID
     , CS2.SiteGUID
     , cus2.HFitUserMpiNumber
     , VHFRAJ.NodeGuid AS RewardActivityGUID	--(03.03.2015 dale/nathan corrected)
     , VHFRPJ.RewardProgramName
     , VHFRPJ.DocumentModifiedWhen AS RewardModifiedDate
     , VHFRGJ.NodeGuid AS RewardGroupGUID	 --(03.03.2015 dale/nathan corrected) and removed 03.26.2015 per Shankar
     , VHFRLJ.DocumentModifiedWhen AS RewardLevelModifiedDate
     , HFRULD.LevelCompletedDt
     , HFRUAD.ActivityPointsEarned
     , HFRUAD.ActivityCompletedDt
     , HFRUAD.ItemModifiedWhen AS RewardActivityModifiedDate
     , VHFRAJ.ActivityPoints
     , HFRE.UserAccepted
     , HFRE.UserExceptionAppliedTo
     , VHFRTJ.NodeGuid AS RewardTriggerGUID	--(03.03.2015 dale/nathan corrected)
     , HFA.AccountID
     , HFA.AccountCD
     , CASE
           WHEN CAST (HFRULD.ItemCreatedWhen AS date) = CAST (HFRULD.ItemModifiedWhen AS date) 
               THEN 'I'
           ELSE 'U'
       END AS ChangeType
	 , HASHBYTES ('sha1',
				isnull (cast(RewardProgramName as nvarchar(50)) , '-')
				+ isnull (cast( VHFRPJ.DocumentModifiedWhen as nvarchar(50)) , '-')
				+ isnull (cast(VHFRLJ.DocumentModifiedWhen as nvarchar(50)) , '-')
				+ isnull (cast(HFRULD.LevelCompletedDt as nvarchar(50)) , '-')
				+ isnull (cast(HFRUAD.ActivityPointsEarned as nvarchar(50)) , '-')
				+ isnull (cast(HFRUAD.ActivityCompletedDt as nvarchar(50)) , '-')
				+ isnull (cast(HFRUAD.ItemModifiedWhen as nvarchar(50)) , '-')
				+ isnull (cast(VHFRAJ.ActivityPoints as nvarchar(50)) , '-')
				+ isnull (cast(HFRE.UserAccepted as nvarchar(50)) , '-')
				+ isnull (cast(HFRE.UserExceptionAppliedTo as nvarchar(50)) , '-')
				+ isnull (cast(HFA.AccountID as nvarchar(50)) , '-')
				+ isnull (cast(HFA.AccountCD as nvarchar(50)) , '-')	   
				) as HashCode	   
	   ,NULL as DeletedFlg

	   --, VHFRAJ.RewardActivityID	 
	   --, VHFRPJ.RewardProgramID
	   --, VHFRPJ.DocumentGuid --(03.03.2015 dale/nathan corrected)
	   --, VHFRPJ.NodeGuid --(03.03.2015 dale/nathan corrected) RewardProgramGUID: View_HFit_RewardProgram_Joined
	   --, VHFRPJ.RewardProgramPeriodStart
	   --, VHFRPJ.RewardProgramPeriodEnd
	   --, VHFRGJ.GroupName
	   --, VHFRGJ.RewardGroupID
	   --, VHFRGJ.RewardGroupPeriodStart
	   --, VHFRGJ.RewardGroupPeriodEnd
	   --, VHFRGJ.DocumentModifiedWhen AS RewardGroupModifieDate
	   --, VHFRLJ.Level
	   --, HFLRLT.RewardLevelTypeLKPName
	   --, HFRULD.LevelVersionHistoryID
	   --, VHFRLJ.RewardLevelPeriodStart
	   --, VHFRLJ.RewardLevelPeriodEnd
	   --, VHFRAJ.ActivityName
	   --, HFRUAD.ActivityVersionID
	   --, VHFRAJ.RewardActivityPeriodStart
	   --, VHFRAJ.RewardActivityPeriodEnd
	   --, VHFRTJ.TriggerName
	   --, VHFRTJ.RewardTriggerID
	   --, HFLRT2.RewardTriggerLKPDisplayName
	   --, HFLRT2.RewardTriggerDynamicValue
	   --, HFLRT2.ItemModifiedWhen AS     RewardTriggerModifiedDate
	   --, HFLRT.RewardTypeLKPName
	   --, HFRULD.ItemCreatedWhen
	   --, HFRULD.ItemModifiedWhen

	   --, HFRE.ItemModifiedWhen AS       RewardExceptionModifiedDate	  --Removed 03.26.2015 per Shankar

	   --, HFRUAD.ItemModifiedWhen AS     RewardsUserActivity_ItemModifiedWhen
	   --, VHFRTJ.DocumentModifiedWhen AS RewardTrigger_DocumentModifiedWhen	 --01.01.2015 (WDM) added for CR-47520

	   --, LKPRA.RewardActivityLKPName
	   --, VHFRPJ.DocumentCulture AS      VHFRPJ_DocumentCulture
	   --, VHFRGJ.DocumentCulture AS      VHFRGJ_DocumentCulture
	   --, VHFRLJ.DocumentCulture AS      VHFRLJ_DocumentCulture
	   --, VHFRAJ.DocumentCulture AS      VHFRAJ_DocumentCulture
	   --, VHFRTJ.DocumentCulture AS      VHFRTJ_DocumentCulture
       FROM
            dbo.View_HFit_RewardProgram_Joined AS VHFRPJ WITH (NOLOCK) 
                LEFT OUTER JOIN dbo.View_HFit_RewardGroup_Joined AS VHFRGJ WITH (NOLOCK) 
                    ON VHFRPJ.NodeID = VHFRGJ.NodeParentID
                LEFT OUTER JOIN dbo.View_HFit_RewardLevel_Joined AS VHFRLJ WITH (NOLOCK) 
                    ON VHFRGJ.NodeID = VHFRLJ.NodeParentID
                   AND VHFRLJ.DocumentCulture = 'en-us'
                LEFT OUTER JOIN dbo.HFit_LKP_RewardType AS HFLRT WITH (NOLOCK) 
                    ON VHFRLJ.AwardType = HFLRT.RewardTypeLKPID
                LEFT OUTER JOIN dbo.HFit_LKP_RewardLevelType AS HFLRLT WITH (NOLOCK) 
                    ON vhfrlj.LevelType = HFLRLT.RewardLevelTypeLKPID
                INNER JOIN dbo.HFit_RewardsUserLevelDetail AS HFRULD WITH (NOLOCK) 
                    ON VHFRLJ.NodeID = HFRULD.LevelNodeID
                INNER JOIN dbo.CMS_User AS CU WITH (NOLOCK) 
                    ON hfruld.UserID = cu.UserID
                INNER JOIN dbo.CMS_UserSite AS CUS WITH (NOLOCK) 
                    ON CU.UserID = CUS.UserID
                INNER JOIN dbo.CMS_Site AS CS2 WITH (NOLOCK) 
                    ON CUS.SiteID = CS2.SiteID
                INNER JOIN dbo.HFit_Account AS HFA WITH (NOLOCK) 
                    ON cs2.SiteID = HFA.SiteID
                INNER JOIN dbo.CMS_UserSettings AS CUS2 WITH (NOLOCK) 
                    ON cu.UserID = cus2.UserSettingsUserID
                LEFT OUTER JOIN dbo.View_HFit_RewardActivity_Joined AS VHFRAJ WITH (NOLOCK) 
                    ON VHFRLJ.NodeID = VHFRAJ.NodeParentID
                   AND VHFRAJ.DocumentCulture = 'en-us'
                LEFT OUTER JOIN HFit_LKP_RewardActivity AS LKPRA
                    ON LKPRA.RewardActivityLKPID = VHFRAJ.RewardActivityLKPID
                INNER JOIN dbo.HFit_RewardsUserActivityDetail AS HFRUAD WITH (NOLOCK) 
                    ON VHFRAJ.NodeID = HFRUAD.ActivityNodeID
                   AND cu.UserID = HFRUAD.userid
                LEFT OUTER JOIN dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ WITH (NOLOCK) 
                    ON VHFRAJ.NodeID = VHFRTJ.NodeParentID
                   AND VHFRTJ.DocumentCulture = 'en-us'
                LEFT OUTER JOIN dbo.HFit_LKP_RewardTrigger AS HFLRT2 WITH (NOLOCK) 
                    ON VHFRTJ.RewardTriggerLKPID = HFLRT2.RewardTriggerLKPID
                LEFT OUTER JOIN dbo.HFit_RewardException AS HFRE WITH (NOLOCK) 
                    ON HFRE.RewardActivityID = VHFRAJ.RewardActivityID
                   AND HFRE.UserID = cu.UserID
  WHERE VHFRPJ.DocumentCulture = 'en-us'
    AND VHFRGJ.DocumentCulture = 'en-us';

GO
PRINT 'Completed : view_EDW_RewardUserDetail ';
GO

/*
(WDM) Kept only these coulmns IAW CR-51005
UserGUID
SiteGUID 
HFitUserMPINumber
RewardActivityGUID
RewardProgramName
RewardModifiedDate
RewardGroupGUID
RewardLevelModifiedDate
LevelCompletedDt
ActivityPointsEarned
ActivityCompletedDt
RewardActivityModifiedDate
ActivityPoints
UserAccepted
UserExceptionAppliedTo
RewardTriggerGUID
AccountID
AccountCD 
ChangeType
RewardExceptionModifiedDate
*/

PRINT '***** FROM: view_EDW_RewardUserDetail.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;






GO
PRINT '***** FROM: view_EDW_RewardsDefinition.sql';
GO 
PRINT 'Processing: view_EDW_RewardsDefinition:';
GO
IF EXISTS (SELECT
				  NAME
				  FROM sys.VIEWS
				  WHERE NAME = 'view_EDW_RewardsDefinition') 
	BEGIN
		DROP VIEW
			 view_EDW_RewardsDefinition;
	END;
GO

--GRANT SELECT
--	ON [dbo].[view_EDW_RewardsDefinition]
--	TO [EDWReader_PRD]
--GO

CREATE VIEW dbo.view_EDW_RewardsDefinition
AS

--****************************************************************************************************************************************************
--WDM Reviewed 8/6/2014 for needed updates, may be needed
--	My question - Is NodeGUID going to be passed onto the children
--8/7/2014 - added and commented out DocumentGuid in case needed later
--8/8/2014 - Generated corrected view in DEV (WDM)
--8/19/2014 - (WDM) Added where clause to make the query return english data only.	
--09.11.2014 : Added to facilitate EDW Last Mod Date determination and added language filters
--11.14.2014 : Found that this view was in PRod Staging and not in Prod.
--11.17.2014 : John C. found that Spanish was coming across. This was due to the view
--				View_HFit_RewardProgram_Joined not having the capability to FITER at the 
--				Document Culture level. Created a view, View_EDW_RewardProgram_Joined, that
--				used View_HFit_RewardProgram_Joined and added the capability to fiter languages.
--12.31.2014 (WDM) added left outer join HFit_LKP_RewardActivity AND VHFRAJ.RewardActivityLKPName to the view reference CR-47520
--01.01.2014 (WDM) tested changes for CR-47520
--02.16.2015 (WDM) Requested by John C. added as all required is a reference to the name
--		    ,[LevelName]
--			,[LevelHeader]
--		    ,[GroupHeadingText]
--		    ,[GroupHeadingDescription]
-- 03.03.2015 (WDM/NJ) added VHFRPJ.NodeGuid as RewardProgramGUID, RewardGroupGuid, RewardLevelGuid, VHFRAJ.RewardActivityGuid, VHFRAJ.RewardActivityLKPGuid
--			RewardTriggerGuid, VHFRTPJ.NodeGuid,LKPRTP.ItemGuid as OperatorGUID, RewardTriggerGuid
-- 03.03.2015 (WDM/NJ) added new joined table LKPRTP
-- 
--****************************************************************************************************************************************************
--select * from information_schema.columns where column_name = 'RewardProgramGuid' 
--select top 100 * from View_EDW_RewardProgram_Joined 

SELECT DISTINCT
	   cs.SiteGUID
	 , HFA.AccountID
	 , hfa.AccountCD
	 --, RewardProgramID
	 , VHFRPJ.NodeGuid AS             RewardProgramGUID --(WDM/NJ) added 03.03.2015     
	 , RewardProgramName
	 , RewardProgramPeriodStart
	 , RewardProgramPeriodEnd
	 --, ProgramDescription
	 --, RewardGroupID
	 , VHFRGJ.NodeGuid AS             RewardGroupGuid --(WDM/NJ) added 03.03.2015     
	 , GroupName
	 --, RewardContactGroups
	 --, RewardGroupPeriodStart
	 --, RewardGroupPeriodEnd
	 --, RewardLevelID
	 , VHFRLJ.NodeGuid AS             RewardLevelGuid --(WDM/NJ) added 03.03.2015     
	 , Level
	 , RewardLevelTypeLKPName
	 --, RewardLevelPeriodStart
	 --, RewardLevelPeriodEnd
	 --, FrequencyMenu
	 , AwardDisplayName
	 , AwardType
	 , AwardThreshold1
	 , AwardThreshold2
	 , AwardThreshold3
	 , AwardThreshold4
	 , AwardValue1
	 , AwardValue2
	 , AwardValue3
	 , AwardValue4
	 --, CompletionText
	 , ExternalFulfillmentRequired
	 --, RewardHistoryDetailDescription
	 --, VHFRAJ.RewardActivityID
	 , VHFRAJ.NodeGuid AS             RewardActivityGuid --(WDM/NJ) added 03.03.2015     
	 , VHFRAJ.ActivityName
	 , VHFRAJ.ActivityFreqOrCrit
	 --, VHFRAJ.RewardActivityPeriodStart
	 --, VHFRAJ.RewardActivityPeriodEnd
	 --, VHFRAJ.RewardActivityLKPID
	 --, LKPRA.ItemGuid AS              RewardActivityLKPGuid --(WDM/NJ) added 03.03.2015     
	 --, LKPRA.RewardActivityLKPName
	 , VHFRAJ.ActivityPoints
	 , VHFRAJ.IsBundle
	 , VHFRAJ.IsRequired
	 , VHFRAJ.MaxThreshold
	 , VHFRAJ.AwardPointsIncrementally
	 , VHFRAJ.AllowMedicalExceptions
	 --, VHFRAJ.BundleText
	 --, RewardTriggerID
	 , VHFRTJ.NodeGuid AS             RewardTriggerGuid --(WDM/NJ) added 03.03.2015     
	 , HFLRT.RewardTriggerDynamicValue
	 , TriggerName
	 --, RequirementDescription
	 --, LKPRTP.ItemGuid AS             OperatorGUID --(WDM/NJ) added 03.03.2015     
	 , VHFRTPJ.RewardTriggerParameterOperator
	 , VHFRTPJ.NodeGuid AS            RewardTriggerParmGUID --(WDM/NJ) added 03.03.2015     
	 , VHFRTPJ.Value
	 --, vhfrtpj.ParameterDisplayName
	 , CASE
		   WHEN CAST (VHFRPJ.DocumentCreatedWhen AS date) = CAST (VHFRPJ.DocumentModifiedWhen AS date) 
		   THEN 'I'
		   ELSE 'U'
	   END AS                         ChangeType
	 --, VHFRPJ.DocumentGuid --WDM Added 8/7/2014 in case needed
	 --, VHFRPJ.DocumentCreatedWhen
	 --, VHFRPJ.DocumentModifiedWhen
	 --, VHFRAJ.DocumentModifiedWhen AS RewardActivity_DocumentModifiedWhen --09.11.2014 : Added to facilitate EDW Last Mod Date determination
	 , VHFRAJ.DocumentCulture AS      DocumentCulture_VHFRAJ
	 , VHFRPJ.DocumentCulture AS      DocumentCulture_VHFRPJ
	 , VHFRGJ.DocumentCulture AS      DocumentCulture_VHFRGJ
	 , VHFRLJ.DocumentCulture AS      DocumentCulture_VHFRLJ
	 , VHFRTPJ.DocumentCulture AS     DocumentCulture_VHFRTPJ
	 , LevelName
	 --, LevelHeader
	 --, GroupHeadingText
	 --, GroupHeadingDescription
	   FROM dbo.View_EDW_RewardProgram_Joined AS VHFRPJ
				INNER JOIN dbo.View_HFit_RewardGroup_Joined AS VHFRGJ
					ON VHFRPJ.NodeID = VHFRGJ.NodeParentID
				   AND VHFRPJ.DocumentCulture = 'en-US'
				   AND VHFRGJ.DocumentCulture = 'en-US'
				 INNER JOIN dbo.View_HFit_RewardLevel_Joined AS VHFRLJ
					ON VHFRGJ.NodeID = VHFRLJ.NodeParentID
				   AND VHFRLJ.DocumentCulture = 'en-US'
				 INNER JOIN dbo.HFit_LKP_RewardLevelType AS HFLRLT
					ON VHFRLJ.LevelType = HFLRLT.RewardLevelTypeLKPID
				 INNER JOIN dbo.View_HFit_RewardActivity_Joined AS VHFRAJ
					ON VHFRLJ.NodeID = VHFRAJ.NodeParentID
				   AND VHFRAJ.DocumentCulture = 'en-US'
				 LEFT OUTER JOIN HFit_LKP_RewardActivity AS LKPRA
					ON LKPRA.RewardActivityLKPID = VHFRAJ.RewardActivityLKPID   --Added 1.2.2015 for SR-47520
				 INNER JOIN dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ
					ON VHFRAJ.NodeID = VHFRTJ.NodeParentID
				   AND VHFRTJ.DocumentCulture = 'en-US'
				 INNER JOIN dbo.View_HFit_RewardTriggerParameter_Joined AS VHFRTPJ
					ON vhfrtj.nodeid = vhfrtpj.nodeparentid
				   AND VHFRTPJ.DocumentCulture = 'en-US'
				 INNER JOIN dbo.HFit_LKP_RewardTrigger AS HFLRT
					ON VHFRTJ.RewardTriggerLKPID = HFLRT.RewardTriggerLKPID
				 INNER JOIN dbo.CMS_Site AS CS
					ON VHFRPJ.NodeSiteID = cs.SiteID
				 INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				 INNER JOIN HFit_LKP_RewardTriggerParameterOperator AS LKPRTP
					ON LKPRTP.RewardTriggerParameterOperatorLKPID = VHFRTPJ.RewardTriggerParameterOperator;
GO
PRINT 'Processed: view_EDW_RewardsDefinition ';
GO
/*
(WDM) Kept only these coulmns IAW CR-51005
SiteGUID 
AccountID
AccountCD 
RewardProgramGUID
RewardProgramName
RewardProgramPeriodStart
RewardProgramPeriodEnd
RewardGroupGUID
GroupName
RewardLevelGUID
Level
RewardLevelTypeLKPName
AwardDisplayName
AwardType
AwardThreshold1
AwardThreshold2
AwardThreshold3
AwardThreshold4
AwardValue1
AwardValue2
AwardValue3
AwardValue4
ExternalFulfillmentRequired
RewardActivityGUID
RewardActivityName	--VHFRAJ.ActivityName
ActivityFreqOrCrit
ActivityPoints
IsBundle
IsRequired
MaxThreshold
AwardPointsIncrementally
AllowMedicalExceptions
RewardTriggerGUID
RewardTriggerDynamicValue
TriggerName
RewardTriggerParameterOperator
RewardTriggerParameterGUID  --RewardTriggerParmGUID
Value
ChangeType
DocumentCulture_VHFRAJ
DocumentCulture_VHFRPJ
DocumentCulture_VHFRGJ
DocumentCulture_
DocumentCulture_VHFRTPJ
LevelName
*/
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Processing view_EDW_BioMetrics: ' + CAST (GETDATE () AS nvarchar (50)) + '  *** view_EDW_BioMetrics.sql (CR11690)';
GO
--drop table [EDW_BiometricViewRejectCriteria]
IF NOT EXISTS (SELECT [name]
			  FROM [sys].[tables]
			  WHERE [name] = 'EDW_BiometricViewRejectCriteria') 
    BEGIN
	   PRINT 'EDW_BiometricViewRejectCriteria NOT found, creating';
	   --This table contains the REJECT specifications for Biometric data. An entry causes all records before a date for a Client or SITE to be ignored.
	   --Use AccountCD and ItemCreatedWhen together OR SiteID and ItemCreatedWhen together. They work and reject in pairs.
	   CREATE TABLE [dbo].[EDW_BiometricViewRejectCriteria]
	   (
	   [AccountCD] nvarchar (8) NOT NULL
	 , [ItemCreatedWhen] datetime2 (7) NOT NULL
	 , [SiteID] int NOT NULL
	 , [RejectGUID] uniqueidentifier NULL
	   );

	   ALTER TABLE [dbo].[EDW_BiometricViewRejectCriteria]
	   ADD CONSTRAINT
		  [DF_EDW_BiometricViewRejectCriteria_RejectGUID] DEFAULT NEWID () FOR [RejectGUID];

	   ALTER TABLE [dbo].[EDW_BiometricViewRejectCriteria] SET (LOCK_ESCALATION = TABLE) ;

	   EXEC [sp_addextendedproperty]
	   @name = N'PURPOSE' , @value = 'This table contains the REJECT specifications for Biometric data. An entry causes all records before a date for a Client or SITE to be ignored. The data is entered as SiteID and Rejection Date OR AccountCD and Rejection Date. All dates prior to the rejection date wil be ignored.' ,
	   @level0type = N'Schema' , @level0name = 'dbo' ,
	   @level1type = N'Table' , @level1name = 'EDW_BiometricViewRejectCriteria';
	   --@level2type = N'Column', @level2name = NULL

	   EXEC [sp_addextendedproperty]
	   @name = N'MS_Description' , @value = 'Use AccountCD and ItemCreatedWhen together, entering a non-existant value for SiteID. They work and reject in pairs and this type of entry will only take AccountCD and ItemCreatedWhen date into consideration.' ,
	   @level0type = N'Schema' , @level0name = 'dbo' ,
	   @level1type = N'Table' , @level1name = 'EDW_BiometricViewRejectCriteria' ,
	   @level2type = N'Column' , @level2name = 'AccountCD';

	   EXEC [sp_addextendedproperty]
	   @name = N'USAGE' , @value = 'Use SiteID and ItemCreatedWhen together, entering a non-existant value for AccountCD. They work and reject in pairs.' ,
	   @level0type = N'Schema' , @level0name = 'dbo' ,
	   @level1type = N'Table' , @level1name = 'EDW_BiometricViewRejectCriteria' ,
	   @level2type = N'Column' , @level2name = 'SiteID';

	   EXEC [sp_addextendedproperty]
	   @name = N'USAGE' , @value = 'Use AccountCD or SiteID and ItemCreatedWhen together. They work and reject in pairs. Any date before this date will NOT be retrieved.' ,
	   @level0type = N'Schema' , @level0name = 'dbo' ,
	   @level1type = N'Table' , @level1name = 'EDW_BiometricViewRejectCriteria' ,
	   @level2type = N'Column' , @level2name = 'ItemCreatedWhen';
    END;
GO

IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'view_EDW_BiometricViewRejectCriteria') 
    BEGIN
	   PRINT 'view_EDW_BiometricViewRejectCriteria found, updating';
	   DROP VIEW [view_EDW_BiometricViewRejectCriteria];
    END;
GO

CREATE VIEW [view_EDW_BiometricViewRejectCriteria]
AS SELECT [AccountCD]
	   , [ItemCreatedWhen]
	   , [SiteID]
	   , [RejectGUID]
	FROM [dbo].[EDW_BiometricViewRejectCriteria];
GO
PRINT 'view_EDW_BiometricViewRejectCriteria, updated';
GO

IF NOT EXISTS (SELECT [name]
			  FROM [sys].[indexes]
			  WHERE [name] = 'PKI_EDW_BiometricViewRejectCriteria') 
    BEGIN
	   PRINT 'PKI_EDW_BiometricViewRejectCriteria NOT found, creating';
	   CREATE UNIQUE CLUSTERED INDEX [PKI_EDW_BiometricViewRejectCriteria] ON [dbo].[EDW_BiometricViewRejectCriteria]
	   (
	   [AccountCD] ASC ,
	   [ItemCreatedWhen] ASC ,
	   [SiteID] ASC
	   );
    END;
ELSE
    BEGIN
	   PRINT 'PKI_EDW_BiometricViewRejectCriteria created';
    END;

GO

IF EXISTS (SELECT [name]
		   FROM [sys].[procedures]
		   WHERE [name] = 'proc_Insert_EDW_BiometricViewRejectCriteria') 
    BEGIN
	   PRINT 'proc_Insert_EDW_BiometricViewRejectCriteria found, updating.';
	   DROP PROCEDURE [proc_Insert_EDW_BiometricViewRejectCriteria];
    END;
ELSE
    BEGIN
	   PRINT 'Creating proc_Insert_EDW_BiometricViewRejectCriteria';
    END;
GO

CREATE PROC [proc_Insert_EDW_BiometricViewRejectCriteria] (
	  @AccountCD AS nvarchar (50) , @ItemCreatedWhen AS datetime , @SiteID AS int) 
AS
BEGIN

    IF @SiteID IS NULL
	   BEGIN
		  SET @SiteID = -1;
	   END;

    DECLARE @iCnt integer = 0;
    SET @iCnt = (SELECT COUNT (*) 
			    FROM [EDW_BiometricViewRejectCriteria]
			    WHERE [AccountCD] = @AccountCD
				 AND [SiteID] = @SiteID) ;
    IF @iCnt <= 0
	   BEGIN
		  INSERT INTO [dbo].[EDW_BiometricViewRejectCriteria]
		  ([AccountCD]
		 , [ItemCreatedWhen]
		 , [SiteID]
		  ) 
		  VALUES
		  (@AccountCD
		  , @ItemCreatedWhen
		  , @SiteID
		  );
		  PRINT 'ADDED ' + @AccountCD + ' to EDW_BiometricViewRejectCriteria.';
	   END;
    ELSE
	   BEGIN
		  PRINT 'Account ' + @AccountCD + ' already defined to EDW_BiometricViewRejectCriteria.';
	   END;
END;

GO

IF EXISTS (SELECT [name]
		   FROM [sys].[procedures]
		   WHERE [name] = 'proc_Delete_EDW_BiometricViewRejectCriteria_Acct') 
    BEGIN
	   PRINT 'proc_Delete_EDW_BiometricViewRejectCriteria_Acct  found, updating.';
	   DROP PROCEDURE [proc_Delete_EDW_BiometricViewRejectCriteria_Acct];
    END;
ELSE
    BEGIN
	   PRINT 'Creating proc_Delete_EDW_BiometricViewRejectCriteria_Acct';
    END;

GO

CREATE PROC [proc_Delete_EDW_BiometricViewRejectCriteria_Acct] (
	  @AccountCD AS nvarchar (50) , @ItemCreatedWhen AS datetime) 
AS
BEGIN
    DELETE FROM [dbo].[EDW_BiometricViewRejectCriteria]
	 WHERE [AccountCD] = @AccountCD
	   AND [ItemCreatedWhen] = @ItemCreatedWhen;
END;

GO
IF EXISTS (SELECT [name]
		   FROM [sys].[procedures]
		   WHERE [name] = 'proc_Delete_EDW_BiometricViewRejectCriteria_Site') 
    BEGIN
	   PRINT 'proc_Delete_EDW_BiometricViewRejectCriteria_Site  found, updating.';
	   DROP PROCEDURE [proc_Delete_EDW_BiometricViewRejectCriteria_Site];
    END;
ELSE
    BEGIN
	   PRINT 'Creating proc_Delete_EDW_BiometricViewRejectCriteria_Site';
    END;

GO

CREATE PROC [proc_Delete_EDW_BiometricViewRejectCriteria_Site] (
	  @SiteID AS int , @ItemCreatedWhen AS datetime) 
AS
BEGIN
    DELETE FROM [dbo].[EDW_BiometricViewRejectCriteria]
	 WHERE [SiteID] = @SiteID
	   AND [ItemCreatedWhen] = @ItemCreatedWhen;

END;
GO

IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'view_EDW_BioMetrics') 
    BEGIN
	   PRINT 'Removing current view_EDW_BioMetrics.';
	   DROP VIEW [view_EDW_BioMetrics];
    END;
GO
PRINT 'Creating view_EDW_BioMetrics.';
GO

CREATE VIEW [dbo].[view_EDW_BioMetrics]
AS
--*****************************************************************************************************************************************
--************** TEST Criteria and Results for view_EDW_BioMetrics ************************************************************************
--INSERT INTO [dbo].[EDW_BiometricViewRejectCriteria] ([AccountCD],[ItemCreatedWhen],[SiteID]) VALUES('XX','2013-12-01',17  )  
--NOTE:		XX is used so that the AccountCD is NOT taken into account and only SiteID and ItemCreatedWhen is used.
--GO	--Tested by wdm on 11.21.2014

-- select count(*) from view_EDW_BioMetrics		--(wdm) & (jc) : testing on {ProdStaging = 136348} / With reject on 136339 = 9

--select * from view_EDW_BioMetrics	 where AccountCD = 'peabody' AND COALESCE (EventDate,ItemCreatedWhen) is not NULL and COALESCE (EventDate,ItemCreatedWhen) < '2013-12-01'	: 9 
--select * from view_Hfit_BioMetrics where AccountCD = 'peabody' AND COALESCE (EventDate,ItemCreatedWhen) is not NULL and COALESCE (EventDate,ItemCreatedWhen) < '2013-12-01'	: 9 

--select * from view_EDW_BioMetrics	where AccountCD = 'peabody' and ItemCreatedWhen < '2013-12-01 00:00:00.000'		: 7 
--select * from view_EDW_BioMetrics	where AccountCD = 'peaboOK dy' and EventDate < '2013-12-01 00:00:00.000'		: 9 

--select count(*) from view_EDW_BioMetrics		--NO REJECT FILTER : 136348
--select count(*) from view_EDW_BioMetrics		--REJECT FILTER ON : 136339 == 9 GOOD TEST

--select count(*) from view_Hfit_BioMetrics	:136393
--select count(*) from view_Hfit_BioMetrics where COALESCE (EventDate,ItemCreatedWhen) is not NULL 	:136348

--NOTE: All tests passed 11.21.2014, 11.23.2014, 12.2.2014, 12,4,2014

--truncate table EDW_BiometricViewRejectCriteria

--INSERT INTO [dbo].[EDW_BiometricViewRejectCriteria]([AccountCD],[ItemCreatedWhen],[SiteID])VALUES('peabody','2013-12-01',-1)         
--NOTE:		-1 is used so that the SiteID is NOT taken into account and only AccountCD and ItemCreatedWhen is used.
--GO	--Tested by wdm on 11.21.2014

--select * from view_EDW_BioMetrics where ItemCreatedWhen < '2013-12-01' and AccountCD = 'peabody' returns 1034
--		so the number should be 43814 - 1034 = 42780 with AccountCD = 'peabody' and ItemCreatedWhen = '2014-03-19'
--		in table EDW_BiometricViewRejectCriteria. And it worked (wdm) 11.21.2014
--GO	--Tested by wdm on 11.21.2014

--select * from view_EDW_BioMetrics where SiteID = 17 and ItemCreatedWhen < '2014-03-19' returns 22,974
--		so the number should be 43814 - 22974 = 20840 with SIteID = 17 and ItemCreatedWhen = '2014-03-19'
--		in table EDW_BiometricViewRejectCriteria. And it worked (wdm) 11.21.2014
--GO	--Tested by wdm on 11.21.2014

--	11.24.2014 (wdm) -	requested a review of this code and validation with EDW.

-- 12.22.2014 - Received an SR from John C. via Richard to add two fields to the view, Table name and Item ID.
-- 12.23.2014 - Added the Vendor ID and Vendor name to the view via the HFit_LKP_TrackerVendor table
-- 12.25.2014 - Added the EDW_BiometricViewRejectCriteria to allow selective rejection of historical records
-- 01.19.2014 - Prepared for Simpson Willams

--*****************************************************************************************************************************************
SELECT DISTINCT
--HFit_UserTracker
[HFUT].[UserID]
, [cus].[UserSettingsUserGUID] AS [UserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, NULL AS [CreatedDate]
, NULL AS [ModifiedDate]
, NULL AS [Notes]
, NULL AS [IsProfessionallyCollected]
, NULL AS [EventDate]
, 'Not Build Yet' AS [EventName]

--HFit_TrackerWeight
, NULL AS [PPTWeight]

--HFit_TrackerHbA1C
, NULL AS [PPTHbA1C]

--HFit_TrackerCholesterol
, NULL AS [Fasting]
, NULL AS [HDL]
, NULL AS [LDL]
, NULL AS [Ratio]
, NULL AS [Total]
, NULL AS [Triglycerides]

--HFit_TrackerBloodSugarandGlucose
, NULL AS [Glucose]
, NULL AS [FastingState]

--HFit_TrackerBloodPressure
, NULL AS [Systolic]
, NULL AS [Diastolic]

--HFit_TrackerBodyFat
, NULL AS [PPTBodyFatPCT]

--HFit_TrackerBMI
, NULL AS [BMI]

--HFit_TrackerBodyMeasurements
, NULL AS [WaistInches]
, NULL AS [HipInches]
, NULL AS [ThighInches]
, NULL AS [ArmInches]
, NULL AS [ChestInches]
, NULL AS [CalfInches]
, NULL AS [NeckInches]

--HFit_TrackerHeight
, NULL AS [Height]

--HFit_TrackerRestingHeartRate
, NULL AS [HeartRate]
, --HFit_TrackerShots
NULL AS [FluShot]
, NULL AS [PneumoniaShot]

--HFit_TrackerTests
, NULL AS [PSATest]
, NULL AS [OtherExam]
, NULL AS [TScore]
, NULL AS [DRA]
, NULL AS [CotinineTest]
, NULL AS [ColoCareKit]
, NULL AS [CustomTest]
, NULL AS [CustomDesc]
, NULL AS [CollectionSource]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFUT].[ItemCreatedWhen] = COALESCE ([HFUT].[ItemModifiedWhen] , [hfut].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFUT].[ItemCreatedWhen]
, [HFUT].[ItemModifiedWhen]
, 0   AS [TrackerCollectionSourceID]
, [HFUT].[itemid]
, 'HFit_UserTracker' AS [TBL]
, NULL AS [VendorID]		--VENDOR.ItemID as VendorID
, NULL AS [VendorName]		--VENDOR.VendorName
  FROM
	  [dbo].[HFit_UserTracker] AS [HFUT]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [hfut].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
  --left outer join HFit_LKP_TrackerVendor as VENDOR on HFUT.VendorID = VENDOR.ItemID
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE [HFUT].[ItemCreatedWhen] < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND [HFUT].[ItemCreatedWhen] < [ItemCreatedWhen]) 
	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified within table EDW_BiometricViewRejectCriteria
    AND [HFUT].[ItemCreatedWhen] IS NOT NULL		--Add per Robert and Laura 12.4.2014

UNION ALL
SELECT
[hftw].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTW].[ItemCreatedWhen]
, [HFTW].[ItemModifiedWhen]
, [HFTW].[Notes]
, [HFTW].[IsProfessionallyCollected]
, [HFTW].[EventDate]
, 'Not Build Yet' AS [EventName]
, [hftw].Value AS [PPTWeight]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTW].[ItemCreatedWhen] = COALESCE ([HFTW].[ItemModifiedWhen] , [HFTW].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTW].[ItemCreatedWhen]
, [HFTW].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTW].[itemid]
, 'HFit_TrackerWeight' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerWeight] AS [HFTW]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTW].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTW].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTW].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria	  
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTW].[EventDate] , [HFTW].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTW].[EventDate] , [HFTW].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTW].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTW].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014			

UNION ALL
SELECT
[HFTHA].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTHA].[ItemCreatedWhen]
, [HFTHA].[ItemModifiedWhen]
, [HFTHA].[Notes]
, [HFTHA].[IsProfessionallyCollected]
, [HFTHA].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, [HFTHA].Value AS [PPTHbA1C]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTHA].[ItemCreatedWhen] = COALESCE ([HFTHA].[ItemModifiedWhen] , [HFTHA].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTHA].[ItemCreatedWhen]
, [HFTHA].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTHA].[itemid]
, 'HFit_TrackerHbA1c' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerHbA1c] AS [HFTHA]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTHA].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTHA].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTHA].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTHA].[EventDate] , [HFTHA].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTHA].[EventDate] , [HFTHA].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTHA].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTHA].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014

UNION ALL
SELECT
[HFTC].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTC].[ItemCreatedWhen]
, [HFTC].[ItemModifiedWhen]
, [HFTC].[Notes]
, [HFTC].[IsProfessionallyCollected]
, [HFTC].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, [HFTC].[Fasting]
, [HFTC].[HDL]
, [HFTC].[LDL]
, [HFTC].[Ratio]
, [HFTC].[Total]
, [HFTC].[Tri]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTC].[ItemCreatedWhen] = COALESCE ([HFTC].[ItemModifiedWhen] , [HFTC].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTC].[ItemCreatedWhen]
, [HFTC].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTC].[itemid]
, 'HFit_TrackerCholesterol' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerCholesterol] AS [HFTC]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTC].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTC].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTC].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTC].[EventDate] , [HFTC].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTC].[EventDate] , [HFTC].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTC].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTC].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014

UNION ALL
SELECT
[HFTBSAG].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTBSAG].[ItemCreatedWhen]
, [HFTBSAG].[ItemModifiedWhen]
, [HFTBSAG].[Notes]
, [HFTBSAG].[IsProfessionallyCollected]
, [HFTBSAG].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTBSAG].[Units]
, [HFTBSAG].[FastingState]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTBSAG].[ItemCreatedWhen] = COALESCE ([HFTBSAG].[ItemModifiedWhen] , [HFTBSAG].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTBSAG].[ItemCreatedWhen]
, [HFTBSAG].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTBSAG].[itemid]
, 'HFit_TrackerBloodSugarAndGlucose' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerBloodSugarAndGlucose] AS [HFTBSAG]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTBSAG].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTBSAG].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTBSAG].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTBSAG].[EventDate] , [HFTBSAG].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTBSAG].[EventDate] , [HFTBSAG].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTBSAG].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTBSAG].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014

UNION ALL
SELECT
[HFTBP].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTBP].[ItemCreatedWhen]
, [HFTBP].[ItemModifiedWhen]
, [HFTBP].[Notes]
, [HFTBP].[IsProfessionallyCollected]
, [HFTBP].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTBP].[Systolic]
, [HFTBP].[Diastolic]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTBP].[ItemCreatedWhen] = COALESCE ([HFTBP].[ItemModifiedWhen] , [HFTBP].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTBP].[ItemCreatedWhen]
, [HFTBP].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTBP].[itemid]
, 'HFit_TrackerBloodPressure' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerBloodPressure] AS [HFTBP]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTBP].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTBP].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTBP].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTBP].[EventDate] , [HFTBP].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTBP].[EventDate] , [HFTBP].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTBP].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTBP].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014

UNION ALL
SELECT
[HFTBF].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTBF].[ItemCreatedWhen]
, [HFTBF].[ItemModifiedWhen]
, [HFTBF].[Notes]
, [HFTBF].[IsProfessionallyCollected]
, [HFTBF].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTBF].Value AS [PPTBodyFatPCT]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTBF].[ItemCreatedWhen] = COALESCE ([HFTBF].[ItemModifiedWhen] , [HFTBF].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTBF].[ItemCreatedWhen]
, [HFTBF].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTBF].[itemid]
, 'HFit_TrackerBodyFat' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerBodyFat] AS [HFTBF]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTBF].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTBF].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTBF].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTBF].[EventDate] , [HFTBF].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTBF].[EventDate] , [HFTBF].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTBF].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTBF].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014

UNION ALL
SELECT
[HFTB].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTB].[ItemCreatedWhen]
, [HFTB].[ItemModifiedWhen]
, [HFTB].[Notes]
, [HFTB].[IsProfessionallyCollected]
, [HFTB].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTB].[BMI]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTB].[ItemCreatedWhen] = COALESCE ([HFTB].[ItemModifiedWhen] , [HFTB].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTB].[ItemCreatedWhen]
, [HFTB].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTB].[itemid]
, 'HFit_TrackerBMI' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerBMI] AS [HFTB]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTB].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTB].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTB].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTB].[EventDate] , [HFTB].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTB].[EventDate] , [HFTB].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTB].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTB].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014

UNION ALL
SELECT
[HFTBM].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTBM].[ItemCreatedWhen]
, [HFTBM].[ItemModifiedWhen]
, [HFTBM].[Notes]
, [HFTBM].[IsProfessionallyCollected]
, [HFTBM].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTBM].[WaistInches]
, [HFTBM].[HipInches]
, [HFTBM].[ThighInches]
, [HFTBM].[ArmInches]
, [HFTBM].[ChestInches]
, [HFTBM].[CalfInches]
, [HFTBM].[NeckInches]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTBM].[ItemCreatedWhen] = COALESCE ([HFTBM].[ItemModifiedWhen] , [HFTBM].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTBM].[ItemCreatedWhen]
, [HFTBM].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTBM].[itemid]
, 'HFit_TrackerBodyMeasurements' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerBodyMeasurements] AS [HFTBM]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTBM].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTBM].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTBM].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTBM].[EventDate] , [HFTBM].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTBM].[EventDate] , [HFTBM].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTBM].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTBM].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014

UNION ALL
SELECT
[HFTH].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTH].[ItemCreatedWhen]
, [HFTH].[ItemModifiedWhen]
, [HFTH].[Notes]
, [HFTH].[IsProfessionallyCollected]
, [HFTH].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTH].[Height]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTH].[ItemCreatedWhen] = COALESCE ([HFTH].[ItemModifiedWhen] , [HFTH].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTH].[ItemCreatedWhen]
, [HFTH].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTH].[itemid]
, 'HFit_TrackerHeight' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerHeight] AS [HFTH]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTH].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTH].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTH].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria		
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTH].[EventDate] , [HFTH].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTH].[EventDate] , [HFTH].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTH].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTH].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014
UNION ALL
SELECT
[HFTRHR].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTRHR].[ItemCreatedWhen]
, [HFTRHR].[ItemModifiedWhen]
, [HFTRHR].[Notes]
, [HFTRHR].[IsProfessionallyCollected]
, [HFTRHR].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTRHR].[HeartRate]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTRHR].[ItemCreatedWhen] = COALESCE ([HFTRHR].[ItemModifiedWhen] , [HFTRHR].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTRHR].[ItemCreatedWhen]
, [HFTRHR].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTRHR].[itemid]
, 'HFit_TrackerRestingHeartRate' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerRestingHeartRate] AS [HFTRHR]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTRHR].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTRHR].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTRHR].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTRHR].[EventDate] , [HFTRHR].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTRHR].[EventDate] , [HFTRHR].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTRHR].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTRHR].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014

UNION ALL
SELECT
[HFTS].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTS].[ItemCreatedWhen]
, [HFTS].[ItemModifiedWhen]
, [HFTS].[Notes]
, [HFTS].[IsProfessionallyCollected]
, [HFTS].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTS].[FluShot]
, [HFTS].[PneumoniaShot]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTS].[ItemCreatedWhen] = COALESCE ([HFTS].[ItemModifiedWhen] , [HFTS].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTS].[ItemCreatedWhen]
, [HFTS].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTS].[itemid]
, 'HFit_TrackerShots' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerShots] AS [HFTS]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTS].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTS].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTS].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTS].[EventDate] , [HFTS].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTS].[EventDate] , [HFTS].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTS].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTS].[EventDate] IS NOT NULL)		--Add per RObert and Laura 12.4.2014

UNION ALL
SELECT
[HFTT].[UserID]
, [cus].[UserSettingsUserGUID]
, [cus].[HFitUserMpiNumber]
, [cus2].[SiteID]
, [cs].[SiteGUID]
, [HFTT].[ItemCreatedWhen]
, [HFTT].[ItemModifiedWhen]
, [HFTT].[Notes]
, [HFTT].[IsProfessionallyCollected]
, [HFTT].[EventDate]
, 'Not Build Yet' AS [EventName]
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, NULL
, [HFTT].[PSATest]
, [HFTT].[OtherExam]
, [HFTT].[TScore]
, [HFTT].[DRA]
, [HFTT].[CotinineTest]
, [HFTT].[ColoCareKit]
, [HFTT].[CustomTest]
, [HFTT].[CustomDesc]
, [HFTCS].[CollectionSourceName_External]
, [HFA].[AccountID]
, [HFA].[AccountCD]
, CASE
	 WHEN [HFTT].[ItemCreatedWhen] = COALESCE ([HFTT].[ItemModifiedWhen] , [HFTT].[ItemCreatedWhen]) 
	 THEN 'I'
	 ELSE 'U'
  END AS [ChangeType]
, [HFTT].[ItemCreatedWhen]
, [HFTT].[ItemModifiedWhen]
, [HFTCS].[TrackerCollectionSourceID]
, [HFTT].[itemid]
, 'HFit_TrackerTests' AS [TBL]
, [VENDOR].[ItemID] AS [VendorID]
, [VENDOR].[VendorName]
  FROM
	  [dbo].[HFit_TrackerTests] AS [HFTT]
		 INNER JOIN [dbo].[HFit_TrackerCollectionSource] AS [HFTCS]
			ON [HFTT].[TrackerCollectionSourceID] = [HFTCS].[TrackerCollectionSourceID]
		 INNER JOIN [dbo].[CMS_UserSettings] AS [CUS]
			ON [HFTT].[UserID] = [cus].[UserSettingsUserID]
		 INNER JOIN [dbo].[CMS_UserSite] AS [CUS2]
			ON [cus].[UserSettingsUserID] = [cus2].[UserID]
		 INNER JOIN [dbo].[CMS_Site] AS [CS]
			ON [CUS2].[SiteID] = [CS].[SiteID]
		 INNER JOIN [dbo].[HFit_Account] AS [HFA]
			ON [cs].[SiteID] = [HFA].[SiteID]
		 LEFT OUTER JOIN [HFit_LKP_TrackerVendor] AS [VENDOR]
			ON [HFTT].[VendorID] = [VENDOR].[ItemID]
  --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria
  WHERE [CS].[SITEID] NOT IN (SELECT [SiteID]
						  FROM [EDW_BiometricViewRejectCriteria]
						  WHERE COALESCE ([HFTT].[EventDate] , [HFTT].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND [HFA].[AccountCD] NOT IN (SELECT [AccountCD]
							 FROM [EDW_BiometricViewRejectCriteria]
							 WHERE [HFA].[AccountCD] = [AccountCD]
							   AND COALESCE ([HFTT].[EventDate] , [HFTT].[ItemCreatedWhen]) < [ItemCreatedWhen]) 
    AND ([HFTT].[ItemCreatedWhen] IS NOT NULL
	 OR [HFTT].[EventDate] IS NOT NULL);		--Add per RObert and Laura 12.4.2014

--HFit_TrackerBMI
--HFit_TrackerBodyMeasurements
--HFit_TrackerHeight
--HFit_TrackerRestingHeartRate
--HFit_TrackerShots
--HFit_TrackerTests

GO

PRINT 'Created view_EDW_BioMetrics: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO
--  
--  
GO
PRINT '***** FROM: view_EDW_BioMetrics.sql';
GO

----***************************************************************************************************************************
----** REMOVE THE INSERTS AFTER INTITAL LOAD
----***************************************************************************************************************************
--truncate table EDW_BiometricViewRejectCriteria ;
--go 
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'trstmark','11/4/2013',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'entergy','1/6/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'mcwp','1/27/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'stateneb','4/1/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'jnj','5/28/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'coopers','7/1/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'cnh','8/4/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'amat','8/4/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'dupont','8/18/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'ejones','9/3/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'avera','9/15/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'sprvalu','9/18/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'firstgrp','10/6/2014',-1) ;
--GO
--insert into EDW_BiometricViewRejectCriteria (AccountCD, ItemCreatedWhen, SiteID)
--Values (
--'rexnord','12/2/2014',-1) ;
--GO
PRINT '***** COMPLETED : view_EDW_BioMetrics.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





--GO
--IF EXISTS (SELECT name FROM sys.triggers where name = 'trgSchemaMonitor')    
--DISABLE TRIGGER trgSchemaMonitor ON DATABASE;

GO
PRINT '***** FROM: view_EDW_TrackerCompositeDetails.sql';
PRINT 'Processing: view_EDW_TrackerCompositeDetails ';
GO
--SELECT * from view_EDW_TrackerCompositeDetails
IF EXISTS ( SELECT DISTINCT
                   TABLE_NAME
                   FROM INFORMATION_SCHEMA.VIEWS
                   WHERE
                   TABLE_NAME = 'view_EDW_TrackerCompositeDetails') 
    BEGIN
        DROP VIEW
             view_EDW_TrackerCompositeDetails;
    END;
GO
--count with UNION ALL xx @ 00:00:24
--count with UNION ALL and DISTINCT xx @ 00:00:24
--count with UNION 3,218,556 @ 00:00:24
--SELECT count(*) from view_EDW_TrackerCompositeDetails;
GO
CREATE VIEW dbo.view_EDW_TrackerCompositeDetails
AS
--************************************************************************************************************************************
-- NOTES:
--************************************************************************************************************************************
--WDM 6/26/2014
--This view is needed by EDW in order to process the Tracker tables' data.
--As of now, the Tracker tables are representative of objects and that would cause 
--	large volumes of ETL to be devloped and maintained. 
--This view represents a columnar representation of all tracker tables in a Key/Value pair representation.
--Each tracker table to be processed into the EDW must be represented in this view.
--ALL new tracker tables need only be entered once using the structure contained within this view
--	and the same EDW ETL should be able to process it.
--If there is a change to the strucuture of any one query in this view, then all have to be modified 
--	to be support the change.
--Column TrackerNameAggregratetable (AggregateTableName) will be NULL if the Tracker is not a member 
--		of the DISPLAYED Trackers. This allows us to capture all trackers, displayed or not.

--7/29/2014
--ISSUE: HFit_TrackerBMI,  HFit_TrackerCholesterol, and HFit_TrackerHeight are not in the HFIT_Tracker
--		table. This causes T.IsAvailable, T.IsCustom, T.UniqueName to be NULL. 
--		This raises the need for the Tracker Definition Table.

--NOTE: It is a goal to keep this view using BASE tables in order to gain max performance. Nested views will 
--		be avoided here if possible.

--**************** SPECIFIC TRACKER DATA **********************
--**************** on 7/29/2014          **********************
--Tracker GUID or Unique ID across all DB Instances (ItemGuid)
--Tracker NodeID (we use it for the External ID for Audit and error Triage)  (John: can use ItemID in this case)
--Tracker Table Name or Value Group Name (e.g. Body Measurements) - Categorization (TrackerNameAggregateTable)
--Tracker Column Unique Name ( In English)  Must be consistent across all DB Instances  ([UniqueName] will be 
--		the TABLE NAME if tracker name not found in the HFIT_Tracker table)
--Tracker Column Description (In English) (???)
--Tracker Column Data Type (e.g. Character, Numeric, Date, Bit or Yes/No)  so that we can set up the answer type
--	NULLS accepted for No Answer?	(KEY1, KEY2, VAL1, VAL2, etc)
--Tracker Active flag (IsAvailable will be null if tracker name not found in the HFIT_Tracker table)
--Tracker Unit of Measure (character) (Currently, the UOM is supplied in the view based on the table and type of Tracker)
--Tracker Insert Date ([ItemCreatedWhen])
--Tracker Last Update Date ([ItemModifiedWhen])
--NOTE: Convert all numerics to floats 7/30/2104 John/Dale
--****************************************************************************************************************************
-- 12.21.2014 - Added Select Distincts to avoid possible dups.
-- 12.23.2014 - Added the Vendor ID and Vendor name to the view via the HFit_LKP_TrackerVendor table
-- 12.25.2014 - Tested the view to see that it returned the correct VendorID description
--****************************************************************************************************************************
-- NEW ADDITIONS: 02.01.2015	Need for the updates to be completed and then we add.
--	  HFit_TrackerTobaccoAttestation
--	  HFit_TrackerPreventiveCare
--	  HFit_TrackerCotinine
--(03.20.2015) - (WDM) The DISTINCT in this qry in should eliminate duplicate rows found by John C.
--			 All worked correctly in 12.25.2014, NO changes effected since then, and unexplicably rows stated to 
--			 duplicate in three tables (tracker views) Shots, Tests, and TrackerInstance
--(03.20.2015) - WDM : HFit_TrackerInstance_Tracker has a problem that will require developer help - it is still OPEN.
--			    John C. and I looked at the issue and the LEFT join is causing a cartisian as there is no KEY 
--			    on which to join.
-- TGT (PRod1) NO DISTINCT: 
--  SELECT DISTINCT count(*) from view_EDW_TrackerCompositeDetails 00:08:36 @ 3,210,081
--- TGT (PRod1) WITH DISTINCT and Union all: 
--  SELECT DISTINCT count(*) from view_EDW_TrackerCompositeDetails 00:00:30 @ 3,210,081
--- TGT (PRod1) No DISTINCT and UNion all: 
--  SELECT DISTINCT count(*) from view_EDW_TrackerCompositeDetails 00:00:14 @ 3,218,556
--****************************************************************************************************************************
--USE:
--SELECT DISTINCT * from view_EDW_TrackerCompositeDetails where EventDate between '2013-11-01 15:02:00.000' and '2013-12-01 15:02:00.000'

--Set statistics IO ON
--GO

SELECT DISTINCT
       'HFit_TrackerBloodPressure' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'mm/Hg' AS UOM
     , 'Systolic' AS KEY1
     , CAST ( Systolic AS float) AS VAL1
     , 'Diastolic' AS KEY2
     , CAST ( Diastolic AS float) AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , ISNULL ( T.UniqueName , 'bp') AS UniqueName
     , ISNULL ( T.UniqueName , 'bp') AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerBloodPressure AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerBloodPressure'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerBloodSugarAndGlucose' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'mmol/L' AS UOM
     , 'Units' AS KEY1
     , CAST ( Units AS float) AS VAL1
     , 'FastingState' AS KEY2
     , CAST ( FastingState AS float) AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , ISNULL ( T.UniqueName , 'glucose') AS UniqueName
     , ISNULL ( T.UniqueName , 'glucose') AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerBloodSugarAndGlucose AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerBloodSugarAndGlucose'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerBMI' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'kg/m2' AS UOM
     , 'BMI' AS KEY1
     , CAST ( BMI AS float) AS VAL1
     , 'NA' AS KEY2
     , 0 AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , TT.ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , ISNULL ( T.UniqueName , 'HFit_TrackerBMI') AS UniqueName
     , ISNULL ( T.UniqueName , 'HFit_TrackerBMI') AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerBMI AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerBMI'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerBodyFat' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'PCT' AS UOM
     , 'Value' AS KEY1
     , CAST ( [Value] AS float) AS VAL1
     , 'NA' AS KEY2
     , 0 AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , ISNULL ( T.UniqueName , 'HFit_TrackerBodyFat') AS UniqueName
     , ISNULL ( T.UniqueName , 'HFit_TrackerBodyFat') AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerBodyFat AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerBodyFat'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
--******************************************************************************
SELECT DISTINCT
       'HFit_TrackerBodyMeasurements' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Inch' AS UOM
     , 'WaistInches' AS KEY1
     , CAST ( WaistInches AS float) AS VAL1
     , 'HipInches' AS KEY2
     , CAST ( HipInches AS float) AS VAL2
     , 'ThighInches' AS KEY3
     , CAST ( ThighInches AS float) AS VAL3
     , 'ArmInches' AS KEY4
     , CAST ( ArmInches AS float) AS VAL4
     , 'ChestInches' AS KEY5
     , CAST ( ChestInches AS float) AS VAL5
     , 'CalfInches' AS KEY6
     , CAST ( CalfInches AS float) AS VAL6
     , 'NeckInches' AS KEY7
     , CAST ( NeckInches AS float) AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerBodyMeasurements AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerBodyMeasurements'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
--******************************************************************************
UNION ALL
SELECT DISTINCT
       'HFit_TrackerCardio' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA' AS UOM
     , 'Minutes' AS KEY1
     , CAST ( Minutes AS float) AS VAL1
     , 'Distance' AS KEY2
     , CAST ( Distance AS float) AS VAL2
     , 'DistanceUnit' AS KEY3
     , CAST ( DistanceUnit AS float) AS VAL3
     , 'Intensity' AS KEY4
     , CAST ( Intensity AS float) AS VAL4
     , 'ActivityID' AS KEY5
     , CAST ( ActivityID AS float) AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerCardio AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerCardio'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerCholesterol' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'mg/dL' AS UOM
     , 'HDL' AS KEY1
     , CAST ( HDL AS float) AS VAL1
     , 'LDL' AS KEY2
     , CAST ( LDL AS float) AS VAL2
     , 'Total' AS KEY3
     , CAST ( Total AS float) AS VAL3
     , 'Tri' AS KEY4
     , CAST ( Tri AS float) AS VAL4
     , 'Ratio' AS KEY5
     , CAST ( Ratio AS float) AS VAL5
     , 'Fasting' AS KEY6
     , CAST ( Fasting AS float) AS VAL6
     , 'VLDL' AS VLDL
     , CAST ( VLDL AS float) AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , ISNULL ( T.UniqueName , 'HFit_TrackerCholesterol') AS UniqueName
     , ISNULL ( T.UniqueName , 'HFit_TrackerCholesterol') AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerCholesterol AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerCholesterol'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerDailySteps' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Step' AS UOM
     , 'Steps' AS KEY1
     , CAST ( Steps AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , ISNULL ( T.UniqueName , 'HFit_TrackerDailySteps') AS UniqueName
     , ISNULL ( T.UniqueName , 'HFit_TrackerDailySteps') AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerDailySteps AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerDailySteps'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerFlexibility' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Y/N' AS UOM
     , 'HasStretched' AS KEY1
     , CAST ( HasStretched AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'Activity' AS TXTKEY1
     , Activity AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerFlexibility AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerFlexibility'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerFruits' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'CUP(8oz)' AS UOM
     , 'Cups' AS KEY1
     , CAST ( Cups AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerFruits AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerFruits'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerHbA1c' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'mmol/mol' AS UOM
     , 'Value' AS KEY1
     , CAST ( [Value] AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerHbA1c AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerHbA1c'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerHeight' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'inch' AS UOM
     , 'Height' AS KEY1
     , Height AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , TT.ItemOrder
     , TT.ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , ISNULL ( T.UniqueName , 'HFit_TrackerHeight') AS UniqueName
     , ISNULL ( T.UniqueName , 'HFit_TrackerHeight') AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerHeight AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerHeight'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerHighFatFoods' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Occurs' AS UOM
     , 'Times' AS KEY1
     , CAST ( Times AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerHighFatFoods AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerHighFatFoods'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerHighSodiumFoods' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Occurs' AS UOM
     , 'Times' AS KEY1
     , CAST ( Times AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerHighSodiumFoods AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerHighSodiumFoods'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
--w/o  distinct 00:02:07 @ 477120 PRD1
--with distinct 00:03:20 @ 475860 PRD1
--(03.20.2015) - (WDM) verified SELECT DISTINCT to this qry in order to eliminate duplicate rows found by John C.
SELECT DISTINCT 'HFit_TrackerInstance_Tracker' AS TrackerNameAggregateTable ,
                     TT.ItemID ,
                     EventDate ,
                     TT.IsProfessionallyCollected ,
                     TT.TrackerCollectionSourceID ,
                     Notes ,
                     TT.UserID ,
                     CollectionSourceName_Internal ,
                     CollectionSourceName_External ,
                     'MISSING' AS EventName ,
                     'Y/N' AS UOM ,
                     'TrackerDefID' AS KEY1 ,
                     CAST (TrackerDefID AS float) AS VAL1 ,
                     'YesNoValue' AS KEY2 ,
                     CAST (YesNoValue AS float) AS VAL2 ,
                     'NA' AS KEY3 ,
                     NULL AS VAL3 ,
                     'NA' AS KEY4 ,
                     NULL AS VAL4 ,
                     'NA' AS KEY5 ,
                     NULL AS VAL5 ,
                     'NA' AS KEY6 ,
                     NULL AS VAL6 ,
                     'NA' AS KEY7 ,
                     NULL AS VAL7 ,
                     'NA' AS KEY8 ,
                     NULL AS VAL8 ,
                     'NA' AS KEY9 ,
                     NULL AS VAL9 ,
                     'NA' AS KEY10 ,
                     NULL AS VAL10 ,
                     TT.ItemCreatedBy ,
                     TT.ItemCreatedWhen ,
                     TT.ItemModifiedBy ,
                     TT.ItemModifiedWhen ,
                     NULL AS IsProcessedForHa ,
                     'NA' AS TXTKEY1 ,
                     NULL AS TXTVAL1 ,
                     'NA' AS TXTKEY2 ,
                     NULL AS TXTVAL2 ,
                     'NA' AS TXTKEY3 ,
                     NULL AS TXTVAL3 ,
                     NULL AS ItemOrder ,
                     NULL AS ItemGuid ,
                     C.UserGuid ,
                     PP.MPI ,
                     PP.ClientCode ,
                     S.SiteGUID ,
                     ACCT.AccountID ,
                     ACCT.AccountCD ,
                     T.IsAvailable ,
                     T.IsCustom ,
                     T.UniqueName ,
                     T.UniqueName AS ColDesc ,
                     NULL AS VendorID,
                     NULL AS VendorName
          FROM dbo.HFit_TrackerInstance_Tracker AS TT
                              INNER JOIN dbo.HFit_TrackerDef_Tracker TDT     
                                  ON TDT.trackerid = TT.trackerDefID
                           INNER JOIN dbo.CMS_User AS C
                                  ON C.UserID = TT.UserID
                           INNER JOIN dbo.hfit_ppteligibility AS PP
                                  ON TT.UserID = PP.userID
                           INNER JOIN dbo.HFit_Account AS ACCT
                                  ON PP.ClientCode = ACCT.AccountCD
                           INNER JOIN dbo.CMS_Site AS S
                                  ON ACCT.SiteID = S.SiteID
                           INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                                  ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                           LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                                  ON T.AggregateTableName = 'HFit_TrackerInstance_Tracker'
                                                         AND T.uniquename = TDT.name
UNION ALL
SELECT DISTINCT
       'HFit_TrackerMealPortions' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA-portion' AS UOM
     , 'Portions' AS KEY1
     , CAST ( Portions AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerMealPortions AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerMealPortions'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerMedicalCarePlan' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Y/N' AS UOM
     , 'FollowedPlan' AS KEY1
     , CAST ( FollowedPlan AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerMedicalCarePlan AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerMedicalCarePlan'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerRegularMeals' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Occurs' AS UOM
     , 'Units' AS KEY1
     , CAST ( Units AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerRegularMeals AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerRegularMeals'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerRestingHeartRate' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'BPM' AS UOM
     , 'HeartRate' AS KEY1
     , CAST ( HeartRate AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerRestingHeartRate AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerRestingHeartRate'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
--With DISTINCT 00:14 @ 40041
--With NO DISTINCT 00:14 @ 40060
--(03.20.2015) - (WDM) added a SELECT DISTINCT to this qry in order to eliminate duplicate rows found by John C.
SELECT DISTINCT
       'HFit_TrackerShots' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Y/N' AS UOM
     , 'FluShot' AS KEY1
     , CAST ( FluShot AS float) AS VAL1
     , 'PneumoniaShot' AS KEY2
     , CAST ( PneumoniaShot AS float) AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , TT.ItemOrder
     , TT.ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerShots AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerShots'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerSitLess' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Occurs' AS UOM
     , 'Times' AS KEY1
     , CAST ( Times AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerSitLess AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerSitLess'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerSleepPlan' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'HR' AS UOM
     , 'DidFollow' AS KEY1
     , CAST ( DidFollow AS float) AS VAL1
     , 'HoursSlept' AS KEY2
     , HoursSlept AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'Techniques' AS TXTKEY1
     , Techniques AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerSleepPlan AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerSleepPlan'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerStrength' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Y/N' AS UOM
     , 'HasTrained' AS KEY1
     , CAST ( HasTrained AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'Activity' AS TXTKEY1
     , Activity AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerStrength AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerStrength'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerStress' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'gradient' AS UOM
     , 'Intensity' AS KEY1
     , CAST ( Intensity AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'Awareness' AS TXTKEY1
     , Awareness AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerStress AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerStress'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerStressManagement' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'gradient' AS UOM
     , 'HasPracticed' AS KEY1
     , CAST ( HasPracticed AS float) AS VAL1
     , 'Effectiveness' AS KEY2
     , CAST ( Effectiveness AS float) AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'Activity' AS TXTKEY1
     , Activity AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerStressManagement AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerStressManagement'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerSugaryDrinks' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'OZ' AS UOM
     , 'Ounces' AS KEY1
     , CAST ( Ounces AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerSugaryDrinks AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerSugaryDrinks'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerSugaryFoods' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA-portion' AS UOM
     , 'Portions' AS KEY1
     , CAST ( Portions AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerSugaryFoods AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerSugaryFoods'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
--Using DISTINCT PROD1 - 00:08:41 @ 40313
--Using DISTINCT PRD1 - 00:00:09 @ 45502
--Using NO DISTINCT PRD1 00:19 @ 40332
--Using DISTINCT PRD1 - 00:00:11 @ 44483
--(03.20.2015) - (WDM) added a SELECT DISTINCT to this qry in order to eliminate duplicate rows found by John C.
SELECT DISTINCT
       'HFit_TrackerTests' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA' AS UOM
     , 'PSATest' AS KEY1
     , CAST ( PSATest AS float) AS VAL1
     , 'OtherExam' AS KEY1
     , CAST ( OtherExam AS float) AS VAL2
     , 'TScore' AS KEY3
     , CAST ( TScore AS float) AS VAL3
     , 'DRA' AS KEY4
     , CAST ( DRA AS float) AS VAL4
     , 'CotinineTest' AS KEY5
     , CAST ( CotinineTest AS float) AS VAL5
     , 'ColoCareKit' AS KEY6
     , CAST ( ColoCareKit AS float) AS VAL6
     , 'CustomTest' AS KEY7
     , CAST ( CustomTest AS float) AS VAL7
     , 'TSH' AS KEY8
     , CAST ( TSH AS float) AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'CustomDesc' AS TXTKEY1
     , CustomDesc AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , TT.ItemOrder
     , TT.ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerTests AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerTests'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerTobaccoFree' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'Y/N' AS UOM
     , 'WasTobaccoFree' AS KEY1
     , CAST ( WasTobaccoFree AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'QuitAids' AS TXTKEY1
     , QuitAids AS TXTVAL1
     , 'QuitMeds' AS TXTKEY2
     , QuitMeds AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerTobaccoFree AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerTobaccoFree'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerVegetables' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'CUP(8oz)' AS UOM
     , 'Cups' AS KEY1
     , CAST ( Cups AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerVegetables AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerVegetables'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerWater' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'OZ' AS UOM
     , 'Ounces' AS KEY1
     , CAST ( Ounces AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerWater AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerWater'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerWeight' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'LBS' AS UOM
     , 'Value' AS KEY1
     , [Value] AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerWeight AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerWeight'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerWholeGrains' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , CollectionSourceName_Internal
     , CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA-serving' AS UOM
     , 'Servings' AS KEY1
     , CAST ( Servings AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , NULL AS VendorID	--VENDOR.ItemID as VendorID
     ,
       NULL AS VendorName --VENDOR.VendorName
       FROM
            dbo.HFit_TrackerWholeGrains AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerWholeGrains'
--left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerShots' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , NULL AS CollectionSourceName_Internal
     , NULL AS CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA' AS UOM
     , 'FluShot' AS KEY1
     , CAST ( FluShot AS float) AS VAL1
     , 'PneumoniaShot' AS KEY2
     , CAST ( PneumoniaShot AS float) AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerShots AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerShots'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerTests' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , NULL AS CollectionSourceName_Internal
     , NULL AS CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA' AS UOM
     , 'PSATest' AS KEY1
     , CAST ( PSATest AS float) AS VAL1
     , 'OtherExam' AS KEY2
     , CAST ( OtherExam AS float) AS VAL2
     , 'TScore' AS KEY3
     , CAST ( TScore AS float) AS VAL3
     , 'DRA' AS KEY4
     , CAST ( DRA AS float) AS VAL4
     , 'CotinineTest' AS KEY5
     , CAST ( CotinineTest AS float) AS VAL5
     , 'ColoCareKit' AS KEY6
     , CAST ( ColoCareKit AS float) AS VAL6
     , 'CustomTest' AS KEY7
     , CAST ( CustomTest AS float) AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , NULL AS IsProcessedForHa
     , 'CustomDesc' AS TXTKEY1
     , CustomDesc AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , VENDOR.ItemID AS VendorID
     , VENDOR.VendorName
       FROM
            dbo.HFit_TrackerTests AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerTests'
                LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
                ON TT.VendorID = VENDOR.ItemID
UNION ALL
SELECT DISTINCT
       'HFit_TrackerCotinine' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , NULL AS CollectionSourceName_Internal
     , NULL AS CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA' AS UOM
     , 'NicotineAssessment' AS KEY1
     , CAST ( NicotineAssessment AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , --VENDOR.ItemID AS VendorID ,
       --VENDOR.VendorName,
       NULL AS VendorID
     , NULL AS VendorName
       FROM
            dbo.HFit_TrackerCotinine AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerTests'
--LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
--	ON TT.VendorID = VENDOR.ItemID;

UNION ALL
SELECT DISTINCT
       'HFit_TrackerPreventiveCare' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , NULL AS CollectionSourceName_Internal
     , NULL AS CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA' AS UOM
     , 'PreventiveCare' AS KEY1
     , CAST ( PreventiveCare AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , --VENDOR.ItemID AS VendorID ,
       --VENDOR.VendorName,
       NULL AS VendorID
     , NULL AS VendorName
       FROM
            dbo.HFit_TrackerPreventiveCare AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerTests'
--LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
--	ON TT.VendorID = VENDOR.ItemID;
UNION ALL
SELECT DISTINCT
       'HFit_TrackerTobaccoAttestation' AS TrackerNameAggregateTable
     , TT.ItemID
     , EventDate
     , TT.IsProfessionallyCollected
     , TT.TrackerCollectionSourceID
     , Notes
     , TT.UserID
     , NULL AS CollectionSourceName_Internal
     , NULL AS CollectionSourceName_External
     , 'MISSING' AS EventName
     , 'NA' AS UOM
     , 'TobaccoAttestation' AS KEY1
     , CAST ( TobaccoAttestation AS float) AS VAL1
     , 'NA' AS KEY2
     , NULL AS VAL2
     , 'NA' AS KEY3
     , NULL AS VAL3
     , 'NA' AS KEY4
     , NULL AS VAL4
     , 'NA' AS KEY5
     , NULL AS VAL5
     , 'NA' AS KEY6
     , NULL AS VAL6
     , 'NA' AS KEY7
     , NULL AS VAL7
     , 'NA' AS KEY8
     , NULL AS VAL8
     , 'NA' AS KEY9
     , NULL AS VAL9
     , 'NA' AS KEY10
     , NULL AS VAL10
     , TT.ItemCreatedBy
     , TT.ItemCreatedWhen
     , TT.ItemModifiedBy
     , TT.ItemModifiedWhen
     , IsProcessedForHa
     , 'NA' AS TXTKEY1
     , NULL AS TXTVAL1
     , 'NA' AS TXTKEY2
     , NULL AS TXTVAL2
     , 'NA' AS TXTKEY3
     , NULL AS TXTVAL3
     , NULL AS ItemOrder
     , NULL AS ItemGuid
     , C.UserGuid
     , PP.MPI
     , PP.ClientCode
     , S.SiteGUID
     , ACCT.AccountID
     , ACCT.AccountCD
     , T.IsAvailable
     , T.IsCustom
     , T.UniqueName
     , T.UniqueName AS ColDesc
     , --VENDOR.ItemID AS VendorID ,
       --VENDOR.VendorName,
       NULL AS VendorID
     , NULL AS VendorName
       FROM
            dbo.HFit_TrackerTobaccoAttestation AS TT
                INNER JOIN dbo.CMS_User AS C
                ON C.UserID = TT.UserID
                INNER JOIN dbo.hfit_ppteligibility AS PP
                ON TT.UserID = PP.userID
                INNER JOIN dbo.HFit_Account AS ACCT
                ON PP.ClientCode = ACCT.AccountCD
                INNER JOIN dbo.CMS_Site AS S
                ON ACCT.SiteID = S.SiteID
                INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
                ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
                LEFT OUTER JOIN dbo.HFIT_Tracker AS T
                ON T.AggregateTableName = 'HFit_TrackerTests';
--LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
--	ON TT.VendorID = VENDOR.ItemID;

GO

--  
--  
GO
PRINT '***** CREATED: view_EDW_TrackerCompositeDetails.sql';
GO 

--IF EXISTS (SELECT name FROM sys.triggers where name = 'trgSchemaMonitor')    
--enable TRIGGER trgSchemaMonitor ON DATABASE;

GO--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





PRINT 'Processing eligibility: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO

/******************************************************************************
***************************************************************************
DBCC FREEPROCCACHE
EXEC proc_EDW_EligibilityDaily
EXEC proc_EDW_EligibilityStarted
EXEC proc_EDW_EligibilityExpired

exec proc_build_EDW_Eligibility

WITH CTE AS
(
SELECT TOP 20 *
FROM [EDW_GroupMemberToday]
--ORDER BY HFitUserMpiNumber
)
select* from CTE


WITH CTE AS
(
SELECT TOP 10 *
FROM [EDW_GroupMemberToday]
--ORDER BY HFitUserMpiNumber
)
DELETE FROM CTE

--delete from [EDW_GroupMemberToday] where ContactGroupMemberRelatedID = 21805 
--and HFitUserMpiNumber = 8705496
--and GroupName = 'KraigTesting'

--Select * from EDW_GroupMemberHistory where EndedDate is not null
--Select * from view_EDW_Eligibility where GroupEndDate  is not null

***************************************************************************
******************************************************************************/

--IF EXISTS (SELECT
--				  name
--			 FROM sys.tables
--			 WHERE name = 'EDW_GroupMemberHistory') 
--	BEGIN
--		DROP TABLE
--			 dbo.EDW_GroupMemberHistory;
--	END;
--GO
--*********************************************************************************************************************
--EDW_GroupMemberHistory is used to track starting and ending dates of a PPTs participation and enrollment into a group.
--*********************************************************************************************************************

IF NOT EXISTS (SELECT
					  name
					  FROM sys.tables
					  WHERE name = 'EDW_GroupMemberHistory') 
	BEGIN
		CREATE TABLE dbo.EDW_GroupMemberHistory (
					 GroupName nvarchar (200) NOT NULL
				   , UserMpiNumber bigint NOT NULL
				   , StartedDate [date] NULL
				   , EndedDate [date] NULL
				   , RowNbr int IDENTITY (1, 1) 
								NOT NULL) ;
		CREATE UNIQUE CLUSTERED INDEX PKI_EDW_GroupMemberHistory ON dbo.EDW_GroupMemberHistory (GroupName ASC, UserMpiNumber ASC, StartedDate ASC, EndedDate ASC) ;
		CREATE INDEX PI_EDW_GroupMemberHistory_MPI ON dbo.EDW_GroupMemberHistory (UserMpiNumber ASC) ;
		CREATE NONCLUSTERED INDEX PI_EDW_GroupMemberHistory_RowNbr ON dbo.EDW_GroupMemberHistory (RowNbr ASC) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ;
	END;
else 
		PRINT 'EDW_GroupMemberHistory: ALREADY EXISTS - Do not have to create again' + CAST (GETDATE () AS nvarchar (50)) ;
GO
PRINT 'creating EDW_GroupMemberHistory: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO

--IF EXISTS (SELECT
--				  name
--			 FROM sys.tables
--			 WHERE name = 'EDW_GroupMemberToday') 
--	BEGIN
--		DROP TABLE
--			 dbo.EDW_GroupMemberToday;
--	END;
--GO
--*****************************************************************************
--EDW_GroupMemberToday is used to store the PPT group members for "today". It is
--then used to compare new to no longer existing.
--*****************************************************************************

IF NOT EXISTS (SELECT
					  name
					  FROM sys.tables
					  WHERE name = 'EDW_GroupMemberToday') 
	BEGIN
		CREATE TABLE dbo.EDW_GroupMemberToday (
					 ContactGroupMemberRelatedID int NOT NULL
				   , GroupName nvarchar (200) NOT NULL
				   , HFitUserMpiNumber bigint NULL
				   , Today [date] NOT NULL) ;
		CREATE CLUSTERED INDEX PKI_EDW_GroupMemberToday ON dbo.EDW_GroupMemberToday (ContactGroupMemberRelatedID ASC, GroupName ASC, HFitUserMpiNumber ASC, Today ASC) ;
	END;
ELSE 
	PRINT 'EDW_GroupMemberHistory: ALREADY EXISTS - Do not have to create again' + CAST (GETDATE () AS nvarchar (50)) ;
GO
PRINT 'created EDW_GroupMemberHistory: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO
IF EXISTS (SELECT
				  name
				  FROM sys.views
				  WHERE name = 'view_EDW_EligibilityHistory') 
	BEGIN
		DROP VIEW
			 view_EDW_EligibilityHistory;
	END;
GO

--************************************************************************************
--view_EDW_EligibilityHistory provides users access to the EDW_GroupMemberHistory table.
--************************************************************************************

CREATE VIEW view_EDW_EligibilityHistory
AS SELECT
		  GroupName
		, UserMpiNumber
		, StartedDate
		, EndedDate
		, RowNbr
		  FROM dbo.EDW_GroupMemberHistory;
GO
IF NOT EXISTS (SELECT
					  name
					  FROM sys.indexes
					  WHERE name = 'PI_EDW_EligibilityHistory_MPI') 
	BEGIN
		CREATE INDEX PI_EDW_EligibilityHistory_MPI ON dbo.EDW_GroupMemberHistory (UserMpiNumber ASC) ;
	END;
PRINT 'created view_EDW_EligibilityHistory: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO
IF EXISTS (SELECT
				  name
				  FROM sys.views
				  WHERE name = 'view_EDW_Eligibility') 
	BEGIN
		DROP VIEW
			 view_EDW_Eligibility;
	END;
GO
PRINT 'Creating view_EDW_Eligibility: ' + CAST (GETDATE () AS nvarchar (50)) ;
PRINT 'Now covering Task #48941 as well. ';
GO

--select top 1000 * from view_EDW_Eligibility where EligibilityStartDate > getdate() -1 

CREATE VIEW view_EDW_Eligibility
AS

--*************************************************************************************************************************
--Total returned 2473454
--Select count(*) from view_EDW_Eligibility (82201407) (10823368)
--select count(*)  from CMS_Role --305
--select count(*) from cms_MembershipRole --256
--select count(*) from cms_MembershipUser --37215
--select count(*) from CMS_Role --305
--select count(*) from view_EDW_EligibilityHistory	--58540
--select count(*) from EDW_GroupMemberHistory			--58540
--view_EDW_Eligibility is the starting point for the EDW to pull data. As of 11.11.2014, all columns
--within the view are just a starting point. We will work with the EDW team to define and pull all the data
--they are needing.
--A PPT becomes eligible to participate through the Rules
--Rules of Engagement:
--00: ROLES are tied to a feature ; if the ROLE is not on a Kentico page - you don't see it.
--01: When the Kentico group rebuild executes, all is lost. There is no retained MEMBER/User history.
--02: The group does not track when a member enters or leaves a group, simply that they exist in that group.
--NOTE: Any data deemed necessary can be added to this view for the EDW
--01.27.2015 (WDM) #48941 - Add Client Identifier to View_EDW_Eligibility
--	   In analyzing this requirement, found that the PPT.ClientID is nvarchar (alphanumeric)
--	   and Hfit_Client.ClientID is integer. A bit of a domain/naming issue.
--02.02.2015 (WDM) #44691 - Added the Site ID, Site Name, and Site Display Name to the returned cols of data
--	  per the conversation with John C. earlier this morning.
--02.05.2015 (WDM) #44691 - Added the Site GUID
--02.27.2015 (WDM) Yesterday, John C. found a potential problem in with what appeared to be a cross-product join.
--				Found that the table EDW_GroupMemberHistory was referenced twice, once as a base table abd once as a view.
--				Removed one of the joins and the number of returned rows fell drastically - from 800M to 50M - 100M.	 
--03.02.2015 (WDM) John C. provided the list of Rolenames and they are applied to the VIEW DDL - Hardcoded in the view.
--*************************************************************************************************************************

SELECT
	   ROLES.RoleID
	 , ROLES.RoleName
	 , ROLES.RoleDescription
	 , ROLES.RoleGUID
	 , MemberROLE.MembershipID
	 , MemberROLE.RoleID AS  MbrRoleID
	 , MemberSHIP.UserID AS  MemberShipUserID
	 , MemberSHIP.ValidTo AS MemberShipValidTo
	 , USERSET.HFitUserMpiNumber
	 , USERSET.UserNickName
	 , USERSET.UserDateOfBirth
	 , USERSET.UserGender
	 , PPT.PPTID
	 , PPT.FirstName
	 , PPT.LastName
	 , PPT.City
	 , PPT.State
	 , PPT.PostalCode
	 , PPT.UserID AS         PPTUserID
	 , PPT.PlanStartDate
	 , PPT.PlanEndDate
	 , PPT.Last_Update_Dt
	 , GRPMBR.ContactGroupMemberContactGroupID
	 , GRPMBR.ContactGroupMemberRelatedID
	 , GRPMBR.ContactGroupMemberType
	 , GRP.ContactGroupName
	 , GRP.ContactGroupDisplayName
	 , PPT.ClientCode
	 , ACCT.AccountName
	 , ACCT.AccountID
	 , ACCT.AccountCD
	 , ACCT.SiteID
	 , SITE.SiteGUID
	 , SITE.SiteName
	 , SITE.SiteDisplayName

	   --, EHIST.GroupName AS EligibilityGroupName

	 , EHIST.StartedDate AS  EligibilityStartDate
	 , EHIST.EndedDate AS    EligibilityEndDate

--, GHIST.GroupName AS GroupName
--, GHIST.StartedDate AS GroupStartDate
--, GHIST.EndedDate AS GroupEndDate
--select count(*) 

	   FROM CMS_Role AS ROLES
				JOIN cms_MembershipRole AS MemberROLE
					ON ROLES.RoleID = MemberROLE.RoleID
				   AND RoleName IN ('AccessTo_Coaching', 'AccessTo_Screenings', 'Challenges', 'Coaching', 'CoachingEligible', 'HealthAdvising', 'HealthAssessment', 'Rewards', 'Screeners', 'ScreeningScheduler') 
				JOIN cms_MembershipUser AS MemberSHIP
					ON MemberROLE.MembershipID = MemberSHIP.MembershipID
				JOIN HFit_PPTEligibility AS PPT
					ON PPT.UserID = MemberSHIP.UserID
				JOIN CMS_USERSettings AS USERSET
					ON USERSET.UserSettingsUserID = PPT.UserID
				   AND HFitUserMpiNumber > 0
				JOIN OM_ContactGroupMember AS GRPMBR
					ON GRPMBR.ContactGroupMemberRelatedID = USERSET.HFitPrimaryContactID
				JOIN OM_ContactGroup AS GRP
					ON GRP.ContactGroupID = GRPMBR.ContactGroupMemberContactGroupID
				JOIN HFit_ContactGroupMembership AS GroupMBR
					ON GroupMBR.cmsMembershipID = MemberSHIP.MembershipID
				JOIN HFit_Account AS ACCT
					ON ROLES.SiteID = ACCT.SiteID
				JOIN CMS_Site AS SITE
					ON SITE.SiteID = ACCT.SiteID
				LEFT OUTER JOIN view_EDW_EligibilityHistory AS EHIST
					ON EHIST.UserMpiNumber = USERSET.HFitUserMpiNumber;

--LEFT JOIN EDW_GroupMemberHistory AS GHIST
--	ON GHIST.UserMpiNumber = USERSET.HFitUserMpiNumber

GO
PRINT 'created view_EDW_Eligibility: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO

--select table_name from information_schema.columns where column_name = 'SiteID' and table_name in 
--('CMS_Role','cms_MembershipUser','HFit_PPTEligibility','CMS_USERSettings','OM_ContactGroupMember','OM_ContactGroup')
--**********************************
--exec proc_EDW_EligibilityDaily
--**********************************

IF EXISTS (SELECT
				  name
				  FROM sys.procedures
				  WHERE name = 'proc_EDW_EligibilityDaily') 
	BEGIN
		DROP PROCEDURE
			 proc_EDW_EligibilityDaily;
	END;
GO
PRINT 'created [proc_EDW_EligibilityDaily]: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO

--exec [proc_EDW_EligibilityDaily]

CREATE PROCEDURE proc_EDW_EligibilityDaily
AS
BEGIN

	--*****************************************************************************************
	--In our initial talks, the statement was made that a PPT eligibility was not known as in a start and end date, only that they are eligible.

	--In order to overcome this, the routine initializes the daily table (A new EDW table) with everyone that is eligible and assigns the date that the eligibility was determined to be in place as todays date.

	--Each row in the daily table is then compared to the eligibility historical table  (A new EDW table). If it exists in the table already, it is skipped. If it does not exist, then it is inserted as an entry showing that PPT became eligible today.

	--The next step goes though the existing historical PPTs that have eligibility and checks to see if they exist in the daily table. If not, they are then marked as ineligible based on today's date.

	--	Find all members and their respective groups that exist at this point in time.
	--    This is a snapshot of PPTs, Groups, and Memberships as it appears in the moment.
	--    This will allow us to track members when they go into or leave a group, daily.
	--    Get all records of PPTs within groups and save them as the daily starting point
	--    for tracking PPT group membership. To ensure the data is fresh, drop the
	--    EDW_GroupMemberToday table and fill it with current PPTs.
	--    Step 1 - Call procedure proc_EDW_EligibilityDaily
	--    Step 2 - Call procedure proc_EDW_EligibilityStarted
	--    Step 3 - Call procedure proc_EDW_EligibilityExpired
	--    Step 4 - Retrieve the PPT membership history using the view view_EDW_EligibilityHistory
	--*****************************************************************************************
	IF EXISTS (SELECT
					  name
					  FROM sys.tables
					  WHERE name = 'EDW_GroupMemberToday') 
		BEGIN
			truncate TABLE EDW_GroupMemberToday;
		END;
	INSERT INTO dbo.EDW_GroupMemberToday (
				ContactGroupMemberRelatedID
			  , GroupName
			  , HFitUserMpiNumber
			  , Today) 
	SELECT
		   GRPMBR.ContactGroupMemberRelatedID
		 , GRP.ContactGroupName AS GroupName
		 , USERSET.HFitUserMpiNumber
		 , (
			SELECT
				   CONVERT (date, GETDATE () , 110)) AS Today
		   FROM OM_CONTACTGroupMember AS GRPMBR
					JOIN CMS_USERSettings AS USERSET
						ON USERSET.HFitPRimaryContactID = GRPMBR.ContactGroupMemberRelatedID
					JOIN OM_ContactGroup AS GRP
						ON GRP.ContactGroupID = GRPMBR.ContactGroupMemberContactGroupID
		   WHERE HFitUserMpiNumber IS NOT NULL;
	DECLARE @iCnt AS integer = 0;
	SET @iCnt = (SELECT
						COUNT (*) 
						FROM EDW_GroupMemberToday) ;
	PRINT 'Beginning to process: ' + CAST (@iCnt AS nvarchar (50)) + ' eligibility records on ' + CAST (GETDATE () AS nvarchar (50)) ;
END;
GO
PRINT 'created proc_EDW_EligibilityDaily: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO

--************************************************************************************
--exec proc_EDW_EligibilityStarted
--************************************************************************************

IF EXISTS (SELECT
				  name
				  FROM sys.procedures
				  WHERE name = 'proc_EDW_EligibilityStarted') 
	BEGIN
		DROP PROCEDURE
			 proc_EDW_EligibilityStarted;
	END;
GO
PRINT 'created proc_EDW_EligibilityStarted: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO
CREATE PROCEDURE proc_EDW_EligibilityStarted
AS
BEGIN
	SET NOCOUNT ON;

	--**********************************************************************************************************
	--*******************************************************************************************************
	--    This procedure, proc_EDW_EligibilityStarted, is a starting point point for new PPTs that are eligibile
	--    to participate. In order to capture those PPTs that may have closed and eligibility, lost it, or had it
	--    expire, an END DATE is also tracked. This is done through the table, EDW_GroupMemberHistory.
	--    Step 1 - Call procedure proc_EDW_EligibilityDaily
	--    Step 2 - Call procedure proc_EDW_EligibilityStarted
	--    Step 3 - Call procedure proc_EDW_EligibilityExpired
	--    Step 4 - Retrieve the PPT membership history using the view view_EDW_EligibilityHistory
	--    *******************************************************************************************************
	--**********************************************************************************************************

	PRINT 'Starting proc_EDW_EligibilityStarted: ' + CAST (GETDATE () AS nvarchar (50)) ;
	WITH NewPPT (
		 GroupName
	   , MpiNumber) 
		AS (SELECT
				   GroupName
				 , HFitUserMpiNumber
				   FROM EDW_GroupMemberToday
			EXCEPT
			SELECT
				   GroupName
				 , UserMpiNumber
				   FROM EDW_GroupMemberHistory
				   WHERE EndedDate IS NULL) 
		INSERT INTO EDW_GroupMemberHistory (
					GroupName
				  , UserMpiNumber
				  , StartedDate) 
		SELECT
			   GroupName
			 , MpiNumber
			 , (
				SELECT
					   CONVERT (date, GETDATE () , 110)) AS Today
			   FROM NewPPT;
	DECLARE @iAdded AS int = 0;
	SET @iAdded = (SELECT
						  COUNT (*) 
						  FROM EDW_GroupMemberHistory
						  WHERE CAST (StartedDate AS date) = CAST (GETDATE () AS date)) ;
	SET NOCOUNT OFF;
	PRINT CAST (@iAdded AS nvarchar (50)) + ' Eligibility Records Processed on: ' + CAST (GETDATE () AS nvarchar (50)) ;
	PRINT 'Ending [proc_EDW_EligibilityStarted]: ' + CAST (GETDATE () AS nvarchar (50)) ;
END;
GO

--************************************************************************************
--**************************************************************************************
--exec proc_EDW_EligibilityExpired
--************************************************************************************

PRINT 'created proc_EDW_EligibilityExpired: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO
IF EXISTS (SELECT
				  name
				  FROM sys.procedures
				  WHERE name = 'proc_EDW_EligibilityExpired') 
	BEGIN
		DROP PROCEDURE
			 proc_EDW_EligibilityExpired;
	END;
GO

--exec proc_EDW_EligibilityExpired

CREATE PROCEDURE proc_EDW_EligibilityExpired
AS
BEGIN

	--******************************************************************************************
	--proc_EDW_EligibilityExpired looks for PPT group memebers that existed previously and
	--    does not currently exist in the daily pull. If one is found missing from the daily,
	--    that PPT is maked with an END DATE indicating the participation within that group
	--    for that PPT has ended. Every 1,000 records processed will generate a message and at
	--    the end, a total records closed count will be displayed.
	--    Step 1 - Call procedure proc_EDW_EligibilityDaily
	--    Step 2 - Call procedure proc_EDW_EligibilityStarted
	--    Step 3 - Call procedure proc_EDW_EligibilityExpired
	--    Step 4 - Retrieve the PPT membership history using the view view_EDW_EligibilityHistory
	--******************************************************************************************

	SET NOCOUNT OFF;
	PRINT 'Starting [proc_EDW_EligibilityExpired] NOW: ' + CAST (GETDATE () AS nvarchar (50)) ;
	DECLARE @iCnt AS integer = 0;

	--SET @iCnt = (SELECT COUNT (*) 
	--			FROM EDW_GroupMemberHistory
	--			WHERE EndedDate IS NULL AND UserMpiNumber IS NOT NULL AND UserMpiNumber NOT IN (
	--																							SELECT HFitUserMpiNumber
	--																							  FROM EDW_GroupMemberToday)) ;

	SET @iCnt = (SELECT
						COUNT (*) 
						FROM EDW_GroupMemberHistory AS HIST
								 LEFT JOIN EDW_GroupMemberToday AS TDAY
									 ON HIST.UserMpiNumber = TDAY.HFitUserMpiNumber
						WHERE HIST.EndedDate IS NULL
						  AND TDAY.HFitUserMpiNumber IS NULL) ;
	IF @iCnt > 0
		BEGIN
			PRINT CAST (@iCnt AS nvarchar (50)) + ' EligibilityExpired PPTs FOUND: ' + CAST (GETDATE () AS nvarchar (50)) ;
			UPDATE HIST
			SET
				EndedDate = GETDATE () 
				FROM EDW_GroupMemberHistory HIST
						 LEFT JOIN EDW_GroupMemberToday TDAY
							 ON HIST.UserMpiNumber = TDAY.HFitUserMpiNumber
				WHERE
					  HIST.EndedDate IS NULL
				  AND TDAY.HFitUserMpiNumber IS NULL;
		END;
	ELSE
		BEGIN
			PRINT 'NO EligibilityExpired PPTs: ' + CAST (GETDATE () AS nvarchar (50)) ;
		END;
	PRINT 'Completed proc_EDW_EligibilityExpired: ' + CAST (GETDATE () AS nvarchar (50)) ;
	PRINT '*******************************************************';
	PRINT 'Ending NOW: ' + CAST (GETDATE () AS nvarchar (50)) ;
END;
GO

--*****************************
--exec proc_build_EDW_Eligibility
--*****************************

PRINT 'created proc_build_EDW_Eligibility: ' + CAST (GETDATE () AS nvarchar (50)) ;
GO
IF EXISTS (SELECT
				  name
				  FROM sys.procedures
				  WHERE name = 'proc_build_EDW_Eligibility') 
	BEGIN
		DROP PROCEDURE
			 proc_build_EDW_Eligibility;
	END;
GO
CREATE PROCEDURE proc_build_EDW_Eligibility
AS
BEGIN

	--*******************************************************************************************
	--Step 1 - Call procedure proc_EDW_EligibilityDaily
	--    Step 2 - Call procedure proc_EDW_EligibilityStarted
	--    Step 3 - Call procedure proc_EDW_EligibilityExpired
	--    Step 4 - Retrieve the PPT membership history using the view view_EDW_EligibilityHistory
	--    proc_build_EDW_Eligibility runs all three required procedures that are needed
	--    to apply current eligibility new, current, and expired (missing).
	--*******************************************************************************************

	SET NOCOUNT ON;
	EXEC proc_EDW_EligibilityDaily;
	EXEC proc_EDW_EligibilityStarted;
	EXEC proc_EDW_EligibilityExpired;
	SET NOCOUNT OFF;
END;
GO
PRINT '******************************************************' ;
PRINT 'Starting Eligibility BUILD : ' + CAST (GETDATE () AS nvarchar (50)) ;
GO
EXEC proc_build_EDW_Eligibility;
GO
PRINT 'Eligibility Completed: ' + CAST (GETDATE () AS nvarchar (50)) ;
PRINT '******************************************************' ;
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




--W. Dale Miller
--Dec. 11, 2011
--Test and Evaluate Index Performance for HA

GO

if not exists(select name from sys.indexes where name = 'PI_EDW_GroupMemberHistory_RowNbr')
BEGIN
	print ('CREATING Index PI_EDW_GroupMemberHistory_RowNbr') ;
	CREATE NONCLUSTERED INDEX [PI_EDW_GroupMemberHistory_RowNbr] ON [dbo].[EDW_GroupMemberHistory] ([RowNbr]);
END
ELSE 
	print ('Index PI_EDW_GroupMemberHistory_RowNbr FOUND') ;

GO

PRINT ' 1 of 1510 : Analyzing IX_COM_InternalStatus_InternalStatusDisplayName_InternalStatusEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_InternalStatus_InternalStatusDisplayName_InternalStatusEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX

	   [IX_COM_InternalStatus_InternalStatusDisplayName_InternalStatusEnabled]

	   ON [dbo].[COM_InternalStatus] (  [InternalStatusDisplayName]  ASC , [InternalStatusEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 2 of 1510 : Created [IX_COM_InternalStatus_InternalStatusDisplayName_InternalStatusEnabled]';
    END;

GO

PRINT ' 3 of 1510 : Analyzing IX_OM_ContactRole_ContactRoleSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ContactRole_ContactRoleSiteID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_ContactRole_ContactRoleSiteID]
		ON [dbo].[OM_ContactRole] ( [ContactRoleSiteID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 4 of 1510 : Created [IX_OM_ContactRole_ContactRoleSiteID]';
    END;

GO

PRINT ' 5 of 1510 : Analyzing IX_CMS_AutomationHistory_HistoryStepID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AutomationHistory_HistoryStepID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_AutomationHistory_HistoryStepID]
		ON [dbo].[CMS_AutomationHistory] (  [HistoryStepID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 6 of 1510 : Created [IX_CMS_AutomationHistory_HistoryStepID]';
    END;

GO

PRINT ' 7 of 1510 : Analyzing IX_CMS_AutomationHistory_HistoryApprovedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AutomationHistory_HistoryApprovedByUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_AutomationHistory_HistoryApprovedByUserID]
		 ON [dbo].[CMS_AutomationHistory] (  [HistoryApprovedByUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 8 of 1510 : Created [IX_CMS_AutomationHistory_HistoryApprovedByUserID]';
    END;

GO

PRINT ' 9 of 1510 : Analyzing IX_CMS_AutomationHistory_HistoryApprovedWhen';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AutomationHistory_HistoryApprovedWhen') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_AutomationHistory_HistoryApprovedWhen]
		 ON [dbo].[CMS_AutomationHistory] (  [HistoryApprovedWhen]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 10 of 1510 : Created [IX_CMS_AutomationHistory_HistoryApprovedWhen]';
    END;

GO

PRINT ' 11 of 1510 : Analyzing nonHistStateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonHistStateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonHistStateID]
	   ON [dbo].[CMS_AutomationHistory] (  [HistoryStateID]  ASC) INCLUDE ( [HistoryID] , [HistoryStepID] , [HistoryStepName] , [HistoryStepDisplayName] , [HistoryStepType] , [HistoryTargetStepID] , [HistoryTargetStepName] , [HistoryTargetStepDisplayName] , [HistoryTargetStepType] , [HistoryApprovedByUserID] , [HistoryApprovedWhen] , [HistoryComment] , [HistoryTransitionType] , [HistoryWorkflowID] , [HistoryRejected] , [HistoryWasRejected]) WITH ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 12 of 1510 : Created [nonHistStateID]';
    END;

GO

PRINT ' 13 of 1510 : Analyzing IX_CMS_Query_QueryLoadGeneration';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Query_QueryLoadGeneration') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Query_QueryLoadGeneration]
	   ON [dbo].[CMS_Query] (  [QueryLoadGeneration]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 14 of 1510 : Created [IX_CMS_Query_QueryLoadGeneration]';
    END;

GO

PRINT ' 15 of 1510 : Analyzing IX_CMS_Query_QueryClassID_QueryName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Query_QueryClassID_QueryName') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Query_QueryClassID_QueryName]
		ON [dbo].[CMS_Query] (  [ClassID]  ASC , [QueryName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 16 of 1510 : Created [IX_CMS_Query_QueryClassID_QueryName]';
    END;

GO

PRINT ' 17 of 1510 : Analyzing HFit_UserTracker_idx_01';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_UserTracker_idx_01') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_UserTracker_idx_01]
	   ON [dbo].[HFit_UserTracker] (  [UserID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 18 of 1510 : Created [HFit_UserTracker_idx_01]';
    END;

GO

PRINT ' 19 of 1510 : Analyzing IX_HAUQGroupResults_ItemID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HAUQGroupResults_ItemID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_HAUQGroupResults_ItemID]
	   ON [dbo].[HFit_HealthAssesmentUserQuestionGroupResults] (  [HARiskAreaItemID]  ASC) INCLUDE ([PointResults] , [FormulaResult] , [CodeName]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 20 of 1510 : Created [IX_HAUQGroupResults_ItemID]';
    END;

GO

PRINT ' 21 of 1510 : Analyzing IX_HFit_HealthAssesmentUserQuestionGroupResult_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_HealthAssesmentUserQuestionGroupResult_1') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_HFit_HealthAssesmentUserQuestionGroupResult_1]
		 ON [dbo].[HFit_HealthAssesmentUserQuestionGroupResults] (  [HARiskAreaItemID]  ASC) INCLUDE ([CodeName]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 22 of 1510 : Created [IX_HFit_HealthAssesmentUserQuestionGroupResult_1]';
    END;

GO

PRINT ' 23 of 1510 : Analyzing IX_COM_ExchangeTable_ExchangeTableValidFrom_ExchangeTableValidTo';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ExchangeTable_ExchangeTableValidFrom_ExchangeTableValidTo') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_ExchangeTable_ExchangeTableValidFrom_ExchangeTableValidTo]
	   ON [dbo].[COM_ExchangeTable] (  [ExchangeTableValidFrom] DESC , [ExchangeTableValidTo] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 24 of 1510 : Created [IX_COM_ExchangeTable_ExchangeTableValidFrom_ExchangeTableValidTo]';
    END;

GO

PRINT ' 25 of 1510 : Analyzing nonMemID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonMemID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonMemID]
	   ON [dbo].[HFit_ContactGroupMembership] (  [cmsMembershipID]  ASC , [omContactGroupID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 26 of 1510 : Created [nonMemID]';
    END;

GO

PRINT ' 27 of 1510 : Analyzing IX_COM_DiscountCoupon_DiscoutCouponDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_DiscountCoupon_DiscoutCouponDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_COM_DiscountCoupon_DiscoutCouponDisplayName]
		 ON [dbo].[COM_DiscountCoupon] (  [DiscountCouponDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 28 of 1510 : Created [IX_COM_DiscountCoupon_DiscoutCouponDisplayName]';
    END;

GO

PRINT ' 29 of 1510 : Analyzing IX_COM_DiscountCoupon_DiscountCouponCode';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_DiscountCoupon_DiscountCouponCode') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_DiscountCoupon_DiscountCouponCode]
		ON [dbo].[COM_DiscountCoupon] ( [DiscountCouponCode]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 30 of 1510 : Created [IX_COM_DiscountCoupon_DiscountCouponCode]';
    END;

GO

PRINT ' 31 of 1510 : Analyzing IX_CMS_Class_ClassID_ClassName_ClassDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Class_ClassID_ClassName_ClassDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_Class_ClassID_ClassName_ClassDisplayName]
		 ON [dbo].[CMS_Class] (  [ClassID]  ASC , [ClassName]  ASC , [ClassDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 32 of 1510 : Created [IX_CMS_Class_ClassID_ClassName_ClassDisplayName]';
    END;

GO

PRINT ' 33 of 1510 : Analyzing IX_CMS_Class_ClassName_ClassDisplayName_ClassID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Class_ClassName_ClassDisplayName_ClassID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_Class_ClassName_ClassDisplayName_ClassID]
		 ON [dbo].[CMS_Class] (  [ClassName]  ASC , [ClassDisplayName]  ASC , [ClassID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 34 of 1510 : Created [IX_CMS_Class_ClassName_ClassDisplayName_ClassID]';
    END;

GO

PRINT ' 35 of 1510 : Analyzing IX_CMS_Class_ClassName_ClassGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Class_ClassName_ClassGUID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Class_ClassName_ClassGUID]
	   ON [dbo].[CMS_Class] (  [ClassName]  ASC , [ClassGUID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 36 of 1510 : Created [IX_CMS_Class_ClassName_ClassGUID]';
    END;

GO

PRINT ' 37 of 1510 : Analyzing tType';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Class_ClassShowAsSystemTable_ClassIsCustomTable_ClassIsCoupledClass_ClassIsDocumentType') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_Class_ClassShowAsSystemTable_ClassIsCustomTable_ClassIsCoupledClass_ClassIsDocumentTyp	e]
		 ON [dbo].[CMS_Class] (  [ClassShowAsSystemTable]  ASC , [ClassIsCustomTable]  ASC , [ClassIsCoupledClass] ASC , [ClassIsDocumentType]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 38 of 1510 : Created e]';
    END;

GO

PRINT ' 39 of 1510 : Analyzing IX_CMS_Class_ClassDefaultPageTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Class_ClassDefaultPageTemplateID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Class_ClassDefaultPageTemplateID]
		ON [dbo].[CMS_Class] ( [ClassDefaultPageTemplateID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 40 of 1510 : Created [IX_CMS_Class_ClassDefaultPageTemplateID]';
    END;

GO

PRINT ' 41 of 1510 : Analyzing IX_CMS_Class_ClassLoadGeneration';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Class_ClassLoadGeneration') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Class_ClassLoadGeneration]
	   ON [dbo].[CMS_Class] (  [ClassLoadGeneration] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 42 of 1510 : Created [IX_CMS_Class_ClassLoadGeneration]';
    END;

GO

PRINT ' 43 of 1510 : Analyzing PI_HFit_RewardsUserActivityDetail_ActivityNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_RewardsUserActivityDetail_ActivityNodeID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [PI_HFit_RewardsUserActivityDetail_ActivityNodeID]
		 ON [dbo].[HFit_RewardsUserActivityDetail] (  [ActivityNodeID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 44 of 1510 : Created [PI_HFit_RewardsUserActivityDetail_ActivityNodeID]';
    END;

GO

PRINT ' 45 of 1510 : Analyzing HFit_RewardsUserActivityDetail_PiDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_RewardsUserActivityDetail_PiDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[HFit_RewardsUserActivityDetail_PiDate]
		ON [dbo].[HFit_RewardsUserActivityDetail] (  [ItemModifiedWhen]  ASC) INCLUDE ( [ItemCreatedWhen]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 46 of 1510 : Created [HFit_RewardsUserActivityDetail_PiDate]';
    END;

GO

PRINT ' 47 of 1510 : Analyzing IDX_RewardsUserActivity_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_RewardsUserActivity_UserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IDX_RewardsUserActivity_UserID]
	   ON [dbo].[HFit_RewardsUserActivityDetail] ( [UserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 48 of 1510 : Created [IDX_RewardsUserActivity_UserID]';
    END;

GO

PRINT ' 49 of 1510 : Analyzing PI_HFit_RewardsUserActivityDetail_Date';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_RewardsUserActivityDetail_Date') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_RewardsUserActivityDetail_Date]
		ON [dbo].[HFit_RewardsUserActivityDetail] (  [ItemModifiedWhen]  ASC) INCLUDE ( [ItemCreatedWhen]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 50 of 1510 : Created [PI_HFit_RewardsUserActivityDetail_Date]';
    END;

GO

--PRINT ' 51 of 1510 : Analyzing cdx_StagingSyncTaskID';
--GO

--IF NOT EXISTS (SELECT [Name]
--			  FROM [sys].[Indexes]
--			  WHERE [Name] = 'cdx_StagingSyncTaskID') 
--    --IS NULL
--    BEGIN
--	   CREATE CLUSTERED INDEX
--	   [cdx_StagingSyncTaskID]
--	   ON [dbo].[Staging_SynchronizationArchive] (  [SynchronizationTaskID]  ASC) 
--	   WITH
--	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 52 of 1510 : Created [cdx_StagingSyncTaskID]';
--    END;

--GO

PRINT ' 53 of 1510 : Analyzing IX_COM_Supplier_SupplierDisplayName_SupplierEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Supplier_SupplierDisplayName_SupplierEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_Supplier_SupplierDisplayName_SupplierEnabled]
	   ON [dbo].[COM_Supplier] (  [SupplierDisplayName]  ASC , [SupplierEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 54 of 1510 : Created [IX_COM_Supplier_SupplierDisplayName_SupplierEnabled]';
    END;

GO

PRINT ' 55 of 1510 : Analyzing IX_CMS_Session_SessionLocation';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Session_SessionLocation') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Session_SessionLocation]
	   ON [dbo].[CMS_Session] (  [SessionLocation]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 56 of 1510 : Created [IX_CMS_Session_SessionLocation]';
    END;

GO

PRINT ' 57 of 1510 : Analyzing IX_CMS_Session_SessionUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Session_SessionUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Session_SessionUserID]
	   ON [dbo].[CMS_Session] (  [SessionUserID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 58 of 1510 : Created [IX_CMS_Session_SessionUserID]';
    END;

GO

PRINT ' 59 of 1510 : Analyzing IX_CMS_Session_SessionSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Session_SessionSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Session_SessionSiteID]
	   ON [dbo].[CMS_Session] (  [SessionSiteID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 60 of 1510 : Created [IX_CMS_Session_SessionSiteID]';
    END;

GO

PRINT ' 61 of 1510 : Analyzing IX_CMS_Session_SessionUserIsHidden';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Session_SessionUserIsHidden') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Session_SessionUserIsHidden]
		ON [dbo].[CMS_Session] ( [SessionUserIsHidden]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 62 of 1510 : Created [IX_CMS_Session_SessionUserIsHidden]';
    END;

GO

PRINT ' 63 of 1510 : Analyzing IX_CMS_TagGroup_TagGroupDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_TagGroup_TagGroupDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_TagGroup_TagGroupDisplayName]
		ON [dbo].[CMS_TagGroup] ( [TagGroupDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 64 of 1510 : Created [IX_CMS_TagGroup_TagGroupDisplayName]';
    END;

GO

PRINT ' 65 of 1510 : Analyzing IX_CMS_TagGroup_TagGroupSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_TagGroup_TagGroupSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_TagGroup_TagGroupSiteID]
	   ON [dbo].[CMS_TagGroup] (  [TagGroupSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 66 of 1510 : Created [IX_CMS_TagGroup_TagGroupSiteID]';
    END;

GO

PRINT ' 67 of 1510 : Analyzing IX_COM_OrderStatusUser_OrderID_Date';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_OrderStatusUser_OrderID_Date') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_COM_OrderStatusUser_OrderID_Date]
		ON [dbo].[COM_OrderStatusUser] ( [OrderID]  ASC , Date DESC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 68 of 1510 : Created [IX_COM_OrderStatusUser_OrderID_Date]';
    END;

GO

PRINT ' 69 of 1510 : Analyzing IX_COM_OrderStatusUser_FromStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_OrderStatusUser_FromStatusID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_OrderStatusUser_FromStatusID]
		ON [dbo].[COM_OrderStatusUser] ( [FromStatusID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 70 of 1510 : Created [IX_COM_OrderStatusUser_FromStatusID]';
    END;

GO

PRINT ' 71 of 1510 : Analyzing IX_COM_OrderStatusUser_ToStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_OrderStatusUser_ToStatusID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_OrderStatusUser_ToStatusID]
	   ON [dbo].[COM_OrderStatusUser] (  [ToStatusID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 72 of 1510 : Created [IX_COM_OrderStatusUser_ToStatusID]';
    END;

GO

PRINT ' 73 of 1510 : Analyzing IX_COM_OrderStatusUser_ChangedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_OrderStatusUser_ChangedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_OrderStatusUser_ChangedByUserID]
		ON [dbo].[COM_OrderStatusUser] ( [ChangedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 74 of 1510 : Created [IX_COM_OrderStatusUser_ChangedByUserID]';
    END;

GO

--PRINT ' 75 of 1510 : Analyzing cdx_StagingSyncLogTaskID';
--GO

--IF NOT EXISTS (SELECT [Name]
--			  FROM [sys].[Indexes]
--			  WHERE [Name] = 'cdx_StagingSyncLogTaskID') 
--    --IS NULL
--    BEGIN
--	   CREATE CLUSTERED INDEX
--	   [cdx_StagingSyncLogTaskID]
--	   ON [dbo].[Staging_SyncLogArchive] (  [SyncLogTaskID]  ASC) 
--	   WITH
--	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 76 of 1510 : Created [cdx_StagingSyncLogTaskID]';
--    END;

--GO

PRINT ' 77 of 1510 : Analyzing IX_CMS_State_CountryID_StateDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_State_CountryID_StateDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_State_CountryID_StateDisplayName]
		ON [dbo].[CMS_State] ( [StateDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 78 of 1510 : Created [IX_CMS_State_CountryID_StateDisplayName]';
    END;

GO

PRINT ' 79 of 1510 : Analyzing IX_Staging_Task_TaskNodeAliasPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_Task_TaskNodeAliasPath') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Staging_Task_TaskNodeAliasPath]
	   ON [dbo].[Staging_Task] (  [TaskNodeAliasPath]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 80 of 1510 : Created [IX_Staging_Task_TaskNodeAliasPath]';
    END;

GO

PRINT ' 81 of 1510 : Analyzing IX_Staging_Task_TaskSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_Task_TaskSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Staging_Task_TaskSiteID]
	   ON [dbo].[Staging_Task] (  [TaskSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 82 of 1510 : Created [IX_Staging_Task_TaskSiteID]';
    END;

GO

PRINT ' 83 of 1510 : Analyzing IX_Staging_Task_TaskDocumentID_TaskNodeID_TaskRunning';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_Task_TaskDocumentID_TaskNodeID_TaskRunning') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Staging_Task_TaskDocumentID_TaskNodeID_TaskRunning]
	   ON [dbo].[Staging_Task] (  [TaskDocumentID] ASC , [TaskNodeID]  ASC , [TaskRunning]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 84 of 1510 : Created [IX_Staging_Task_TaskDocumentID_TaskNodeID_TaskRunning]';
    END;

GO

PRINT ' 85 of 1510 : Analyzing IX_Staging_Task_TaskType';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_Task_TaskType') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Staging_Task_TaskType]
	   ON [dbo].[Staging_Task] (  [TaskType]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 86 of 1510 : Created [IX_Staging_Task_TaskType]';
    END;

GO

PRINT ' 87 of 1510 : Analyzing IX_Staging_Task_TaskObjectType_TaskObjectID_TaskRunning';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_Task_TaskObjectType_TaskObjectID_TaskRunning') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Staging_Task_TaskObjectType_TaskObjectID_TaskRunning]
	   ON [dbo].[Staging_Task] (  [TaskObjectType] ASC , [TaskObjectID]  ASC , [TaskRunning]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 88 of 1510 : Created [IX_Staging_Task_TaskObjectType_TaskObjectID_TaskRunning]';
    END;

GO

PRINT ' 89 of 1510 : Analyzing IX_OM_AccountContact_ContactRoleID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_AccountContact_ContactRoleID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_AccountContact_ContactRoleID]
		ON [dbo].[OM_AccountContact] ( [ContactRoleID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 90 of 1510 : Created [IX_OM_AccountContact_ContactRoleID]';
    END;

GO

PRINT ' 91 of 1510 : Analyzing IX_OM_AccountContact_AccountID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_AccountContact_AccountID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_AccountContact_AccountID]
	   ON [dbo].[OM_AccountContact] (  [AccountID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 92 of 1510 : Created [IX_OM_AccountContact_AccountID]';
    END;

GO

PRINT ' 93 of 1510 : Analyzing IX_OM_AccountContact_ContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_AccountContact_ContactID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_AccountContact_ContactID]
	   ON [dbo].[OM_AccountContact] (  [ContactID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 94 of 1510 : Created [IX_OM_AccountContact_ContactID]';
    END;

GO

PRINT ' 95 of 1510 : Analyzing IX_COM_OptionCategory_CategoryDisplayName_CategoryEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_OptionCategory_CategoryDisplayName_CategoryEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_OptionCategory_CategoryDisplayName_CategoryEnabled]
	   ON [dbo].[COM_OptionCategory] ( [CategoryDisplayName]  ASC , [CategoryEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 96 of 1510 : Created [IX_COM_OptionCategory_CategoryDisplayName_CategoryEnabled]';
    END;

GO

PRINT ' 97 of 1510 : Analyzing IX_CMS_Tag_TagName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tag_TagName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Tag_TagName]
	   ON [dbo].[CMS_Tag] (  [TagName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 98 of 1510 : Created [IX_CMS_Tag_TagName]';
    END;

GO

PRINT ' 99 of 1510 : Analyzing IX_CMS_Tag_TagGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tag_TagGroupID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tag_TagGroupID]
	   ON [dbo].[CMS_Tag] (  [TagGroupID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 100 of 1510 : Created [IX_CMS_Tag_TagGroupID]';
    END;

GO

PRINT ' 101 of 1510 : Analyzing IX_HFit_HealthAssesmentUserQuestion_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_HealthAssesmentUserQuestion_1') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_HFit_HealthAssesmentUserQuestion_1]
		ON [dbo].[HFit_HealthAssesmentUserQuestion] (  [UserID]  ASC) INCLUDE ( [HAQuestionNodeGUID]) WITH ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 102 of 1510 : Created [IX_HFit_HealthAssesmentUserQuestion_1]';
    END;

GO

PRINT ' 103 of 1510 : Analyzing idx_UserQuestionCodeName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_UserQuestionCodeName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_UserQuestionCodeName]
	   ON [dbo].[HFit_HealthAssesmentUserQuestion] (  [CodeName] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 104 of 1510 : Created [idx_UserQuestionCodeName]';
    END;

GO

PRINT ' 105 of 1510 : Analyzing ci_HFit_HealthAssesmentUserQuestion_NodeGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'ci_HFit_HealthAssesmentUserQuestion_NodeGUID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [ci_HFit_HealthAssesmentUserQuestion_NodeGUID]
		 ON [dbo].[HFit_HealthAssesmentUserQuestion] (  [HAQuestionNodeGUID]  ASC) INCLUDE ( [ItemID] , [HAQuestionScore] , [ItemModifiedWhen] , [HARiskAreaItemID] , [CodeName] , [PreWeightedScore] , [IsProfessionallyCollected]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 106 of 1510 : Created [ci_HFit_HealthAssesmentUserQuestion_NodeGUID]';
    END;

GO

PRINT ' 107 of 1510 : Analyzing HFit_HealthAssesmentUserQuestion_HARiskAreaItemID_PI';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_HealthAssesmentUserQuestion_HARiskAreaItemID_PI') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_HealthAssesmentUserQuestion_HARiskAreaItemID_PI]
	   ON [dbo].[HFit_HealthAssesmentUserQuestion] ( [HARiskAreaItemID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 108 of 1510 : Created [HFit_HealthAssesmentUserQuestion_HARiskAreaItemID_PI]';
    END;

GO

PRINT ' 109 of 1510 : Analyzing nonItemIDHARiskAreaItemID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonItemIDHARiskAreaItemID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonItemIDHARiskAreaItemID]
	   ON [dbo].[HFit_HealthAssesmentUserQuestion] (  [ItemID] ASC , [HARiskAreaItemID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 110 of 1510 : Created [nonItemIDHARiskAreaItemID]';
    END;

GO

PRINT ' 111 of 1510 : Analyzing IX_CMS_ResourceTranslation_TranslationStringID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ResourceTranslation_TranslationStringID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_ResourceTranslation_TranslationStringID]
		 ON [dbo].[CMS_ResourceTranslation] (  [TranslationStringID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 112 of 1510 : Created [IX_CMS_ResourceTranslation_TranslationStringID]';
    END;

GO

PRINT ' 113 of 1510 : Analyzing IX_CMS_ResourceTranslation_TranslationUICultureID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ResourceTranslation_TranslationUICultureID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_ResourceTranslation_TranslationUICultureID]
		 ON [dbo].[CMS_ResourceTranslation] (  [TranslationUICultureID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 114 of 1510 : Created [IX_CMS_ResourceTranslation_TranslationUICultureID]';
    END;

GO

--PRINT ' 115 of 1510 : Analyzing cdx_StagingTaskTaskID';
--GO

--IF NOT EXISTS (SELECT [Name]
--			  FROM [sys].[Indexes]
--			  WHERE [Name] = 'cdx_StagingTaskTaskID') 
--    --IS NULL
--    BEGIN
--	   CREATE CLUSTERED INDEX
--	   [cdx_StagingTaskTaskID]
--	   ON [dbo].[Staging_TaskArchive] (  [TaskID]  ASC) 
--	   WITH
--	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 116 of 1510 : Created [cdx_StagingTaskTaskID]';
--    END;

--GO

PRINT ' 117 of 1510 : Analyzing IX_CMS_WebFarmServer_ServerDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebFarmServer_ServerDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_WebFarmServer_ServerDisplayName]
		ON [dbo].[CMS_WebFarmServer] ( [ServerDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 118 of 1510 : Created [IX_CMS_WebFarmServer_ServerDisplayName]';
    END;

GO

PRINT ' 119 of 1510 : Analyzing IX_CMS_WebFarmServer_ServerName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebFarmServer_ServerName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WebFarmServer_ServerName]
	   ON [dbo].[CMS_WebFarmServer] (  [ServerName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 120 of 1510 : Created [IX_CMS_WebFarmServer_ServerName]';
    END;

GO

PRINT ' 121 of 1510 : Analyzing IX_CMS_WebFarmServer_ServerNameServerLastUpdated';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebFarmServer_ServerNameServerLastUpdated') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_WebFarmServer_ServerNameServerLastUpdated]
		 ON [dbo].[CMS_WebFarmServer] (  [ServerName]  ASC , [ServerLastUpdated]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 122 of 1510 : Created [IX_CMS_WebFarmServer_ServerNameServerLastUpdated]';
    END;

GO

PRINT ' 123 of 1510 : Analyzing IX_CMS_EmailTemplate_EmailTemplateDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_EmailTemplate_EmailTemplateDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_EmailTemplate_EmailTemplateDisplayName]
		 ON [dbo].[CMS_EmailTemplate] (  [EmailTemplateDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 124 of 1510 : Created [IX_CMS_EmailTemplate_EmailTemplateDisplayName]';
    END;

GO

PRINT ' 125 of 1510 : Analyzing IX_CMS_EmailTemplate_EmailTemplateName_EmailTemplateSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_EmailTemplate_EmailTemplateName_EmailTemplateSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_EmailTemplate_EmailTemplateName_EmailTemplateSiteID]
	   ON [dbo].[CMS_EmailTemplate] ( [EmailTemplateName]  ASC , [EmailTemplateSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 126 of 1510 : Created [IX_CMS_EmailTemplate_EmailTemplateName_EmailTemplateSiteID]';
    END;

GO

PRINT ' 127 of 1510 : Analyzing IX_CMS_SettingsKey_KeyLoadGeneration_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_SettingsKey_KeyLoadGeneration_SiteID') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_SettingsKey_KeyLoadGeneration_SiteID]
		 ON [dbo].[CMS_SettingsKey] (  [KeyLoadGeneration]  ASC , [SiteID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 128 of 1510 : Created [IX_CMS_SettingsKey_KeyLoadGeneration_SiteID]';
    END;

GO

PRINT ' 129 of 1510 : Analyzing IX_CMS_SettingsKey_SiteID_KeyName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_SettingsKey_SiteID_KeyName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_SettingsKey_SiteID_KeyName]
	   ON [dbo].[CMS_SettingsKey] (  [SiteID]  ASC , [KeyName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 130 of 1510 : Created [IX_CMS_SettingsKey_SiteID_KeyName]';
    END;

GO

PRINT ' 131 of 1510 : Analyzing IX_CMS_SettingsKey_KeyCategoryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_SettingsKey_KeyCategoryID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_SettingsKey_KeyCategoryID]
	   ON [dbo].[CMS_SettingsKey] (  [KeyCategoryID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 132 of 1510 : Created [IX_CMS_SettingsKey_KeyCategoryID]';
    END;

GO

PRINT ' 133 of 1510 : Analyzing nonKeyName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonKeyName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonKeyName]
	   ON [dbo].[CMS_SettingsKey] (  [KeyName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 134 of 1510 : Created [nonKeyName]';
    END;

GO

PRINT ' 135 of 1510 : Analyzing nonKeyNameLocSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonKeyNameLocSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonKeyNameLocSiteID]
	   ON [dbo].[CMS_SettingsKey] (  [KeyName]  ASC , [KeyLoadGeneration]  ASC , [SiteID]  ASC) INCLUDE ( [KeyValue]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 136 of 1510 : Created [nonKeyNameLocSiteID]';
    END;

GO

PRINT ' 137 of 1510 : Analyzing IX_CMS_SettingsKey_KeyName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_SettingsKey_KeyName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_SettingsKey_KeyName]
	   ON [dbo].[CMS_SettingsKey] (  [KeyName]  ASC) INCLUDE ( [KeyValue] , [SiteID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 138 of 1510 : Created [IX_CMS_SettingsKey_KeyName]';
    END;

GO

PRINT ' 139 of 1510 : Analyzing IX_OM_MVTVariant_MVTVariantPageTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_MVTVariant_MVTVariantPageTemplateID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_OM_MVTVariant_MVTVariantPageTemplateID]
		 ON [dbo].[OM_MVTVariant] (  [MVTVariantPageTemplateID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 140 of 1510 : Created [IX_OM_MVTVariant_MVTVariantPageTemplateID]';
    END;

GO

PRINT ' 141 of 1510 : Analyzing IX_Analytics_ConversionCampaign';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_ConversionCampaign') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE CLUSTERED INDEX
	   [IX_Analytics_ConversionCampaign]
	   ON [dbo].[Analytics_ConversionCampaign] ( [CampaignID]  ASC , [ConversionID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 142 of 1510 : Created [IX_Analytics_ConversionCampaign]';
    END;

GO

PRINT ' 143 of 1510 : Analyzing IX_HFit_TrackerCardio_UserID_EventDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_TrackerCardio_UserID_EventDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_HFit_TrackerCardio_UserID_EventDate]
		ON [dbo].[HFit_TrackerCardio] ( [UserID]  ASC , [EventDate]  ASC) INCLUDE ( [Minutes]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 144 of 1510 : Created [IX_HFit_TrackerCardio_UserID_EventDate]';
    END;

GO

PRINT ' 145 of 1510 : Analyzing idx_HFit_TrackerCardio_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerCardio_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerCardio_CreateDate]
	   ON [dbo].[HFit_TrackerCardio] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 146 of 1510 : Created [idx_HFit_TrackerCardio_CreateDate]';
    END;

GO

PRINT ' 147 of 1510 : Analyzing IX_Chat_OnlineSupport_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Chat_OnlineSupport_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Chat_OnlineSupport_SiteID]
	   ON [dbo].[Chat_OnlineSupport] ( [ChatOnlineSupportSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 148 of 1510 : Created [IX_Chat_OnlineSupport_SiteID]';
    END;

GO

PRINT ' 149 of 1510 : Analyzing IX_COM_Manufacturer_ManufacturerDisplayName_ManufacturerEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Manufacturer_ManufacturerDisplayName_ManufacturerEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_Manufacturer_ManufacturerDisplayName_ManufacturerEnabled]
	   ON [dbo].[COM_Manufacturer] (  [ManufacturerDisplayName]  ASC , [ManufacturerEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 150 of 1510 : Created [IX_COM_Manufacturer_ManufacturerDisplayName_ManufacturerEnabled]';
    END;

GO

PRINT ' 151 of 1510 : Analyzing IX_CMS_WebPart_WebPartLoadGeneration';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPart_WebPartLoadGeneration') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_WebPart_WebPartLoadGeneration]
		ON [dbo].[CMS_WebPart] ( [WebPartLoadGeneration]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 152 of 1510 : Created [IX_CMS_WebPart_WebPartLoadGeneration]';
    END;

GO

PRINT ' 153 of 1510 : Analyzing IX_CMS_WebPart_WebPartName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPart_WebPartName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WebPart_WebPartName]
	   ON [dbo].[CMS_WebPart] (  [WebPartName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 154 of 1510 : Created [IX_CMS_WebPart_WebPartName]';
    END;

GO

PRINT ' 155 of 1510 : Analyzing IX_CMS_WebPart_WebPartCategoryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPart_WebPartCategoryID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WebPart_WebPartCategoryID]
	   ON [dbo].[CMS_WebPart] (  [WebPartCategoryID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 156 of 1510 : Created [IX_CMS_WebPart_WebPartCategoryID]';
    END;

GO

PRINT ' 157 of 1510 : Analyzing IX_CMS_WebPart_WebPartParentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPart_WebPartParentID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WebPart_WebPartParentID]
	   ON [dbo].[CMS_WebPart] (  [WebPartParentID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 158 of 1510 : Created [IX_CMS_WebPart_WebPartParentID]';
    END;

GO

PRINT ' 159 of 1510 : Analyzing IX_CMS_WebPart_WebPartLastSelection';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPart_WebPartLastSelection') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_WebPart_WebPartLastSelection]
		ON [dbo].[CMS_WebPart] ( [WebPartLastSelection]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 160 of 1510 : Created [IX_CMS_WebPart_WebPartLastSelection]';
    END;

GO

PRINT ' 161 of 1510 : Analyzing idx_HFit_TrackerBloodPressure_UserIDEventDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerBloodPressure_UserIDEventDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idx_HFit_TrackerBloodPressure_UserIDEventDate]
		 ON [dbo].[HFit_TrackerBloodPressure] (  [EventDate]  ASC , [UserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 162 of 1510 : Created [idx_HFit_TrackerBloodPressure_UserIDEventDate]';
    END;

GO

PRINT ' 163 of 1510 : Analyzing IX_Hfit_TrackerBloodPressure_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Hfit_TrackerBloodPressure_1') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Hfit_TrackerBloodPressure_1]
	   ON [dbo].[HFit_TrackerBloodPressure] (  [UserID] ASC , [EventDate]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 164 of 1510 : Created [IX_Hfit_TrackerBloodPressure_1]';
    END;

GO

PRINT ' 165 of 1510 : Analyzing idx_HFit_TrackerBloodPressure_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerBloodPressure_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerBloodPressure_CreateDate]
		ON [dbo].[HFit_TrackerBloodPressure] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 166 of 1510 : Created [idx_HFit_TrackerBloodPressure_CreateDate]';
    END;

GO

PRINT ' 167 of 1510 : Analyzing IX_OM_Contact_ContactLastName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_ContactLastName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Contact_ContactLastName]
	   ON [dbo].[OM_Contact] (  [ContactLastName]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 168 of 1510 : Created [IX_OM_Contact_ContactLastName]';
    END;

GO

PRINT ' 169 of 1510 : Analyzing IX_OM_Contact_ContactStateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_ContactStateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Contact_ContactStateID]
	   ON [dbo].[OM_Contact] (  [ContactStateID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 170 of 1510 : Created [IX_OM_Contact_ContactStateID]';
    END;

GO

PRINT ' 171 of 1510 : Analyzing IX_OM_Contact_ContactCountryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_ContactCountryID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Contact_ContactCountryID]
	   ON [dbo].[OM_Contact] (  [ContactCountryID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 172 of 1510 : Created [IX_OM_Contact_ContactCountryID]';
    END;

GO

PRINT ' 173 of 1510 : Analyzing IX_OM_Contact_ContactStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_ContactStatusID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Contact_ContactStatusID]
	   ON [dbo].[OM_Contact] (  [ContactStatusID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 174 of 1510 : Created [IX_OM_Contact_ContactStatusID]';
    END;

GO

PRINT ' 175 of 1510 : Analyzing IX_OM_Contact_ContactOwnerUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_ContactOwnerUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Contact_ContactOwnerUserID]
	   ON [dbo].[OM_Contact] (  [ContactOwnerUserID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 176 of 1510 : Created [IX_OM_Contact_ContactOwnerUserID]';
    END;

GO

PRINT ' 177 of 1510 : Analyzing IX_OM_Contact_ContactMergedWithContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_ContactMergedWithContactID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Contact_ContactMergedWithContactID]
		ON [dbo].[OM_Contact] ( [ContactMergedWithContactID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 178 of 1510 : Created [IX_OM_Contact_ContactMergedWithContactID]';
    END;

GO

PRINT ' 179 of 1510 : Analyzing IX_OM_Contact_ContactMergedWithContactID_ContactSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_ContactMergedWithContactID_ContactSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Contact_ContactMergedWithContactID_ContactSiteID]
	   ON [dbo].[OM_Contact] ( [ContactMergedWithContactID]  ASC , [ContactSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 180 of 1510 : Created [IX_OM_Contact_ContactMergedWithContactID_ContactSiteID]';
    END;

GO

PRINT ' 181 of 1510 : Analyzing IX_OM_Contact_ContactSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_ContactSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Contact_ContactSiteID]
	   ON [dbo].[OM_Contact] (  [ContactSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 182 of 1510 : Created [IX_OM_Contact_ContactSiteID]';
    END;

GO

PRINT ' 183 of 1510 : Analyzing IX_OM_Contact_ContactGlobalContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_ContactGlobalContactID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Contact_ContactGlobalContactID]
		ON [dbo].[OM_Contact] ( [ContactGlobalContactID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 184 of 1510 : Created [IX_OM_Contact_ContactGlobalContactID]';
    END;

GO

PRINT ' 185 of 1510 : Analyzing IX_OM_Contact_SalesForce';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Contact_SalesForce') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Contact_SalesForce]
	   ON [dbo].[OM_Contact] (  [ContactSalesForceLeadID]  ASC , [ContactSalesForceLeadReplicationDisabled]  ASC , [ContactSalesForceLeadReplicationSuspensionDateTime]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 186 of 1510 : Created [IX_OM_Contact_SalesForce]';
    END;

GO

PRINT ' 187 of 1510 : Analyzing IX_ContactContactSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_ContactContactSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_ContactContactSiteID]
	   ON [dbo].[OM_Contact] (  [ContactSiteID]  ASC , [ContactGUID]  ASC) INCLUDE ( [ContactID] , [ContactFirstName] , [ContactLastName] , [ContactCountryID] , [ContactEmail] , [ContactStatusID] , [ContactMergedWithContactID] , [ContactCreated] , [ContactGlobalContactID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 188 of 1510 : Created [IX_ContactContactSiteID]';
    END;

GO

PRINT ' 189 of 1510 : Analyzing nonContactID';
GO

--WDM Verify

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonContactID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonContactID]
	   ON [dbo].[OM_Contact] (  [ContactID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 190 of 1510 : Created [nonContactID]';
    END;

GO

PRINT ' 191 of 1510 : Analyzing IX_Forums_ForumSubscription_SubscriptionForumID_SubscriptionEmail';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumSubscription_SubscriptionForumID_SubscriptionEmail') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Forums_ForumSubscription_SubscriptionForumID_SubscriptionEmail]
	   ON [dbo].[Forums_ForumSubscription] (  [SubscriptionEmail]  ASC , [SubscriptionForumID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 192 of 1510 : Created [IX_Forums_ForumSubscription_SubscriptionForumID_SubscriptionEmail]';
    END;

GO

PRINT ' 193 of 1510 : Analyzing IX_Forums_ForumSubscription_SubscriptionUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumSubscription_SubscriptionUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Forums_ForumSubscription_SubscriptionUserID]
		 ON [dbo].[Forums_ForumSubscription] (  [SubscriptionUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 194 of 1510 : Created [IX_Forums_ForumSubscription_SubscriptionUserID]';
    END;

GO

PRINT ' 195 of 1510 : Analyzing IX_Forums_ForumSubscription_SubscriptionPostID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumSubscription_SubscriptionPostID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Forums_ForumSubscription_SubscriptionPostID]
		 ON [dbo].[Forums_ForumSubscription] (  [SubscriptionPostID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 196 of 1510 : Created [IX_Forums_ForumSubscription_SubscriptionPostID]';
    END;

GO

PRINT ' 197 of 1510 : Analyzing IX_CMS_TemplateDeviceLayout_PageTemplateID_ProfileID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_TemplateDeviceLayout_PageTemplateID_ProfileID') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE NONCLUSTERED INDEX
	   [IX_CMS_TemplateDeviceLayout_PageTemplateID_ProfileID]
	   ON [dbo].[CMS_TemplateDeviceLayout] ( [PageTemplateID]  ASC , [ProfileID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 198 of 1510 : Created [IX_CMS_TemplateDeviceLayout_PageTemplateID_ProfileID]';
    END;

GO

PRINT ' 199 of 1510 : Analyzing IX_CMS_TemplateDeviceLayout_LayoutID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_TemplateDeviceLayout_LayoutID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_TemplateDeviceLayout_LayoutID]
		ON [dbo].[CMS_TemplateDeviceLayout] (  [LayoutID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 200 of 1510 : Created [IX_CMS_TemplateDeviceLayout_LayoutID]';
    END;

GO

PRINT ' 201 of 1510 : Analyzing IX_CMS_BannerCategory_BannerCategoryName_BannerCategorySiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_BannerCategory_BannerCategoryName_BannerCategorySiteID') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE NONCLUSTERED  INDEX
	   [IX_CMS_BannerCategory_BannerCategoryName_BannerCategorySiteID]
	   ON [dbo].[CMS_BannerCategory] (  [BannerCategoryName]  ASC , [BannerCategorySiteID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 202 of 1510 : Created [IX_CMS_BannerCategory_BannerCategoryName_BannerCategorySiteID]';
    END;

GO

PRINT ' 203 of 1510 : Analyzing IX_CMS_UIElement_ElementResourceID_ElementLevel_ElementParentID_ElementOrder_ElementCaption';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UIElement_ElementResourceID_ElementLevel_ElementParentID_ElementOrder_ElementCaption') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_UIElement_ElementResourceID_ElementLevel_ElementParentID_ElementOrder_ElementCaption]
		 ON [dbo].[CMS_UIElement] (  [ElementResourceID]  ASC , [ElementLevel]  ASC , [ElementParentID]  ASC , [ElementOrder]  ASC , [ElementCaption]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 204 of 1510 : Created [IX_CMS_UIElement_ElementResourceID_ElementLevel_ElementParentID_ElementOrder_ElementCaption]';
    END;

GO

PRINT ' 205 of 1510 : Analyzing CMS_UIElement_idx_01';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'CMS_UIElement_idx_01') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [CMS_UIElement_idx_01]
	   ON [dbo].[CMS_UIElement] (  [ElementParentID]  ASC , [ElementLevel]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 206 of 1510 : Created [CMS_UIElement_idx_01]';
    END;

GO

PRINT ' 207 of 1510 : Analyzing IX_Analytics_Index_All';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_Index_All') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Analytics_Index_All]
	   ON [dbo].[Analytics_Index] (  [IndexID]  ASC , [IndexZero]  ASC , [IndexMonthName]  ASC , [IndexDayName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 208 of 1510 : Created [IX_Analytics_Index_All]';
    END;

GO

PRINT ' 209 of 1510 : Analyzing idx_HFit_TrackerStressManagement_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerStressManagement_CreateDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idx_HFit_TrackerStressManagement_CreateDate]
		 ON [dbo].[HFit_TrackerStressManagement] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 210 of 1510 : Created [idx_HFit_TrackerStressManagement_CreateDate]';
    END;

GO

PRINT ' 211 of 1510 : Analyzing IX_CMS_Country_CountryDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Country_CountryDisplayName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Country_CountryDisplayName]
	   ON [dbo].[CMS_Country] (  [CountryDisplayName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 212 of 1510 : Created [IX_CMS_Country_CountryDisplayName]';
    END;

GO

PRINT ' 213 of 1510 : Analyzing IX_HFit_HealthAssesmentUserModule_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_HealthAssesmentUserModule_1') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_HFit_HealthAssesmentUserModule_1]
		ON [dbo].[HFit_HealthAssesmentUserModule] (  [UserID]  ASC) INCLUDE ( [HAModuleNodeGUID]) WITH ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 214 of 1510 : Created [IX_HFit_HealthAssesmentUserModule_1]';
    END;

GO

PRINT ' 215 of 1510 : Analyzing IX_HAModule_StartedItemID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HAModule_StartedItemID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_HAModule_StartedItemID]
	   ON [dbo].[HFit_HealthAssesmentUserModule] ( [HAStartedItemID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 216 of 1510 : Created [IX_HAModule_StartedItemID]';
    END;

GO

PRINT ' 217 of 1510 : Analyzing IX_CMS_LicenseKey_LicenseDomain';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_LicenseKey_LicenseDomain') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_LicenseKey_LicenseDomain]
	   ON [dbo].[CMS_LicenseKey] (  [LicenseDomain]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 218 of 1510 : Created [IX_CMS_LicenseKey_LicenseDomain]';
    END;

GO

PRINT ' 219 of 1510 : Analyzing IX_Blog_PostSubscription_SubscriptionPostDocumentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Blog_PostSubscription_SubscriptionPostDocumentID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Blog_PostSubscription_SubscriptionPostDocumentID]
	   ON [dbo].[Blog_PostSubscription] ( [SubscriptionPostDocumentID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 220 of 1510 : Created [IX_Blog_PostSubscription_SubscriptionPostDocumentID]';
    END;

GO

PRINT ' 221 of 1510 : Analyzing IX_Blog_PostSubscription_SubscriptionUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Blog_PostSubscription_SubscriptionUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Blog_PostSubscription_SubscriptionUserID]
		 ON [dbo].[Blog_PostSubscription] (  [SubscriptionUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 222 of 1510 : Created [IX_Blog_PostSubscription_SubscriptionUserID]';
    END;

GO

PRINT ' 223 of 1510 : Analyzing IX_CMS_Permission_ClassID_PermissionName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Permission_ClassID_PermissionName') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Permission_ClassID_PermissionName]
		ON [dbo].[CMS_Permission] ( [ClassID]  ASC , [PermissionName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 224 of 1510 : Created [IX_CMS_Permission_ClassID_PermissionName]';
    END;

GO

PRINT ' 225 of 1510 : Analyzing IX_CMS_Permission_ResourceID_PermissionName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Permission_ResourceID_PermissionName') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_Permission_ResourceID_PermissionName]
		 ON [dbo].[CMS_Permission] (  [ResourceID]  ASC , [PermissionName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 226 of 1510 : Created [IX_CMS_Permission_ResourceID_PermissionName]';
    END;

GO

PRINT ' 227 of 1510 : Analyzing IX_CMS_PageTemplateScope_PageTemplateScopePath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplateScope_PageTemplateScopePath') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_PageTemplateScope_PageTemplateScopePath]
		 ON [dbo].[CMS_PageTemplateScope] (  [PageTemplateScopePath]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 228 of 1510 : Created [IX_CMS_PageTemplateScope_PageTemplateScopePath]';
    END;

GO

PRINT ' 229 of 1510 : Analyzing IX_CMS_PageTemplateScope_PageTemplateScopeLevels';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplateScope_PageTemplateScopeLevels') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_PageTemplateScope_PageTemplateScopeLevels]
		 ON [dbo].[CMS_PageTemplateScope] (  [PageTemplateScopeLevels]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 230 of 1510 : Created [IX_CMS_PageTemplateScope_PageTemplateScopeLevels]';
    END;

GO

PRINT ' 231 of 1510 : Analyzing IX_CMS_PageTemplateScope_PageTemplateScopeCultureID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplateScope_PageTemplateScopeCultureID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_PageTemplateScope_PageTemplateScopeCultureID]
	   ON [dbo].[CMS_PageTemplateScope] ( [PageTemplateScopeCultureID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 232 of 1510 : Created [IX_CMS_PageTemplateScope_PageTemplateScopeCultureID]';
    END;

GO

PRINT ' 233 of 1510 : Analyzing IX_CMS_PageTemplateScope_PageTemplateScopeClassID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplateScope_PageTemplateScopeClassID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_PageTemplateScope_PageTemplateScopeClassID]
		 ON [dbo].[CMS_PageTemplateScope] (  [PageTemplateScopeClassID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 234 of 1510 : Created [IX_CMS_PageTemplateScope_PageTemplateScopeClassID]';
    END;

GO

PRINT ' 235 of 1510 : Analyzing IX_CMS_PageTemplateScope_PageTemplateScopeTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplateScope_PageTemplateScopeTemplateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_PageTemplateScope_PageTemplateScopeTemplateID]
	   ON [dbo].[CMS_PageTemplateScope] ( [PageTemplateScopeTemplateID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 236 of 1510 : Created [IX_CMS_PageTemplateScope_PageTemplateScopeTemplateID]';
    END;

GO

PRINT ' 237 of 1510 : Analyzing IX_CMS_PageTemplateScope_PageTemplateScopeSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplateScope_PageTemplateScopeSiteID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_PageTemplateScope_PageTemplateScopeSiteID]
		 ON [dbo].[CMS_PageTemplateScope] (  [PageTemplateScopeSiteID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 238 of 1510 : Created [IX_CMS_PageTemplateScope_PageTemplateScopeSiteID]';
    END;

GO

PRINT ' 239 of 1510 : Analyzing idx_HFit_TrackerRegularMeals_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerRegularMeals_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerRegularMeals_CreateDate]
		ON [dbo].[HFit_TrackerRegularMeals] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 240 of 1510 : Created [idx_HFit_TrackerRegularMeals_CreateDate]';
    END;

GO

PRINT ' 241 of 1510 : Analyzing idx_HFit_TrackerWholeGrains_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerWholeGrains_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerWholeGrains_CreateDate]
		ON [dbo].[HFit_TrackerWholeGrains] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 242 of 1510 : Created [idx_HFit_TrackerWholeGrains_CreateDate]';
    END;

GO

PRINT ' 243 of 1510 : Analyzing IX_Analytics_YearHits_HitsStartTime_HitsEndTime';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_YearHits_HitsStartTime_HitsEndTime') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Analytics_YearHits_HitsStartTime_HitsEndTime]
		 ON [dbo].[Analytics_YearHits] (  [HitsStartTime] DESC , [HitsEndTime] DESC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 244 of 1510 : Created [IX_Analytics_YearHits_HitsStartTime_HitsEndTime]';
    END;

GO

PRINT ' 245 of 1510 : Analyzing IX_Analytics_WeekYearHits_HitsStatisticsID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_WeekYearHits_HitsStatisticsID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Analytics_WeekYearHits_HitsStatisticsID]
		 ON [dbo].[Analytics_YearHits] (  [HitsStatisticsID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 246 of 1510 : Created [IX_Analytics_WeekYearHits_HitsStatisticsID]';
    END;

GO

PRINT ' 247 of 1510 : Analyzing IX_OM_Activity_ActivityActiveContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Activity_ActivityActiveContactID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Activity_ActivityActiveContactID]
		ON [dbo].[OM_Activity] ( [ActivityActiveContactID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 248 of 1510 : Created [IX_OM_Activity_ActivityActiveContactID]';
    END;

GO

PRINT ' 249 of 1510 : Analyzing IX_OM_Activity_ActivityOriginalContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Activity_ActivityOriginalContactID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Activity_ActivityOriginalContactID]
		ON [dbo].[OM_Activity] ( [ActivityOriginalContactID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 250 of 1510 : Created [IX_OM_Activity_ActivityOriginalContactID]';
    END;

GO

PRINT ' 251 of 1510 : Analyzing IX_OM_Activity_ActivityCreated';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Activity_ActivityCreated') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Activity_ActivityCreated]
	   ON [dbo].[OM_Activity] (  [ActivityCreated]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 252 of 1510 : Created [IX_OM_Activity_ActivityCreated]';
    END;

GO

PRINT ' 253 of 1510 : Analyzing IX_OM_Activity_ActivityType';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Activity_ActivityType') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Activity_ActivityType]
	   ON [dbo].[OM_Activity] (  [ActivityType]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 254 of 1510 : Created [IX_OM_Activity_ActivityType]';
    END;

GO

PRINT ' 255 of 1510 : Analyzing IX_OM_Activity_ActivityItemDetailID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Activity_ActivityItemDetailID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Activity_ActivityItemDetailID]
		ON [dbo].[OM_Activity] ( [ActivityItemDetailID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 256 of 1510 : Created [IX_OM_Activity_ActivityItemDetailID]';
    END;

GO

PRINT ' 257 of 1510 : Analyzing IX_OM_Activity_ActivitySiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Activity_ActivitySiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Activity_ActivitySiteID]
	   ON [dbo].[OM_Activity] (  [ActivitySiteID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 258 of 1510 : Created [IX_OM_Activity_ActivitySiteID]';
    END;

GO

PRINT ' 259 of 1510 : Analyzing IX_CMS_InlineControl_ControlDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_InlineControl_ControlDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_InlineControl_ControlDisplayName]
		ON [dbo].[CMS_InlineControl] ( [ControlDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 260 of 1510 : Created [IX_CMS_InlineControl_ControlDisplayName]';
    END;

GO

PRINT ' 261 of 1510 : Analyzing IX_CMS_BannedIP_IPAddressSiteID_IPAddress';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_BannedIP_IPAddressSiteID_IPAddress') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_BannedIP_IPAddressSiteID_IPAddress]
		 ON [dbo].[CMS_BannedIP] ( [IPAddress]  ASC , [IPAddressSiteID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 262 of 1510 : Created [IX_CMS_BannedIP_IPAddressSiteID_IPAddress]';
    END;

GO

PRINT ' 263 of 1510 : Analyzing IX_Analytics_WeekHits_HitsStartTime_HitsEndTime';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_WeekHits_HitsStartTime_HitsEndTime') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Analytics_WeekHits_HitsStartTime_HitsEndTime]
		 ON [dbo].[Analytics_WeekHits] (  [HitsStartTime] DESC , [HitsEndTime] DESC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 264 of 1510 : Created [IX_Analytics_WeekHits_HitsStartTime_HitsEndTime]';
    END;

GO

PRINT ' 265 of 1510 : Analyzing IX_Analytics_WeekHits_HitsStatisticsID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_WeekHits_HitsStatisticsID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Analytics_WeekHits_HitsStatisticsID]
		ON [dbo].[Analytics_WeekHits] ( [HitsStatisticsID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 266 of 1510 : Created [IX_Analytics_WeekHits_HitsStatisticsID]';
    END;

GO

PRINT ' 267 of 1510 : Analyzing idxpagetemplatetemp';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idxpagetemplatetemp') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE CLUSTERED  INDEX
	   [idxpagetemplatetemp]
	   ON [dbo].[temp_CMS_PageTemplate] (  [PageTemplateID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 268 of 1510 : Created [idxpagetemplatetemp]';
    END;

GO

PRINT ' 269 of 1510 : Analyzing IX_CMS_FormUserControl_UserControlDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_FormUserControl_UserControlDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_FormUserControl_UserControlDisplayName]
		 ON [dbo].[CMS_FormUserControl] (  [UserControlDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 270 of 1510 : Created [IX_CMS_FormUserControl_UserControlDisplayName]';
    END;

GO

PRINT ' 271 of 1510 : Analyzing IX_CMS_FormUserControl_UserControlResourceID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_FormUserControl_UserControlResourceID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_FormUserControl_UserControlResourceID]
		 ON [dbo].[CMS_FormUserControl] (  [UserControlResourceID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 272 of 1510 : Created [IX_CMS_FormUserControl_UserControlResourceID]';
    END;

GO

PRINT ' 273 of 1510 : Analyzing IX_CMS_FormUserControl_UserControlParentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_FormUserControl_UserControlParentID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_FormUserControl_UserControlParentID]
		 ON [dbo].[CMS_FormUserControl] (  [UserControlParentID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 274 of 1510 : Created [IX_CMS_FormUserControl_UserControlParentID]';
    END;

GO

PRINT ' 275 of 1510 : Analyzing IX_Analytics_MonthHits_HitsStartTime_HitsEndTime';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_MonthHits_HitsStartTime_HitsEndTime') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Analytics_MonthHits_HitsStartTime_HitsEndTime]
		 ON [dbo].[Analytics_MonthHits] (  [HitsStartTime] DESC , [HitsEndTime] DESC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 276 of 1510 : Created [IX_Analytics_MonthHits_HitsStartTime_HitsEndTime]';
    END;

GO

PRINT ' 277 of 1510 : Analyzing IX_Analytics_MonthHits_HitsStatisticsID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_MonthHits_HitsStatisticsID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Analytics_MonthHits_HitsStatisticsID]
		ON [dbo].[Analytics_MonthHits] ( [HitsStatisticsID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 278 of 1510 : Created [IX_Analytics_MonthHits_HitsStatisticsID]';
    END;

GO

PRINT ' 279 of 1510 : Analyzing IX_Newsletter_Subscriber_SubscriberSiteID_SubscriberFullName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Subscriber_SubscriberSiteID_SubscriberFullName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Newsletter_Subscriber_SubscriberSiteID_SubscriberFullName]
	   ON [dbo].[Newsletter_Subscriber] ( [SubscriberSiteID]  ASC , [SubscriberFullName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 280 of 1510 : Created [IX_Newsletter_Subscriber_SubscriberSiteID_SubscriberFullName]';
    END;

GO

PRINT ' 281 of 1510 : Analyzing IX_Newsletter_Subscriber_SubscriberType_SubscriberRelatedID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Subscriber_SubscriberType_SubscriberRelatedID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Newsletter_Subscriber_SubscriberType_SubscriberRelatedID]
	   ON [dbo].[Newsletter_Subscriber] (  [SubscriberType]  ASC , [SubscriberRelatedID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 282 of 1510 : Created [IX_Newsletter_Subscriber_SubscriberType_SubscriberRelatedID]';
    END;

GO

PRINT ' 283 of 1510 : Analyzing IDX_Hfit_HealthAssesmentUserAnswers_HAAnswerNodeGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_Hfit_HealthAssesmentUserAnswers_HAAnswerNodeGUID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IDX_Hfit_HealthAssesmentUserAnswers_HAAnswerNodeGUID]
	   ON [dbo].[HFit_HealthAssesmentUserAnswers] ( [ItemID]  ASC , [HAQuestionItemID]  ASC , [HAAnswerPoints]  ASC , [HAAnswerValue]  ASC , [CodeName]  ASC , [UOMCode]  ASC , [HAAnswerNodeGUID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 284 of 1510 : Created [IDX_Hfit_HealthAssesmentUserAnswers_HAAnswerNodeGUID]';
    END;

GO

PRINT ' 285 of 1510 : Analyzing nonHAQuestionItemID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonHAQuestionItemID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonHAQuestionItemID]
	   ON [dbo].[HFit_HealthAssesmentUserAnswers] (  [HAQuestionItemID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 286 of 1510 : Created [nonHAQuestionItemID]';
    END;

GO

PRINT ' 287 of 1510 : Analyzing idx_HFit_TrackerStrength_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerStrength_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerStrength_CreateDate]
		ON [dbo].[HFit_TrackerStrength] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 288 of 1510 : Created [idx_HFit_TrackerStrength_CreateDate]';
    END;

GO

PRINT ' 289 of 1510 : Analyzing idx_ThresholdTypeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_ThresholdTypeID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_ThresholdTypeID]
	   ON [dbo].[HFit_HealthAssesmentThresholds] (  [ThresholdTypeID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 290 of 1510 : Created [idx_ThresholdTypeID]';
    END;

GO

PRINT ' 291 of 1510 : Analyzing Ref65';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'Ref65') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [Ref65]
	   ON [dbo].[HFit_HealthAssesmentThresholds] (  [ThresholdTypeID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 292 of 1510 : Created [Ref65]';
    END;

GO

PRINT ' 293 of 1510 : Analyzing IX_Analytics_HourHits_HitsStartTime_HitsEndTime';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_HourHits_HitsStartTime_HitsEndTime') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Analytics_HourHits_HitsStartTime_HitsEndTime]
		 ON [dbo].[Analytics_HourHits] (  [HitsStartTime] DESC , [HitsEndTime] DESC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 294 of 1510 : Created [IX_Analytics_HourHits_HitsStartTime_HitsEndTime]';
    END;

GO

PRINT ' 295 of 1510 : Analyzing IX_Analytics_HourHits_HitsStatisticsID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_HourHits_HitsStatisticsID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Analytics_HourHits_HitsStatisticsID]
		ON [dbo].[Analytics_HourHits] ( [HitsStatisticsID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 296 of 1510 : Created [IX_Analytics_HourHits_HitsStatisticsID]';
    END;

GO

PRINT ' 297 of 1510 : Analyzing IX_OM_ContactGroup_ContactGroupSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ContactGroup_ContactGroupSiteID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_ContactGroup_ContactGroupSiteID]
		ON [dbo].[OM_ContactGroup] ( [ContactGroupSiteID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 298 of 1510 : Created [IX_OM_ContactGroup_ContactGroupSiteID]';
    END;

GO

PRINT ' 299 of 1510 : Analyzing PKI_EDW_BiometricViewRejectCriteria';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PKI_EDW_BiometricViewRejectCriteria') --IS NULL
    BEGIN CREATE  UNIQUE CLUSTERED INDEX
		[PKI_EDW_BiometricViewRejectCriteria]
		ON [dbo].[EDW_BiometricViewRejectCriteria] (  [AccountCD]  ASC , [ItemCreatedWhen]  ASC , [SiteID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 300 of 1510 : Created [PKI_EDW_BiometricViewRejectCriteria]';
    END;

GO

PRINT ' 301 of 1510 : Analyzing idx_HFit_TrackerHighFatFoods_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerHighFatFoods_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerHighFatFoods_CreateDate]
		ON [dbo].[HFit_TrackerHighFatFoods] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 302 of 1510 : Created [idx_HFit_TrackerHighFatFoods_CreateDate]';
    END;

GO

PRINT ' 303 of 1510 : Analyzing IX_Newsletter_Emails_EmailNewsletterIssueID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Emails_EmailNewsletterIssueID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Newsletter_Emails_EmailNewsletterIssueID]
		 ON [dbo].[Newsletter_Emails] (  [EmailNewsletterIssueID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 304 of 1510 : Created [IX_Newsletter_Emails_EmailNewsletterIssueID]';
    END;

GO

PRINT ' 305 of 1510 : Analyzing IX_Newsletter_Emails_EmailSubscriberID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Emails_EmailSubscriberID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Newsletter_Emails_EmailSubscriberID]
		ON [dbo].[Newsletter_Emails] ( [EmailSubscriberID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 306 of 1510 : Created [IX_Newsletter_Emails_EmailSubscriberID]';
    END;

GO

PRINT ' 307 of 1510 : Analyzing IX_Newsletter_Emails_EmailSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Emails_EmailSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Newsletter_Emails_EmailSiteID]
	   ON [dbo].[Newsletter_Emails] (  [EmailSiteID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 308 of 1510 : Created [IX_Newsletter_Emails_EmailSiteID]';
    END;

GO

PRINT ' 309 of 1510 : Analyzing IX_Newsletter_Emails_EmailSending';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Emails_EmailSending') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Newsletter_Emails_EmailSending]
	   ON [dbo].[Newsletter_Emails] (  [EmailSending] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 310 of 1510 : Created [IX_Newsletter_Emails_EmailSending]';
    END;

GO

PRINT ' 311 of 1510 : Analyzing IX_Newsletter_Emails_EmailGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Emails_EmailGUID') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE NONCLUSTERED INDEX
	   [IX_Newsletter_Emails_EmailGUID]
	   ON [dbo].[Newsletter_Emails] (  [EmailGUID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 312 of 1510 : Created [IX_Newsletter_Emails_EmailGUID]';
    END;

GO

PRINT ' 313 of 1510 : Analyzing IX_Analytics_DayHits_HitsStartTime_HitsEndTime';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_DayHits_HitsStartTime_HitsEndTime') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Analytics_DayHits_HitsStartTime_HitsEndTime]
		 ON [dbo].[Analytics_DayHits] (  [HitsStartTime] DESC , [HitsEndTime] DESC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 314 of 1510 : Created [IX_Analytics_DayHits_HitsStartTime_HitsEndTime]';
    END;

GO

PRINT ' 315 of 1510 : Analyzing IX_Analytics_DayHits_HitsStatisticsID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_DayHits_HitsStatisticsID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Analytics_DayHits_HitsStatisticsID]
		ON [dbo].[Analytics_DayHits] ( [HitsStatisticsID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 316 of 1510 : Created [IX_Analytics_DayHits_HitsStatisticsID]';
    END;

GO

PRINT ' 317 of 1510 : Analyzing IX_Forums_ForumGroup_GroupSiteID_GroupOrder';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumGroup_GroupSiteID_GroupOrder') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Forums_ForumGroup_GroupSiteID_GroupOrder]
		 ON [dbo].[Forums_ForumGroup] (  [GroupSiteID]  ASC , [GroupOrder]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 318 of 1510 : Created [IX_Forums_ForumGroup_GroupSiteID_GroupOrder]';
    END;

GO

PRINT ' 319 of 1510 : Analyzing IX_Forums_ForumGroup_GroupSiteID_GroupName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumGroup_GroupSiteID_GroupName') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Forums_ForumGroup_GroupSiteID_GroupName]
		 ON [dbo].[Forums_ForumGroup] (  [GroupSiteID]  ASC , [GroupName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 320 of 1510 : Created [IX_Forums_ForumGroup_GroupSiteID_GroupName]';
    END;

GO

PRINT ' 321 of 1510 : Analyzing IX_Forums_ForumGroup_GroupGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumGroup_GroupGroupID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_ForumGroup_GroupGroupID]
	   ON [dbo].[Forums_ForumGroup] (  [GroupGroupID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 322 of 1510 : Created [IX_Forums_ForumGroup_GroupGroupID]';
    END;

GO

PRINT ' 323 of 1510 : Analyzing IX_TrackerDailySteps_SourceID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_TrackerDailySteps_SourceID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_TrackerDailySteps_SourceID]
	   ON [dbo].[HFit_TrackerDailySteps] ( [TrackerCollectionSourceID]  ASC , [IsProfessionallyCollected]  ASC , [UserID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 324 of 1510 : Created [IX_TrackerDailySteps_SourceID]';
    END;

GO

PRINT ' 325 of 1510 : Analyzing idx_HFit_TrackerDailySteps_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerDailySteps_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerDailySteps_CreateDate]
		ON [dbo].[HFit_TrackerDailySteps] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 326 of 1510 : Created [idx_HFit_TrackerDailySteps_CreateDate]';
    END;

GO

PRINT ' 327 of 1510 : Analyzing IX_Chat_Room_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Chat_Room_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Chat_Room_SiteID]
	   ON [dbo].[Chat_Room] (  [ChatRoomSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 328 of 1510 : Created [IX_Chat_Room_SiteID]';
    END;

GO

PRINT ' 329 of 1510 : Analyzing IX_Chat_Room_Enabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Chat_Room_Enabled') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Chat_Room_Enabled]
	   ON [dbo].[Chat_Room] (  [ChatRoomEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 330 of 1510 : Created [IX_Chat_Room_Enabled]';
    END;

GO

PRINT ' 331 of 1510 : Analyzing IX_Chat_Room_IsSupport';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Chat_Room_IsSupport') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Chat_Room_IsSupport]
	   ON [dbo].[Chat_Room] (  [ChatRoomIsSupport]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 332 of 1510 : Created [IX_Chat_Room_IsSupport]';
    END;

GO

PRINT ' 333 of 1510 : Analyzing idx_HFit_TrackerFruits_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerFruits_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerFruits_CreateDate]
	   ON [dbo].[HFit_TrackerFruits] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 334 of 1510 : Created [idx_HFit_TrackerFruits_CreateDate]';
    END;

GO

PRINT ' 335 of 1510 : Analyzing IX_CMS_RelationshipName_RelationshipName_RelationshipDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_RelationshipName_RelationshipName_RelationshipDisplayName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_RelationshipName_RelationshipName_RelationshipDisplayName]
	   ON [dbo].[CMS_RelationshipName] (  [RelationshipName]  ASC , [RelationshipDisplayName]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 336 of 1510 : Created [IX_CMS_RelationshipName_RelationshipName_RelationshipDisplayName]';
    END;

GO

PRINT ' 337 of 1510 : Analyzing IX_CMS_RelationshipName_RelationshipAllowedObjects';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_RelationshipName_RelationshipAllowedObjects') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_RelationshipName_RelationshipAllowedObjects]
	   ON [dbo].[CMS_RelationshipName] ( [RelationshipAllowedObjects]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 338 of 1510 : Created [IX_CMS_RelationshipName_RelationshipAllowedObjects]';
    END;

GO

PRINT ' 339 of 1510 : Analyzing IX_CMS_UserSettings_UserNickName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserNickName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_UserSettings_UserNickName]
	   ON [dbo].[CMS_UserSettings] (  [UserNickName] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 340 of 1510 : Created [IX_CMS_UserSettings_UserNickName]';
    END;

GO

PRINT ' 341 of 1510 : Analyzing IX_CMS_UserSettings_UserActivatedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserActivatedByUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_UserSettings_UserActivatedByUserID]
		 ON [dbo].[CMS_UserSettings] (  [UserActivatedByUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 342 of 1510 : Created [IX_CMS_UserSettings_UserActivatedByUserID]';
    END;

GO

PRINT ' 343 of 1510 : Analyzing IX_CMS_UserSettings_UserTimeZoneID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserTimeZoneID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_UserSettings_UserTimeZoneID]
		ON [dbo].[CMS_UserSettings] ( [UserTimeZoneID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 344 of 1510 : Created [IX_CMS_UserSettings_UserTimeZoneID]';
    END;

GO

PRINT ' 345 of 1510 : Analyzing IX_CMS_UserSettings_UserAvatarID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserAvatarID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_UserSettings_UserAvatarID]
	   ON [dbo].[CMS_UserSettings] (  [UserAvatarID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 346 of 1510 : Created [IX_CMS_UserSettings_UserAvatarID]';
    END;

GO

PRINT ' 347 of 1510 : Analyzing IX_CMS_UserSettings_UserBadgeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserBadgeID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_UserSettings_UserBadgeID]
	   ON [dbo].[CMS_UserSettings] (  [UserBadgeID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 348 of 1510 : Created [IX_CMS_UserSettings_UserBadgeID]';
    END;

GO

PRINT ' 349 of 1510 : Analyzing IX_CMS_UserSettings_UserGender';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserGender') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_UserSettings_UserGender]
	   ON [dbo].[CMS_UserSettings] (  [UserGender]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 350 of 1510 : Created [IX_CMS_UserSettings_UserGender]';
    END;

GO

PRINT ' 351 of 1510 : Analyzing IX_CMS_UserSettings_UserSettingsUserGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserSettingsUserGUID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_UserSettings_UserSettingsUserGUID]
		ON [dbo].[CMS_UserSettings] ( [UserSettingsUserGUID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 352 of 1510 : Created [IX_CMS_UserSettings_UserSettingsUserGUID]';
    END;

GO

PRINT ' 353 of 1510 : Analyzing IX_CMS_UserSettings_UserSettingsUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserSettingsUserID') --IS NULL
    BEGIN CREATE  UNIQUE NONCLUSTERED INDEX
		[IX_CMS_UserSettings_UserSettingsUserID]
		ON [dbo].[CMS_UserSettings] (  [UserSettingsUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 354 of 1510 : Created [IX_CMS_UserSettings_UserSettingsUserID]';
    END;

GO

PRINT ' 355 of 1510 : Analyzing IX_CMS_UserSettings_WindowsLiveID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_WindowsLiveID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_UserSettings_WindowsLiveID]
	   ON [dbo].[CMS_UserSettings] (  [WindowsLiveID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 356 of 1510 : Created [IX_CMS_UserSettings_WindowsLiveID]';
    END;

GO

PRINT ' 357 of 1510 : Analyzing IX_CMS_UserSettings_UserWaitingForApproval';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserWaitingForApproval') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_UserSettings_UserWaitingForApproval]
		 ON [dbo].[CMS_UserSettings] (  [UserWaitingForApproval]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 358 of 1510 : Created [IX_CMS_UserSettings_UserWaitingForApproval]';
    END;

GO

PRINT ' 359 of 1510 : Analyzing IX_CMS_UserSettings_UserFacebookID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserFacebookID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_UserSettings_UserFacebookID]
		ON [dbo].[CMS_UserSettings] ( [UserFacebookID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 360 of 1510 : Created [IX_CMS_UserSettings_UserFacebookID]';
    END;

GO

PRINT ' 361 of 1510 : Analyzing IX_CMS_UserSettings_UserAuthenticationGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserAuthenticationGUID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_UserSettings_UserAuthenticationGUID]
		 ON [dbo].[CMS_UserSettings] (  [UserAuthenticationGUID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 362 of 1510 : Created [IX_CMS_UserSettings_UserAuthenticationGUID]';
    END;

GO

PRINT ' 363 of 1510 : Analyzing IX_CMS_UserSettings_UserPasswordRequestHash';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSettings_UserPasswordRequestHash') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_UserSettings_UserPasswordRequestHash]
		 ON [dbo].[CMS_UserSettings] (  [UserPasswordRequestHash]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 364 of 1510 : Created [IX_CMS_UserSettings_UserPasswordRequestHash]';
    END;

GO

PRINT ' 365 of 1510 : Analyzing IX_UserSettingsUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_UserSettingsUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_UserSettingsUserID]
	   ON [dbo].[CMS_UserSettings] (  [UserSettingsUserID]  ASC , [UserSettingsID]  ASC) INCLUDE ( [UserNickName]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 366 of 1510 : Created [IX_UserSettingsUserID]';
    END;

GO

PRINT ' 367 of 1510 : Analyzing nonUserIDSetIDDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonUserIDSetIDDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonUserIDSetIDDate]
	   ON [dbo].[CMS_UserSettings] (  [UserSettingsUserID]  ASC , [UserSettingsID] ASC , [HFitCoachingEnrollDate]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 368 of 1510 : Created [nonUserIDSetIDDate]';
    END;

GO

PRINT ' 369 of 1510 : Analyzing pi_CMS_UserSettings_IDMPI';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'pi_CMS_UserSettings_IDMPI') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [pi_CMS_UserSettings_IDMPI]
	   ON [dbo].[CMS_UserSettings] (  [UserSettingsID]  ASC , [HFitUserMpiNumber]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 370 of 1510 : Created [pi_CMS_UserSettings_IDMPI]';
    END;

GO

PRINT ' 371 of 1510 : Analyzing PI02_view_EDW_RewardUserDetail';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI02_view_EDW_RewardUserDetail') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI02_view_EDW_RewardUserDetail]
	   ON [dbo].[CMS_UserSettings] (  [UserSettingsID] ASC , [HFitUserMpiNumber]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 372 of 1510 : Created [PI02_view_EDW_RewardUserDetail]';
    END;

GO

PRINT ' 373 of 1510 : Analyzing IDX_UserSettings_CoachID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_UserSettings_CoachID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IDX_UserSettings_CoachID]
	   ON [dbo].[CMS_UserSettings] (  [HFitCoachId]  ASC) INCLUDE ( [UserSettingsUserID] , [HFitCoachingEnrollDate]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 374 of 1510 : Created [IDX_UserSettings_CoachID]';
    END;

GO

PRINT ' 375 of 1510 : Analyzing IDX_UserSettings_SettingsUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_UserSettings_SettingsUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IDX_UserSettings_SettingsUserID]
	   ON [dbo].[CMS_UserSettings] ( [UserSettingsUserID]  ASC) INCLUDE ( [UserNickName] , [UserGender] , [UserDateOfBirth] , [HFitUserMpiNumber]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 376 of 1510 : Created [IDX_UserSettings_SettingsUserID]';
    END;

GO

PRINT ' 377 of 1510 : Analyzing IX_CMS_SearchIndex_IndexDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_SearchIndex_IndexDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_SearchIndex_IndexDisplayName]
		ON [dbo].[CMS_SearchIndex] ( [IndexDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 378 of 1510 : Created [IX_CMS_SearchIndex_IndexDisplayName]';
    END;

GO

PRINT ' 379 of 1510 : Analyzing idx_HFit_TrackerVegetables_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerVegetables_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerVegetables_CreateDate]
		ON [dbo].[HFit_TrackerVegetables] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 380 of 1510 : Created [idx_HFit_TrackerVegetables_CreateDate]';
    END;

GO

PRINT ' 381 of 1510 : Analyzing HFit_Account_ClientCode_PI';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_Account_ClientCode_PI') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_Account_ClientCode_PI]
	   ON [dbo].[HFit_Account] (  [AccountCD]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 382 of 1510 : Created [HFit_Account_ClientCode_PI]';
    END;

GO

PRINT ' 383 of 1510 : Analyzing HFit_Account_AccountID_CI';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_Account_AccountID_CI') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_Account_AccountID_CI]
	   ON [dbo].[HFit_Account] (  [AccountID]  ASC , [AccountCD] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 384 of 1510 : Created [HFit_Account_AccountID_CI]';
    END;

GO

PRINT ' 385 of 1510 : Analyzing HFit_Account_SiteID_PI';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_Account_SiteID_PI') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_Account_SiteID_PI]
	   ON [dbo].[HFit_Account] (  [SiteID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 386 of 1510 : Created [HFit_Account_SiteID_PI]';
    END;

GO

PRINT ' 387 of 1510 : Analyzing IX_CMS_ObjectSettings_ObjectSettingsObjectType_ObjectSettingsObjectID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ObjectSettings_ObjectSettingsObjectType_ObjectSettingsObjectID') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE NONCLUSTERED INDEX
	   [IX_CMS_ObjectSettings_ObjectSettingsObjectType_ObjectSettingsObjectID]
	   ON [dbo].[CMS_ObjectSettings] (  [ObjectSettingsObjectID]  ASC , [ObjectSettingsObjectType]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 388 of 1510 : Created [IX_CMS_ObjectSettings_ObjectSettingsObjectType_ObjectSettingsObjectID]';
    END;

GO

PRINT ' 389 of 1510 : Analyzing IX_CMS_UICulture_UICultureName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UICulture_UICultureName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_UICulture_UICultureName]
	   ON [dbo].[CMS_UICulture] (  [UICultureName]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 390 of 1510 : Created [IX_CMS_UICulture_UICultureName]';
    END;

GO

PRINT ' 391 of 1510 : Analyzing IX_Events_Attendee_AttendeeEmail_AttendeeFirstName_AttendeeLastName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Events_Attendee_AttendeeEmail_AttendeeFirstName_AttendeeLastName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Events_Attendee_AttendeeEmail_AttendeeFirstName_AttendeeLastName]
	   ON [dbo].[Events_Attendee] (  [AttendeeEmail]  ASC , [AttendeeFirstName]  ASC , [AttendeeLastName]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 392 of 1510 : Created [IX_Events_Attendee_AttendeeEmail_AttendeeFirstName_AttendeeLastName]';
    END;

GO

PRINT ' 393 of 1510 : Analyzing IX_Events_Attendee_AttendeeEventNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Events_Attendee_AttendeeEventNodeID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Events_Attendee_AttendeeEventNodeID]
		ON [dbo].[Events_Attendee] ( [AttendeeEventNodeID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 394 of 1510 : Created [IX_Events_Attendee_AttendeeEventNodeID]';
    END;

GO

PRINT ' 395 of 1510 : Analyzing IX_Polls_PollAnswer_AnswerPollID_AnswerOrder_AnswerEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Polls_PollAnswer_AnswerPollID_AnswerOrder_AnswerEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Polls_PollAnswer_AnswerPollID_AnswerOrder_AnswerEnabled]
	   ON [dbo].[Polls_PollAnswer] ( [AnswerOrder]  ASC , [AnswerPollID]  ASC , [AnswerEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 396 of 1510 : Created [IX_Polls_PollAnswer_AnswerPollID_AnswerOrder_AnswerEnabled]';
    END;

GO

PRINT ' 397 of 1510 : Analyzing IX_CMS_ObjectRelationship_RelationshipLeftObjectType_RelationshipLeftObjectID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ObjectRelationship_RelationshipLeftObjectType_RelationshipLeftObjectID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_ObjectRelationship_RelationshipLeftObjectType_RelationshipLeftObjectID]
		ON [dbo].[CMS_ObjectRelationship] (  [RelationshipLeftObjectType]  ASC , [RelationshipLeftObjectID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 398 of 1510 : Created [IX_CMS_ObjectRelationship_RelationshipLeftObjectType_RelationshipLeftObjectID]';
    END;

GO

PRINT ' 399 of 1510 : Analyzing IX_CMS_ObjectRelationship_RelationshipRightObjectType_RelationshipRightObjectID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ObjectRelationship_RelationshipRightObjectType_RelationshipRightObjectID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_ObjectRelationship_RelationshipRightObjectType_RelationshipRightObjectID]
		ON [dbo].[CMS_ObjectRelationship] (  [RelationshipRightObjectType]  ASC , [RelationshipRightObjectID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 400 of 1510 : Created [IX_CMS_ObjectRelationship_RelationshipRightObjectType_RelationshipRightObjectID]';
    END;

GO

PRINT ' 401 of 1510 : Analyzing idx_HFit_TrackerBMI_UserIDEventDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerBMI_UserIDEventDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerBMI_UserIDEventDate]
		ON [dbo].[HFit_TrackerBMI] (  [UserID] ASC) INCLUDE ( [EventDate]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 402 of 1510 : Created [idx_HFit_TrackerBMI_UserIDEventDate]';
    END;

GO

PRINT ' 403 of 1510 : Analyzing idx_HFit_TrackerBMI_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerBMI_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerBMI_CreateDate]
	   ON [dbo].[HFit_TrackerBMI] (  [ItemCreatedWhen] ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 404 of 1510 : Created [idx_HFit_TrackerBMI_CreateDate]';
    END;

GO

PRINT ' 405 of 1510 : Analyzing IX_Chat_Message_ChatMessageRoomID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Chat_Message_ChatMessageRoomID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Chat_Message_ChatMessageRoomID]
	   ON [dbo].[Chat_Message] (  [ChatMessageRoomID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 406 of 1510 : Created [IX_Chat_Message_ChatMessageRoomID]';
    END;

GO

PRINT ' 407 of 1510 : Analyzing IX_Chat_Message_ChatMessageLastModified';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Chat_Message_ChatMessageLastModified') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Chat_Message_ChatMessageLastModified]
		ON [dbo].[Chat_Message] ( [ChatMessageLastModified]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 408 of 1510 : Created [IX_Chat_Message_ChatMessageLastModified]';
    END;

GO

PRINT ' 409 of 1510 : Analyzing IX_Chat_Message_ChatMessageSystemMessageType';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Chat_Message_ChatMessageSystemMessageType') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Chat_Message_ChatMessageSystemMessageType]
		 ON [dbo].[Chat_Message] (  [ChatMessageSystemMessageType]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 410 of 1510 : Created [IX_Chat_Message_ChatMessageSystemMessageType]';
    END;

GO

PRINT ' 411 of 1510 : Analyzing IX_Messaging_Message_MessageRecipientUserID_MessageSent_MessageRecipientDeleted';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Messaging_Message_MessageRecipientUserID_MessageSent_MessageRecipientDeleted') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_Messaging_Message_MessageRecipientUserID_MessageSent_MessageRecipientDeleted]
		ON [dbo].[Messaging_Message] (  [MessageRecipientUserID]  ASC , [MessageSent] DESC , [MessageRecipientDeleted]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 412 of 1510 : Created [IX_Messaging_Message_MessageRecipientUserID_MessageSent_MessageRecipientDeleted]';
    END;

GO

PRINT ' 413 of 1510 : Analyzing IX_Messaging_Message_MessageSenderUserID_MessageSent_MessageSenderDeleted';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Messaging_Message_MessageSenderUserID_MessageSent_MessageSenderDeleted') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Messaging_Message_MessageSenderUserID_MessageSent_MessageSenderDeleted]
	   ON [dbo].[Messaging_Message] (  [MessageSenderUserID]  ASC , [MessageSent]  ASC , [MessageSenderDeleted] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 414 of 1510 : Created [IX_Messaging_Message_MessageSenderUserID_MessageSent_MessageSenderDeleted]';
    END;

GO

PRINT ' 415 of 1510 : Analyzing IX_Messaging_Message_MessageRecipientUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Messaging_Message_MessageRecipientUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Messaging_Message_MessageRecipientUserID]
		 ON [dbo].[Messaging_Message] (  [MessageRecipientUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 416 of 1510 : Created [IX_Messaging_Message_MessageRecipientUserID]';
    END;

GO

PRINT ' 417 of 1510 : Analyzing IX_Community_Friend_FriendRequestedUserID_FriendStatus';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Friend_FriendRequestedUserID_FriendStatus') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Community_Friend_FriendRequestedUserID_FriendStatus]
	   ON [dbo].[Community_Friend] ( [FriendRequestedUserID]  ASC , [FriendStatus]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 418 of 1510 : Created [IX_Community_Friend_FriendRequestedUserID_FriendStatus]';
    END;

GO

PRINT ' 419 of 1510 : Analyzing IX_Community_Friend_FriendRequestedUserID_FriendUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Friend_FriendRequestedUserID_FriendUserID') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE NONCLUSTERED INDEX
	   [IX_Community_Friend_FriendRequestedUserID_FriendUserID]
	   ON [dbo].[Community_Friend] ( [FriendRequestedUserID]  ASC , [FriendUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 420 of 1510 : Created [IX_Community_Friend_FriendRequestedUserID_FriendUserID]';
    END;

GO

PRINT ' 421 of 1510 : Analyzing IX_Community_Friend_FriendUserID_FriendStatus';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Friend_FriendUserID_FriendStatus') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Community_Friend_FriendUserID_FriendStatus]
		 ON [dbo].[Community_Friend] (  [FriendUserID]  ASC , [FriendStatus]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 422 of 1510 : Created [IX_Community_Friend_FriendUserID_FriendStatus]';
    END;

GO

PRINT ' 423 of 1510 : Analyzing IX_Community_Friend_FriendApprovedBy';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Friend_FriendApprovedBy') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_Friend_FriendApprovedBy]
		ON [dbo].[Community_Friend] ( [FriendApprovedBy]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 424 of 1510 : Created [IX_Community_Friend_FriendApprovedBy]';
    END;

GO

PRINT ' 425 of 1510 : Analyzing IX_Community_Friend_FriendRejectedBy';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Friend_FriendRejectedBy') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_Friend_FriendRejectedBy]
		ON [dbo].[Community_Friend] ( [FriendRejectedBy]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 426 of 1510 : Created [IX_Community_Friend_FriendRejectedBy]';
    END;

GO

PRINT ' 427 of 1510 : Analyzing IX_Hfit_PostSubscriber_ContactGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Hfit_PostSubscriber_ContactGroupID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Hfit_PostSubscriber_ContactGroupID]
		ON [dbo].[HFit_PostSubscriber] ( [ContactGroupID]  ASC) INCLUDE ( [DocumentID] , [ContactID] , [Pinned] , [PublishDate]) WITH ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 428 of 1510 : Created [IX_Hfit_PostSubscriber_ContactGroupID]';
    END;

GO

PRINT ' 429 of 1510 : Analyzing IX_HFit_PostSubscriber_PublishDate_ItemModifiedWhen_ContactID_GroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_PostSubscriber_PublishDate_ItemModifiedWhen_ContactID_GroupID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_HFit_PostSubscriber_PublishDate_ItemModifiedWhen_ContactID_GroupID]
	   ON [dbo].[HFit_PostSubscriber] (  [ItemModifiedWhen]  ASC , [PublishDate]  ASC , [ContactID]  ASC , [ContactGroupID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 430 of 1510 : Created [IX_HFit_PostSubscriber_PublishDate_ItemModifiedWhen_ContactID_GroupID]';
    END;

GO

PRINT ' 431 of 1510 : Analyzing IX_Hfit_PostSubscriber_ContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Hfit_PostSubscriber_ContactID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Hfit_PostSubscriber_ContactID]
	   ON [dbo].[HFit_PostSubscriber] (  [ContactID] ASC) INCLUDE ( [DocumentID] , [Pinned] , [PublishDate]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 432 of 1510 : Created [IX_Hfit_PostSubscriber_ContactID]';
    END;

GO

PRINT ' 433 of 1510 : Analyzing IX_Hfit_PostSubscriber_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Hfit_PostSubscriber_1') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Hfit_PostSubscriber_1]
	   ON [dbo].[HFit_PostSubscriber] (  [DocumentID]  ASC) INCLUDE ( [ContactID] , [Pinned] , [PublishDate]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 434 of 1510 : Created [IX_Hfit_PostSubscriber_1]';
    END;

GO

PRINT ' 435 of 1510 : Analyzing IX_Hfit_PostSubscriber_DocumentID_PublishDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Hfit_PostSubscriber_DocumentID_PublishDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Hfit_PostSubscriber_DocumentID_PublishDate]
		 ON [dbo].[HFit_PostSubscriber] (  [DocumentID]  ASC , [PublishDate]  ASC) INCLUDE ( [ContactID] , [ContactGroupID] , [Pinned]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 436 of 1510 : Created [IX_Hfit_PostSubscriber_DocumentID_PublishDate]';
    END;

GO

PRINT ' 437 of 1510 : Analyzing IX_PostSubscriber_PublishDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PostSubscriber_PublishDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_PostSubscriber_PublishDate]
	   ON [dbo].[HFit_PostSubscriber] (  [PublishDate]  ASC) INCLUDE ( [ContactID] , [ContactGroupID] , [ItemModifiedWhen]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 438 of 1510 : Created [IX_PostSubscriber_PublishDate]';
    END;

GO

PRINT ' 439 of 1510 : Analyzing IX_PostSubscriber_NodeID_ContactGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PostSubscriber_NodeID_ContactGroupID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_PostSubscriber_NodeID_ContactGroupID]
		ON [dbo].[HFit_PostSubscriber] ( [NodeID]  ASC , [ContactGroupID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 440 of 1510 : Created [IX_PostSubscriber_NodeID_ContactGroupID]';
    END;

GO

PRINT ' 441 of 1510 : Analyzing IX_Hfit_PostSubscriber_NodeID_PublishDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Hfit_PostSubscriber_NodeID_PublishDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Hfit_PostSubscriber_NodeID_PublishDate]
		 ON [dbo].[HFit_PostSubscriber] (  [NodeID]  ASC , [PublishDate]  ASC) INCLUDE ( [ContactID] , [ContactGroupID] , [Pinned]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 442 of 1510 : Created [IX_Hfit_PostSubscriber_NodeID_PublishDate]';
    END;

GO

PRINT ' 443 of 1510 : Analyzing IX_CMS_Resource_ResourceDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Resource_ResourceDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_Resource_ResourceDisplayName]
		ON [dbo].[CMS_Resource] ( [ResourceDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 444 of 1510 : Created [IX_CMS_Resource_ResourceDisplayName]';
    END;

GO

PRINT ' 445 of 1510 : Analyzing IX_CMS_Resource_ResourceName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Resource_ResourceName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Resource_ResourceName]
	   ON [dbo].[CMS_Resource] (  [ResourceName]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 446 of 1510 : Created [IX_CMS_Resource_ResourceName]';
    END;

GO

PRINT ' 447 of 1510 : Analyzing IX_Notification_Gateway_GatewayDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Notification_Gateway_GatewayDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Notification_Gateway_GatewayDisplayName]
		 ON [dbo].[Notification_Gateway] (  [GatewayDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 448 of 1510 : Created [IX_Notification_Gateway_GatewayDisplayName]';
    END;

GO

PRINT ' 449 of 1510 : Analyzing IX_Export_History_ExportDateTime';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Export_History_ExportDateTime') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Export_History_ExportDateTime]
	   ON [dbo].[Export_History] (  [ExportDateTime] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 450 of 1510 : Created [IX_Export_History_ExportDateTime]';
    END;

GO

PRINT ' 451 of 1510 : Analyzing IX_Export_History_ExportSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Export_History_ExportSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Export_History_ExportSiteID]
	   ON [dbo].[Export_History] (  [ExportSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 452 of 1510 : Created [IX_Export_History_ExportSiteID]';
    END;

GO

PRINT ' 453 of 1510 : Analyzing IX_Export_History_ExportUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Export_History_ExportUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Export_History_ExportUserID]
	   ON [dbo].[Export_History] (  [ExportUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 454 of 1510 : Created [IX_Export_History_ExportUserID]';
    END;

GO

PRINT ' 455 of 1510 : Analyzing IX_Polls_Poll_PollSiteID_PollDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Polls_Poll_PollSiteID_PollDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_Polls_Poll_PollSiteID_PollDisplayName]
		ON [dbo].[Polls_Poll] (  [PollSiteID] ASC , [PollDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 456 of 1510 : Created [IX_Polls_Poll_PollSiteID_PollDisplayName]';
    END;

GO

PRINT ' 457 of 1510 : Analyzing IX_Polls_Poll_PollSiteID_PollCodeName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Polls_Poll_PollSiteID_PollCodeName') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Polls_Poll_PollSiteID_PollCodeName]
		ON [dbo].[Polls_Poll] (  [PollSiteID] ASC , [PollCodeName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 458 of 1510 : Created [IX_Polls_Poll_PollSiteID_PollCodeName]';
    END;

GO

PRINT ' 459 of 1510 : Analyzing IX_Polls_Poll_PollGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Polls_Poll_PollGroupID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Polls_Poll_PollGroupID]
	   ON [dbo].[Polls_Poll] (  [PollGroupID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 460 of 1510 : Created [IX_Polls_Poll_PollGroupID]';
    END;

GO

PRINT ' 461 of 1510 : Analyzing IX_HFit_SSISLoadDetail_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_SSISLoadDetail_1') 
    AND EXISTS (Select name 
				from sys.tables 
				where name = 'HFit_SSISLoadDetail')
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_HFit_SSISLoadDetail_1]
	   ON [dbo].[HFit_SSISLoadDetail] (  [SSISLoadID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 462 of 1510 : Created [IX_HFit_SSISLoadDetail_1]';
    END;

GO

PRINT ' 463 of 1510 : Analyzing IX_Community_GroupMember_MemberJoined';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_GroupMember_MemberJoined') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_Community_GroupMember_MemberJoined]
		ON [dbo].[Community_GroupMember] ( [MemberJoined] DESC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 464 of 1510 : Created [IX_Community_GroupMember_MemberJoined]';
    END;

GO

PRINT ' 465 of 1510 : Analyzing IX_Community_GroupMember_MemberUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_GroupMember_MemberUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_GroupMember_MemberUserID]
		ON [dbo].[Community_GroupMember] ( [MemberUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 466 of 1510 : Created [IX_Community_GroupMember_MemberUserID]';
    END;

GO

PRINT ' 467 of 1510 : Analyzing IX_Community_GroupMember_MemberGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_GroupMember_MemberGroupID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_GroupMember_MemberGroupID]
		ON [dbo].[Community_GroupMember] (  [MemberGroupID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 468 of 1510 : Created [IX_Community_GroupMember_MemberGroupID]';
    END;

GO

PRINT ' 469 of 1510 : Analyzing IX_Community_GroupMember_MemberApprovedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_GroupMember_MemberApprovedByUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Community_GroupMember_MemberApprovedByUserID]
		 ON [dbo].[Community_GroupMember] (  [MemberApprovedByUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 470 of 1510 : Created [IX_Community_GroupMember_MemberApprovedByUserID]';
    END;

GO

PRINT ' 471 of 1510 : Analyzing IX_Community_GroupMember_MemberInvitedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_GroupMember_MemberInvitedByUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Community_GroupMember_MemberInvitedByUserID]
		 ON [dbo].[Community_GroupMember] (  [MemberInvitedByUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 472 of 1510 : Created [IX_Community_GroupMember_MemberInvitedByUserID]';
    END;

GO

PRINT ' 473 of 1510 : Analyzing IX_Community_GroupMember_MemberStatus';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_GroupMember_MemberStatus') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_GroupMember_MemberStatus]
		ON [dbo].[Community_GroupMember] ( [MemberStatus]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 474 of 1510 : Created [IX_Community_GroupMember_MemberStatus]';
    END;

GO

PRINT ' 475 of 1510 : Analyzing IX_COM_CurrencyExchangeRate_ExchangeRateToCurrencyID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_CurrencyExchangeRate_ExchangeRateToCurrencyID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_CurrencyExchangeRate_ExchangeRateToCurrencyID]
	   ON [dbo].[COM_CurrencyExchangeRate] ( [ExchangeRateToCurrencyID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 476 of 1510 : Created [IX_COM_CurrencyExchangeRate_ExchangeRateToCurrencyID]';
    END;

GO

PRINT ' 477 of 1510 : Analyzing IX_COM_CurrencyExchangeRate_ExchangeTableID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_CurrencyExchangeRate_ExchangeTableID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_CurrencyExchangeRate_ExchangeTableID]
		 ON [dbo].[COM_CurrencyExchangeRate] (  [ExchangeTableID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 478 of 1510 : Created [IX_COM_CurrencyExchangeRate_ExchangeTableID]';
    END;

GO

GO
PRINT ' 479 of 1510 : Analyzing IX_Reporting_ReportCategory_CategoryPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportCategory_CategoryPath') --IS NULL
    BEGIN CREATE  UNIQUE CLUSTERED INDEX
		[IX_Reporting_ReportCategory_CategoryPath]
		ON [dbo].[Reporting_ReportCategory] (  [CategoryPath]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 480 of 1510 : Created [IX_Reporting_ReportCategory_CategoryPath]';
    END;

GO

PRINT ' 481 of 1510 : Analyzing IX_Reporting_ReportCategory_CategoryParentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportCategory_CategoryParentID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Reporting_ReportCategory_CategoryParentID]
		 ON [dbo].[Reporting_ReportCategory] (  [CategoryParentID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 482 of 1510 : Created [IX_Reporting_ReportCategory_CategoryParentID]';
    END;

GO

PRINT ' 483 of 1510 : Analyzing IX_PM_ProjectTask_ProjectTaskProjectID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_ProjectTask_ProjectTaskProjectID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_PM_ProjectTask_ProjectTaskProjectID]
		ON [dbo].[PM_ProjectTask] ( [ProjectTaskProjectID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 484 of 1510 : Created [IX_PM_ProjectTask_ProjectTaskProjectID]';
    END;

GO

PRINT ' 485 of 1510 : Analyzing IX_PM_ProjectTask_ProjectTaskStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_ProjectTask_ProjectTaskStatusID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_PM_ProjectTask_ProjectTaskStatusID]
		ON [dbo].[PM_ProjectTask] ( [ProjectTaskStatusID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 486 of 1510 : Created [IX_PM_ProjectTask_ProjectTaskStatusID]';
    END;

GO

PRINT ' 487 of 1510 : Analyzing IX_PM_ProjectTask_ProjectTaskPriorityID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_ProjectTask_ProjectTaskPriorityID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_PM_ProjectTask_ProjectTaskPriorityID]
		ON [dbo].[PM_ProjectTask] ( [ProjectTaskPriorityID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 488 of 1510 : Created [IX_PM_ProjectTask_ProjectTaskPriorityID]';
    END;

GO

PRINT ' 489 of 1510 : Analyzing IX_PM_ProjectTask_ProjectTaskOwnerID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_ProjectTask_ProjectTaskOwnerID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_PM_ProjectTask_ProjectTaskOwnerID]
		ON [dbo].[PM_ProjectTask] ( [ProjectTaskOwnerID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 490 of 1510 : Created [IX_PM_ProjectTask_ProjectTaskOwnerID]';
    END;

GO

PRINT ' 491 of 1510 : Analyzing IX_PM_ProjectTask_ProjectTaskAssignedToUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_ProjectTask_ProjectTaskAssignedToUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_PM_ProjectTask_ProjectTaskAssignedToUserID]
		 ON [dbo].[PM_ProjectTask] (  [ProjectTaskAssignedToUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 492 of 1510 : Created [IX_PM_ProjectTask_ProjectTaskAssignedToUserID]';
    END;

GO

GO
PRINT ' 493 of 1510 : Analyzing PI_HFIT_Tracker_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerFlexibility_LastUpdate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_HFit_TrackerFlexibility_LastUpdate]
	   ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen] ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 494 of 1510 : Created [PI_HFit_TrackerFlexibility_LastUpdate]';
    END;

GO

PRINT ' 495 of 1510 : Analyzing PI_HFit_TrackerBloodPressure_LastUpdate';
GO

--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerBloodPressure_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerBloodPressure_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 496 of 1510 : Created [PI_HFit_TrackerBloodPressure_LastUpdate]';
--    END;
--GO
--PRINT (' 497 of 1510 : Analyzing PI_HFit_TrackerBloodSugarAndGlucose_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerBloodSugarAndGlucose_LastUpdate') --IS NULL
--    BEGIN  CREATE NONCLUSTERED INDEX
--		 [PI_HFit_TrackerBloodSugarAndGlucose_LastUpdate]
--		 ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		 WITH
--		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 498 of 1510 : Created [PI_HFit_TrackerBloodSugarAndGlucose_LastUpdate]';
--    END;
--GO
--PRINT (' 499 of 1510 : Analyzing PI_HFit_TrackerBMI_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerBMI_LastUpdate') 
----IS NULL
--    BEGIN
--	   CREATE NONCLUSTERED INDEX
--	   [PI_HFit_TrackerBMI_LastUpdate]
--	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--	   WITH
--	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 500 of 1510 : Created [PI_HFit_TrackerBMI_LastUpdate]';
--    END;
--GO
--PRINT (' 501 of 1510 : Analyzing PI_HFit_TrackerBodyFat_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerBodyFat_LastUpdate') 
----IS NULL
--    BEGIN
--	   CREATE NONCLUSTERED INDEX
--	   [PI_HFit_TrackerBodyFat_LastUpdate]
--	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--	   WITH
--	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 502 of 1510 : Created [PI_HFit_TrackerBodyFat_LastUpdate]';
--    END;
--GO
--PRINT (' 503 of 1510 : Analyzing PI_HFit_TrackerBodyMeasurements_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerBodyMeasurements_LastUpdate') --IS NULL
--    BEGIN  CREATE NONCLUSTERED INDEX
--		 [PI_HFit_TrackerBodyMeasurements_LastUpdate]
--		 ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		 WITH
--		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 504 of 1510 : Created [PI_HFit_TrackerBodyMeasurements_LastUpdate]';
--    END;
--GO
--PRINT (' 505 of 1510 : Analyzing PI_HFit_TrackerCardio_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerCardio_LastUpdate') 
----IS NULL
--    BEGIN
--	   CREATE NONCLUSTERED INDEX
--	   [PI_HFit_TrackerCardio_LastUpdate]
--	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--	   WITH
--	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 506 of 1510 : Created [PI_HFit_TrackerCardio_LastUpdate]';
--    END;
--GO
--PRINT (' 507 of 1510 : Analyzing PI_HFit_TrackerCategory_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerCategory_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerCategory_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 508 of 1510 : Created [PI_HFit_TrackerCategory_LastUpdate]';
--    END;
--GO
--PRINT (' 509 of 1510 : Analyzing PI_HFit_TrackerCholesterol_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerCholesterol_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerCholesterol_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 510 of 1510 : Created [PI_HFit_TrackerCholesterol_LastUpdate]';
--    END;
--GO
--PRINT (' 511 of 1510 : Analyzing PI_HFit_TrackerCollectionSource_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerCollectionSource_LastUpdate') --IS NULL
--    BEGIN  CREATE NONCLUSTERED INDEX
--		 [PI_HFit_TrackerCollectionSource_LastUpdate]
--		 ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		 WITH
--		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 512 of 1510 : Created [PI_HFit_TrackerCollectionSource_LastUpdate]';
--    END;
--GO
--PRINT (' 513 of 1510 : Analyzing PI_HFit_TrackerDailySteps_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerDailySteps_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerDailySteps_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 514 of 1510 : Created [PI_HFit_TrackerDailySteps_LastUpdate]';
--    END;
--GO
--PRINT (' 515 of 1510 : Analyzing PI_HFit_TrackerDef_Item_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerDef_Item_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerDef_Item_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 516 of 1510 : Created [PI_HFit_TrackerDef_Item_LastUpdate]';
--    END;
--GO
--PRINT (' 517 of 1510 : Analyzing PI_HFit_TrackerDef_Tracker_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerDef_Tracker_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerDef_Tracker_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 518 of 1510 : Created [PI_HFit_TrackerDef_Tracker_LastUpdate]';
--    END;
--GO
--PRINT (' 519 of 1510 : Analyzing PI_HFit_TrackerDocument_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerDocument_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerDocument_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 520 of 1510 : Created [PI_HFit_TrackerDocument_LastUpdate]';
--    END;
--GO
--PRINT (' 521 of 1510 : Analyzing PI_HFit_TrackerFlexibility_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerFlexibility_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerFlexibility_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 522 of 1510 : Created [PI_HFit_TrackerFlexibility_LastUpdate]';
--    END;
--GO
--PRINT (' 523 of 1510 : Analyzing PI_HFit_TrackerFruits_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerFruits_LastUpdate') 
----IS NULL
--    BEGIN
--	   CREATE NONCLUSTERED INDEX
--	   [PI_HFit_TrackerFruits_LastUpdate]
--	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--	   WITH
--	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 524 of 1510 : Created [PI_HFit_TrackerFruits_LastUpdate]';
--    END;
--GO
--PRINT (' 525 of 1510 : Analyzing PI_HFit_TrackerHbA1c_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerHbA1c_LastUpdate') 
----IS NULL
--    BEGIN
--	   CREATE NONCLUSTERED INDEX
--	   [PI_HFit_TrackerHbA1c_LastUpdate]
--	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--	   WITH
--	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 526 of 1510 : Created [PI_HFit_TrackerHbA1c_LastUpdate]';
--    END;
--GO
--PRINT (' 527 of 1510 : Analyzing PI_HFit_TrackerHeight_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerHeight_LastUpdate') 
----IS NULL
--    BEGIN
--	   CREATE NONCLUSTERED INDEX
--	   [PI_HFit_TrackerHeight_LastUpdate]
--	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--	   WITH
--	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 528 of 1510 : Created [PI_HFit_TrackerHeight_LastUpdate]';
--    END;
--GO
--PRINT (' 529 of 1510 : Analyzing PI_HFit_TrackerHighFatFoods_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerHighFatFoods_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerHighFatFoods_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 530 of 1510 : Created [PI_HFit_TrackerHighFatFoods_LastUpdate]';
--    END;
--GO
--PRINT (' 531 of 1510 : Analyzing PI_HFit_TrackerHighSodiumFoods_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerHighSodiumFoods_LastUpdate') --IS NULL
--    BEGIN  CREATE NONCLUSTERED INDEX
--		 [PI_HFit_TrackerHighSodiumFoods_LastUpdate]
--		 ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		 WITH
--		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 532 of 1510 : Created [PI_HFit_TrackerHighSodiumFoods_LastUpdate]';
--    END;
--GO
--PRINT (' 533 of 1510 : Analyzing PI_HFit_TrackerInstance_Item_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerInstance_Item_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerInstance_Item_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 534 of 1510 : Created [PI_HFit_TrackerInstance_Item_LastUpdate]';
--    END;
--GO
--PRINT (' 535 of 1510 : Analyzing PI_HFit_TrackerInstance_Tracker_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerInstance_Tracker_LastUpdate') --IS NULL
--    BEGIN  CREATE NONCLUSTERED INDEX
--		 [PI_HFit_TrackerInstance_Tracker_LastUpdate]
--		 ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		 WITH
--		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 536 of 1510 : Created [PI_HFit_TrackerInstance_Tracker_LastUpdate]';
--    END;
--GO
--PRINT (' 537 of 1510 : Analyzing PI_HFit_TrackerMealPortions_LastUpdate');
--GO
--If NOT EXISTS (Select Name
--	 FROM [sys].[Indexes]
--	 WHERE [Name] = 'PI_HFit_TrackerMealPortions_LastUpdate') --IS NULL
--    BEGIN CREATE NONCLUSTERED INDEX
--		[PI_HFit_TrackerMealPortions_LastUpdate]
--		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
--		WITH
--		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
--	   PRINT ' 538 of 1510 : Created [PI_HFit_TrackerMealPortions_LastUpdate]';
--    END;
--GO
PRINT ' 539 of 1510 : Analyzing PI_HFit_TrackerMedicalCarePlan_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerMedicalCarePlan_LastUpdate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [PI_HFit_TrackerMedicalCarePlan_LastUpdate]
		 ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 540 of 1510 : Created [PI_HFit_TrackerMedicalCarePlan_LastUpdate]';
    END;

GO

PRINT ' 541 of 1510 : Analyzing PI_HFit_TrackerRegularMeals_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerRegularMeals_LastUpdate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_TrackerRegularMeals_LastUpdate]
		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 542 of 1510 : Created [PI_HFit_TrackerRegularMeals_LastUpdate]';
    END;

GO

PRINT ' 543 of 1510 : Analyzing PI_HFit_TrackerRestingHeartRate_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerRestingHeartRate_LastUpdate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [PI_HFit_TrackerRestingHeartRate_LastUpdate]
		 ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 544 of 1510 : Created [PI_HFit_TrackerRestingHeartRate_LastUpdate]';
    END;

GO

PRINT ' 545 of 1510 : Analyzing PI_HFit_TrackerShots_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerShots_LastUpdate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_HFit_TrackerShots_LastUpdate]
	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 546 of 1510 : Created [PI_HFit_TrackerShots_LastUpdate]';
    END;

GO

PRINT ' 547 of 1510 : Analyzing PI_HFit_TrackerSitLess_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerSitLess_LastUpdate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_HFit_TrackerSitLess_LastUpdate]
	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 548 of 1510 : Created [PI_HFit_TrackerSitLess_LastUpdate]';
    END;

GO

PRINT ' 549 of 1510 : Analyzing PI_HFit_TrackerSleepPlan_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerSleepPlan_LastUpdate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_TrackerSleepPlan_LastUpdate]
		ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 550 of 1510 : Created [PI_HFit_TrackerSleepPlan_LastUpdate]';
    END;

GO

PRINT ' 551 of 1510 : Analyzing PI_HFit_TrackerStrength_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerStrength_LastUpdate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_TrackerStrength_LastUpdate]
		ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 552 of 1510 : Created [PI_HFit_TrackerStrength_LastUpdate]';
    END;

GO

PRINT ' 553 of 1510 : Analyzing PI_HFit_TrackerStress_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerStress_LastUpdate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_HFit_TrackerStress_LastUpdate]
	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 554 of 1510 : Created [PI_HFit_TrackerStress_LastUpdate]';
    END;

GO

PRINT ' 555 of 1510 : Analyzing PI_HFit_TrackerStressManagement_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerStressManagement_LastUpdate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [PI_HFit_TrackerStressManagement_LastUpdate]
		 ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 556 of 1510 : Created [PI_HFit_TrackerStressManagement_LastUpdate]';
    END;

GO

PRINT ' 557 of 1510 : Analyzing PI_HFit_TrackerSugaryDrinks_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerSugaryDrinks_LastUpdate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_TrackerSugaryDrinks_LastUpdate]
		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 558 of 1510 : Created [PI_HFit_TrackerSugaryDrinks_LastUpdate]';
    END;

GO

PRINT ' 559 of 1510 : Analyzing PI_HFit_TrackerSugaryFoods_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerSugaryFoods_LastUpdate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_TrackerSugaryFoods_LastUpdate]
		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 560 of 1510 : Created [PI_HFit_TrackerSugaryFoods_LastUpdate]';
    END;

GO

PRINT ' 561 of 1510 : Analyzing PI_HFit_TrackerSummary_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerSummary_LastUpdate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_HFit_TrackerSummary_LastUpdate]
	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 562 of 1510 : Created [PI_HFit_TrackerSummary_LastUpdate]';
    END;

GO

PRINT ' 563 of 1510 : Analyzing PI_HFit_TrackerTests_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerTests_LastUpdate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_HFit_TrackerTests_LastUpdate]
	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 564 of 1510 : Created [PI_HFit_TrackerTests_LastUpdate]';
    END;

GO

PRINT ' 565 of 1510 : Analyzing PI_HFit_TrackerTobaccoFree_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerTobaccoFree_LastUpdate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_TrackerTobaccoFree_LastUpdate]
		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 566 of 1510 : Created [PI_HFit_TrackerTobaccoFree_LastUpdate]';
    END;

GO

PRINT ' 567 of 1510 : Analyzing PI_HFit_TrackerVegetables_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerVegetables_LastUpdate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_TrackerVegetables_LastUpdate]
		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 568 of 1510 : Created [PI_HFit_TrackerVegetables_LastUpdate]';
    END;

GO

PRINT ' 569 of 1510 : Analyzing PI_HFit_TrackerWater_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerWater_LastUpdate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_HFit_TrackerWater_LastUpdate]
	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 570 of 1510 : Created [PI_HFit_TrackerWater_LastUpdate]';
    END;

GO

PRINT ' 571 of 1510 : Analyzing PI_HFit_TrackerWeight_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerWeight_LastUpdate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_HFit_TrackerWeight_LastUpdate]
	   ON [dbo].[HFit_TrackerFlexibility] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 572 of 1510 : Created [PI_HFit_TrackerWeight_LastUpdate]';
    END;

GO

PRINT ' 573 of 1510 : Analyzing PI_HFit_TrackerWholeGrains_LastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_TrackerWholeGrains_LastUpdate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_TrackerWholeGrains_LastUpdate]
		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 574 of 1510 : Created [PI_HFit_TrackerWholeGrains_LastUpdate]';
    END;

GO

PRINT ' 575 of 1510 : Analyzing idx_HFit_TrackerFlexibility_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerFlexibility_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerFlexibility_CreateDate]
		ON [dbo].[HFit_TrackerFlexibility] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 576 of 1510 : Created [idx_HFit_TrackerFlexibility_CreateDate]';
    END;

GO

PRINT ' 577 of 1510 : Analyzing IX_Community_Group_GroupDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Group_GroupDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_Community_Group_GroupDisplayName]
		ON [dbo].[Community_Group] ( [GroupSiteID]  ASC , [GroupDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 578 of 1510 : Created [IX_Community_Group_GroupDisplayName]';
    END;

GO

PRINT ' 579 of 1510 : Analyzing IX_Community_Group_GroupSiteID_GroupName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Group_GroupSiteID_GroupName') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_Group_GroupSiteID_GroupName]
		ON [dbo].[Community_Group] ( [GroupSiteID]  ASC , [GroupName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 580 of 1510 : Created [IX_Community_Group_GroupSiteID_GroupName]';
    END;

GO

PRINT ' 581 of 1510 : Analyzing IX_Community_Group_GroupCreatedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Group_GroupCreatedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_Group_GroupCreatedByUserID]
		ON [dbo].[Community_Group] ( [GroupCreatedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 582 of 1510 : Created [IX_Community_Group_GroupCreatedByUserID]';
    END;

GO

PRINT ' 583 of 1510 : Analyzing IX_Community_Group_GroupApprovedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Group_GroupApprovedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_Group_GroupApprovedByUserID]
		ON [dbo].[Community_Group] ( [GroupApprovedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 584 of 1510 : Created [IX_Community_Group_GroupApprovedByUserID]';
    END;

GO

PRINT ' 585 of 1510 : Analyzing IX_Community_Group_GroupAvatarID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Group_GroupAvatarID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Community_Group_GroupAvatarID]
	   ON [dbo].[Community_Group] (  [GroupAvatarID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 586 of 1510 : Created [IX_Community_Group_GroupAvatarID]';
    END;

GO

PRINT ' 587 of 1510 : Analyzing IX_Community_Group_GroupApproved';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Group_GroupApproved') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Community_Group_GroupApproved]
	   ON [dbo].[Community_Group] (  [GroupApproved] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 588 of 1510 : Created [IX_Community_Group_GroupApproved]';
    END;

GO

PRINT ' 589 of 1510 : Analyzing IX_Reporting_ReportSubscription_ReportSubscriptionReportID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportSubscription_ReportSubscriptionReportID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Reporting_ReportSubscription_ReportSubscriptionReportID]
	   ON [dbo].[Reporting_ReportSubscription] (  [ReportSubscriptionReportID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 590 of 1510 : Created [IX_Reporting_ReportSubscription_ReportSubscriptionReportID]';
    END;

GO

PRINT ' 591 of 1510 : Analyzing IX_Reporting_ReportSubscription_ReportSubscriptionGraphID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportSubscription_ReportSubscriptionGraphID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Reporting_ReportSubscription_ReportSubscriptionGraphID]
	   ON [dbo].[Reporting_ReportSubscription] (  [ReportSubscriptionGraphID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 592 of 1510 : Created [IX_Reporting_ReportSubscription_ReportSubscriptionGraphID]';
    END;

GO

PRINT ' 593 of 1510 : Analyzing IX_Reporting_ReportSubscription_ReportSubscriptionTableID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportSubscription_ReportSubscriptionTableID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Reporting_ReportSubscription_ReportSubscriptionTableID]
	   ON [dbo].[Reporting_ReportSubscription] (  [ReportSubscriptionTableID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 594 of 1510 : Created [IX_Reporting_ReportSubscription_ReportSubscriptionTableID]';
    END;

GO

PRINT ' 595 of 1510 : Analyzing IX_Reporting_ReportSubscription_ReportSubscriptionValueID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportSubscription_ReportSubscriptionValueID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Reporting_ReportSubscription_ReportSubscriptionValueID]
	   ON [dbo].[Reporting_ReportSubscription] (  [ReportSubscriptionValueID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 596 of 1510 : Created [IX_Reporting_ReportSubscription_ReportSubscriptionValueID]';
    END;

GO

PRINT ' 597 of 1510 : Analyzing IX_Reporting_ReportSubscription_ReportSubscriptionSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportSubscription_ReportSubscriptionSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Reporting_ReportSubscription_ReportSubscriptionSiteID]
	   ON [dbo].[Reporting_ReportSubscription] ( [ReportSubscriptionSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 598 of 1510 : Created [IX_Reporting_ReportSubscription_ReportSubscriptionSiteID]';
    END;

GO

PRINT ' 599 of 1510 : Analyzing IX_CMS_TranslationSubmission';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_TranslationSubmission') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_TranslationSubmission]
	   ON [dbo].[CMS_TranslationSubmission] ( [SubmissionID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 600 of 1510 : Created [IX_CMS_TranslationSubmission]';
    END;

GO

PRINT ' 601 of 1510 : Analyzing IX_CMS_TimeZone_TimeZoneDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_TimeZone_TimeZoneDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_TimeZone_TimeZoneDisplayName]
		ON [dbo].[CMS_TimeZone] ( [TimeZoneDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 602 of 1510 : Created [IX_CMS_TimeZone_TimeZoneDisplayName]';
    END;

GO

PRINT ' 603 of 1510 : Analyzing IX_CMS_WebPartCategory_CategoryPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPartCategory_CategoryPath') --IS NULL
    BEGIN CREATE  UNIQUE CLUSTERED INDEX
		[IX_CMS_WebPartCategory_CategoryPath]
		ON [dbo].[CMS_WebPartCategory] (  [CategoryPath]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 604 of 1510 : Created [IX_CMS_WebPartCategory_CategoryPath]';
    END;

GO

PRINT ' 605 of 1510 : Analyzing IX_CMS_WebPartCategory_CategoryParentID_CategoryOrder';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPartCategory_CategoryParentID_CategoryOrder') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WebPartCategory_CategoryParentID_CategoryOrder]
	   ON [dbo].[CMS_WebPartCategory] ( [CategoryParentID]  ASC , [CategoryOrder]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 606 of 1510 : Created [IX_CMS_WebPartCategory_CategoryParentID_CategoryOrder]';
    END;

GO

GO
PRINT ' 607 of 1510 : Analyzing IX_PM_Project_ProjectNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_Project_ProjectNodeID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_PM_Project_ProjectNodeID]
	   ON [dbo].[PM_Project] (  [ProjectNodeID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 608 of 1510 : Created [IX_PM_Project_ProjectNodeID]';
    END;

GO

PRINT ' 609 of 1510 : Analyzing IX_PM_Project_ProjectGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_Project_ProjectGroupID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_PM_Project_ProjectGroupID]
	   ON [dbo].[PM_Project] (  [ProjectGroupID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 610 of 1510 : Created [IX_PM_Project_ProjectGroupID]';
    END;

GO

PRINT ' 611 of 1510 : Analyzing IX_PM_Project_ProjectOwner';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_Project_ProjectOwner') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_PM_Project_ProjectOwner]
	   ON [dbo].[PM_Project] (  [ProjectOwner]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 612 of 1510 : Created [IX_PM_Project_ProjectOwner]';
    END;

GO

PRINT ' 613 of 1510 : Analyzing IX_PM_Project_ProjectStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_Project_ProjectStatusID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_PM_Project_ProjectStatusID]
	   ON [dbo].[PM_Project] (  [ProjectStatusID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 614 of 1510 : Created [IX_PM_Project_ProjectStatusID]';
    END;

GO

PRINT ' 615 of 1510 : Analyzing IX_PM_Project_ProjectSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_PM_Project_ProjectSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_PM_Project_ProjectSiteID]
	   ON [dbo].[PM_Project] (  [ProjectSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 616 of 1510 : Created [IX_PM_Project_ProjectSiteID]';
    END;

GO

PRINT ' 617 of 1510 : Analyzing IX_Blog_Comment_CommentDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Blog_Comment_CommentDate') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Blog_Comment_CommentDate]
	   ON [dbo].[Blog_Comment] (  [CommentDate] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 618 of 1510 : Created [IX_Blog_Comment_CommentDate]';
    END;

GO

PRINT ' 619 of 1510 : Analyzing IX_Blog_Comment_CommentUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Blog_Comment_CommentUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Blog_Comment_CommentUserID]
	   ON [dbo].[Blog_Comment] (  [CommentUserID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 620 of 1510 : Created [IX_Blog_Comment_CommentUserID]';
    END;

GO

PRINT ' 621 of 1510 : Analyzing IX_Blog_Comment_CommentApprovedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Blog_Comment_CommentApprovedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Blog_Comment_CommentApprovedByUserID]
		ON [dbo].[Blog_Comment] ( [CommentApprovedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 622 of 1510 : Created [IX_Blog_Comment_CommentApprovedByUserID]';
    END;

GO

PRINT ' 623 of 1510 : Analyzing IX_Blog_Comment_CommentPostDocumentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Blog_Comment_CommentPostDocumentID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Blog_Comment_CommentPostDocumentID]
		ON [dbo].[Blog_Comment] ( [CommentPostDocumentID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 624 of 1510 : Created [IX_Blog_Comment_CommentPostDocumentID]';
    END;

GO

PRINT ' 625 of 1510 : Analyzing IX_Blog_Comment_CommentIsSpam_CommentIsApproved_CommentIsTrackback';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Blog_Comment_CommentIsSpam_CommentIsApproved_CommentIsTrackback') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Blog_Comment_CommentIsSpam_CommentIsApproved_CommentIsTrackback]
	   ON [dbo].[Blog_Comment] (  [CommentIsSpam]  ASC , [CommentApproved]  ASC , [CommentIsTrackBack]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 626 of 1510 : Created [IX_Blog_Comment_CommentIsSpam_CommentIsApproved_CommentIsTrackback]';
    END;

GO

PRINT ' 627 of 1510 : Analyzing IX_Forums_UserFavorites_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_UserFavorites_UserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_UserFavorites_UserID]
	   ON [dbo].[Forums_UserFavorites] (  [UserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 628 of 1510 : Created [IX_Forums_UserFavorites_UserID]';
    END;

GO

PRINT ' 629 of 1510 : Analyzing IX_Forums_UserFavorites_UserID_PostID_ForumID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_UserFavorites_UserID_PostID_ForumID') --IS NULL
    BEGIN  CREATE  UNIQUE NONCLUSTERED INDEX
		 [IX_Forums_UserFavorites_UserID_PostID_ForumID]
		 ON [dbo].[Forums_UserFavorites] (  [UserID]  ASC , [PostID]  ASC , [ForumID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 630 of 1510 : Created [IX_Forums_UserFavorites_UserID_PostID_ForumID]';
    END;

GO

PRINT ' 631 of 1510 : Analyzing IX_Forums_UserFavorites_PostID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_UserFavorites_PostID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_UserFavorites_PostID]
	   ON [dbo].[Forums_UserFavorites] (  [PostID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 632 of 1510 : Created [IX_Forums_UserFavorites_PostID]';
    END;

GO

PRINT ' 633 of 1510 : Analyzing IX_Forums_UserFavorites_ForumID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_UserFavorites_ForumID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_UserFavorites_ForumID]
	   ON [dbo].[Forums_UserFavorites] (  [ForumID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 634 of 1510 : Created [IX_Forums_UserFavorites_ForumID]';
    END;

GO

PRINT ' 635 of 1510 : Analyzing IX_Forums_UserFavorites_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_UserFavorites_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_UserFavorites_SiteID]
	   ON [dbo].[Forums_UserFavorites] (  [SiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 636 of 1510 : Created [IX_Forums_UserFavorites_SiteID]';
    END;

GO

PRINT ' 637 of 1510 : Analyzing IX_HFit_HealthAssessmentImportStagingDetail_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_HealthAssessmentImportStagingDetail_1') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_HFit_HealthAssessmentImportStagingDetail_1]
		 ON [dbo].[HFit_HealthAssessmentImportStagingDetail] (  [MasterID]  ASC , [CodeNameType]  ASC) INCLUDE ([QuestionCodeName] , [AnswerValue] , [AnswerCodeName] , [IsProfessionallyCollected] , Timestamp) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 638 of 1510 : Created [IX_HFit_HealthAssessmentImportStagingDetail_1]';
    END;

GO

PRINT ' 639 of 1510 : Analyzing IX_HFit_HealthAssessmentImportStagingDetail_2';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_HealthAssessmentImportStagingDetail_2') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_HFit_HealthAssessmentImportStagingDetail_2]
		 ON [dbo].[HFit_HealthAssessmentImportStagingDetail] (  [CodeNameType]  ASC , [QuestionCodeName]  ASC , [IsProfessionallyCollected]  ASC) INCLUDE ( [MasterID] , [AnswerValue] , Timestamp) WITH ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 640 of 1510 : Created [IX_HFit_HealthAssessmentImportStagingDetail_2]';
    END;

GO

PRINT ' 641 of 1510 : Analyzing IX_CMS_Category_CategoryDisplayName_CategoryEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Category_CategoryDisplayName_CategoryEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Category_CategoryDisplayName_CategoryEnabled]
	   ON [dbo].[CMS_Category] (  [CategoryDisplayName] ASC , [CategoryEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 642 of 1510 : Created [IX_CMS_Category_CategoryDisplayName_CategoryEnabled]';
    END;

GO

PRINT ' 643 of 1510 : Analyzing IX_CMS_Category_CategoryUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Category_CategoryUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Category_CategoryUserID]
	   ON [dbo].[CMS_Category] (  [CategoryUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 644 of 1510 : Created [IX_CMS_Category_CategoryUserID]';
    END;

GO

PRINT ' 645 of 1510 : Analyzing IX_Community_Invitation_InvitedUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Invitation_InvitedUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_Invitation_InvitedUserID]
		ON [dbo].[Community_Invitation] ( [InvitedUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 646 of 1510 : Created [IX_Community_Invitation_InvitedUserID]';
    END;

GO

PRINT ' 647 of 1510 : Analyzing IX_Community_Invitation_InvitedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Invitation_InvitedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Community_Invitation_InvitedByUserID]
		ON [dbo].[Community_Invitation] (  [InvitedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 648 of 1510 : Created [IX_Community_Invitation_InvitedByUserID]';
    END;

GO

PRINT ' 649 of 1510 : Analyzing IX_Community_Invitation_InvitationGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Community_Invitation_InvitationGroupID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Community_Invitation_InvitationGroupID]
		 ON [dbo].[Community_Invitation] (  [InvitationGroupID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 650 of 1510 : Created [IX_Community_Invitation_InvitationGroupID]';
    END;

GO

PRINT ' 651 of 1510 : Analyzing idx_HFit_TrackerBodyFat_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerBodyFat_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerBodyFat_CreateDate]
		ON [dbo].[HFit_TrackerBodyFat] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 652 of 1510 : Created [idx_HFit_TrackerBodyFat_CreateDate]';
    END;

GO

PRINT ' 653 of 1510 : Analyzing IX_CMS_WebPartContainer_ContainerDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPartContainer_ContainerDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_WebPartContainer_ContainerDisplayName]
		 ON [dbo].[CMS_WebPartContainer] (  [ContainerDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 654 of 1510 : Created [IX_CMS_WebPartContainer_ContainerDisplayName]';
    END;

GO

PRINT ' 655 of 1510 : Analyzing IX_CMS_WebPartContainer_ContainerName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPartContainer_ContainerName') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_WebPartContainer_ContainerName]
		ON [dbo].[CMS_WebPartContainer] ( [ContainerName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 656 of 1510 : Created [IX_CMS_WebPartContainer_ContainerName]';
    END;

GO

PRINT ' 657 of 1510 : Analyzing IX_Reporting_Report_ReportCategoryID_ReportDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_Report_ReportCategoryID_ReportDisplayName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Reporting_Report_ReportCategoryID_ReportDisplayName]
	   ON [dbo].[Reporting_Report] ( [ReportDisplayName]  ASC , [ReportCategoryID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 658 of 1510 : Created [IX_Reporting_Report_ReportCategoryID_ReportDisplayName]';
    END;

GO

PRINT ' 659 of 1510 : Analyzing IX_Reporting_Report_ReportGUID_ReportName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_Report_ReportGUID_ReportName') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Reporting_Report_ReportGUID_ReportName]
		 ON [dbo].[Reporting_Report] (  [ReportGUID]  ASC , [ReportName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 660 of 1510 : Created [IX_Reporting_Report_ReportGUID_ReportName]';
    END;

GO

PRINT ' 661 of 1510 : Analyzing IX_Reporting_Report_ReportName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_Report_ReportName') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE NONCLUSTERED INDEX
	   [IX_Reporting_Report_ReportName]
	   ON [dbo].[Reporting_Report] (  [ReportName] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 662 of 1510 : Created [IX_Reporting_Report_ReportName]';
    END;

GO

PRINT ' 663 of 1510 : Analyzing IX_CMS_SearchTask_SearchTaskPriority_SearchTaskStatus_SearchTaskServerName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_SearchTask_SearchTaskPriority_SearchTaskStatus_SearchTaskServerName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_SearchTask_SearchTaskPriority_SearchTaskStatus_SearchTaskServerName]
	   ON [dbo].[CMS_SearchTask] (  [SearchTaskPriority] DESC , [SearchTaskStatus]  ASC , [SearchTaskServerName] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 664 of 1510 : Created [IX_CMS_SearchTask_SearchTaskPriority_SearchTaskStatus_SearchTaskServerName]';
    END;

GO

PRINT ' 665 of 1510 : Analyzing IX_CMS_WorkflowStepRoles_StepID_StepSourcePointGUID_RoleID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowStepRoles_StepID_StepSourcePointGUID_RoleID') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE CLUSTERED INDEX
	   [IX_CMS_WorkflowStepRoles_StepID_StepSourcePointGUID_RoleID]
	   ON [dbo].[CMS_WorkflowStepRoles] (  [StepID]  ASC , [StepSourcePointGUID]  ASC , [RoleID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 666 of 1510 : Created [IX_CMS_WorkflowStepRoles_StepID_StepSourcePointGUID_RoleID]';
    END;

GO

PRINT ' 667 of 1510 : Analyzing IX_CMS_Tree_NodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeID') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE CLUSTERED  INDEX
	   [IX_CMS_Tree_NodeID]
	   ON [dbo].[CMS_Tree] (  [NodeID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 668 of 1510 : Created [IX_CMS_Tree_NodeID]';
    END;

GO

PRINT ' 669 of 1510 : Analyzing IX_CMS_Tree_NodeID_NodeSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeID_NodeSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeID_NodeSiteID]
	   ON [dbo].[CMS_Tree] (  [NodeID]  ASC , [NodeSiteID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 670 of 1510 : Created [IX_CMS_Tree_NodeID_NodeSiteID]';
    END;

GO

PRINT ' 671 of 1510 : Analyzing IX_CMS_Tree_NodeLinkedNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeLinkedNodeID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeLinkedNodeID]
	   ON [dbo].[CMS_Tree] (  [NodeLinkedNodeID]  ASC) INCLUDE ( [NodeID] , [NodeClassID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 672 of 1510 : Created [IX_CMS_Tree_NodeLinkedNodeID]';
    END;

GO

PRINT ' 673 of 1510 : Analyzing CMS_Tree_NodeSiteID_NodeID_NodeClassID_NodeLinkedNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'CMS_Tree_NodeSiteID_NodeID_NodeClassID_NodeLinkedNodeID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [CMS_Tree_NodeSiteID_NodeID_NodeClassID_NodeLinkedNodeID]
	   ON [dbo].[CMS_Tree] (  [NodeSiteID]  ASC) INCLUDE ( [NodeID] , [NodeClassID] , [NodeLinkedNodeID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 674 of 1510 : Created [CMS_Tree_NodeSiteID_NodeID_NodeClassID_NodeLinkedNodeID]';
    END;

GO

PRINT ' 675 of 1510 : Analyzing IX_CMS_Tree_NodeSiteID_NodeGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeSiteID_NodeGUID') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeSiteID_NodeGUID]
	   ON [dbo].[CMS_Tree] (  [NodeSiteID]  ASC , [NodeGUID]  ASC) INCLUDE ( [NodeID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 676 of 1510 : Created [IX_CMS_Tree_NodeSiteID_NodeGUID]';
    END;

GO

PRINT ' 677 of 1510 : Analyzing IX_CMS_Tree_NodeAliasPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeAliasPath') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeAliasPath]
	   ON [dbo].[CMS_Tree] (  [NodeAliasPath]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 678 of 1510 : Created [IX_CMS_Tree_NodeAliasPath]';
    END;

GO

PRINT ' 679 of 1510 : Analyzing IX_CMS_Tree_NodeParentID_NodeAlias_NodeName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeParentID_NodeAlias_NodeName') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_Tree_NodeParentID_NodeAlias_NodeName]
		 ON [dbo].[CMS_Tree] ( [NodeParentID]  ASC , [NodeAlias]  ASC , [NodeName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 680 of 1510 : Created [IX_CMS_Tree_NodeParentID_NodeAlias_NodeName]';
    END;

GO

PRINT ' 681 of 1510 : Analyzing IX_CMS_Tree_NodeClassID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeClassID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeClassID]
	   ON [dbo].[CMS_Tree] (  [NodeClassID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 682 of 1510 : Created [IX_CMS_Tree_NodeClassID]';
    END;

GO

PRINT ' 683 of 1510 : Analyzing IX_CMS_Tree_NodeLevel';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeLevel') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeLevel]
	   ON [dbo].[CMS_Tree] (  [NodeLevel]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 684 of 1510 : Created [IX_CMS_Tree_NodeLevel]';
    END;

GO

PRINT ' 685 of 1510 : Analyzing IX_CMS_Tree_NodeACLID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeACLID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeACLID]
	   ON [dbo].[CMS_Tree] (  [NodeACLID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 686 of 1510 : Created [IX_CMS_Tree_NodeACLID]';
    END;

GO

PRINT ' 687 of 1510 : Analyzing IX_CMS_Tree_IsSecuredNode_RequiresSSL_NodeCacheMinutes';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_IsSecuredNode_RequiresSSL_NodeCacheMinutes') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_IsSecuredNode_RequiresSSL_NodeCacheMinutes]
	   ON [dbo].[CMS_Tree] (  [IsSecuredNode]  ASC , [RequiresSSL]  ASC , [NodeCacheMinutes]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 688 of 1510 : Created [IX_CMS_Tree_IsSecuredNode_RequiresSSL_NodeCacheMinutes]';
    END;

GO

PRINT ' 689 of 1510 : Analyzing IX_CMS_Tree_NodeSKUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeSKUID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeSKUID]
	   ON [dbo].[CMS_Tree] (  [NodeSKUID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 690 of 1510 : Created [IX_CMS_Tree_NodeSKUID]';
    END;

GO

PRINT ' 691 of 1510 : Analyzing IX_CMS_Tree_NodeOwner';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeOwner') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeOwner]
	   ON [dbo].[CMS_Tree] (  [NodeOwner]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 692 of 1510 : Created [IX_CMS_Tree_NodeOwner]';
    END;

GO

PRINT ' 693 of 1510 : Analyzing IX_CMS_Tree_NodeGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Tree_NodeGroupID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Tree_NodeGroupID]
	   ON [dbo].[CMS_Tree] (  [NodeGroupID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 694 of 1510 : Created [IX_CMS_Tree_NodeGroupID]';
    END;

GO

PRINT ' 695 of 1510 : Analyzing IX_CMS_WorkflowStepUser_StepID_StepSourcePointGUID_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowStepUser_StepID_StepSourcePointGUID_UserID') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE CLUSTERED INDEX
	   [IX_CMS_WorkflowStepUser_StepID_StepSourcePointGUID_UserID]
	   ON [dbo].[CMS_WorkflowStepUser] ( [StepID]  ASC , [StepSourcePointGUID]  ASC , [UserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 696 of 1510 : Created [IX_CMS_WorkflowStepUser_StepID_StepSourcePointGUID_UserID]';
    END;

GO

PRINT ' 697 of 1510 : Analyzing IX_Forums_ForumPost_PostIDPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumPost_PostIDPath') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE CLUSTERED INDEX
	   [IX_Forums_ForumPost_PostIDPath]
	   ON [dbo].[Forums_ForumPost] (  [PostIDPath] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 698 of 1510 : Created [IX_Forums_ForumPost_PostIDPath]';
    END;

GO

PRINT ' 699 of 1510 : Analyzing IX_Forums_ForumPost_PostForumID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumPost_PostForumID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_ForumPost_PostForumID]
	   ON [dbo].[Forums_ForumPost] (  [PostForumID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 700 of 1510 : Created [IX_Forums_ForumPost_PostForumID]';
    END;

GO

PRINT ' 701 of 1510 : Analyzing IX_Forums_ForumPost_PostParentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumPost_PostParentID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_ForumPost_PostParentID]
	   ON [dbo].[Forums_ForumPost] (  [PostParentID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 702 of 1510 : Created [IX_Forums_ForumPost_PostParentID]';
    END;

GO

PRINT ' 703 of 1510 : Analyzing IX_Forums_ForumPost_PostLevel';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumPost_PostLevel') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_ForumPost_PostLevel]
	   ON [dbo].[Forums_ForumPost] (  [PostLevel]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 704 of 1510 : Created [IX_Forums_ForumPost_PostLevel]';
    END;

GO

PRINT ' 705 of 1510 : Analyzing IX_Forums_ForumPost_PostUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumPost_PostUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_ForumPost_PostUserID]
	   ON [dbo].[Forums_ForumPost] (  [PostUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 706 of 1510 : Created [IX_Forums_ForumPost_PostUserID]';
    END;

GO

PRINT ' 707 of 1510 : Analyzing IX_Forums_ForumPost_PostApprovedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumPost_PostApprovedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Forums_ForumPost_PostApprovedByUserID]
		ON [dbo].[Forums_ForumPost] ( [PostApprovedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 708 of 1510 : Created [IX_Forums_ForumPost_PostApprovedByUserID]';
    END;

GO

PRINT ' 709 of 1510 : Analyzing IX_Forums_ForumPost_PostApproved';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_ForumPost_PostApproved') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_ForumPost_PostApproved]
	   ON [dbo].[Forums_ForumPost] (  [PostApproved] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 710 of 1510 : Created [IX_Forums_ForumPost_PostApproved]';
    END;

GO

PRINT ' 711 of 1510 : Analyzing IX_OM_ScoreContactRule_ScoreID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ScoreContactRule_ScoreID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_ScoreContactRule_ScoreID]
	   ON [dbo].[OM_ScoreContactRule] (  [ScoreID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 712 of 1510 : Created [IX_OM_ScoreContactRule_ScoreID]';
    END;

GO

PRINT ' 713 of 1510 : Analyzing IX_OM_ScoreContactRule_ScoreID_Expiration_ContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ScoreContactRule_ScoreID_Expiration_ContactID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_ScoreContactRule_ScoreID_Expiration_ContactID]
	   ON [dbo].[OM_ScoreContactRule] (  [ScoreID]  ASC , [Expiration]  ASC) INCLUDE ( [ContactID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 714 of 1510 : Created [IX_OM_ScoreContactRule_ScoreID_Expiration_ContactID]';
    END;

GO

PRINT ' 715 of 1510 : Analyzing IX_OM_ScoreContactRule_RuleID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ScoreContactRule_RuleID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_ScoreContactRule_RuleID]
	   ON [dbo].[OM_ScoreContactRule] (  [RuleID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 716 of 1510 : Created [IX_OM_ScoreContactRule_RuleID]';
    END;

GO

PRINT ' 717 of 1510 : Analyzing IX_CMS_UserRole_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserRole_UserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_UserRole_UserID]
	   ON [dbo].[CMS_UserRole] (  [UserID]  ASC) INCLUDE ([RoleID] , [ValidTo]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 718 of 1510 : Created [IX_CMS_UserRole_UserID]';
    END;

GO

PRINT ' 719 of 1510 : Analyzing IX_CMS_UserRole_UserID_RoleID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserRole_UserID_RoleID') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE NONCLUSTERED INDEX
	   [IX_CMS_UserRole_UserID_RoleID]
	   ON [dbo].[CMS_UserRole] (  [UserID]  ASC , [RoleID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 720 of 1510 : Created [IX_CMS_UserRole_UserID_RoleID]';
    END;

GO

PRINT ' 721 of 1510 : Analyzing IX_CMS_Widget_WidgetCategoryID_WidgetDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Widget_WidgetCategoryID_WidgetDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_Widget_WidgetCategoryID_WidgetDisplayName]
		 ON [dbo].[CMS_Widget] (  [WidgetCategoryID]  ASC , [WidgetDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 722 of 1510 : Created [IX_CMS_Widget_WidgetCategoryID_WidgetDisplayName]';
    END;

GO

PRINT ' 723 of 1510 : Analyzing IX_CMS_Widget_WidgetWebPartID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Widget_WidgetWebPartID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Widget_WidgetWebPartID]
	   ON [dbo].[CMS_Widget] (  [WidgetWebPartID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 724 of 1510 : Created [IX_CMS_Widget_WidgetWebPartID]';
    END;

GO

PRINT ' 725 of 1510 : Analyzing IX_CMS_Widget_WidgetIsEnabled_WidgetForGroup_WidgetForEditor_WidgetForUser';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Widget_WidgetIsEnabled_WidgetForGroup_WidgetForEditor_WidgetForUser') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Widget_WidgetIsEnabled_WidgetForGroup_WidgetForEditor_WidgetForUser]
	   ON [dbo].[CMS_Widget] (  [WidgetIsEnabled]  ASC , [WidgetForGroup]  ASC , [WidgetForEditor]  ASC , [WidgetForUser]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 726 of 1510 : Created [IX_CMS_Widget_WidgetIsEnabled_WidgetForGroup_WidgetForEditor_WidgetForUser]';
    END;

GO

PRINT ' 727 of 1510 : Analyzing IX_CMS_MembershipUser_MembershipID_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_MembershipUser_MembershipID_UserID') --IS NULL
    BEGIN  CREATE  UNIQUE NONCLUSTERED INDEX
		 [IX_CMS_MembershipUser_MembershipID_UserID]
		 ON [dbo].[CMS_MembershipUser] (  [MembershipID]  ASC , [UserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 728 of 1510 : Created [IX_CMS_MembershipUser_MembershipID_UserID]';
    END;

GO

PRINT ' 729 of 1510 : Analyzing IX_CMS_MembershipUser_UserIDValidTo';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_MembershipUser_UserIDValidTo') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_MembershipUser_UserIDValidTo]
		ON [dbo].[CMS_MembershipUser] ( [UserID]  ASC , [ValidTo]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 730 of 1510 : Created [IX_CMS_MembershipUser_UserIDValidTo]';
    END;

GO

PRINT ' 731 of 1510 : Analyzing IX_CMS_Layout_LayoutDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Layout_LayoutDisplayName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Layout_LayoutDisplayName]
	   ON [dbo].[CMS_Layout] (  [LayoutDisplayName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 732 of 1510 : Created [IX_CMS_Layout_LayoutDisplayName]';
    END;

GO

PRINT ' 733 of 1510 : Analyzing IX_OM_Rule_RuleScoreID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Rule_RuleScoreID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Rule_RuleScoreID]
	   ON [dbo].[OM_Rule] (  [RuleScoreID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 734 of 1510 : Created [IX_OM_Rule_RuleScoreID]';
    END;

GO

PRINT ' 735 of 1510 : Analyzing IX_OM_Rule_RuleSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Rule_RuleSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Rule_RuleSiteID]
	   ON [dbo].[OM_Rule] (  [RuleSiteID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 736 of 1510 : Created [IX_OM_Rule_RuleSiteID]';
    END;

GO

PRINT ' 737 of 1510 : Analyzing IX_CMS_Avatar_AvatarName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Avatar_AvatarName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Avatar_AvatarName]
	   ON [dbo].[CMS_Avatar] (  [AvatarName]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 738 of 1510 : Created [IX_CMS_Avatar_AvatarName]';
    END;

GO

PRINT ' 739 of 1510 : Analyzing IX_CMS_Avatar_AvatarType_AvatarIsCustom';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Avatar_AvatarType_AvatarIsCustom') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Avatar_AvatarType_AvatarIsCustom]
		ON [dbo].[CMS_Avatar] ( [AvatarType]  ASC , [AvatarIsCustom]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 740 of 1510 : Created [IX_CMS_Avatar_AvatarType_AvatarIsCustom]';
    END;

GO

PRINT ' 741 of 1510 : Analyzing IX_CMS_Avatar_AvatarGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Avatar_AvatarGUID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Avatar_AvatarGUID]
	   ON [dbo].[CMS_Avatar] (  [AvatarGUID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 742 of 1510 : Created [IX_CMS_Avatar_AvatarGUID]';
    END;

GO

PRINT ' 743 of 1510 : Analyzing IX_Forums_Attachment_AttachmentGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_Attachment_AttachmentGUID') --IS NULL
    BEGIN CREATE  UNIQUE NONCLUSTERED INDEX
		[IX_Forums_Attachment_AttachmentGUID]
		ON [dbo].[Forums_Attachment] (  [AttachmentSiteID]  ASC , [AttachmentGUID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 744 of 1510 : Created [IX_Forums_Attachment_AttachmentGUID]';
    END;

GO

PRINT ' 745 of 1510 : Analyzing IX_Forums_Attachment_AttachmentPostID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_Attachment_AttachmentPostID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Forums_Attachment_AttachmentPostID]
		ON [dbo].[Forums_Attachment] ( [AttachmentPostID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 746 of 1510 : Created [IX_Forums_Attachment_AttachmentPostID]';
    END;

GO

PRINT ' 747 of 1510 : Analyzing IX_CMS_WorkflowStep_StepID_StepName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowStep_StepID_StepName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_WorkflowStep_StepID_StepName]
		ON [dbo].[CMS_WorkflowStep] (  [StepID] ASC , [StepName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 748 of 1510 : Created [IX_CMS_WorkflowStep_StepID_StepName]';
    END;

GO

PRINT ' 749 of 1510 : Analyzing IX_CMS_WorkflowStep_StepWorkflowID_StepName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowStep_StepWorkflowID_StepName') --IS NULL
    BEGIN  CREATE  UNIQUE NONCLUSTERED INDEX
		 [IX_CMS_WorkflowStep_StepWorkflowID_StepName]
		 ON [dbo].[CMS_WorkflowStep] (  [StepWorkflowID]  ASC , [StepName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 750 of 1510 : Created [IX_CMS_WorkflowStep_StepWorkflowID_StepName]';
    END;

GO

PRINT ' 751 of 1510 : Analyzing IX_CMS_WorkflowStep_StepWorkflowID_StepOrder';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowStep_StepWorkflowID_StepOrder') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_WorkflowStep_StepWorkflowID_StepOrder]
		 ON [dbo].[CMS_WorkflowStep] (  [StepWorkflowID]  ASC , [StepOrder]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 752 of 1510 : Created [IX_CMS_WorkflowStep_StepWorkflowID_StepOrder]';
    END;

GO

PRINT ' 753 of 1510 : Analyzing IX_CMS_Role_SiteID_RoleName_RoleDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Role_SiteID_RoleName_RoleDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_Role_SiteID_RoleName_RoleDisplayName]
		 ON [dbo].[CMS_Role] ( [SiteID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 754 of 1510 : Created [IX_CMS_Role_SiteID_RoleName_RoleDisplayName]';
    END;

GO

PRINT ' 755 of 1510 : Analyzing IX_CMS_Role_SiteID_RoleName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Role_SiteID_RoleName') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE NONCLUSTERED INDEX
	   [IX_CMS_Role_SiteID_RoleName]
	   ON [dbo].[CMS_Role] (  [RoleName]  ASC , [SiteID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 756 of 1510 : Created [IX_CMS_Role_SiteID_RoleName]';
    END;

GO

PRINT ' 757 of 1510 : Analyzing IX_CMS_Role_SiteID_RoleID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Role_SiteID_RoleID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Role_SiteID_RoleID]
	   ON [dbo].[CMS_Role] (  [SiteID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 758 of 1510 : Created [IX_CMS_Role_SiteID_RoleID]';
    END;

GO

PRINT ' 759 of 1510 : Analyzing IX_CMS_Role_RoleGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Role_RoleGroupID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Role_RoleGroupID]
	   ON [dbo].[CMS_Role] (  [RoleGroupID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 760 of 1510 : Created [IX_CMS_Role_RoleGroupID]';
    END;

GO

PRINT ' 761 of 1510 : Analyzing idx_HFit_CMS_Role_SiteIDRoleID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_CMS_Role_SiteIDRoleID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_CMS_Role_SiteIDRoleID]
	   ON [dbo].[CMS_Role] (  [SiteID]  ASC , [RoleID]  ASC , [RoleDisplayName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 762 of 1510 : Created [idx_HFit_CMS_Role_SiteIDRoleID]';
    END;

GO

PRINT ' 763 of 1510 : Analyzing nonRoleNameID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonRoleNameID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonRoleNameID]
	   ON [dbo].[CMS_Role] (  [RoleName]  ASC , [RoleID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 764 of 1510 : Created [nonRoleNameID]';
    END;

GO

PRINT ' 765 of 1510 : Analyzing IX_CMS_EmailUser_Status';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_EmailUser_Status') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_EmailUser_Status]
	   ON [dbo].[CMS_EmailUser] (  [Status]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 766 of 1510 : Created [IX_CMS_EmailUser_Status]';
    END;

GO

PRINT ' 767 of 1510 : Analyzing IX_CMS_Transformation_TransformationClassID_TransformationName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Transformation_TransformationClassID_TransformationName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Transformation_TransformationClassID_TransformationName]
	   ON [dbo].[CMS_Transformation] (  [TransformationClassID]  ASC , [TransformationName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 768 of 1510 : Created [IX_CMS_Transformation_TransformationClassID_TransformationName]';
    END;

GO

PRINT ' 769 of 1510 : Analyzing IX_Board_Subscription_SubscriptionBoardID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Subscription_SubscriptionBoardID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Board_Subscription_SubscriptionBoardID]
		 ON [dbo].[Board_Subscription] (  [SubscriptionBoardID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 770 of 1510 : Created [IX_Board_Subscription_SubscriptionBoardID]';
    END;

GO

PRINT ' 771 of 1510 : Analyzing IX_Board_Subscription_SubscriptionUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Subscription_SubscriptionUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Board_Subscription_SubscriptionUserID]
		ON [dbo].[Board_Subscription] ( [SubscriptionUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 772 of 1510 : Created [IX_Board_Subscription_SubscriptionUserID]';
    END;

GO

PRINT ' 773 of 1510 : Analyzing IX_OM_ContactGroupMember_ContactGroupMemberContactGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ContactGroupMember_ContactGroupMemberContactGroupID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_ContactGroupMember_ContactGroupMemberContactGroupID]
	   ON [dbo].[OM_ContactGroupMember] ( [ContactGroupMemberContactGroupID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 774 of 1510 : Created [IX_OM_ContactGroupMember_ContactGroupMemberContactGroupID]';
    END;

GO

PRINT ' 775 of 1510 : Analyzing IX_OM_ContactGroupMember_ContactGroupMemberRelatedID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ContactGroupMember_ContactGroupMemberRelatedID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_ContactGroupMember_ContactGroupMemberRelatedID]
	   ON [dbo].[OM_ContactGroupMember] ( [ContactGroupMemberRelatedID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 776 of 1510 : Created [IX_OM_ContactGroupMember_ContactGroupMemberRelatedID]';
    END;

GO

PRINT ' 777 of 1510 : Analyzing idx_HFit_ContactGroupMember_RelatedID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_ContactGroupMember_RelatedID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_ContactGroupMember_RelatedID]
		ON [dbo].[OM_ContactGroupMember] ( [ContactGroupMemberContactGroupID]  ASC , [ContactGroupMemberID]  ASC , [ContactGroupMemberRelatedID] ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 778 of 1510 : Created [idx_HFit_ContactGroupMember_RelatedID]';
    END;

GO

PRINT ' 779 of 1510 : Analyzing IX_CMS_CssStylesheet_StylesheetDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_CssStylesheet_StylesheetDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_CssStylesheet_StylesheetDisplayName]
		 ON [dbo].[CMS_CssStylesheet] (  [StylesheetDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 780 of 1510 : Created [IX_CMS_CssStylesheet_StylesheetDisplayName]';
    END;

GO

PRINT ' 781 of 1510 : Analyzing IX_CMS_CssStylesheet_StylesheetName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_CssStylesheet_StylesheetName') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_CssStylesheet_StylesheetName]
		ON [dbo].[CMS_CssStylesheet] ( [StylesheetName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 782 of 1510 : Created [IX_CMS_CssStylesheet_StylesheetName]';
    END;

GO

PRINT ' 783 of 1510 : Analyzing idx_HFit_TrackerSugaryDrinks_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerSugaryDrinks_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerSugaryDrinks_CreateDate]
		ON [dbo].[HFit_TrackerSugaryDrinks] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 784 of 1510 : Created [idx_HFit_TrackerSugaryDrinks_CreateDate]';
    END;

GO

PRINT ' 785 of 1510 : Analyzing Ref76';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'Ref76') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [Ref76]
	   ON [dbo].[HFit_HealthAssesmentRecomendations] (  [RecomendationTypeID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 786 of 1510 : Created [Ref76]';
    END;

GO

PRINT ' 787 of 1510 : Analyzing IX_CMS_WorkflowScope_ScopeStartingPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowScope_ScopeStartingPath') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_WorkflowScope_ScopeStartingPath]
		ON [dbo].[CMS_WorkflowScope] ( [ScopeStartingPath]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 788 of 1510 : Created [IX_CMS_WorkflowScope_ScopeStartingPath]';
    END;

GO

PRINT ' 789 of 1510 : Analyzing IX_CMS_WorkflowScope_ScopeWorkflowID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowScope_ScopeWorkflowID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_WorkflowScope_ScopeWorkflowID]
		ON [dbo].[CMS_WorkflowScope] ( [ScopeWorkflowID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 790 of 1510 : Created [IX_CMS_WorkflowScope_ScopeWorkflowID]';
    END;

GO

PRINT ' 791 of 1510 : Analyzing IX_CMS_WorkflowScope_ScopeClassID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowScope_ScopeClassID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WorkflowScope_ScopeClassID]
	   ON [dbo].[CMS_WorkflowScope] (  [ScopeClassID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 792 of 1510 : Created [IX_CMS_WorkflowScope_ScopeClassID]';
    END;

GO

PRINT ' 793 of 1510 : Analyzing IX_CMS_WorkflowScope_ScopeSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowScope_ScopeSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WorkflowScope_ScopeSiteID]
	   ON [dbo].[CMS_WorkflowScope] (  [ScopeSiteID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 794 of 1510 : Created [IX_CMS_WorkflowScope_ScopeSiteID]';
    END;

GO

PRINT ' 795 of 1510 : Analyzing IX_CMS_WorkflowScope_ScopeCultureID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowScope_ScopeCultureID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_WorkflowScope_ScopeCultureID]
		ON [dbo].[CMS_WorkflowScope] ( [ScopeCultureID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 796 of 1510 : Created [IX_CMS_WorkflowScope_ScopeCultureID]';
    END;

GO

PRINT ' 797 of 1510 : Analyzing IX_CMS_Form_FormDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Form_FormDisplayName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Form_FormDisplayName]
	   ON [dbo].[CMS_Form] (  [FormDisplayName]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 798 of 1510 : Created [IX_CMS_Form_FormDisplayName]';
    END;

GO

PRINT ' 799 of 1510 : Analyzing IX_CMS_Form_FormClassID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Form_FormClassID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Form_FormClassID]
	   ON [dbo].[CMS_Form] (  [FormClassID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 800 of 1510 : Created [IX_CMS_Form_FormClassID]';
    END;

GO

PRINT ' 801 of 1510 : Analyzing IX_CMS_Form_FormSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Form_FormSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Form_FormSiteID]
	   ON [dbo].[CMS_Form] (  [FormSiteID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 802 of 1510 : Created [IX_CMS_Form_FormSiteID]';
    END;

GO

PRINT ' 803 of 1510 : Analyzing IX_CMS_Culture_CultureName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Culture_CultureName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Culture_CultureName]
	   ON [dbo].[CMS_Culture] (  [CultureName]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 804 of 1510 : Created [IX_CMS_Culture_CultureName]';
    END;

GO

PRINT ' 805 of 1510 : Analyzing IX_CMS_Culture_CultureCode';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Culture_CultureCode') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Culture_CultureCode]
	   ON [dbo].[CMS_Culture] (  [CultureCode]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 806 of 1510 : Created [IX_CMS_Culture_CultureCode]';
    END;

GO

PRINT ' 807 of 1510 : Analyzing IX_CMS_CulturAlias';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_CulturAlias') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_CulturAlias]
	   ON [dbo].[CMS_Culture] (  [CultureAlias]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 808 of 1510 : Created [IX_CMS_CulturAlias]';
    END;

GO

PRINT ' 809 of 1510 : Analyzing IX_CMS_WidgetCategory_CategoryPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WidgetCategory_CategoryPath') --IS NULL
    BEGIN CREATE  UNIQUE CLUSTERED INDEX
		[IX_CMS_WidgetCategory_CategoryPath]
		ON [dbo].[CMS_WidgetCategory] ( [WidgetCategoryPath]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 810 of 1510 : Created [IX_CMS_WidgetCategory_CategoryPath]';
    END;

GO

PRINT ' 811 of 1510 : Analyzing IX_CMS_WidgetCategory_WidgetCategoryID_WidgetCategoryOrder';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WidgetCategory_WidgetCategoryID_WidgetCategoryOrder') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WidgetCategory_WidgetCategoryID_WidgetCategoryOrder]
	   ON [dbo].[CMS_WidgetCategory] ( [WidgetCategoryParentID]  ASC , [WidgetCategoryOrder]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 812 of 1510 : Created [IX_CMS_WidgetCategory_WidgetCategoryID_WidgetCategoryOrder]';
    END;

GO

PRINT ' 813 of 1510 : Analyzing IX_Goal_CodeName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Goal_CodeName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Goal_CodeName]
	   ON [dbo].[HFit_Goal] (  [CodeName]  ASC , [TrackerNodeGUID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 814 of 1510 : Created [IX_Goal_CodeName]';
    END;

GO

PRINT ' 815 of 1510 : Analyzing IX_CMS_Email_EmailPriority_EmailStatus';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Email_EmailPriority_EmailStatus') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_Email_EmailPriority_EmailStatus]
		ON [dbo].[CMS_Email] (  [EmailPriority] ASC , [EmailStatus]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 816 of 1510 : Created [IX_CMS_Email_EmailPriority_EmailStatus]';
    END;

GO

PRINT ' 817 of 1510 : Analyzing IX_CMS_Email_EmailSiteID_EmailStatus_EmailLastSendAttempt';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Email_EmailSiteID_EmailStatus_EmailLastSendAttempt') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Email_EmailSiteID_EmailStatus_EmailLastSendAttempt]
	   ON [dbo].[CMS_Email] (  [EmailSiteID]  ASC , [EmailStatus]  ASC , [EmailLastSendAttempt]  ASC) INCLUDE ( [EmailID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 818 of 1510 : Created [IX_CMS_Email_EmailSiteID_EmailStatus_EmailLastSendAttempt]';
    END;

GO

PRINT ' 819 of 1510 : Analyzing IX_CMS_Email_EmailStatus_EmailID_EmailPriority_EmailLastModified';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Email_EmailStatus_EmailID_EmailPriority_EmailLastModified') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Email_EmailStatus_EmailID_EmailPriority_EmailLastModified]
	   ON [dbo].[CMS_Email] (  [EmailStatus]  ASC , [EmailID]  ASC) INCLUDE ( [EmailPriority] , [EmailLastModified]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 820 of 1510 : Created [IX_CMS_Email_EmailStatus_EmailID_EmailPriority_EmailLastModified]';
    END;

GO

PRINT ' 821 of 1510 : Analyzing idx_HFit_TrackerWater_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerWater_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerWater_CreateDate]
	   ON [dbo].[HFit_TrackerWater] (  [ItemCreatedWhen] ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 822 of 1510 : Created [idx_HFit_TrackerWater_CreateDate]';
    END;

GO

PRINT ' 823 of 1510 : Analyzing IX_Board_Message_MessageInserted';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Message_MessageInserted') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Board_Message_MessageInserted]
	   ON [dbo].[Board_Message] (  [MessageInserted] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 824 of 1510 : Created [IX_Board_Message_MessageInserted]';
    END;

GO

PRINT ' 825 of 1510 : Analyzing IX_Board_Message_MessageApproved_MessageIsSpam';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Message_MessageApproved_MessageIsSpam') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Board_Message_MessageApproved_MessageIsSpam]
		 ON [dbo].[Board_Message] (  [MessageApproved]  ASC , [MessageIsSpam]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 826 of 1510 : Created [IX_Board_Message_MessageApproved_MessageIsSpam]';
    END;

GO

PRINT ' 827 of 1510 : Analyzing IX_Board_Message_MessageBoardID_MessageGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Message_MessageBoardID_MessageGUID') --IS NULL
    BEGIN  CREATE  UNIQUE NONCLUSTERED INDEX
		 [IX_Board_Message_MessageBoardID_MessageGUID]
		 ON [dbo].[Board_Message] (  [MessageBoardID]  ASC , [MessageGUID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 828 of 1510 : Created [IX_Board_Message_MessageBoardID_MessageGUID]';
    END;

GO

PRINT ' 829 of 1510 : Analyzing IX_Board_Message_MessageApprovedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Message_MessageApprovedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Board_Message_MessageApprovedByUserID]
		ON [dbo].[Board_Message] ( [MessageApprovedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 830 of 1510 : Created [IX_Board_Message_MessageApprovedByUserID]';
    END;

GO

PRINT ' 831 of 1510 : Analyzing IX_Board_Message_MessageUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Message_MessageUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Board_Message_MessageUserID]
	   ON [dbo].[Board_Message] (  [MessageUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 832 of 1510 : Created [IX_Board_Message_MessageUserID]';
    END;

GO

PRINT ' 833 of 1510 : Analyzing PI_SchemaChangeMonitor';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_SchemaChangeMonitor') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_SchemaChangeMonitor]
	   ON [dbo].[SchemaChangeMonitor] (  [OBJ]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 834 of 1510 : Created [PI_SchemaChangeMonitor]';
    END;

GO

PRINT ' 835 of 1510 : Analyzing IX_COM_TaxClassState_TaxClassID_StateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_TaxClassState_TaxClassID_StateID') --IS NULL
    BEGIN CREATE  UNIQUE NONCLUSTERED INDEX
		[IX_COM_TaxClassState_TaxClassID_StateID]
		ON [dbo].[COM_TaxClassState] (  [TaxClassID]  ASC , [StateID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 836 of 1510 : Created [IX_COM_TaxClassState_TaxClassID_StateID]';
    END;

GO

PRINT ' 837 of 1510 : Analyzing IX_CMS_AlternativeForm_FormClassID_FormName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AlternativeForm_FormClassID_FormName') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_AlternativeForm_FormClassID_FormName]
		 ON [dbo].[CMS_AlternativeForm] (  [FormClassID]  ASC , [FormName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 838 of 1510 : Created [IX_CMS_AlternativeForm_FormClassID_FormName]';
    END;

GO

PRINT ' 839 of 1510 : Analyzing IX_CMS_AlternativeForm_FormCoupledClassID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AlternativeForm_FormCoupledClassID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_AlternativeForm_FormCoupledClassID]
		 ON [dbo].[CMS_AlternativeForm] (  [FormCoupledClassID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 840 of 1510 : Created [IX_CMS_AlternativeForm_FormCoupledClassID]';
    END;

GO

PRINT ' 841 of 1510 : Analyzing idx_HFit_TrackerMedicalCarePlan_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerMedicalCarePlan_CreateDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idx_HFit_TrackerMedicalCarePlan_CreateDate]
		 ON [dbo].[HFit_TrackerMedicalCarePlan] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 842 of 1510 : Created [idx_HFit_TrackerMedicalCarePlan_CreateDate]';
    END;

GO

PRINT ' 843 of 1510 : Analyzing IX_COM_TaxClassCountry_TaxClassID_CountryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_TaxClassCountry_TaxClassID_CountryID') --IS NULL
    BEGIN  CREATE  UNIQUE NONCLUSTERED INDEX
		 [IX_COM_TaxClassCountry_TaxClassID_CountryID]
		 ON [dbo].[COM_TaxClassCountry] (  [TaxClassID]  ASC , [CountryID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 844 of 1510 : Created [IX_COM_TaxClassCountry_TaxClassID_CountryID]';
    END;

GO

PRINT ' 845 of 1510 : Analyzing idx_HFit_TrackerStress_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerStress_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerStress_CreateDate]
	   ON [dbo].[HFit_TrackerStress] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 846 of 1510 : Created [idx_HFit_TrackerStress_CreateDate]';
    END;

GO

PRINT ' 847 of 1510 : Analyzing IX_CMS_WebPartLayout_WebPartLayoutWebPartID_WebPartLayoutCodeName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebPartLayout_WebPartLayoutWebPartID_WebPartLayoutCodeName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_WebPartLayout_WebPartLayoutWebPartID_WebPartLayoutCodeName]
	   ON [dbo].[CMS_WebPartLayout] (  [WebPartLayoutWebPartID]  ASC , [WebPartLayoutCodeName]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 848 of 1510 : Created [IX_CMS_WebPartLayout_WebPartLayoutWebPartID_WebPartLayoutCodeName]';
    END;

GO

PRINT ' 849 of 1510 : Analyzing ctCulture';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Analytics_Statistics_StatisticsCode_StatisticsSiteID_StatisticsObjectID_StatisticsObjectCulture') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Analytics_Statistics_StatisticsCode_StatisticsSiteID_StatisticsObjectID_StatisticsObjectCu	lture]
		 ON [dbo].[Analytics_Statistics] (  [StatisticsCode]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 850 of 1510 : Created lture]';
    END;

GO

PRINT ' 851 of 1510 : Analyzing IX_Staging_SyncLog_SyncLogTaskID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_SyncLog_SyncLogTaskID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Staging_SyncLog_SyncLogTaskID]
	   ON [dbo].[Staging_SyncLog] (  [SyncLogTaskID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 852 of 1510 : Created [IX_Staging_SyncLog_SyncLogTaskID]';
    END;

GO

PRINT ' 853 of 1510 : Analyzing IX_Staging_SyncLog_SyncLogServerID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_SyncLog_SyncLogServerID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Staging_SyncLog_SyncLogServerID]
		ON [dbo].[Staging_SyncLog] ( [SyncLogServerID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 854 of 1510 : Created [IX_Staging_SyncLog_SyncLogServerID]';
    END;

GO

PRINT ' 855 of 1510 : Analyzing IX_CMS_AutomationState_StateStepID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AutomationState_StateStepID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_AutomationState_StateStepID]
		ON [dbo].[CMS_AutomationState] ( [StateStepID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 856 of 1510 : Created [IX_CMS_AutomationState_StateStepID]';
    END;

GO

PRINT ' 857 of 1510 : Analyzing IX_CMS_AutomationState_StateObjectID_StateObjectType';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AutomationState_StateObjectID_StateObjectType') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_AutomationState_StateObjectID_StateObjectType]
	   ON [dbo].[CMS_AutomationState] ( [StateObjectID]  ASC , [StateObjectType]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 858 of 1510 : Created [IX_CMS_AutomationState_StateObjectID_StateObjectType]';
    END;

GO

PRINT ' 859 of 1510 : Analyzing nonStateSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonStateSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonStateSiteID]
	   ON [dbo].[CMS_AutomationState] (  [StateSiteID]  ASC , [StateStatus]  ASC) INCLUDE ([StateID] , [StateStepID] , [StateObjectID] , [StateObjectType] , [StateCreated] , [StateWorkflowID] , [StateUserID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 860 of 1510 : Created [nonStateSiteID]';
    END;

GO

PRINT ' 861 of 1510 : Analyzing idx_HFit_TrackerHbA1c_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerHbA1c_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerHbA1c_CreateDate]
	   ON [dbo].[HFit_TrackerHbA1c] (  [ItemCreatedWhen] ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 862 of 1510 : Created [idx_HFit_TrackerHbA1c_CreateDate]';
    END;

GO

PRINT ' 863 of 1510 : Analyzing IX_Staging_Synchronization_SynchronizationTaskID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_Synchronization_SynchronizationTaskID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Staging_Synchronization_SynchronizationTaskID]
		 ON [dbo].[Staging_Synchronization] (  [SynchronizationTaskID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 864 of 1510 : Created [IX_Staging_Synchronization_SynchronizationTaskID]';
    END;

GO

PRINT ' 865 of 1510 : Analyzing IX_Staging_Synchronization_SynchronizationServerID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_Synchronization_SynchronizationServerID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Staging_Synchronization_SynchronizationServerID]
	   ON [dbo].[Staging_Synchronization] ( [SynchronizationServerID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 866 of 1510 : Created [IX_Staging_Synchronization_SynchronizationServerID]';
    END;

GO

PRINT ' 867 of 1510 : Analyzing IX_OM_IP_IPActiveContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_IP_IPActiveContactID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_IP_IPActiveContactID]
	   ON [dbo].[OM_IP] (  [IPActiveContactID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 868 of 1510 : Created [IX_OM_IP_IPActiveContactID]';
    END;

GO

PRINT ' 869 of 1510 : Analyzing IX_OM_IP_IPOriginalContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_IP_IPOriginalContactID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_IP_IPOriginalContactID]
	   ON [dbo].[OM_IP] (  [IPOriginalContactID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 870 of 1510 : Created [IX_OM_IP_IPOriginalContactID]';
    END;

GO

PRINT ' 871 of 1510 : Analyzing nonPostHealth';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonPostHealth') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonPostHealth]
	   ON [dbo].[HFit_PostHealthEducation] (  [PostHealthEducationID]  ASC , [PostName]  ASC , [PostTitle]  ASC , [PostImage]  ASC , [Pinned]  ASC , [PinnedExpireDate]  ASC , [PillarID]  ASC , [PersonaID]  ASC) INCLUDE ( [PostBody]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 872 of 1510 : Created [nonPostHealth]';
    END;

GO

PRINT ' 873 of 1510 : Analyzing HFit_RewardException_PiDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_RewardException_PiDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_RewardException_PiDate]
	   ON [dbo].[HFit_RewardException] (  [ItemModifiedWhen] ASC) INCLUDE ( [ItemCreatedWhen]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 874 of 1510 : Created [HFit_RewardException_PiDate]';
    END;

GO

PRINT ' 875 of 1510 : Analyzing IX_CMS_ACL_ACLInheritedACLs';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ACL_ACLInheritedACLs') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_ACL_ACLInheritedACLs]
	   ON [dbo].[CMS_ACL] (  [ACLInheritedACLs]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 876 of 1510 : Created [IX_CMS_ACL_ACLInheritedACLs]';
    END;

GO

PRINT ' 877 of 1510 : Analyzing IX_CMS_ACL_ACLOwnerNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ACL_ACLOwnerNodeID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_ACL_ACLOwnerNodeID]
	   ON [dbo].[CMS_ACL] (  [ACLOwnerNodeID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 878 of 1510 : Created [IX_CMS_ACL_ACLOwnerNodeID]';
    END;

GO

PRINT ' 879 of 1510 : Analyzing IX_COM_Department_DepartmentDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Department_DepartmentDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_COM_Department_DepartmentDisplayName]
		ON [dbo].[COM_Department] ( [DepartmentDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 880 of 1510 : Created [IX_COM_Department_DepartmentDisplayName]';
    END;

GO

PRINT ' 881 of 1510 : Analyzing IX_COM_Department_DepartmentDefaultTaxClassID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Department_DepartmentDefaultTaxClassID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_Department_DepartmentDefaultTaxClassID]
		 ON [dbo].[COM_Department] (  [DepartmentDefaultTaxClassID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 882 of 1510 : Created [IX_COM_Department_DepartmentDefaultTaxClassID]';
    END;

GO

PRINT ' 883 of 1510 : Analyzing idx_HFit_TrackerSugaryFoods_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerSugaryFoods_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerSugaryFoods_CreateDate]
		ON [dbo].[HFit_TrackerSugaryFoods] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 884 of 1510 : Created [idx_HFit_TrackerSugaryFoods_CreateDate]';
    END;

GO

PRINT ' 885 of 1510 : Analyzing IX_OM_Search_SearchActivityID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Search_SearchActivityID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Search_SearchActivityID]
	   ON [dbo].[OM_Search] (  [SearchActivityID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 886 of 1510 : Created [IX_OM_Search_SearchActivityID]';
    END;

GO

PRINT ' 887 of 1510 : Analyzing IX_OM_UserAgent_UserAgentActiveContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_UserAgent_UserAgentActiveContactID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_UserAgent_UserAgentActiveContactID]
		ON [dbo].[OM_UserAgent] ( [UserAgentActiveContactID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 888 of 1510 : Created [IX_OM_UserAgent_UserAgentActiveContactID]';
    END;

GO

PRINT ' 889 of 1510 : Analyzing IX_OM_UserAgent_UserAgentOriginalContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_UserAgent_UserAgentOriginalContactID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_OM_UserAgent_UserAgentOriginalContactID]
		 ON [dbo].[OM_UserAgent] (  [UserAgentOriginalContactID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 890 of 1510 : Created [IX_OM_UserAgent_UserAgentOriginalContactID]';
    END;

GO

PRINT ' 891 of 1510 : Analyzing IX_Board_Board_BoardDocumentID_BoardName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Board_BoardDocumentID_BoardName') --IS NULL
    BEGIN CREATE  UNIQUE NONCLUSTERED INDEX
		[IX_Board_Board_BoardDocumentID_BoardName]
		ON [dbo].[Board_Board] (  [BoardDocumentID]  ASC , [BoardName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 892 of 1510 : Created [IX_Board_Board_BoardDocumentID_BoardName]';
    END;

GO

PRINT ' 893 of 1510 : Analyzing IX_Board_Board_BoardGroupID_BoardName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Board_BoardGroupID_BoardName') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Board_Board_BoardGroupID_BoardName]
		ON [dbo].[Board_Board] ( [BoardGroupID]  ASC , [BoardName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 894 of 1510 : Created [IX_Board_Board_BoardGroupID_BoardName]';
    END;

GO

PRINT ' 895 of 1510 : Analyzing IX_Board_Board_BoardUserID_BoardName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Board_BoardUserID_BoardName') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Board_Board_BoardUserID_BoardName]
		ON [dbo].[Board_Board] ( [BoardUserID]  ASC , [BoardName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 896 of 1510 : Created [IX_Board_Board_BoardUserID_BoardName]';
    END;

GO

PRINT ' 897 of 1510 : Analyzing IX_Board_Board_BoardSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Board_Board_BoardSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Board_Board_BoardSiteID]
	   ON [dbo].[Board_Board] (  [BoardSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 898 of 1510 : Created [IX_Board_Board_BoardSiteID]';
    END;

GO

PRINT ' 899 of 1510 : Analyzing IX_CMS_SettingsCategory_CategoryOrder';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_SettingsCategory_CategoryOrder') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_SettingsCategory_CategoryOrder]
		ON [dbo].[CMS_SettingsCategory] ( [CategoryOrder]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 900 of 1510 : Created [IX_CMS_SettingsCategory_CategoryOrder]';
    END;

GO

PRINT ' 901 of 1510 : Analyzing IX_OM_PageVisit_PageVisitActivityID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_PageVisit_PageVisitActivityID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_PageVisit_PageVisitActivityID]
		ON [dbo].[OM_PageVisit] ( [PageVisitActivityID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 902 of 1510 : Created [IX_OM_PageVisit_PageVisitActivityID]';
    END;

GO

PRINT ' 903 of 1510 : Analyzing IX_CMS_WebTemplate_WebTemplateOrder';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebTemplate_WebTemplateOrder') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_WebTemplate_WebTemplateOrder]
		ON [dbo].[CMS_WebTemplate] ( [WebTemplateOrder]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 904 of 1510 : Created [IX_CMS_WebTemplate_WebTemplateOrder]';
    END;

GO

PRINT ' 905 of 1510 : Analyzing idx_HFit_TrackerRestingHeartRate_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerRestingHeartRate_CreateDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idx_HFit_TrackerRestingHeartRate_CreateDate]
		 ON [dbo].[HFit_TrackerRestingHeartRate] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 906 of 1510 : Created [idx_HFit_TrackerRestingHeartRate_CreateDate]';
    END;

GO

PRINT ' 907 of 1510 : Analyzing IX_CMS_WebFarmTask_TaskEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebFarmTask_TaskEnabled') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WebFarmTask_TaskEnabled]
	   ON [dbo].[CMS_WebFarmTask] (  [TaskEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 908 of 1510 : Created [IX_CMS_WebFarmTask_TaskEnabled]';
    END;

GO

PRINT ' 909 of 1510 : Analyzing HFit_LKP_RewardTrigger_PiDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_LKP_RewardTrigger_PiDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_LKP_RewardTrigger_PiDate]
	   ON [dbo].[HFit_LKP_RewardTrigger] ( [ItemModifiedWhen]  ASC) INCLUDE ( [ItemCreatedWhen]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 910 of 1510 : Created [HFit_LKP_RewardTrigger_PiDate]';
    END;

GO

PRINT ' 911 of 1510 : Analyzing idx_HFitTrackerSummary_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFitTrackerSummary_UserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFitTrackerSummary_UserID]
	   ON [dbo].[HFit_TrackerSummary] (  [UserId]  ASC) INCLUDE ( [WeekendDate] , [TrackerNodeGUID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 912 of 1510 : Created [idx_HFitTrackerSummary_UserID]';
    END;

GO

PRINT ' 913 of 1510 : Analyzing idx_HFitTrackerSummary_WeekendDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFitTrackerSummary_WeekendDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFitTrackerSummary_WeekendDate]
		ON [dbo].[HFit_TrackerSummary] ( [WeekendDate]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 914 of 1510 : Created [idx_HFitTrackerSummary_WeekendDate]';
    END;

GO

PRINT ' 915 of 1510 : Analyzing IX_Reporting_SavedReport_SavedReportReportID_SavedReportDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_SavedReport_SavedReportReportID_SavedReportDate') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Reporting_SavedReport_SavedReportReportID_SavedReportDate]
	   ON [dbo].[Reporting_SavedReport] ( [SavedReportReportID]  ASC , [SavedReportDate] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 916 of 1510 : Created [IX_Reporting_SavedReport_SavedReportReportID_SavedReportDate]';
    END;

GO

PRINT ' 917 of 1510 : Analyzing IX_Reporting_SavedReport_SavedReportCreatedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_SavedReport_SavedReportCreatedByUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Reporting_SavedReport_SavedReportCreatedByUserID]
	   ON [dbo].[Reporting_SavedReport] ( [SavedReportCreatedByUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 918 of 1510 : Created [IX_Reporting_SavedReport_SavedReportCreatedByUserID]';
    END;

GO

PRINT ' 919 of 1510 : Analyzing IX_UserGoal_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_UserGoal_UserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_UserGoal_UserID]
	   ON [dbo].[HFit_UserGoal] (  [UserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 920 of 1510 : Created [IX_UserGoal_UserID]';
    END;

GO

PRINT ' 921 of 1510 : Analyzing IX_COM_VolumeDiscount_VolumeDiscountSKUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_VolumeDiscount_VolumeDiscountSKUID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_VolumeDiscount_VolumeDiscountSKUID]
		 ON [dbo].[COM_VolumeDiscount] (  [VolumeDiscountSKUID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 922 of 1510 : Created [IX_COM_VolumeDiscount_VolumeDiscountSKUID]';
    END;

GO

PRINT ' 923 of 1510 : Analyzing IX_Reporting_SavedGraph_SavedGraphSavedReportID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_SavedGraph_SavedGraphSavedReportID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Reporting_SavedGraph_SavedGraphSavedReportID]
		 ON [dbo].[Reporting_SavedGraph] (  [SavedGraphSavedReportID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 924 of 1510 : Created [IX_Reporting_SavedGraph_SavedGraphSavedReportID]';
    END;

GO

PRINT ' 925 of 1510 : Analyzing IX_Reporting_SavedGraph_SavedGraphGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_SavedGraph_SavedGraphGUID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Reporting_SavedGraph_SavedGraphGUID]
		ON [dbo].[Reporting_SavedGraph] ( [SavedGraphGUID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 926 of 1510 : Created [IX_Reporting_SavedGraph_SavedGraphGUID]';
    END;

GO

PRINT ' 927 of 1510 : Analyzing IX_CMS_DocumentAlias_AliasURLPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_DocumentAlias_AliasURLPath') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_DocumentAlias_AliasURLPath]
	   ON [dbo].[CMS_DocumentAlias] (  [AliasURLPath]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 928 of 1510 : Created [IX_CMS_DocumentAlias_AliasURLPath]';
    END;

GO

PRINT ' 929 of 1510 : Analyzing IX_CMS_DocumentAlias_AliasNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_DocumentAlias_AliasNodeID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_DocumentAlias_AliasNodeID]
	   ON [dbo].[CMS_DocumentAlias] (  [AliasNodeID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 930 of 1510 : Created [IX_CMS_DocumentAlias_AliasNodeID]';
    END;

GO

PRINT ' 931 of 1510 : Analyzing IX_CMS_Document_AliasCulture';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_AliasCulture') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Document_AliasCulture]
	   ON [dbo].[CMS_DocumentAlias] (  [AliasCulture]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 932 of 1510 : Created [IX_CMS_Document_AliasCulture]';
    END;

GO

PRINT ' 933 of 1510 : Analyzing IX_CMS_DocumentAlias_AliasWildcardRule_AliasPriority';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_DocumentAlias_AliasWildcardRule_AliasPriority') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_DocumentAlias_AliasWildcardRule_AliasPriority]
	   ON [dbo].[CMS_DocumentAlias] ( [AliasWildcardRule]  ASC , [AliasPriority]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 934 of 1510 : Created [IX_CMS_DocumentAlias_AliasWildcardRule_AliasPriority]';
    END;

GO

PRINT ' 935 of 1510 : Analyzing IX_CMS_DocumentAlias_AliasSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_DocumentAlias_AliasSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_DocumentAlias_AliasSiteID]
	   ON [dbo].[CMS_DocumentAlias] (  [AliasSiteID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 936 of 1510 : Created [IX_CMS_DocumentAlias_AliasSiteID]';
    END;

GO

PRINT ' 937 of 1510 : Analyzing nonChallengeNodeGIUD';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonChallengeNodeGIUD') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonChallengeNodeGIUD]
	   ON [dbo].[HFit_ChallengeUserRegistration] (  [UserID]  ASC , [SiteID]  ASC , [ChallengeNodeGUID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 938 of 1510 : Created [nonChallengeNodeGIUD]';
    END;

GO

PRINT ' 939 of 1510 : Analyzing idx_HFit_TrackerHighSodiumFoods_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerHighSodiumFoods_CreateDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idx_HFit_TrackerHighSodiumFoods_CreateDate]
		 ON [dbo].[HFit_TrackerHighSodiumFoods] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 940 of 1510 : Created [idx_HFit_TrackerHighSodiumFoods_CreateDate]';
    END;

GO

PRINT ' 941 of 1510 : Analyzing IX_CMS_ResourceString_StringLoadGeneration';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ResourceString_StringLoadGeneration') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_ResourceString_StringLoadGeneration]
		 ON [dbo].[CMS_ResourceString] (  [StringLoadGeneration]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 942 of 1510 : Created [IX_CMS_ResourceString_StringLoadGeneration]';
    END;

GO

PRINT ' 943 of 1510 : Analyzing IX_CMS_ResourceString_StringKey';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ResourceString_StringKey') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_ResourceString_StringKey]
	   ON [dbo].[CMS_ResourceString] (  [StringKey]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 944 of 1510 : Created [IX_CMS_ResourceString_StringKey]';
    END;

GO

PRINT ' 945 of 1510 : Analyzing idx_HFit_TrackerCholesterol_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerCholesterol_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerCholesterol_CreateDate]
		ON [dbo].[HFit_TrackerCholesterol] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 946 of 1510 : Created [idx_HFit_TrackerCholesterol_CreateDate]';
    END;

GO

PRINT ' 947 of 1510 : Analyzing IX_Forums_Forum_ForumGroupID_ForumOrder';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_Forum_ForumGroupID_ForumOrder') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_Forums_Forum_ForumGroupID_ForumOrder]
		ON [dbo].[Forums_Forum] ( [ForumGroupID]  ASC , [ForumOrder]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 948 of 1510 : Created [IX_Forums_Forum_ForumGroupID_ForumOrder]';
    END;

GO

PRINT ' 949 of 1510 : Analyzing IX_Forums_Forum_ForumSiteID_ForumName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_Forum_ForumSiteID_ForumName') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Forums_Forum_ForumSiteID_ForumName]
		ON [dbo].[Forums_Forum] ( [ForumSiteID]  ASC , [ForumName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 950 of 1510 : Created [IX_Forums_Forum_ForumSiteID_ForumName]';
    END;

GO

PRINT ' 951 of 1510 : Analyzing IX_Forums_Forum_ForumDocumentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Forums_Forum_ForumDocumentID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Forums_Forum_ForumDocumentID]
	   ON [dbo].[Forums_Forum] (  [ForumDocumentID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 952 of 1510 : Created [IX_Forums_Forum_ForumDocumentID]';
    END;

GO

PRINT ' 953 of 1510 : Analyzing IX_HFit_CentralConfigSiteClientCulture';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_CentralConfigSiteClientCulture') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_HFit_CentralConfigSiteClientCulture]
		ON [dbo].[HFit_CentralConfig] ( [ConfigSiteName]  ASC , [ConfigClientName]  ASC , [ConfigCultureCode]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 954 of 1510 : Created [IX_HFit_CentralConfigSiteClientCulture]';
    END;

GO

PRINT ' 955 of 1510 : Analyzing IX_HFit_CentralConfigKey';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_CentralConfigKey') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_HFit_CentralConfigKey]
	   ON [dbo].[HFit_CentralConfig] (  [ConfigKey]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 956 of 1510 : Created [IX_HFit_CentralConfigKey]';
    END;

GO

PRINT ' 957 of 1510 : Analyzing IX_Reporting_ReportValue_ValueName_ValueReportID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportValue_ValueName_ValueReportID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Reporting_ReportValue_ValueName_ValueReportID]
		 ON [dbo].[Reporting_ReportValue] (  [ValueName]  ASC , [ValueReportID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 958 of 1510 : Created [IX_Reporting_ReportValue_ValueName_ValueReportID]';
    END;

GO

PRINT ' 959 of 1510 : Analyzing idx_HFit_TrackerInstance_Tracker_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerInstance_Tracker_CreateDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idx_HFit_TrackerInstance_Tracker_CreateDate]
		 ON [dbo].[HFit_TrackerInstance_Tracker] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 960 of 1510 : Created [idx_HFit_TrackerInstance_Tracker_CreateDate]';
    END;

GO

PRINT ' 961 of 1510 : Analyzing IX_Reporting_ReportTable_TableReportID_TableName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportTable_TableReportID_TableName') --IS NULL
    BEGIN  CREATE  UNIQUE NONCLUSTERED INDEX
		 [IX_Reporting_ReportTable_TableReportID_TableName]
		 ON [dbo].[Reporting_ReportTable] (  [TableName]  ASC , [TableReportID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 962 of 1510 : Created [IX_Reporting_ReportTable_TableReportID_TableName]';
    END;

GO

PRINT ' 963 of 1510 : Analyzing IX_COM_ShoppingCartSKU_ShoppingCartID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCartSKU_ShoppingCartID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_ShoppingCartSKU_ShoppingCartID]
		ON [dbo].[COM_ShoppingCartSKU] ( [ShoppingCartID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 964 of 1510 : Created [IX_COM_ShoppingCartSKU_ShoppingCartID]';
    END;

GO

PRINT ' 965 of 1510 : Analyzing IX_COM_ShoppingCartSKU_SKUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCartSKU_SKUID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_ShoppingCartSKU_SKUID]
	   ON [dbo].[COM_ShoppingCartSKU] (  [SKUID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 966 of 1510 : Created [IX_COM_ShoppingCartSKU_SKUID]';
    END;

GO

PRINT ' 967 of 1510 : Analyzing IX_Notification_Subscription_SubscriptionGatewayID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Notification_Subscription_SubscriptionGatewayID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Notification_Subscription_SubscriptionGatewayID]
	   ON [dbo].[Notification_Subscription] ( [SubscriptionGatewayID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 968 of 1510 : Created [IX_Notification_Subscription_SubscriptionGatewayID]';
    END;

GO

PRINT ' 969 of 1510 : Analyzing IX_Notification_Subscription_SubscriptionTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Notification_Subscription_SubscriptionTemplateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Notification_Subscription_SubscriptionTemplateID]
	   ON [dbo].[Notification_Subscription] ( [SubscriptionTemplateID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 970 of 1510 : Created [IX_Notification_Subscription_SubscriptionTemplateID]';
    END;

GO

PRINT ' 971 of 1510 : Analyzing entObjectID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Notification_Subscription_SubscriptionEventSource_SubscriptionEventCode_SubscriptionEventObjectID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Notification_Subscription_SubscriptionEventSource_SubscriptionEventCode_SubscriptionEventO	bjectID]
		 ON [dbo].[Notification_Subscription] (  [SubscriptionEventSource]  ASC , [SubscriptionEventCode]  ASC , [SubscriptionEventObjectID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 972 of 1510 : Created bjectID]';
    END;

GO

PRINT ' 973 of 1510 : Analyzing IX_Notification_Subscription_SubscriptionUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Notification_Subscription_SubscriptionUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Notification_Subscription_SubscriptionUserID]
		 ON [dbo].[Notification_Subscription] (  [SubscriptionUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 974 of 1510 : Created [IX_Notification_Subscription_SubscriptionUserID]';
    END;

GO

PRINT ' 975 of 1510 : Analyzing IX_Notification_Subscription_SubscriptionSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Notification_Subscription_SubscriptionSiteID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Notification_Subscription_SubscriptionSiteID]
		 ON [dbo].[Notification_Subscription] (  [SubscriptionSiteID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 976 of 1510 : Created [IX_Notification_Subscription_SubscriptionSiteID]';
    END;

GO

PRINT ' 977 of 1510 : Analyzing idx_HFit_TrackerBodyMeasurements_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerBodyMeasurements_CreateDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idx_HFit_TrackerBodyMeasurements_CreateDate]
		 ON [dbo].[HFit_TrackerBodyMeasurements] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 978 of 1510 : Created [idx_HFit_TrackerBodyMeasurements_CreateDate]';
    END;

GO

PRINT ' 979 of 1510 : Analyzing IX_COM_OrderItem_OrderItemOrderID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_OrderItem_OrderItemOrderID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_OrderItem_OrderItemOrderID]
	   ON [dbo].[COM_OrderItem] (  [OrderItemOrderID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 980 of 1510 : Created [IX_COM_OrderItem_OrderItemOrderID]';
    END;

GO

PRINT ' 981 of 1510 : Analyzing IX_COM_OrderItem_OrderItemSKUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_OrderItem_OrderItemSKUID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_OrderItem_OrderItemSKUID]
	   ON [dbo].[COM_OrderItem] (  [OrderItemSKUID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 982 of 1510 : Created [IX_COM_OrderItem_OrderItemSKUID]';
    END;

GO

PRINT ' 983 of 1510 : Analyzing idx_HFIT_Tracker_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFIT_Tracker_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFIT_Tracker_CreateDate]
	   ON [dbo].[HFIT_Tracker] (  [ItemCreatedWhen] DESC , [ItemModifiedWhen] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 984 of 1510 : Created [idx_HFIT_Tracker_CreateDate]';
    END;

GO

PRINT ' 985 of 1510 : Analyzing idxHfitRewardsAwardUserDetail_CreateDate_PI';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idxHfitRewardsAwardUserDetail_CreateDate_PI') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idxHfitRewardsAwardUserDetail_CreateDate_PI]
		 ON [dbo].[HFit_RewardsAwardUserDetail] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 986 of 1510 : Created [idxHfitRewardsAwardUserDetail_CreateDate_PI]';
    END;

GO

PRINT ' 987 of 1510 : Analyzing IX_Reporting_ReportGraph_GraphReportID_GraphName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportGraph_GraphReportID_GraphName') --IS NULL
    BEGIN  CREATE  UNIQUE NONCLUSTERED INDEX
		 [IX_Reporting_ReportGraph_GraphReportID_GraphName]
		 ON [dbo].[Reporting_ReportGraph] (  [GraphReportID]  ASC , [GraphName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 988 of 1510 : Created [IX_Reporting_ReportGraph_GraphReportID_GraphName]';
    END;

GO

PRINT ' 989 of 1510 : Analyzing IX_Reporting_ReportGraph_GraphGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Reporting_ReportGraph_GraphGUID') --IS NULL
    BEGIN CREATE  UNIQUE NONCLUSTERED INDEX
		[IX_Reporting_ReportGraph_GraphGUID]
		ON [dbo].[Reporting_ReportGraph] (  [GraphGUID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 990 of 1510 : Created [IX_Reporting_ReportGraph_GraphGUID]';
    END;

GO

PRINT ' 991 of 1510 : Analyzing PK_CMS_ObjectVersionHistory';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PK_CMS_ObjectVersionHistory') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE CLUSTERED INDEX
	   [PK_CMS_ObjectVersionHistory]
	   ON [dbo].[CMS_ObjectVersionHistory] ( [VersionObjectType]  ASC , [VersionObjectID]  ASC , [VersionID] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 992 of 1510 : Created [PK_CMS_ObjectVersionHistory]';
    END;

GO

PRINT ' 993 of 1510 : Analyzing IX_CMS_ObjectVersionHistory_VersionObjectType_VersionObjectID_VersionModifiedWhen';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ObjectVersionHistory_VersionObjectType_VersionObjectID_VersionModifiedWhen') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_ObjectVersionHistory_VersionObjectType_VersionObjectID_VersionModifiedWhen]
		ON [dbo].[CMS_ObjectVersionHistory] (  [VersionObjectType]  ASC , [VersionObjectID]  ASC , [VersionModifiedWhen] DESC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 994 of 1510 : Created [IX_CMS_ObjectVersionHistory_VersionObjectType_VersionObjectID_VersionModifiedWhen]';
    END;

GO

PRINT ' 995 of 1510 : Analyzing IX_CMS_ObjectVersionHistory_VersionObjectSiteID_VersionDeletedWhen';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ObjectVersionHistory_VersionObjectSiteID_VersionDeletedWhen') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_ObjectVersionHistory_VersionObjectSiteID_VersionDeletedWhen]
	   ON [dbo].[CMS_ObjectVersionHistory] (  [VersionObjectSiteID]  ASC , [VersionDeletedWhen] DESC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 996 of 1510 : Created [IX_CMS_ObjectVersionHistory_VersionObjectSiteID_VersionDeletedWhen]';
    END;

GO

PRINT ' 997 of 1510 : Analyzing IX_CMS_ObjectVersionHistory_VersionModifiedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ObjectVersionHistory_VersionModifiedByUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_ObjectVersionHistory_VersionModifiedByUserID]
	   ON [dbo].[CMS_ObjectVersionHistory] ( [VersionModifiedByUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 998 of 1510 : Created [IX_CMS_ObjectVersionHistory_VersionModifiedByUserID]';
    END;

GO

PRINT ' 999 of 1510 : Analyzing IX_CMS_ObjectVersionHistory_VersionDeletedByUserID_VersionDeletedWhen';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ObjectVersionHistory_VersionDeletedByUserID_VersionDeletedWhen') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_ObjectVersionHistory_VersionDeletedByUserID_VersionDeletedWhen]
	   ON [dbo].[CMS_ObjectVersionHistory] (  [VersionDeletedByUserID]  ASC , [VersionDeletedWhen] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1000 of 1510 : Created [IX_CMS_ObjectVersionHistory_VersionDeletedByUserID_VersionDeletedWhen]';
    END;

GO

PRINT ' 1001 of 1510 : Analyzing IX_Newsletter_Link_LinkIssueID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Link_LinkIssueID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Newsletter_Link_LinkIssueID]
	   ON [dbo].[Newsletter_Link] (  [LinkIssueID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1002 of 1510 : Created [IX_Newsletter_Link_LinkIssueID]';
    END;

GO

PRINT ' 1003 of 1510 : Analyzing IX_Notification_TemplateText_TemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Notification_TemplateText_TemplateID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Notification_TemplateText_TemplateID]
		ON [dbo].[Notification_TemplateText] (  [TemplateID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1004 of 1510 : Created [IX_Notification_TemplateText_TemplateID]';
    END;

GO

PRINT ' 1005 of 1510 : Analyzing IX_Notification_TemplateText_GatewayID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Notification_TemplateText_GatewayID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Notification_TemplateText_GatewayID]
		ON [dbo].[Notification_TemplateText] (  [GatewayID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1006 of 1510 : Created [IX_Notification_TemplateText_GatewayID]';
    END;

GO

PRINT ' 1007 of 1510 : Analyzing IX_CMS_Metafile_MetaFileObjectType_MetaFileObjectID_MetaFileGroupName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Metafile_MetaFileObjectType_MetaFileObjectID_MetaFileGroupName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Metafile_MetaFileObjectType_MetaFileObjectID_MetaFileGroupName]
	   ON [dbo].[CMS_MetaFile] (  [MetaFileObjectType]  ASC , [MetaFileObjectID]  ASC , [MetaFileGroupName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1008 of 1510 : Created [IX_CMS_Metafile_MetaFileObjectType_MetaFileObjectID_MetaFileGroupName]';
    END;

GO

PRINT ' 1009 of 1510 : Analyzing roupName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_MetaFile_MetaFileGUID_MetaFileSiteID_MetaFileObjectType_MetaFileObjectID_MetaFileGroupName') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_MetaFile_MetaFileGUID_MetaFileSiteID_MetaFileObjectType_MetaFileObjectID_MetaFileGroup	Name]
		 ON [dbo].[CMS_MetaFile] (  [MetaFileGUID]  ASC , [MetaFileSiteID]  ASC , [MetaFileObjectType]  ASC , [MetaFileObjectID]  ASC , [MetaFileGroupName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1010 of 1510 : Created Name]';
    END;

GO

PRINT ' 1011 of 1510 : Analyzing IX_CMS_Site_SiteDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Site_SiteDisplayName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Site_SiteDisplayName]
	   ON [dbo].[CMS_Site] (  [SiteDisplayName]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1012 of 1510 : Created [IX_CMS_Site_SiteDisplayName]';
    END;

GO

PRINT ' 1013 of 1510 : Analyzing IX_CMS_Site_SiteName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Site_SiteName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Site_SiteName]
	   ON [dbo].[CMS_Site] (  [SiteName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1014 of 1510 : Created [IX_CMS_Site_SiteName]';
    END;

GO

PRINT ' 1015 of 1510 : Analyzing IX_CMS_Site_SiteDomainName_SiteStatus';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Site_SiteDomainName_SiteStatus') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Site_SiteDomainName_SiteStatus]
		ON [dbo].[CMS_Site] ( [SiteDomainName]  ASC , [SiteStatus]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1016 of 1510 : Created [IX_CMS_Site_SiteDomainName_SiteStatus]';
    END;

GO

PRINT ' 1017 of 1510 : Analyzing IX_CMS_Site_SiteDefaultStylesheetID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Site_SiteDefaultStylesheetID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Site_SiteDefaultStylesheetID]
		ON [dbo].[CMS_Site] ( [SiteDefaultStylesheetID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1018 of 1510 : Created [IX_CMS_Site_SiteDefaultStylesheetID]';
    END;

GO

PRINT ' 1019 of 1510 : Analyzing IX_CMS_Site_SiteDefaultEditorStylesheet';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Site_SiteDefaultEditorStylesheet') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Site_SiteDefaultEditorStylesheet]
		ON [dbo].[CMS_Site] ( [SiteDefaultEditorStylesheet]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1020 of 1510 : Created [IX_CMS_Site_SiteDefaultEditorStylesheet]';
    END;

GO

PRINT ' 1021 of 1510 : Analyzing HFit_PPTEligiblity_idx_01';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_PPTEligiblity_idx_01') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_PPTEligiblity_idx_01]
	   ON [dbo].[HFit_PPTEligibility] (  [TeamName]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1022 of 1510 : Created [HFit_PPTEligiblity_idx_01]';
    END;

GO

PRINT ' 1023 of 1510 : Analyzing HFit_PPTEligibililty_idx_02';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_PPTEligibililty_idx_02') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_PPTEligibililty_idx_02]
	   ON [dbo].[HFit_PPTEligibility] (  [ClientCode]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1024 of 1510 : Created [HFit_PPTEligibililty_idx_02]';
    END;

GO

PRINT ' 1025 of 1510 : Analyzing HFit_PPTEligibility_idx_03';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_PPTEligibility_idx_03') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_PPTEligibility_idx_03]
	   ON [dbo].[HFit_PPTEligibility] (  [LastName]  ASC , [FirstName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1026 of 1510 : Created [HFit_PPTEligibility_idx_03]';
    END;

GO

PRINT ' 1027 of 1510 : Analyzing HFit_PPTEligibililty_idx_04';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_PPTEligibililty_idx_04') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_PPTEligibililty_idx_04]
	   ON [dbo].[HFit_PPTEligibility] (  [UserID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1028 of 1510 : Created [HFit_PPTEligibililty_idx_04]';
    END;

GO

PRINT ' 1029 of 1510 : Analyzing IX_Media_File_FilePath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Media_File_FilePath') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Media_File_FilePath]
	   ON [dbo].[Media_File] (  [FilePath]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1030 of 1510 : Created [IX_Media_File_FilePath]';
    END;

GO

PRINT ' 1031 of 1510 : Analyzing IX_Media_File_FileSiteID_FileGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Media_File_FileSiteID_FileGUID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Media_File_FileSiteID_FileGUID]
	   ON [dbo].[Media_File] (  [FileSiteID]  ASC , [FileGUID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1032 of 1510 : Created [IX_Media_File_FileSiteID_FileGUID]';
    END;

GO

PRINT ' 1033 of 1510 : Analyzing IX_Media_File_FileLibraryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Media_File_FileLibraryID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Media_File_FileLibraryID]
	   ON [dbo].[Media_File] (  [FileLibraryID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1034 of 1510 : Created [IX_Media_File_FileLibraryID]';
    END;

GO

PRINT ' 1035 of 1510 : Analyzing IX_Media_File_FileCreatedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Media_File_FileCreatedByUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Media_File_FileCreatedByUserID]
	   ON [dbo].[Media_File] (  [FileCreatedByUserID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1036 of 1510 : Created [IX_Media_File_FileCreatedByUserID]';
    END;

GO

PRINT ' 1037 of 1510 : Analyzing IX_Media_File_FileModifiedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Media_File_FileModifiedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Media_File_FileModifiedByUserID]
		ON [dbo].[Media_File] ( [FileModifiedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1038 of 1510 : Created [IX_Media_File_FileModifiedByUserID]';
    END;

GO

PRINT ' 1039 of 1510 : Analyzing IX_OM_MVTest_MVTestSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_MVTest_MVTestSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_MVTest_MVTestSiteID]
	   ON [dbo].[OM_MVTest] (  [MVTestSiteID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1040 of 1510 : Created [IX_OM_MVTest_MVTestSiteID]';
    END;

GO

PRINT ' 1041 of 1510 : Analyzing IX_CMS_SiteDomainAlias_SiteDomainAliasName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_SiteDomainAlias_SiteDomainAliasName') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_SiteDomainAlias_SiteDomainAliasName]
		 ON [dbo].[CMS_SiteDomainAlias] (  [SiteDomainAliasName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1042 of 1510 : Created [IX_CMS_SiteDomainAlias_SiteDomainAliasName]';
    END;

GO

PRINT ' 1043 of 1510 : Analyzing IX_CMS_SiteDomainAlias_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_SiteDomainAlias_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_SiteDomainAlias_SiteID]
	   ON [dbo].[CMS_SiteDomainAlias] (  [SiteID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1044 of 1510 : Created [IX_CMS_SiteDomainAlias_SiteID]';
    END;

GO

PRINT ' 1045 of 1510 : Analyzing idx_HFit_TrackerHeight_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerHeight_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerHeight_CreateDate]
	   ON [dbo].[HFit_TrackerHeight] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1046 of 1510 : Created [idx_HFit_TrackerHeight_CreateDate]';
    END;

GO

PRINT ' 1047 of 1510 : Analyzing IX_NC_Hfit_HealthAssessmentDataForImport';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_NC_Hfit_HealthAssessmentDataForImport') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_NC_Hfit_HealthAssessmentDataForImport]
		ON [dbo].[Hfit_HealthAssessmentDataForImport] (  [QuestionCodeName]  ASC) INCLUDE ( [AnswerCodeName]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1048 of 1510 : Created [IX_NC_Hfit_HealthAssessmentDataForImport]';
    END;

GO

PRINT ' 1049 of 1510 : Analyzing IX_OM_Account_AccountStateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountStateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Account_AccountStateID]
	   ON [dbo].[OM_Account] (  [AccountStateID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1050 of 1510 : Created [IX_OM_Account_AccountStateID]';
    END;

GO

PRINT ' 1051 of 1510 : Analyzing IX_OM_Account_AccountCountryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountCountryID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Account_AccountCountryID]
	   ON [dbo].[OM_Account] (  [AccountCountryID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1052 of 1510 : Created [IX_OM_Account_AccountCountryID]';
    END;

GO

PRINT ' 1053 of 1510 : Analyzing IX_OM_Account_AccountPrimaryContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountPrimaryContactID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Account_AccountPrimaryContactID]
		ON [dbo].[OM_Account] ( [AccountPrimaryContactID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1054 of 1510 : Created [IX_OM_Account_AccountPrimaryContactID]';
    END;

GO

PRINT ' 1055 of 1510 : Analyzing IX_OM_Account_AccountSecondaryContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountSecondaryContactID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Account_AccountSecondaryContactID]
		ON [dbo].[OM_Account] ( [AccountSecondaryContactID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1056 of 1510 : Created [IX_OM_Account_AccountSecondaryContactID]';
    END;

GO

PRINT ' 1057 of 1510 : Analyzing IX_OM_Account_AccountStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountStatusID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Account_AccountStatusID]
	   ON [dbo].[OM_Account] (  [AccountStatusID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1058 of 1510 : Created [IX_OM_Account_AccountStatusID]';
    END;

GO

PRINT ' 1059 of 1510 : Analyzing IX_OM_Account_AccountOwnerUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountOwnerUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Account_AccountOwnerUserID]
	   ON [dbo].[OM_Account] (  [AccountOwnerUserID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1060 of 1510 : Created [IX_OM_Account_AccountOwnerUserID]';
    END;

GO

PRINT ' 1061 of 1510 : Analyzing IX_OM_Account_AccountSubsidiaryOfID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountSubsidiaryOfID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Account_AccountSubsidiaryOfID]
		ON [dbo].[OM_Account] ( [AccountSubsidiaryOfID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1062 of 1510 : Created [IX_OM_Account_AccountSubsidiaryOfID]';
    END;

GO

PRINT ' 1063 of 1510 : Analyzing IX_OM_Account_AccountMergedWithAccountID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountMergedWithAccountID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Account_AccountMergedWithAccountID]
		ON [dbo].[OM_Account] ( [AccountMergedWithAccountID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1064 of 1510 : Created [IX_OM_Account_AccountMergedWithAccountID]';
    END;

GO

PRINT ' 1065 of 1510 : Analyzing IX_OM_Account_AccountSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Account_AccountSiteID]
	   ON [dbo].[OM_Account] (  [AccountSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1066 of 1510 : Created [IX_OM_Account_AccountSiteID]';
    END;

GO

PRINT ' 1067 of 1510 : Analyzing IX_OM_Account_AccountGlobalAccountID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Account_AccountGlobalAccountID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Account_AccountGlobalAccountID]
		ON [dbo].[OM_Account] ( [AccountGlobalAccountID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1068 of 1510 : Created [IX_OM_Account_AccountGlobalAccountID]';
    END;

GO

PRINT ' 1069 of 1510 : Analyzing IDX_ConfigFeatures_RoleID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_ConfigFeatures_RoleID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IDX_ConfigFeatures_RoleID]
	   ON [dbo].[HFit_configFeatures] (  [RoleID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1070 of 1510 : Created [IDX_ConfigFeatures_RoleID]';
    END;

GO

PRINT ' 1071 of 1510 : Analyzing IDX_ConfigFeatures_ParentRoleID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_ConfigFeatures_ParentRoleID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IDX_ConfigFeatures_ParentRoleID]
	   ON [dbo].[HFit_configFeatures] (  [ParentRoleID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1072 of 1510 : Created [IDX_ConfigFeatures_ParentRoleID]';
    END;

GO

PRINT ' 1073 of 1510 : Analyzing IDX_ConfigFeatures_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_ConfigFeatures_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IDX_ConfigFeatures_SiteID]
	   ON [dbo].[HFit_configFeatures] (  [SiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1074 of 1510 : Created [IDX_ConfigFeatures_SiteID]';
    END;

GO

PRINT ' 1075 of 1510 : Analyzing IX_CMS_Workflow_WorkflowDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Workflow_WorkflowDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_CMS_Workflow_WorkflowDisplayName]
		ON [dbo].[CMS_Workflow] ( [WorkflowDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1076 of 1510 : Created [IX_CMS_Workflow_WorkflowDisplayName]';
    END;

GO

PRINT ' 1077 of 1510 : Analyzing idx_HFit_TrackerTobaccoFree_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerTobaccoFree_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerTobaccoFree_CreateDate]
		ON [dbo].[HFit_TrackerTobaccoFree] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1078 of 1510 : Created [idx_HFit_TrackerTobaccoFree_CreateDate]';
    END;

GO

PRINT ' 1079 of 1510 : Analyzing IX_OM_MVTCombination_MVTCombinationPageTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_MVTCombination_MVTCombinationPageTemplateID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_OM_MVTCombination_MVTCombinationPageTemplateID]
		 ON [dbo].[OM_MVTCombination] (  [MVTCombinationPageTemplateID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1080 of 1510 : Created [IX_OM_MVTCombination_MVTCombinationPageTemplateID]';
    END;

GO

PRINT ' 1081 of 1510 : Analyzing IDX_FeaturesToGroups_ContactGroupMembershipID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_FeaturesToGroups_ContactGroupMembershipID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IDX_FeaturesToGroups_ContactGroupMembershipID]
		 ON [dbo].[HFit_configGroupToFeature] (  [ContactGroupMembershipID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1082 of 1510 : Created [IDX_FeaturesToGroups_ContactGroupMembershipID]';
    END;

GO

PRINT ' 1083 of 1510 : Analyzing IDX_ConfigGroupToFeatures_ConfigFeatureID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_ConfigGroupToFeatures_ConfigFeatureID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IDX_ConfigGroupToFeatures_ConfigFeatureID]
		 ON [dbo].[HFit_configGroupToFeature] (  [configFeatureID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1084 of 1510 : Created [IDX_ConfigGroupToFeatures_ConfigFeatureID]';
    END;

GO

PRINT ' 1085 of 1510 : Analyzing nonFeatureIDItemID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonFeatureIDItemID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonFeatureIDItemID]
	   ON [dbo].[HFit_configGroupToFeature] (  [configFeatureID]  ASC , [ItemID]  ASC , [ContactGroupMembershipID]  ASC , [ValidFromDate]  ASC , [ValidToDate]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1086 of 1510 : Created [nonFeatureIDItemID]';
    END;

GO

PRINT ' 1087 of 1510 : Analyzing IDX_ConfigGroupToFeatures_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IDX_ConfigGroupToFeatures_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IDX_ConfigGroupToFeatures_SiteID]
	   ON [dbo].[HFit_configGroupToFeature] (  [SiteID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1088 of 1510 : Created [IDX_ConfigGroupToFeatures_SiteID]';
    END;

GO

PRINT ' 1089 of 1510 : Analyzing IX_CMS_ScheduledTask_TaskNextRunTime_TaskEnabled_TaskServerName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ScheduledTask_TaskNextRunTime_TaskEnabled_TaskServerName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_ScheduledTask_TaskNextRunTime_TaskEnabled_TaskServerName]
	   ON [dbo].[CMS_ScheduledTask] (  [TaskNextRunTime]  ASC , [TaskEnabled]  ASC , [TaskServerName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1090 of 1510 : Created [IX_CMS_ScheduledTask_TaskNextRunTime_TaskEnabled_TaskServerName]';
    END;

GO

PRINT ' 1091 of 1510 : Analyzing IX_CMS_ScheduledTask_TaskSiteID_TaskDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_ScheduledTask_TaskSiteID_TaskDisplayName') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_ScheduledTask_TaskSiteID_TaskDisplayName]
		 ON [dbo].[CMS_ScheduledTask] (  [TaskSiteID]  ASC , [TaskDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1092 of 1510 : Created [IX_CMS_ScheduledTask_TaskSiteID_TaskDisplayName]';
    END;

GO

PRINT ' 1093 of 1510 : Analyzing IX_ScheduledTaskEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_ScheduledTaskEnabled') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_ScheduledTaskEnabled]
	   ON [dbo].[CMS_ScheduledTask] (  [TaskEnabled]  ASC , [TaskNextRunTime]  ASC , [TaskSiteID]  ASC , [TaskServerName]  ASC , [TaskUseExternalService]  ASC) INCLUDE ( [TaskID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1094 of 1510 : Created [IX_ScheduledTaskEnabled]';
    END;

GO

PRINT ' 1095 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartSiteID_ShoppingCartGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartSiteID_ShoppingCartGUID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_ShoppingCart_ShoppingCartSiteID_ShoppingCartGUID]
	   ON [dbo].[COM_ShoppingCart] ( [ShoppingCartGUID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1096 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartSiteID_ShoppingCartGUID]';
    END;

GO

PRINT ' 1097 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_ShoppingCart_ShoppingCartUserID]
		ON [dbo].[COM_ShoppingCart] ( [ShoppingCartUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1098 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartUserID]';
    END;

GO

PRINT ' 1099 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartLastUpdate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartLastUpdate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShoppingCart_ShoppingCartLastUpdate]
		 ON [dbo].[COM_ShoppingCart] (  [ShoppingCartLastUpdate]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1100 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartLastUpdate]';
    END;

GO

PRINT ' 1101 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartCurrencyID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartCurrencyID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShoppingCart_ShoppingCartCurrencyID]
		 ON [dbo].[COM_ShoppingCart] (  [ShoppingCartCurrencyID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1102 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartCurrencyID]';
    END;

GO

PRINT ' 1103 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartPaymentOptionID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartPaymentOptionID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShoppingCart_ShoppingCartPaymentOptionID]
		 ON [dbo].[COM_ShoppingCart] (  [ShoppingCartPaymentOptionID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1104 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartPaymentOptionID]';
    END;

GO

PRINT ' 1105 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartShippingOptionID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartShippingOptionID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShoppingCart_ShoppingCartShippingOptionID]
		 ON [dbo].[COM_ShoppingCart] (  [ShoppingCartShippingOptionID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1106 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartShippingOptionID]';
    END;

GO

PRINT ' 1107 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartDiscountCouponID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartDiscountCouponID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShoppingCart_ShoppingCartDiscountCouponID]
		 ON [dbo].[COM_ShoppingCart] (  [ShoppingCartDiscountCouponID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1108 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartDiscountCouponID]';
    END;

GO

PRINT ' 1109 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartBillingAddressID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartBillingAddressID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShoppingCart_ShoppingCartBillingAddressID]
		 ON [dbo].[COM_ShoppingCart] (  [ShoppingCartBillingAddressID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1110 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartBillingAddressID]';
    END;

GO

PRINT ' 1111 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartShippingAddressID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartShippingAddressID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShoppingCart_ShoppingCartShippingAddressID]
		 ON [dbo].[COM_ShoppingCart] (  [ShoppingCartShippingAddressID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1112 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartShippingAddressID]';
    END;

GO

PRINT ' 1113 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartCustomerID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartCustomerID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShoppingCart_ShoppingCartCustomerID]
		 ON [dbo].[COM_ShoppingCart] (  [ShoppingCartCustomerID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1114 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartCustomerID]';
    END;

GO

PRINT ' 1115 of 1510 : Analyzing IX_COM_ShoppingCart_ShoppingCartCompanyAddressID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShoppingCart_ShoppingCartCompanyAddressID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShoppingCart_ShoppingCartCompanyAddressID]
		 ON [dbo].[COM_ShoppingCart] (  [ShoppingCartCompanyAddressID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1116 of 1510 : Created [IX_COM_ShoppingCart_ShoppingCartCompanyAddressID]';
    END;

GO

PRINT ' 1117 of 1510 : Analyzing IX_OM_ABVariant_ABVariantTestID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ABVariant_ABVariantTestID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_ABVariant_ABVariantTestID]
	   ON [dbo].[OM_ABVariant] (  [ABVariantTestID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1118 of 1510 : Created [IX_OM_ABVariant_ABVariantTestID]';
    END;

GO

PRINT ' 1119 of 1510 : Analyzing IX_OM_ABVariant_ABVariantSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ABVariant_ABVariantSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_ABVariant_ABVariantSiteID]
	   ON [dbo].[OM_ABVariant] (  [ABVariantSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1120 of 1510 : Created [IX_OM_ABVariant_ABVariantSiteID]';
    END;

GO

PRINT ' 1121 of 1510 : Analyzing idx_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_UserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_UserID]
	   ON [dbo].[HFit_HealthAssesmentUserStarted] (  [UserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1122 of 1510 : Created [idx_UserID]';
    END;

GO

PRINT ' 1123 of 1510 : Analyzing IX_CMS_UserSite_UserID_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_UserSite_UserID_SiteID') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE NONCLUSTERED INDEX
	   [IX_CMS_UserSite_UserID_SiteID]
	   ON [dbo].[CMS_UserSite] (  [UserID]  ASC , [SiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1124 of 1510 : Created [IX_CMS_UserSite_UserID_SiteID]';
    END;

GO

PRINT ' 1125 of 1510 : Analyzing PI_CMS_UserSite_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_CMS_UserSite_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [PI_CMS_UserSite_SiteID]
	   ON [dbo].[CMS_UserSite] (  [SiteID]  ASC) INCLUDE ([UserID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1126 of 1510 : Created [PI_CMS_UserSite_SiteID]';
    END;

GO

PRINT ' 1127 of 1510 : Analyzing ix_CmsUserSite_Userid_PI';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'ix_CmsUserSite_Userid_PI') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [ix_CmsUserSite_Userid_PI]
	   ON [dbo].[CMS_UserSite] (  [UserID]  ASC) INCLUDE ([UserSiteID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1128 of 1510 : Created [ix_CmsUserSite_Userid_PI]';
    END;

GO

PRINT ' 1129 of 1510 : Analyzing IX_COM_Customer_CustomerLastName_CustomerFirstName_CustomerEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerLastName_CustomerFirstName_CustomerEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_Customer_CustomerLastName_CustomerFirstName_CustomerEnabled]
	   ON [dbo].[COM_Customer] ( [CustomerLastName]  ASC , [CustomerFirstName]  ASC , [CustomerEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1130 of 1510 : Created [IX_COM_Customer_CustomerLastName_CustomerFirstName_CustomerEnabled]';
    END;

GO

PRINT ' 1131 of 1510 : Analyzing IX_COM_Customer_CustomerEmail';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerEmail') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Customer_CustomerEmail]
	   ON [dbo].[COM_Customer] (  [CustomerEmail]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1132 of 1510 : Created [IX_COM_Customer_CustomerEmail]';
    END;

GO

PRINT ' 1133 of 1510 : Analyzing IX_COM_Customer_CustomerCompany';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerCompany') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Customer_CustomerCompany]
	   ON [dbo].[COM_Customer] (  [CustomerCompany]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1134 of 1510 : Created [IX_COM_Customer_CustomerCompany]';
    END;

GO

PRINT ' 1135 of 1510 : Analyzing IX_COM_Customer_CustomerUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Customer_CustomerUserID]
	   ON [dbo].[COM_Customer] (  [CustomerUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1136 of 1510 : Created [IX_COM_Customer_CustomerUserID]';
    END;

GO

PRINT ' 1137 of 1510 : Analyzing IX_COM_Customer_CustomerPreferredCurrencyID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerPreferredCurrencyID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_Customer_CustomerPreferredCurrencyID]
		 ON [dbo].[COM_Customer] (  [CustomerPreferredCurrencyID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1138 of 1510 : Created [IX_COM_Customer_CustomerPreferredCurrencyID]';
    END;

GO

PRINT ' 1139 of 1510 : Analyzing IX_COM_Customer_CustomerPreferredShippingOptionID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerPreferredShippingOptionID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_Customer_CustomerPreferredShippingOptionID]
		 ON [dbo].[COM_Customer] (  [CustomerPreferredShippingOptionID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1140 of 1510 : Created [IX_COM_Customer_CustomerPreferredShippingOptionID]';
    END;

GO

PRINT ' 1141 of 1510 : Analyzing IX_COM_Customer_CustomerCountryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerCountryID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Customer_CustomerCountryID]
	   ON [dbo].[COM_Customer] (  [CustomerCountryID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1142 of 1510 : Created [IX_COM_Customer_CustomerCountryID]';
    END;

GO

PRINT ' 1143 of 1510 : Analyzing IX_COM_Customer_CustomerPrefferedPaymentOptionID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerPrefferedPaymentOptionID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_Customer_CustomerPrefferedPaymentOptionID]
		 ON [dbo].[COM_Customer] (  [CustomerPrefferedPaymentOptionID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1144 of 1510 : Created [IX_COM_Customer_CustomerPrefferedPaymentOptionID]';
    END;

GO

PRINT ' 1145 of 1510 : Analyzing IX_COM_Customer_CustomerStateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerStateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Customer_CustomerStateID]
	   ON [dbo].[COM_Customer] (  [CustomerStateID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1146 of 1510 : Created [IX_COM_Customer_CustomerStateID]';
    END;

GO

PRINT ' 1147 of 1510 : Analyzing IX_COM_Customer_CustomerDiscountLevelID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Customer_CustomerDiscountLevelID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_Customer_CustomerDiscountLevelID]
		ON [dbo].[COM_Customer] ( [CustomerDiscountLevelID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1148 of 1510 : Created [IX_COM_Customer_CustomerDiscountLevelID]';
    END;

GO

PRINT ' 1149 of 1510 : Analyzing idx_HFit_TrackerShots_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerShots_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerShots_CreateDate]
	   ON [dbo].[HFit_TrackerShots] (  [ItemCreatedWhen] ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1150 of 1510 : Created [idx_HFit_TrackerShots_CreateDate]';
    END;

GO

PRINT ' 1151 of 1510 : Analyzing IX_CMS_AttachmentHistory_AttachmentDocumentID_AttachmentName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AttachmentHistory_AttachmentDocumentID_AttachmentName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_AttachmentHistory_AttachmentDocumentID_AttachmentName]
	   ON [dbo].[CMS_AttachmentHistory] ( [AttachmentDocumentID]  ASC , [AttachmentName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1152 of 1510 : Created [IX_CMS_AttachmentHistory_AttachmentDocumentID_AttachmentName]';
    END;

GO

PRINT ' 1153 of 1510 : Analyzing IX_CMS_AttachmentHistory_AttachmentGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AttachmentHistory_AttachmentGUID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_AttachmentHistory_AttachmentGUID]
		ON [dbo].[CMS_AttachmentHistory] (  [AttachmentGUID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1154 of 1510 : Created [IX_CMS_AttachmentHistory_AttachmentGUID]';
    END;

GO

PRINT ' 1155 of 1510 : Analyzing IX_CMS_AttachmentHistory_AttachmentIsUnsorted_AttachmentGroupGUID_AttachmentOrder';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AttachmentHistory_AttachmentIsUnsorted_AttachmentGroupGUID_AttachmentOrder') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_AttachmentHistory_AttachmentIsUnsorted_AttachmentGroupGUID_AttachmentOrder]
		ON [dbo].[CMS_AttachmentHistory] (  [AttachmentIsUnsorted]  ASC , [AttachmentGroupGUID]  ASC , [AttachmentOrder]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1156 of 1510 : Created [IX_CMS_AttachmentHistory_AttachmentIsUnsorted_AttachmentGroupGUID_AttachmentOrder]';
    END;

GO

PRINT ' 1157 of 1510 : Analyzing IX_CMS_Personalization_PersonalizationUserID_PersonalizationDocumentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Personalization_PersonalizationUserID_PersonalizationDocumentID') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Personalization_PersonalizationUserID_PersonalizationDocumentID]
	   ON [dbo].[CMS_Personalization] (  [PersonalizationDocumentID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1158 of 1510 : Created [IX_CMS_Personalization_PersonalizationUserID_PersonalizationDocumentID]';
    END;

GO

PRINT ' 1159 of 1510 : Analyzing PersonalizationDashboardName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Personalization_PersonalizationID_PersonalizationUserID_PersonalizationDocumentID_PersonalizationDashboardName') --IS NULL
    BEGIN  CREATE  UNIQUE NONCLUSTERED INDEX
		 [IX_CMS_Personalization_PersonalizationID_PersonalizationUserID_PersonalizationDocumentID_Pers	onalizationDashboardName]
		 ON [dbo].[CMS_Personalization] (  [PersonalizationID]  ASC , [PersonalizationUserID]  ASC , [PersonalizationDocumentID]  ASC , [PersonalizationDashboardName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1160 of 1510 : Created onalizationDashboardName]';
    END;

GO

PRINT ' 1161 of 1510 : Analyzing IX_CMS_Personalization_PersonalizationSiteID_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Personalization_PersonalizationSiteID_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Personalization_PersonalizationSiteID_SiteID]
	   ON [dbo].[CMS_Personalization] ( [PersonalizationSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1162 of 1510 : Created [IX_CMS_Personalization_PersonalizationSiteID_SiteID]';
    END;

GO

PRINT ' 1163 of 1510 : Analyzing nonActiveTip';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonActiveTip') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonActiveTip]
	   ON [dbo].[HFit_TipOfTheDay] (  [Active]  ASC , [TipOfTheDayCategoryID]  ASC , [TipOfTheDayID]  ASC) INCLUDE ( [Title] , [Details] , [Source]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1164 of 1510 : Created [nonActiveTip]';
    END;

GO

PRINT ' 1165 of 1510 : Analyzing nonUserID';
GO

IF NOT EXISTS (SELECT [name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonUserID') 
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonUserID]
	   ON [dbo].[HFit_Ref_RewardTrackerValidation] (  [UserId]  ASC , [TrackerType]  ASC , [RewardActivityNodeId]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1166 of 1510 : Created [nonUserID]';
    END;

GO

PRINT ' 1167 of 1510 : Analyzing r';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Attachment_AttachmentDocumentID_AttachmentIsUnsorted_AttachmentName_AttachmentOrder') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_Attachment_AttachmentDocumentID_AttachmentIsUnsorted_AttachmentName_AttachmentOrder]
		 ON [dbo].[CMS_Attachment] (  [AttachmentDocumentID]  ASC , [AttachmentName]  ASC , [AttachmentIsUnsorted] ASC , [AttachmentOrder]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1168 of 1510 : Created [IX_CMS_Attachment_AttachmentDocumentID_AttachmentIsUnsorted_AttachmentName_AttachmentOrder]';
    END;

GO

PRINT ' 1169 of 1510 : Analyzing IX_CMS_Attachment_AttachmentGUID_AttachmentSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Attachment_AttachmentGUID_AttachmentSiteID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_Attachment_AttachmentGUID_AttachmentSiteID]
		 ON [dbo].[CMS_Attachment] (  [AttachmentGUID]  ASC , [AttachmentSiteID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1170 of 1510 : Created [IX_CMS_Attachment_AttachmentGUID_AttachmentSiteID]';
    END;

GO

PRINT ' 1171 of 1510 : Analyzing rder';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Attachment_AttachmentIsUnsorted_AttachmentGroupGUID_AttachmentFormGUID_AttachmentOrder') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_Attachment_AttachmentIsUnsorted_AttachmentGroupGUID_AttachmentFormGUID_AttachmentOrder	]
		 ON [dbo].[CMS_Attachment] (  [AttachmentIsUnsorted]  ASC , [AttachmentGroupGUID]  ASC , [AttachmentFormGUID]  ASC , [AttachmentOrder]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1172 of 1510 : Created ]';
    END;

GO

PRINT ' 1173 of 1510 : Analyzing IX_GoalOutcome_WeekendGoalItem';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_GoalOutcome_WeekendGoalItem') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_GoalOutcome_WeekendGoalItem]
	   ON [dbo].[HFit_GoalOutcome] (  [WeekendDate]  ASC , [UserGoalItemID]  ASC) INCLUDE ( [Passed] , [IsCoachCreated]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1174 of 1510 : Created [IX_GoalOutcome_WeekendGoalItem]';
    END;

GO

PRINT ' 1175 of 1510 : Analyzing IX_GoalOutcome_ItemidPassed';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_GoalOutcome_ItemidPassed') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_GoalOutcome_ItemidPassed]
	   ON [dbo].[HFit_GoalOutcome] (  [UserGoalItemID]  ASC , [Passed]  ASC , [Tracked]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1176 of 1510 : Created [IX_GoalOutcome_ItemidPassed]';
    END;

GO

PRINT ' 1177 of 1510 : Analyzing IX_OM_Membership_RelatedID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Membership_RelatedID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Membership_RelatedID]
	   ON [dbo].[OM_Membership] (  [RelatedID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1178 of 1510 : Created [IX_OM_Membership_RelatedID]';
    END;

GO

PRINT ' 1179 of 1510 : Analyzing IX_OM_Membership_OriginalContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Membership_OriginalContactID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_Membership_OriginalContactID]
		ON [dbo].[OM_Membership] ( [OriginalContactID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1180 of 1510 : Created [IX_OM_Membership_OriginalContactID]';
    END;

GO

PRINT ' 1181 of 1510 : Analyzing IX_OM_Membership_ActiveContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Membership_ActiveContactID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Membership_ActiveContactID]
	   ON [dbo].[OM_Membership] (  [ActiveContactID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1182 of 1510 : Created [IX_OM_Membership_ActiveContactID]';
    END;

GO

PRINT ' 1183 of 1510 : Analyzing nonRelatedID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonRelatedID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonRelatedID]
	   ON [dbo].[OM_Membership] (  [RelatedID]  ASC , [MemberType]  ASC) INCLUDE ([OriginalContactID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1184 of 1510 : Created [nonRelatedID]';
    END;

GO

PRINT ' 1185 of 1510 : Analyzing nonActiveContactID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonActiveContactID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonActiveContactID]
	   ON [dbo].[OM_Membership] (  [ActiveContactID]  ASC , [RelatedID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1186 of 1510 : Created [nonActiveContactID]';
    END;

GO

PRINT ' 1187 of 1510 : Analyzing IX_OM_MembershipMember';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_MembershipMember') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_MembershipMember]
	   ON [dbo].[OM_Membership] (  [MemberType]  ASC) INCLUDE ([RelatedID] , [ActiveContactID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1188 of 1510 : Created [IX_OM_MembershipMember]';
    END;

GO

PRINT ' 1189 of 1510 : Analyzing idx_HFit_OM_Membership_ActiveContactIDRelatedid';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_OM_Membership_ActiveContactIDRelatedid') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idx_HFit_OM_Membership_ActiveContactIDRelatedid]
		 ON [dbo].[OM_Membership] (  [OriginalContactID]  ASC , [ActiveContactID]  ASC , [RelatedID]  ASC) 
		 WITH
		 ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1190 of 1510 : Created [idx_HFit_OM_Membership_ActiveContactIDRelatedid]';
    END;

GO

PRINT ' 1191 of 1510 : Analyzing nonMemIDActiveContID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonMemIDActiveContID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonMemIDActiveContID]
	   ON [dbo].[OM_Membership] (  [MembershipID]  ASC) INCLUDE ([ActiveContactID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1192 of 1510 : Created [nonMemIDActiveContID]';
    END;

GO

PRINT ' 1193 of 1510 : Analyzing nonRelMemTypeActContID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonRelMemTypeActContID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonRelMemTypeActContID]
	   ON [dbo].[OM_Membership] (  [RelatedID]  ASC , [MemberType] ASC , [ActiveContactID]  ASC) INCLUDE ( [MembershipID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1194 of 1510 : Created [nonRelMemTypeActContID]';
    END;

GO

PRINT ' 1195 of 1510 : Analyzing idx_HFit_TrackerBloodSugarAndGlucose_UserIDEventDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerBloodSugarAndGlucose_UserIDEventDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerBloodSugarAndGlucose_UserIDEventDate]
	   ON [dbo].[HFit_TrackerBloodSugarAndGlucose] ( [EventDate]  ASC , [UserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1196 of 1510 : Created [idx_HFit_TrackerBloodSugarAndGlucose_UserIDEventDate]';
    END;

GO

PRINT ' 1197 of 1510 : Analyzing IX_TrackerBloodSugar_ProfCollecUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_TrackerBloodSugar_ProfCollecUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_TrackerBloodSugar_ProfCollecUserID]
		ON [dbo].[HFit_TrackerBloodSugarAndGlucose] (  [IsProfessionallyCollected]  ASC , [UserID]  ASC , [EventDate]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1198 of 1510 : Created [IX_TrackerBloodSugar_ProfCollecUserID]';
    END;

GO

PRINT ' 1199 of 1510 : Analyzing IX_TrackerBloodSugar_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_TrackerBloodSugar_UserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_TrackerBloodSugar_UserID]
	   ON [dbo].[HFit_TrackerBloodSugarAndGlucose] ( [UserID]  ASC , [EventDate] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1200 of 1510 : Created [IX_TrackerBloodSugar_UserID]';
    END;

GO

PRINT ' 1201 of 1510 : Analyzing idx_HFit_TrackerBloodSugarAndGlucose_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerBloodSugarAndGlucose_CreateDate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [idx_HFit_TrackerBloodSugarAndGlucose_CreateDate]
		 ON [dbo].[HFit_TrackerBloodSugarAndGlucose] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1202 of 1510 : Created [idx_HFit_TrackerBloodSugarAndGlucose_CreateDate]';
    END;

GO

PRINT ' 1203 of 1510 : Analyzing IX_OM_Score_ScoreSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_Score_ScoreSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_Score_ScoreSiteID]
	   ON [dbo].[OM_Score] (  [ScoreSiteID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1204 of 1510 : Created [IX_OM_Score_ScoreSiteID]';
    END;

GO

PRINT ' 1205 of 1510 : Analyzing IX_Integration_Task_TaskNodeAliasPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Integration_Task_TaskNodeAliasPath') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_Integration_Task_TaskNodeAliasPath]
		ON [dbo].[Integration_Task] ( [TaskNodeAliasPath]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1206 of 1510 : Created [IX_Integration_Task_TaskNodeAliasPath]';
    END;

GO

PRINT ' 1207 of 1510 : Analyzing IX_Integration_Task_TaskType';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Integration_Task_TaskType') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Integration_Task_TaskType]
	   ON [dbo].[Integration_Task] (  [TaskType]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1208 of 1510 : Created [IX_Integration_Task_TaskType]';
    END;

GO

PRINT ' 1209 of 1510 : Analyzing IX_Integration_Task_TaskSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Integration_Task_TaskSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Integration_Task_TaskSiteID]
	   ON [dbo].[Integration_Task] (  [TaskSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1210 of 1510 : Created [IX_Integration_Task_TaskSiteID]';
    END;

GO

PRINT ' 1211 of 1510 : Analyzing IX_CMS_OpenIDUser_OpenID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_OpenIDUser_OpenID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_OpenIDUser_OpenID]
	   ON [dbo].[CMS_OpenIDUser] (  [OpenID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1212 of 1510 : Created [IX_CMS_OpenIDUser_OpenID]';
    END;

GO

PRINT ' 1213 of 1510 : Analyzing IX_CMS_OpenIDUser_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_OpenIDUser_UserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_OpenIDUser_UserID]
	   ON [dbo].[CMS_OpenIDUser] (  [UserID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1214 of 1510 : Created [IX_CMS_OpenIDUser_UserID]';
    END;

GO

PRINT ' 1215 of 1510 : Analyzing IX_OM_ABTest_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ABTest_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_OM_ABTest_SiteID]
	   ON [dbo].[OM_ABTest] (  [ABTestSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1216 of 1510 : Created [IX_OM_ABTest_SiteID]';
    END;

GO

PRINT ' 1217 of 1510 : Analyzing epID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowTransition_TransitionStartStepID_TransitionSourcePointGUID_TransitionEndStepID') --IS NULL
    BEGIN  CREATE  UNIQUE NONCLUSTERED INDEX
		 [IX_CMS_WorkflowTransition_TransitionStartStepID_TransitionSourcePointGUID_TransitionEndStepID	]
		 ON [dbo].[CMS_WorkflowTransition] (  [TransitionStartStepID]  ASC , [TransitionSourcePointGUID]  ASC , [TransitionEndStepID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1218 of 1510 : Created ]';
    END;

GO

PRINT ' 1219 of 1510 : Analyzing IX_BadWords_Word_WordExpression';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_BadWords_Word_WordExpression') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_BadWords_Word_WordExpression]
	   ON [dbo].[BadWords_Word] (  [WordExpression]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1220 of 1510 : Created [IX_BadWords_Word_WordExpression]';
    END;

GO

PRINT ' 1221 of 1510 : Analyzing IX_BadWords_Word_WordIsGlobal';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_BadWords_Word_WordIsGlobal') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_BadWords_Word_WordIsGlobal]
	   ON [dbo].[BadWords_Word] (  [WordIsGlobal]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1222 of 1510 : Created [IX_BadWords_Word_WordIsGlobal]';
    END;

GO

PRINT ' 1223 of 1510 : Analyzing IX_OM_AccountStatus_AccountStatusSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_AccountStatus_AccountStatusSiteID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_AccountStatus_AccountStatusSiteID]
		ON [dbo].[OM_AccountStatus] ( [AccountStatusSiteID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1224 of 1510 : Created [IX_OM_AccountStatus_AccountStatusSiteID]';
    END;

GO

PRINT ' 1225 of 1510 : Analyzing IX_Integration_Synchronization_SynchronizationTaskID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Integration_Synchronization_SynchronizationTaskID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Integration_Synchronization_SynchronizationTaskID]
	   ON [dbo].[Integration_Synchronization] ( [SynchronizationTaskID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1226 of 1510 : Created [IX_Integration_Synchronization_SynchronizationTaskID]';
    END;

GO

PRINT ' 1227 of 1510 : Analyzing IX_Integration_Synchronization_SynchronizationConnectorID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Integration_Synchronization_SynchronizationConnectorID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Integration_Synchronization_SynchronizationConnectorID]
	   ON [dbo].[Integration_Synchronization] ( [SynchronizationConnectorID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1228 of 1510 : Created [IX_Integration_Synchronization_SynchronizationConnectorID]';
    END;

GO

PRINT ' 1229 of 1510 : Analyzing IX_HFit_HealthAssesmentUserRiskCategory_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_HealthAssesmentUserRiskCategory_1') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_HFit_HealthAssesmentUserRiskCategory_1]
		 ON [dbo].[HFit_HealthAssesmentUserRiskCategory] (  [UserID]  ASC) INCLUDE ( [HARiskCategoryNodeGUID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1230 of 1510 : Created [IX_HFit_HealthAssesmentUserRiskCategory_1]';
    END;

GO

PRINT ' 1231 of 1510 : Analyzing IX_COM_ShippingOptionDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShippingOptionDisplayName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_ShippingOptionDisplayName]
	   ON [dbo].[COM_ShippingOption] ( [ShippingOptionDisplayName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1232 of 1510 : Created [IX_COM_ShippingOptionDisplayName]';
    END;

GO

PRINT ' 1233 of 1510 : Analyzing d';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_ShippingOption_ShippingOptionSiteID_ShippingOptionDisplayName_ShippingOptionEnabled') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_ShippingOption_ShippingOptionSiteID_ShippingOptionDisplayName_ShippingOptionEnabled]
		 ON [dbo].[COM_ShippingOption] (  [ShippingOptionSiteID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1234 of 1510 : Created [IX_COM_ShippingOption_ShippingOptionSiteID_ShippingOptionDisplayName_ShippingOptionEnabled]';
    END;

GO

PRINT ' 1235 of 1510 : Analyzing idx_HFit_TrackerMealPortions_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerMealPortions_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerMealPortions_CreateDate]
		ON [dbo].[HFit_TrackerMealPortions] (  [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		( PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1236 of 1510 : Created [idx_HFit_TrackerMealPortions_CreateDate]';
    END;

GO

PRINT ' 1237 of 1510 : Analyzing idx_HFit_TrackerTests_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerTests_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerTests_CreateDate]
	   ON [dbo].[HFit_TrackerTests] (  [ItemCreatedWhen] ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1238 of 1510 : Created [idx_HFit_TrackerTests_CreateDate]';
    END;

GO

PRINT ' 1239 of 1510 : Analyzing IX_Chat_OnlineUser_SiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Chat_OnlineUser_SiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Chat_OnlineUser_SiteID]
	   ON [dbo].[Chat_OnlineUser] (  [ChatOnlineUserSiteID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1240 of 1510 : Created [IX_Chat_OnlineUser_SiteID]';
    END;

GO

PRINT ' 1241 of 1510 : Analyzing IX_Newsletter_NewsletterIssue_IssueNewsletterID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_NewsletterIssue_IssueNewsletterID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Newsletter_NewsletterIssue_IssueNewsletterID]
		 ON [dbo].[Newsletter_NewsletterIssue] (  [IssueNewsletterID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1242 of 1510 : Created [IX_Newsletter_NewsletterIssue_IssueNewsletterID]';
    END;

GO

PRINT ' 1243 of 1510 : Analyzing IX_Newsletter_NewsletterIssue_IssueTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_NewsletterIssue_IssueTemplateID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Newsletter_NewsletterIssue_IssueTemplateID]
		 ON [dbo].[Newsletter_NewsletterIssue] (  [IssueTemplateID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1244 of 1510 : Created [IX_Newsletter_NewsletterIssue_IssueTemplateID]';
    END;

GO

PRINT ' 1245 of 1510 : Analyzing IX_Newslettes_NewsletterIssue_IssueShowInNewsletterArchive';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newslettes_NewsletterIssue_IssueShowInNewsletterArchive') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Newslettes_NewsletterIssue_IssueShowInNewsletterArchive]
	   ON [dbo].[Newsletter_NewsletterIssue] (  [IssueShowInNewsletterArchive]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1246 of 1510 : Created [IX_Newslettes_NewsletterIssue_IssueShowInNewsletterArchive]';
    END;

GO

PRINT ' 1247 of 1510 : Analyzing IX_Newsletter_NewsletterIssue_IssueSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_NewsletterIssue_IssueSiteID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Newsletter_NewsletterIssue_IssueSiteID]
		 ON [dbo].[Newsletter_NewsletterIssue] (  [IssueSiteID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1248 of 1510 : Created [IX_Newsletter_NewsletterIssue_IssueSiteID]';
    END;

GO

PRINT ' 1249 of 1510 : Analyzing IX_Integration_Connector_ConnectorDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Integration_Connector_ConnectorDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Integration_Connector_ConnectorDisplayName]
		 ON [dbo].[Integration_Connector] (  [ConnectorDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1250 of 1510 : Created [IX_Integration_Connector_ConnectorDisplayName]';
    END;

GO

PRINT ' 1251 of 1510 : Analyzing IX_Integration_Connector_ConnectorEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Integration_Connector_ConnectorEnabled') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Integration_Connector_ConnectorEnabled]
		 ON [dbo].[Integration_Connector] (  [ConnectorEnabled]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1252 of 1510 : Created [IX_Integration_Connector_ConnectorEnabled]';
    END;

GO

PRINT ' 1253 of 1510 : Analyzing IX_COM_PaymentOption_PaymentOptionSiteID_PaymentOptionDisplayName_PaymentOptionEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_PaymentOption_PaymentOptionSiteID_PaymentOptionDisplayName_PaymentOptionEnabled') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_COM_PaymentOption_PaymentOptionSiteID_PaymentOptionDisplayName_PaymentOptionEnabled]
		 ON [dbo].[COM_PaymentOption] (  [PaymentOptionSiteID]  ASC , [PaymentOptionDisplayName]  ASC , [PaymentOptionEnabled]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1254 of 1510 : Created [IX_COM_PaymentOption_PaymentOptionSiteID_PaymentOptionDisplayName_PaymentOptionEnabled]';
    END;

GO

PRINT ' 1255 of 1510 : Analyzing IX_COM_PaymentOption_PaymentOptionSucceededOrderStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_PaymentOption_PaymentOptionSucceededOrderStatusID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_PaymentOption_PaymentOptionSucceededOrderStatusID]
	   ON [dbo].[COM_PaymentOption] ( [PaymentOptionSucceededOrderStatusID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1256 of 1510 : Created [IX_COM_PaymentOption_PaymentOptionSucceededOrderStatusID]';
    END;

GO

PRINT ' 1257 of 1510 : Analyzing IX_COM_PaymentOption_PaymentOptionFailedOrderStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_PaymentOption_PaymentOptionFailedOrderStatusID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_PaymentOption_PaymentOptionFailedOrderStatusID]
	   ON [dbo].[COM_PaymentOption] ( [PaymentOptionFailedOrderStatusID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1258 of 1510 : Created [IX_COM_PaymentOption_PaymentOptionFailedOrderStatusID]';
    END;

GO

PRINT ' 1259 of 1510 : Analyzing IX_HFit_HealthAssessmentImportStagingMaster_2';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_HealthAssessmentImportStagingMaster_2') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_HFit_HealthAssessmentImportStagingMaster_2]
		 ON [dbo].[HFit_HealthAssessmentImportStagingMaster] (  [IsProcessed]  ASC) INCLUDE ( [MasterID] , [UserID] , [SiteID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1260 of 1510 : Created [IX_HFit_HealthAssessmentImportStagingMaster_2]';
    END;

GO

PRINT ' 1261 of 1510 : Analyzing IX_CMS_AbuseReport_ReportWhen';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AbuseReport_ReportWhen') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_AbuseReport_ReportWhen]
	   ON [dbo].[CMS_AbuseReport] (  [ReportWhen] DESC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1262 of 1510 : Created [IX_CMS_AbuseReport_ReportWhen]';
    END;

GO

PRINT ' 1263 of 1510 : Analyzing IX_CMS_AbuseReport_ReportUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AbuseReport_ReportUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_AbuseReport_ReportUserID]
	   ON [dbo].[CMS_AbuseReport] (  [ReportUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1264 of 1510 : Created [IX_CMS_AbuseReport_ReportUserID]';
    END;

GO

PRINT ' 1265 of 1510 : Analyzing IX_CMS_AbuseReport_ReportStatus';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AbuseReport_ReportStatus') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_AbuseReport_ReportStatus]
	   ON [dbo].[CMS_AbuseReport] (  [ReportStatus]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1266 of 1510 : Created [IX_CMS_AbuseReport_ReportStatus]';
    END;

GO

PRINT ' 1267 of 1510 : Analyzing IX_CMS_AbuseReport_ReportSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_AbuseReport_ReportSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_AbuseReport_ReportSiteID]
	   ON [dbo].[CMS_AbuseReport] (  [ReportSiteID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1268 of 1510 : Created [IX_CMS_AbuseReport_ReportSiteID]';
    END;

GO

PRINT ' 1269 of 1510 : Analyzing IX_COM_SKU_SKUName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_SKU_SKUName]
	   ON [dbo].[COM_SKU] (  [SKUName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1270 of 1510 : Created [IX_COM_SKU_SKUName]';
    END;

GO

PRINT ' 1271 of 1510 : Analyzing IX_COM_SKU_SKUPrice';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUPrice') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_SKU_SKUPrice]
	   ON [dbo].[COM_SKU] (  [SKUPrice]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1272 of 1510 : Created [IX_COM_SKU_SKUPrice]';
    END;

GO

PRINT ' 1273 of 1510 : Analyzing IX_COM_SKU_SKUEnabled_SKUAvailableItems';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUEnabled_SKUAvailableItems') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_SKU_SKUEnabled_SKUAvailableItems]
		ON [dbo].[COM_SKU] (  [SKUEnabled] ASC , [SKUAvailableItems]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1274 of 1510 : Created [IX_COM_SKU_SKUEnabled_SKUAvailableItems]';
    END;

GO

PRINT ' 1275 of 1510 : Analyzing IX_COM_SKU_SKUDepartmentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUDepartmentID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_SKU_SKUDepartmentID]
	   ON [dbo].[COM_SKU] (  [SKUDepartmentID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1276 of 1510 : Created [IX_COM_SKU_SKUDepartmentID]';
    END;

GO

PRINT ' 1277 of 1510 : Analyzing IX_COM_SKU_SKUName_SKUEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUName_SKUEnabled') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_SKU_SKUName_SKUEnabled]
	   ON [dbo].[COM_SKU] (  [SKUDepartmentID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1278 of 1510 : Created [IX_COM_SKU_SKUName_SKUEnabled]';
    END;

GO

PRINT ' 1279 of 1510 : Analyzing IX_COM_SKU_SKUManufacturerID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUManufacturerID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_SKU_SKUManufacturerID]
	   ON [dbo].[COM_SKU] (  [SKUManufacturerID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1280 of 1510 : Created [IX_COM_SKU_SKUManufacturerID]';
    END;

GO

PRINT ' 1281 of 1510 : Analyzing IX_COM_SKU_SKUInternalStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUInternalStatusID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_SKU_SKUInternalStatusID]
	   ON [dbo].[COM_SKU] (  [SKUInternalStatusID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1282 of 1510 : Created [IX_COM_SKU_SKUInternalStatusID]';
    END;

GO

PRINT ' 1283 of 1510 : Analyzing IX_COM_SKU_SKUPublicStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUPublicStatusID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_SKU_SKUPublicStatusID]
	   ON [dbo].[COM_SKU] (  [SKUPublicStatusID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1284 of 1510 : Created [IX_COM_SKU_SKUPublicStatusID]';
    END;

GO

PRINT ' 1285 of 1510 : Analyzing IX_COM_SKU_SKUSupplierID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUSupplierID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_SKU_SKUSupplierID]
	   ON [dbo].[COM_SKU] (  [SKUSupplierID]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1286 of 1510 : Created [IX_COM_SKU_SKUSupplierID]';
    END;

GO

PRINT ' 1287 of 1510 : Analyzing IX_COM_SKU_SKUOptionCategoryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_SKU_SKUOptionCategoryID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_SKU_SKUOptionCategoryID]
	   ON [dbo].[COM_SKU] (  [SKUOptionCategoryID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1288 of 1510 : Created [IX_COM_SKU_SKUOptionCategoryID]';
    END;

GO

PRINT ' 1289 of 1510 : Analyzing IX_Notification_Template_TemplateSiteID_TemplateDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Notification_Template_TemplateSiteID_TemplateDisplayName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Notification_Template_TemplateSiteID_TemplateDisplayName]
	   ON [dbo].[Notification_Template] ( [TemplateSiteID]  ASC , [TemplateDisplayName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1290 of 1510 : Created [IX_Notification_Template_TemplateSiteID_TemplateDisplayName]';
    END;

GO

PRINT ' 1291 of 1510 : Analyzing PKI_SchemaMonitorObjectName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PKI_SchemaMonitorObjectName') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE CLUSTERED INDEX
	   [PKI_SchemaMonitorObjectName]
	   ON [dbo].[SchemaMonitorObjectName] (  [ObjectName] ASC , [ObjectType]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1292 of 1510 : Created [PKI_SchemaMonitorObjectName]';
    END;

GO

PRINT ' 1293 of 1510 : Analyzing IX_COM_OrderStatus_StatusOrder_StatusDisplayName_StatusEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_OrderStatus_StatusOrder_StatusDisplayName_StatusEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_OrderStatus_StatusOrder_StatusDisplayName_StatusEnabled]
	   ON [dbo].[COM_OrderStatus] ( [StatusOrder]  ASC , [StatusDisplayName]  ASC , [StatusEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1294 of 1510 : Created [IX_COM_OrderStatus_StatusOrder_StatusDisplayName_StatusEnabled]';
    END;

GO

PRINT ' 1295 of 1510 : Analyzing PCI_SchemaMonitorObjectNotify';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PCI_SchemaMonitorObjectNotify') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE CLUSTERED INDEX
	   [PCI_SchemaMonitorObjectNotify]
	   ON [dbo].[SchemaMonitorObjectNotify] ( [EmailAddr]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1296 of 1510 : Created [PCI_SchemaMonitorObjectNotify]';
    END;

GO

PRINT ' 1297 of 1510 : Analyzing IX_Newsletter_EmailTemplate_TemplateSiteID_TemplateDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_EmailTemplate_TemplateSiteID_TemplateDisplayName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Newsletter_EmailTemplate_TemplateSiteID_TemplateDisplayName]
	   ON [dbo].[Newsletter_EmailTemplate] (  [TemplateSiteID]  ASC , [TemplateDisplayName]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1298 of 1510 : Created [IX_Newsletter_EmailTemplate_TemplateSiteID_TemplateDisplayName]';
    END;

GO

PRINT ' 1299 of 1510 : Analyzing IX_Newsletter_EmailTemplate_TemplateSiteID_TemplateName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_EmailTemplate_TemplateSiteID_TemplateName') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE NONCLUSTERED INDEX
	   [IX_Newsletter_EmailTemplate_TemplateSiteID_TemplateName]
	   ON [dbo].[Newsletter_EmailTemplate] (  [TemplateSiteID]  ASC , [TemplateName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1300 of 1510 : Created [IX_Newsletter_EmailTemplate_TemplateSiteID_TemplateName]';
    END;

GO

PRINT ' 1301 of 1510 : Analyzing idx_HFit_TrackerWeight_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerWeight_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_HFit_TrackerWeight_CreateDate]
	   ON [dbo].[HFit_TrackerWeight] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1302 of 1510 : Created [idx_HFit_TrackerWeight_CreateDate]';
    END;

GO

PRINT ' 1303 of 1510 : Analyzing IX_CMS_Badge_BadgeTopLimit';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Badge_BadgeTopLimit') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_Badge_BadgeTopLimit]
	   ON [dbo].[CMS_Badge] (  [BadgeTopLimit] DESC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1304 of 1510 : Created [IX_CMS_Badge_BadgeTopLimit]';
    END;

GO

PRINT ' 1305 of 1510 : Analyzing IX_Newsletter_ABTest_TestIssueID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_ABTest_TestIssueID') 
    --IS NULL
    BEGIN
	   CREATE UNIQUE NONCLUSTERED INDEX
	   [IX_Newsletter_ABTest_TestIssueID]
	   ON [dbo].[Newsletter_ABTest] ( [TestIssueID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1306 of 1510 : Created [IX_Newsletter_ABTest_TestIssueID]';
    END;

GO

PRINT ' 1307 of 1510 : Analyzing IX_Newsletter_ABTest_TestWinnerIssueID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_ABTest_TestWinnerIssueID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Newsletter_ABTest_TestWinnerIssueID]
		ON [dbo].[Newsletter_ABTest] ( [TestWinnerIssueID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1308 of 1510 : Created [IX_Newsletter_ABTest_TestWinnerIssueID]';
    END;

GO

PRINT ' 1309 of 1510 : Analyzing IX_CMS_PageTemplateCategory_CategoryPath';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplateCategory_CategoryPath') --IS NULL
    BEGIN CREATE  UNIQUE CLUSTERED INDEX
		[IX_CMS_PageTemplateCategory_CategoryPath]
		ON [dbo].[CMS_PageTemplateCategory] (  [CategoryPath]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1310 of 1510 : Created [IX_CMS_PageTemplateCategory_CategoryPath]';
    END;

GO

PRINT ' 1311 of 1510 : Analyzing IX_CMS_PageTemplateCategory_CategoryParentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplateCategory_CategoryParentID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_PageTemplateCategory_CategoryParentID]
		 ON [dbo].[CMS_PageTemplateCategory] (  [CategoryParentID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1312 of 1510 : Created [IX_CMS_PageTemplateCategory_CategoryParentID]';
    END;

GO

PRINT ' 1313 of 1510 : Analyzing IX_CMS_PageTemplateCategory_CategoryLevel';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplateCategory_CategoryLevel') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_PageTemplateCategory_CategoryLevel]
		 ON [dbo].[CMS_PageTemplateCategory] (  [CategoryLevel]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1314 of 1510 : Created [IX_CMS_PageTemplateCategory_CategoryLevel]';
    END;

GO

PRINT ' 1315 of 1510 : Analyzing IX_COM_DiscountLevel_DiscountLevelDisplayName_DiscountLevelEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_DiscountLevel_DiscountLevelDisplayName_DiscountLevelEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_DiscountLevel_DiscountLevelDisplayName_DiscountLevelEnabled]
	   ON [dbo].[COM_DiscountLevel] (  [DiscountLevelDisplayName]  ASC , [DiscountLevelEnabled]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1316 of 1510 : Created [IX_COM_DiscountLevel_DiscountLevelDisplayName_DiscountLevelEnabled]';
    END;

GO

PRINT ' 1317 of 1510 : Analyzing IX_Media_Library_LibraryDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Media_Library_LibraryDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_Media_Library_LibraryDisplayName]
		ON [dbo].[Media_Library] ( [LibrarySiteID]  ASC , [LibraryDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1318 of 1510 : Created [IX_Media_Library_LibraryDisplayName]';
    END;

GO

PRINT ' 1319 of 1510 : Analyzing IX_Media_Library_LibrarySiteID_LibraryName_LibraryGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Media_Library_LibrarySiteID_LibraryName_LibraryGUID') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE NONCLUSTERED INDEX
	   [IX_Media_Library_LibrarySiteID_LibraryName_LibraryGUID]
	   ON [dbo].[Media_Library] ( [LibrarySiteID]  ASC , [LibraryName]  ASC , [LibraryGUID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1320 of 1510 : Created [IX_Media_Library_LibrarySiteID_LibraryName_LibraryGUID]';
    END;

GO

PRINT ' 1321 of 1510 : Analyzing IX_Media_Library_LibraryGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Media_Library_LibraryGroupID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Media_Library_LibraryGroupID]
	   ON [dbo].[Media_Library] (  [LibraryGroupID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1322 of 1510 : Created [IX_Media_Library_LibraryGroupID]';
    END;

GO

PRINT ' 1323 of 1510 : Analyzing IX_CMS_WorkflowHistory_VersionHistoryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowHistory_VersionHistoryID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_WorkflowHistory_VersionHistoryID]
		ON [dbo].[CMS_WorkflowHistory] ( [VersionHistoryID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1324 of 1510 : Created [IX_CMS_WorkflowHistory_VersionHistoryID]';
    END;

GO

PRINT ' 1325 of 1510 : Analyzing IX_CMS_WorkflowHistory_StepID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowHistory_StepID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_WorkflowHistory_StepID]
	   ON [dbo].[CMS_WorkflowHistory] (  [StepID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1326 of 1510 : Created [IX_CMS_WorkflowHistory_StepID]';
    END;

GO

PRINT ' 1327 of 1510 : Analyzing IX_CMS_WorkflowHistory_ApprovedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowHistory_ApprovedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_WorkflowHistory_ApprovedByUserID]
		ON [dbo].[CMS_WorkflowHistory] ( [ApprovedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1328 of 1510 : Created [IX_CMS_WorkflowHistory_ApprovedByUserID]';
    END;

GO

PRINT ' 1329 of 1510 : Analyzing IX_CMS_WorkflowHistory_ApprovedWhen';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WorkflowHistory_ApprovedWhen') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_WorkflowHistory_ApprovedWhen]
		ON [dbo].[CMS_WorkflowHistory] ( [ApprovedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1330 of 1510 : Created [IX_CMS_WorkflowHistory_ApprovedWhen]';
    END;

GO

PRINT ' 1331 of 1510 : Analyzing IX_COM_CustomerCreditHistory_EventCustomerID_EventDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_CustomerCreditHistory_EventCustomerID_EventDate') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_CustomerCreditHistory_EventCustomerID_EventDate]
	   ON [dbo].[COM_CustomerCreditHistory] ( [EventCustomerID]  ASC , [EventDate] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1332 of 1510 : Created [IX_COM_CustomerCreditHistory_EventCustomerID_EventDate]';
    END;

GO

PRINT ' 1333 of 1510 : Analyzing IX_Integration_SyncLog_SyncLogTaskID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Integration_SyncLog_SyncLogTaskID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Integration_SyncLog_SyncLogTaskID]
		ON [dbo].[Integration_SyncLog] ( [SyncLogSynchronizationID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1334 of 1510 : Created [IX_Integration_SyncLog_SyncLogTaskID]';
    END;

GO

PRINT ' 1335 of 1510 : Analyzing IX_HFit_HealthAssesmentUserRiskArea_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_HealthAssesmentUserRiskArea_1') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_HFit_HealthAssesmentUserRiskArea_1]
		ON [dbo].[HFit_HealthAssesmentUserRiskArea] (  [UserID]  ASC) INCLUDE ( [HARiskAreaNodeGUID]) WITH ( PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1336 of 1510 : Created [IX_HFit_HealthAssesmentUserRiskArea_1]';
    END;

GO

PRINT ' 1337 of 1510 : Analyzing idx_UserRiskAreaCodeName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_UserRiskAreaCodeName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_UserRiskAreaCodeName]
	   ON [dbo].[HFit_HealthAssesmentUserRiskArea] (  [CodeName] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1338 of 1510 : Created [idx_UserRiskAreaCodeName]';
    END;

GO

PRINT ' 1339 of 1510 : Analyzing HFit_HealthAssesmentUserRiskArea_HARiskCategoryItemID_PI';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_HealthAssesmentUserRiskArea_HARiskCategoryItemID_PI') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [HFit_HealthAssesmentUserRiskArea_HARiskCategoryItemID_PI]
	   ON [dbo].[HFit_HealthAssesmentUserRiskArea] (  [HARiskCategoryItemID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1340 of 1510 : Created [HFit_HealthAssesmentUserRiskArea_HARiskCategoryItemID_PI]';
    END;

GO

PRINT ' 1341 of 1510 : Analyzing nonHARiskCategoryItemID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonHARiskCategoryItemID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonHARiskCategoryItemID]
	   ON [dbo].[HFit_HealthAssesmentUserRiskArea] (  [ItemID] ASC , [HARiskCategoryItemID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1342 of 1510 : Created [nonHARiskCategoryItemID]';
    END;

GO

PRINT ' 1343 of 1510 : Analyzing IX_CMS_Membership_MembershipSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Membership_MembershipSiteID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Membership_MembershipSiteID]
		ON [dbo].[CMS_Membership] ( [MembershipSiteID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1344 of 1510 : Created [IX_CMS_Membership_MembershipSiteID]';
    END;

GO

PRINT ' 1345 of 1510 : Analyzing idx_HFit_TrackerSitLess_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerSitLess_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerSitLess_CreateDate]
		ON [dbo].[HFit_TrackerSitLess] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1346 of 1510 : Created [idx_HFit_TrackerSitLess_CreateDate]';
    END;

GO

PRINT ' 1347 of 1510 : Analyzing IX_CMS_PageTemplate_PageTemplateCategoryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplate_PageTemplateCategoryID') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_CMS_PageTemplate_PageTemplateCategoryID]
		 ON [dbo].[CMS_PageTemplate] (  [PageTemplateCategoryID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1348 of 1510 : Created [IX_CMS_PageTemplate_PageTemplateCategoryID]';
    END;

GO

PRINT ' 1349 of 1510 : Analyzing IX_CMS_PageTemplate_PageTemplateCodeName_PageTemplateDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplate_PageTemplateCodeName_PageTemplateDisplayName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_PageTemplate_PageTemplateCodeName_PageTemplateDisplayName]
	   ON [dbo].[CMS_PageTemplate] (  [PageTemplateCodeName]  ASC , [PageTemplateDisplayName]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1350 of 1510 : Created [IX_CMS_PageTemplate_PageTemplateCodeName_PageTemplateDisplayName]';
    END;

GO

PRINT ' 1351 of 1510 : Analyzing IX_CMS_PageTemplate_PageTemplateSiteID_PageTemplateCodeName_PageTemplateGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplate_PageTemplateSiteID_PageTemplateCodeName_PageTemplateGUID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_PageTemplate_PageTemplateSiteID_PageTemplateCodeName_PageTemplateGUID]
	   ON [dbo].[CMS_PageTemplate] (  [PageTemplateSiteID]  ASC , [PageTemplateCodeName]  ASC , [PageTemplateGUID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1352 of 1510 : Created [IX_CMS_PageTemplate_PageTemplateSiteID_PageTemplateCodeName_PageTemplateGUID]';
    END;

GO

PRINT ' 1353 of 1510 : Analyzing IX_CMS_PageTemplate_PageTemplateLayoutID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplate_PageTemplateLayoutID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_PageTemplate_PageTemplateLayoutID]
		ON [dbo].[CMS_PageTemplate] ( [PageTemplateLayoutID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1354 of 1510 : Created [IX_CMS_PageTemplate_PageTemplateLayoutID]';
    END;

GO

PRINT ' 1355 of 1510 : Analyzing erTemplate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_PageTemplate_PageTemplateIsReusable_PageTemplateForAllPages_PageTemplateShowAsMasterTemplate') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_PageTemplate_PageTemplateIsReusable_PageTemplateForAllPages_PageTemplateShowAsMasterTe	mplate]
		 ON [dbo].[CMS_PageTemplate] (  [PageTemplateIsReusable]  ASC , [PageTemplateForAllPages]  ASC , [PageTemplateShowAsMasterTemplate]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1356 of 1510 : Created mplate]';
    END;

GO

PRINT ' 1357 of 1510 : Analyzing IX_COM_Currency_CurrencyDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Currency_CurrencyDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_COM_Currency_CurrencyDisplayName]
		ON [dbo].[COM_Currency] ( [CurrencyDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1358 of 1510 : Created [IX_COM_Currency_CurrencyDisplayName]';
    END;

GO

PRINT ' 1359 of 1510 : Analyzing IX_COM_Currency_CurrencyEnabled_CurrencyIsMain';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Currency_CurrencyEnabled_CurrencyIsMain') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_COM_Currency_CurrencyEnabled_CurrencyIsMain]
		 ON [dbo].[COM_Currency] (  [CurrencyEnabled]  ASC , [CurrencyIsMain]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1360 of 1510 : Created [IX_COM_Currency_CurrencyEnabled_CurrencyIsMain]';
    END;

GO

PRINT ' 1361 of 1510 : Analyzing IX_COM_Order_OrderSiteID_OrderDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderSiteID_OrderDate') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_COM_Order_OrderSiteID_OrderDate]
		ON [dbo].[COM_Order] (  [OrderSiteID]  ASC , [OrderDate] DESC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1362 of 1510 : Created [IX_COM_Order_OrderSiteID_OrderDate]';
    END;

GO

PRINT ' 1363 of 1510 : Analyzing IX_COM_Order_OrderBillingAddressID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderBillingAddressID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_Order_OrderBillingAddressID]
		ON [dbo].[COM_Order] ( [OrderBillingAddressID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1364 of 1510 : Created [IX_COM_Order_OrderBillingAddressID]';
    END;

GO

PRINT ' 1365 of 1510 : Analyzing IX_COM_Order_OrderShippingAddressID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderShippingAddressID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_Order_OrderShippingAddressID]
		ON [dbo].[COM_Order] ( [OrderShippingAddressID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1366 of 1510 : Created [IX_COM_Order_OrderShippingAddressID]';
    END;

GO

PRINT ' 1367 of 1510 : Analyzing IX_COM_Order_OrderShippingOptionID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderShippingOptionID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_Order_OrderShippingOptionID]
		ON [dbo].[COM_Order] ( [OrderShippingOptionID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1368 of 1510 : Created [IX_COM_Order_OrderShippingOptionID]';
    END;

GO

PRINT ' 1369 of 1510 : Analyzing IX_COM_Order_OrderStatusID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderStatusID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Order_OrderStatusID]
	   ON [dbo].[COM_Order] (  [OrderStatusID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1370 of 1510 : Created [IX_COM_Order_OrderStatusID]';
    END;

GO

PRINT ' 1371 of 1510 : Analyzing IX_COM_Order_OrderCurrencyID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderCurrencyID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Order_OrderCurrencyID]
	   ON [dbo].[COM_Order] (  [OrderCurrencyID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1372 of 1510 : Created [IX_COM_Order_OrderCurrencyID]';
    END;

GO

PRINT ' 1373 of 1510 : Analyzing IX_COM_Order_OrderCustomerID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderCustomerID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Order_OrderCustomerID]
	   ON [dbo].[COM_Order] (  [OrderCustomerID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1374 of 1510 : Created [IX_COM_Order_OrderCustomerID]';
    END;

GO

PRINT ' 1375 of 1510 : Analyzing IX_COM_Order_OrderPaymentOptionID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderPaymentOptionID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Order_OrderPaymentOptionID]
	   ON [dbo].[COM_Order] (  [OrderPaymentOptionID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1376 of 1510 : Created [IX_COM_Order_OrderPaymentOptionID]';
    END;

GO

PRINT ' 1377 of 1510 : Analyzing IX_COM_Order_OrderDiscountCouponID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderDiscountCouponID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_Order_OrderDiscountCouponID]
		ON [dbo].[COM_Order] ( [OrderDiscountCouponID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1378 of 1510 : Created [IX_COM_Order_OrderDiscountCouponID]';
    END;

GO

PRINT ' 1379 of 1510 : Analyzing IX_COM_Order_OrderCompanyAddressID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Order_OrderCompanyAddressID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_Order_OrderCompanyAddressID]
		ON [dbo].[COM_Order] ( [OrderCompanyAddressID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1380 of 1510 : Created [IX_COM_Order_OrderCompanyAddressID]';
    END;

GO

PRINT ' 1381 of 1510 : Analyzing PK_Tracker_EDW_Metadata';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PK_Tracker_EDW_Metadata') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE CLUSTERED  INDEX
	   [PK_Tracker_EDW_Metadata]
	   ON [dbo].[Tracker_EDW_Metadata] (  [TableName]  ASC , [ColName] ASC , [AttrName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1382 of 1510 : Created [PK_Tracker_EDW_Metadata]';
    END;

GO

PRINT ' 1383 of 1510 : Analyzing IX_Export_Task_TaskSiteID_TaskObjectType';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Export_Task_TaskSiteID_TaskObjectType') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_Export_Task_TaskSiteID_TaskObjectType]
		ON [dbo].[Export_Task] ( [TaskSiteID]  ASC , [TaskObjectType]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1384 of 1510 : Created [IX_Export_Task_TaskSiteID_TaskObjectType]';
    END;

GO

PRINT ' 1385 of 1510 : Analyzing IX_CMS_VersionHistory_DocumentID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_VersionHistory_DocumentID') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_CMS_VersionHistory_DocumentID]
	   ON [dbo].[CMS_VersionHistory] (  [DocumentID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1386 of 1510 : Created [IX_CMS_VersionHistory_DocumentID]';
    END;

GO

PRINT ' 1387 of 1510 : Analyzing IX_CMS_VersionHistory_NodeSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_VersionHistory_NodeSiteID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_VersionHistory_NodeSiteID]
	   ON [dbo].[CMS_VersionHistory] (  [NodeSiteID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1388 of 1510 : Created [IX_CMS_VersionHistory_NodeSiteID]';
    END;

GO

PRINT ' 1389 of 1510 : Analyzing IX_CMS_VersionHistory_ModifiedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_VersionHistory_ModifiedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_VersionHistory_ModifiedByUserID]
		ON [dbo].[CMS_VersionHistory] ( [ModifiedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1390 of 1510 : Created [IX_CMS_VersionHistory_ModifiedByUserID]';
    END;

GO

PRINT ' 1391 of 1510 : Analyzing IX_CMS_VersionHistory_ToBePublished_PublishFrom_PublishTo';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_VersionHistory_ToBePublished_PublishFrom_PublishTo') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_VersionHistory_ToBePublished_PublishFrom_PublishTo]
	   ON [dbo].[CMS_VersionHistory] ( [ToBePublished]  ASC , [PublishFrom]  ASC , [PublishTo]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1392 of 1510 : Created [IX_CMS_VersionHistory_ToBePublished_PublishFrom_PublishTo]';
    END;

GO

PRINT ' 1393 of 1510 : Analyzing IX_CMS_VersionHistory_VersionDeletedByUserID_VersionDeletedWhen';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_VersionHistory_VersionDeletedByUserID_VersionDeletedWhen') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_VersionHistory_VersionDeletedByUserID_VersionDeletedWhen]
	   ON [dbo].[CMS_VersionHistory] (  [VersionDeletedByUserID]  ASC , [VersionDeletedWhen] DESC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1394 of 1510 : Created [IX_CMS_VersionHistory_VersionDeletedByUserID_VersionDeletedWhen]';
    END;

GO

PRINT ' 1395 of 1510 : Analyzing IX_VersionHistoryDocID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_VersionHistoryDocID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_VersionHistoryDocID]
	   ON [dbo].[CMS_VersionHistory] (  [DocumentID]  ASC , [VersionHistoryID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1396 of 1510 : Created [IX_VersionHistoryDocID]';
    END;

GO

PRINT ' 1397 of 1510 : Analyzing IX_Newsletter_Newsletter_NewsletterSiteID_NewsletterDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Newsletter_NewsletterSiteID_NewsletterDisplayName') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_Newsletter_Newsletter_NewsletterSiteID_NewsletterDisplayName]
	   ON [dbo].[Newsletter_Newsletter] (  [NewsletterSiteID]  ASC , [NewsletterDisplayName]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1398 of 1510 : Created [IX_Newsletter_Newsletter_NewsletterSiteID_NewsletterDisplayName]';
    END;

GO

PRINT ' 1399 of 1510 : Analyzing IX_Newsletter_Newsletter_NewsletterSiteID_NewsletterName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Newsletter_NewsletterSiteID_NewsletterName') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE NONCLUSTERED  INDEX
	   [IX_Newsletter_Newsletter_NewsletterSiteID_NewsletterName]
	   ON [dbo].[Newsletter_Newsletter] (  [NewsletterSiteID]  ASC , [NewsletterName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1400 of 1510 : Created [IX_Newsletter_Newsletter_NewsletterSiteID_NewsletterName]';
    END;

GO

PRINT ' 1401 of 1510 : Analyzing IX_Newsletter_Newsletter_NewsletterSubscriptionTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Newsletter_NewsletterSubscriptionTemplateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Newsletter_Newsletter_NewsletterSubscriptionTemplateID]
	   ON [dbo].[Newsletter_Newsletter] ( [NewsletterSubscriptionTemplateID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1402 of 1510 : Created [IX_Newsletter_Newsletter_NewsletterSubscriptionTemplateID]';
    END;

GO

PRINT ' 1403 of 1510 : Analyzing IX_Newsletter_Newsletter_NewsletterUnsubscriptionTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Newsletter_NewsletterUnsubscriptionTemplateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Newsletter_Newsletter_NewsletterUnsubscriptionTemplateID]
	   ON [dbo].[Newsletter_Newsletter] (  [NewsletterUnsubscriptionTemplateID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1404 of 1510 : Created [IX_Newsletter_Newsletter_NewsletterUnsubscriptionTemplateID]';
    END;

GO

PRINT ' 1405 of 1510 : Analyzing IX_Newsletter_Newsletter_NewsletterTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Newsletter_NewsletterTemplateID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_Newsletter_Newsletter_NewsletterTemplateID]
		 ON [dbo].[Newsletter_Newsletter] (  [NewsletterTemplateID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1406 of 1510 : Created [IX_Newsletter_Newsletter_NewsletterTemplateID]';
    END;

GO

PRINT ' 1407 of 1510 : Analyzing IX_Newsletter_Newsletter_NewsletterOptInTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Newsletter_Newsletter_NewsletterOptInTemplateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Newsletter_Newsletter_NewsletterOptInTemplateID]
	   ON [dbo].[Newsletter_Newsletter] ( [NewsletterOptInTemplateID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1408 of 1510 : Created [IX_Newsletter_Newsletter_NewsletterOptInTemplateID]';
    END;

GO

PRINT ' 1409 of 1510 : Analyzing idx_HFit_TrackerSleepPlan_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_HFit_TrackerSleepPlan_CreateDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[idx_HFit_TrackerSleepPlan_CreateDate]
		ON [dbo].[HFit_TrackerSleepPlan] ( [ItemCreatedWhen]  ASC , [ItemModifiedWhen]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1410 of 1510 : Created [idx_HFit_TrackerSleepPlan_CreateDate]';
    END;

GO

PRINT ' 1411 of 1510 : Analyzing IX_COM_Address_AddressCustomerID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Address_AddressCustomerID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Address_AddressCustomerID]
	   ON [dbo].[COM_Address] (  [AddressCustomerID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1412 of 1510 : Created [IX_COM_Address_AddressCustomerID]';
    END;

GO

PRINT ' 1413 of 1510 : Analyzing IX_COM_Address_AddressCountryID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Address_AddressCountryID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Address_AddressCountryID]
	   ON [dbo].[COM_Address] (  [AddressCountryID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1414 of 1510 : Created [IX_COM_Address_AddressCountryID]';
    END;

GO

PRINT ' 1415 of 1510 : Analyzing IX_COM_Address_AddressStateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Address_AddressStateID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_COM_Address_AddressStateID]
	   ON [dbo].[COM_Address] (  [AddressStateID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1416 of 1510 : Created [IX_COM_Address_AddressStateID]';
    END;

GO

PRINT ' 1417 of 1510 : Analyzing IX_COM_Address_AddressEnabled_AddressIsBilling_AddressIsShipping_AddressIsCompany';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_Address_AddressEnabled_AddressIsBilling_AddressIsShipping_AddressIsCompany') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_COM_Address_AddressEnabled_AddressIsBilling_AddressIsShipping_AddressIsCompany]
		ON [dbo].[COM_Address] (  [AddressEnabled]  ASC , [AddressIsBilling]  ASC , [AddressIsShipping]  ASC , [AddressIsCompany]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1418 of 1510 : Created [IX_COM_Address_AddressEnabled_AddressIsBilling_AddressIsShipping_AddressIsCompany]';
    END;

GO

PRINT ' 1419 of 1510 : Analyzing idx_RecomendationID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'idx_RecomendationID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [idx_RecomendationID]
	   ON [dbo].[HFit_HealthAssesmentRecomendationClientConfig] (  [RecomdationID] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1420 of 1510 : Created [idx_RecomendationID]';
    END;

GO

PRINT ' 1421 of 1510 : Analyzing IX_Chat_User_UserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Chat_User_UserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Chat_User_UserID]
	   ON [dbo].[Chat_User] (  [ChatUserUserID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1422 of 1510 : Created [IX_Chat_User_UserID]';
    END;

GO

PRINT ' 1423 of 1510 : Analyzing IX_COM_TaxClass_TaxClassDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_TaxClass_TaxClassDisplayName') --IS NULL
    BEGIN CREATE CLUSTERED INDEX
		[IX_COM_TaxClass_TaxClassDisplayName]
		ON [dbo].[COM_TaxClass] ( [TaxClassDisplayName]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1424 of 1510 : Created [IX_COM_TaxClass_TaxClassDisplayName]';
    END;

GO

PRINT ' 1425 of 1510 : Analyzing IX_OM_ContactStatus_ContactStatusSiteID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_OM_ContactStatus_ContactStatusSiteID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_OM_ContactStatus_ContactStatusSiteID]
		ON [dbo].[OM_ContactStatus] ( [ContactStatusSiteID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1426 of 1510 : Created [IX_OM_ContactStatus_ContactStatusSiteID]';
    END;

GO

PRINT ' 1427 of 1510 : Analyzing IX_CMS_User_UserName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_User_UserName') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE NONCLUSTERED  INDEX
	   [IX_CMS_User_UserName]
	   ON [dbo].[CMS_User] (  [UserName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1428 of 1510 : Created [IX_CMS_User_UserName]';
    END;

GO

PRINT ' 1429 of 1510 : Analyzing IX_CMS_User_FullName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_User_FullName') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_User_FullName]
	   ON [dbo].[CMS_User] (  [FullName]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1430 of 1510 : Created [IX_CMS_User_FullName]';
    END;

GO

PRINT ' 1431 of 1510 : Analyzing IX_CMS_User_Email';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_User_Email') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_User_Email]
	   ON [dbo].[CMS_User] (  [Email]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1432 of 1510 : Created [IX_CMS_User_Email]';
    END;

GO

PRINT ' 1433 of 1510 : Analyzing IX_CMS_User_UserEnabled_UserIsHidden';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_User_UserEnabled_UserIsHidden') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_User_UserEnabled_UserIsHidden]
		ON [dbo].[CMS_User] (  [UserEnabled] ASC , [UserIsHidden]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1434 of 1510 : Created [IX_CMS_User_UserEnabled_UserIsHidden]';
    END;

GO

PRINT ' 1435 of 1510 : Analyzing IX_CMS_User_UserIsEditor';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_User_UserIsEditor') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_User_UserIsEditor]
	   ON [dbo].[CMS_User] (  [UserIsEditor]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1436 of 1510 : Created [IX_CMS_User_UserIsEditor]';
    END;

GO

PRINT ' 1437 of 1510 : Analyzing IX_CMS_User_UserIsGlobalAdministrator';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_User_UserIsGlobalAdministrator') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_User_UserIsGlobalAdministrator]
		ON [dbo].[CMS_User] ( [UserIsGlobalAdministrator]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1438 of 1510 : Created [IX_CMS_User_UserIsGlobalAdministrator]';
    END;

GO

PRINT ' 1439 of 1510 : Analyzing IX_CMS_User_UserGUID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_User_UserGUID') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE NONCLUSTERED  INDEX
	   [IX_CMS_User_UserGUID]
	   ON [dbo].[CMS_User] (  [UserGUID]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1440 of 1510 : Created [IX_CMS_User_UserGUID]';
    END;

GO

PRINT ' 1441 of 1510 : Analyzing PI_CMS_User_UserIsGlobalAdministrator';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_CMS_User_UserIsGlobalAdministrator') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_CMS_User_UserIsGlobalAdministrator]
		ON [dbo].[CMS_User] ( [UserIsGlobalAdministrator]  ASC , [UserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1442 of 1510 : Created [PI_CMS_User_UserIsGlobalAdministrator]';
    END;

GO

PRINT ' 1443 of 1510 : Analyzing IX_CMS_Document_DocumentForeignKeyValue_DocumentID_DocumentNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentForeignKeyValue_DocumentID_DocumentNodeID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Document_DocumentForeignKeyValue_DocumentID_DocumentNodeID]
	   ON [dbo].[CMS_Document] (  [DocumentForeignKeyValue]  ASC , [DocumentID]  ASC , [DocumentNodeID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1444 of 1510 : Created [IX_CMS_Document_DocumentForeignKeyValue_DocumentID_DocumentNodeID]';
    END;

GO

PRINT ' 1445 of 1510 : Analyzing IX_CMS_Document_WorkflowColumns';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_WorkflowColumns') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Document_WorkflowColumns]
	   ON [dbo].[CMS_Document] (  [DocumentID]  ASC , [DocumentNodeID]  ASC , [DocumentCulture]  ASC , [DocumentCheckedOutVersionHistoryID]  ASC , [DocumentPublishedVersionHistoryID]  ASC , [DocumentPublishFrom]  ASC , [DocumentPublishTo]  ASC , [DocumentWorkflowStepID]  ASC , [DocumentIsArchived]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1446 of 1510 : Created [IX_CMS_Document_WorkflowColumns]';
    END;

GO

PRINT ' 1447 of 1510 : Analyzing IX_CMS_Document_DocumentNodeID_DocumentID_DocumentCulture';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentNodeID_DocumentID_DocumentCulture') 
    --IS NULL
    BEGIN
	   CREATE  UNIQUE NONCLUSTERED  INDEX
	   [IX_CMS_Document_DocumentNodeID_DocumentID_DocumentCulture]
	   ON [dbo].[CMS_Document] (  [DocumentNodeID]  ASC , [DocumentID]  ASC , [DocumentCulture]  ASC) 
	   WITH
	   ( PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1448 of 1510 : Created [IX_CMS_Document_DocumentNodeID_DocumentID_DocumentCulture]';
    END;

GO

PRINT ' 1449 of 1510 : Analyzing IX_CMS_Document_DocumentUrlPath_DocumentID_DocumentNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentUrlPath_DocumentID_DocumentNodeID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Document_DocumentUrlPath_DocumentID_DocumentNodeID]
	   ON [dbo].[CMS_Document] ( [DocumentUrlPath]  ASC) INCLUDE ( [DocumentID] , [DocumentNodeID]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1450 of 1510 : Created [IX_CMS_Document_DocumentUrlPath_DocumentID_DocumentNodeID]';
    END;

GO

PRINT ' 1451 of 1510 : Analyzing IX_CMS_Document_DocumentModifiedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentModifiedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Document_DocumentModifiedByUserID]
		ON [dbo].[CMS_Document] ( [DocumentModifiedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1452 of 1510 : Created [IX_CMS_Document_DocumentModifiedByUserID]';
    END;

GO

PRINT ' 1453 of 1510 : Analyzing IX_CMS_Document_DocumentCulture_DocumentForeignKeyValue_Workflow';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentCulture_DocumentForeignKeyValue_Workflow') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Document_DocumentCulture_DocumentForeignKeyValue_Workflow]
	   ON [dbo].[CMS_Document] (  [DocumentCulture]  ASC) INCLUDE ( [DocumentForeignKeyValue] , [DocumentCheckedOutVersionHistoryID] , [DocumentPublishedVersionHistoryID] , [DocumentPublishFrom] , [DocumentPublishTo] , [DocumentNodeID] , [DocumentIsArchived]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1454 of 1510 : Created [IX_CMS_Document_DocumentCulture_DocumentForeignKeyValue_Workflow]';
    END;

GO

PRINT ' 1455 of 1510 : Analyzing IX_CMS_Document_DocumentCreatedByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentCreatedByUserID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Document_DocumentCreatedByUserID]
		ON [dbo].[CMS_Document] ( [DocumentCreatedByUserID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1456 of 1510 : Created [IX_CMS_Document_DocumentCreatedByUserID]';
    END;

GO

PRINT ' 1457 of 1510 : Analyzing IX_CMS_Document_DocumentCheckedOutByUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentCheckedOutByUserID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_Document_DocumentCheckedOutByUserID]
		 ON [dbo].[CMS_Document] (  [DocumentCheckedOutByUserID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1458 of 1510 : Created [IX_CMS_Document_DocumentCheckedOutByUserID]';
    END;

GO

PRINT ' 1459 of 1510 : Analyzing IX_CMS_Document_DocumentCulture';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentCulture') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Document_DocumentCulture]
	   ON [dbo].[CMS_Document] (  [DocumentCulture]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1460 of 1510 : Created [IX_CMS_Document_DocumentCulture]';
    END;

GO

PRINT ' 1461 of 1510 : Analyzing IX_CMS_Document_DocumentShowInSiteMap';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentShowInSiteMap') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Document_DocumentShowInSiteMap]
		ON [dbo].[CMS_Document] ( [DocumentShowInSiteMap]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1462 of 1510 : Created [IX_CMS_Document_DocumentShowInSiteMap]';
    END;

GO

PRINT ' 1463 of 1510 : Analyzing IX_CMS_Document_DocumentMenuItemHideInNavigation';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentMenuItemHideInNavigation') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [IX_CMS_Document_DocumentMenuItemHideInNavigation]
		 ON [dbo].[CMS_Document] (  [DocumentMenuItemHideInNavigation]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1464 of 1510 : Created [IX_CMS_Document_DocumentMenuItemHideInNavigation]';
    END;

GO

PRINT ' 1465 of 1510 : Analyzing IX_CMS_Document_DocumentPageTemplateID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentPageTemplateID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Document_DocumentPageTemplateID]
		ON [dbo].[CMS_Document] ( [DocumentPageTemplateID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1466 of 1510 : Created [IX_CMS_Document_DocumentPageTemplateID]';
    END;

GO

PRINT ' 1467 of 1510 : Analyzing IX_CMS_Document_DocumentTagGroupID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentTagGroupID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_Document_DocumentTagGroupID]
		ON [dbo].[CMS_Document] ( [DocumentTagGroupID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1468 of 1510 : Created [IX_CMS_Document_DocumentTagGroupID]';
    END;

GO

PRINT ' 1469 of 1510 : Analyzing IX_CMS_Document_DocumentWildcardRule_DocumentPriority';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_DocumentWildcardRule_DocumentPriority') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Document_DocumentWildcardRule_DocumentPriority]
	   ON [dbo].[CMS_Document] ( [DocumentWildcardRule]  ASC , [DocumentPriority]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1470 of 1510 : Created [IX_CMS_Document_DocumentWildcardRule_DocumentPriority]';
    END;

GO

PRINT ' 1471 of 1510 : Analyzing IX_CMS_Document_CreateDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_CreateDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Document_CreateDate]
	   ON [dbo].[CMS_Document] (  [DocumentCreatedWhen]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1472 of 1510 : Created [IX_CMS_Document_CreateDate]';
    END;

GO

PRINT ' 1473 of 1510 : Analyzing IX_CMS_Document_ModifiedDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_Document_ModifiedDate') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_CMS_Document_ModifiedDate]
	   ON [dbo].[CMS_Document] (  [DocumentModifiedWhen] ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1474 of 1510 : Created [IX_CMS_Document_ModifiedDate]';
    END;

GO

PRINT ' 1475 of 1510 : Analyzing IX_CMS_WebFarmServerTask_ServerID_TaskID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_CMS_WebFarmServerTask_ServerID_TaskID') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[IX_CMS_WebFarmServerTask_ServerID_TaskID]
		ON [dbo].[CMS_WebFarmServerTask] (  [ServerID]  ASC , [TaskID]  ASC) 
		WITH
		(  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1476 of 1510 : Created [IX_CMS_WebFarmServerTask_ServerID_TaskID]';
    END;

GO

PRINT ' 1477 of 1510 : Analyzing CMS_WebFarmServerTask_idx_01';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'CMS_WebFarmServerTask_idx_01') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [CMS_WebFarmServerTask_idx_01]
	   ON [dbo].[CMS_WebFarmServerTask] (  [TaskID]  ASC) WITH (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1478 of 1510 : Created [CMS_WebFarmServerTask_idx_01]';
    END;

GO

PRINT ' 1479 of 1510 : Analyzing IX_COM_PublicStatus_PublicStatusDisplayName_PublicStatusEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_COM_PublicStatus_PublicStatusDisplayName_PublicStatusEnabled') 
    --IS NULL
    BEGIN
	   CREATE CLUSTERED INDEX
	   [IX_COM_PublicStatus_PublicStatusDisplayName_PublicStatusEnabled]
	   ON [dbo].[COM_PublicStatus] (  [PublicStatusDisplayName]  ASC , [PublicStatusEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1480 of 1510 : Created [IX_COM_PublicStatus_PublicStatusDisplayName_PublicStatusEnabled]';
    END;

GO

PRINT ' 1481 of 1510 : Analyzing IX_HFit_Screening_QST_1';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_HFit_Screening_QST_1') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_HFit_Screening_QST_1]
	   ON [dbo].[HFit_Screening_QST] (  [SSISLoadID]  ASC , [SBL_Participant_ID]  ASC) INCLUDE ( Timestamp) WITH (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1482 of 1510 : Created [IX_HFit_Screening_QST_1]';
    END;

GO

PRINT ' 1483 of 1510 : Analyzing HFit_RewardsUserLevelDetail_PiDate';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'HFit_RewardsUserLevelDetail_PiDate') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[HFit_RewardsUserLevelDetail_PiDate]
		ON [dbo].[HFit_RewardsUserLevelDetail] (  [ItemModifiedWhen]  ASC) INCLUDE ( [ItemCreatedWhen]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1484 of 1510 : Created [HFit_RewardsUserLevelDetail_PiDate]';
    END;

GO

PRINT ' 1485 of 1510 : Analyzing PI_HFit_RewardsUserLevelDetail_Date';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_RewardsUserLevelDetail_Date') --IS NULL
    BEGIN CREATE NONCLUSTERED INDEX
		[PI_HFit_RewardsUserLevelDetail_Date]
		ON [dbo].[HFit_RewardsUserLevelDetail] (  [ItemModifiedWhen]  ASC) INCLUDE ( [ItemCreatedWhen]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1486 of 1510 : Created [PI_HFit_RewardsUserLevelDetail_Date]';
    END;

GO

PRINT ' 1487 of 1510 : Analyzing PI_HFit_RewardsUserLevelDetail_LevelNodeID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'PI_HFit_RewardsUserLevelDetail_LevelNodeID') --IS NULL
    BEGIN  CREATE NONCLUSTERED INDEX
		 [PI_HFit_RewardsUserLevelDetail_LevelNodeID]
		 ON [dbo].[HFit_RewardsUserLevelDetail] (  [LevelNodeID]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 100 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1488 of 1510 : Created [PI_HFit_RewardsUserLevelDetail_LevelNodeID]';
    END;

GO

PRINT ' 1489 of 1510 : Analyzing nonUserID';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'nonUserID') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [nonUserID]
	   ON [dbo].[HFit_RewardsUserLevelDetail] (  [UserID]  ASC) INCLUDE ( [ItemID] , [LevelVersionHistoryID] , [ItemCreatedBy] , [ItemCreatedWhen] , [ItemModifiedBy] , [ItemModifiedWhen] , [ItemOrder] , [ItemGUID] , [LevelCompletedDt] , [LevelNodeID] , [RewardGroupNodeId] , [RewardProgramNodeId]) WITH (  PAD_INDEX = OFF , FILLFACTOR = 80 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1490 of 1510 : Created [nonUserID]';
    END;

GO

PRINT ' 1491 of 1510 : Analyzing IX_Staging_Server_ServerSiteID_ServerDisplayName';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_Server_ServerSiteID_ServerDisplayName') --IS NULL
    BEGIN  CREATE CLUSTERED INDEX
		 [IX_Staging_Server_ServerSiteID_ServerDisplayName]
		 ON [dbo].[Staging_Server] (  [ServerSiteID]  ASC , [ServerDisplayName]  ASC) 
		 WITH
		 (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1492 of 1510 : Created [IX_Staging_Server_ServerSiteID_ServerDisplayName]';
    END;

GO

PRINT ' 1493 of 1510 : Analyzing IX_Staging_Server_ServerEnabled';
GO

IF NOT EXISTS (SELECT [Name]
			  FROM [sys].[Indexes]
			  WHERE [Name] = 'IX_Staging_Server_ServerEnabled') 
    --IS NULL
    BEGIN
	   CREATE NONCLUSTERED INDEX
	   [IX_Staging_Server_ServerEnabled]
	   ON [dbo].[Staging_Server] (  [ServerEnabled]  ASC) 
	   WITH
	   (  PAD_INDEX = OFF , FILLFACTOR = 90 , SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON) ON [PRIMARY ];
	   PRINT ' 1494 of 1510 : Created [IX_Staging_Server_ServerEnabled]';
    END;

GO

PRINT ' 1495 of 1510 : *****************************************';
PRINT ' 1496 of 1510 : BEGINNING IVP ***************************';
PRINT ' 1497 of 1510 : *****************************************';

--Turn OFF the DELETE and turn on the INDEX bit to CREATE an index
DECLARE @i1 AS bit = 0;	--PI_CMS_User_UserIsGlobalAdministrator
DECLARE @i2 AS bit = 0;	--pi_CMS_UserSettings_IDMPI
DECLARE @i3 AS bit = 0;	--PI02_view_EDW_RewardUserDetail
DECLARE @i4 AS bit = 0;	--ix_CmsUserSite_Userid_PI
DECLARE @i5 AS bit = 0;	--PI_CMS_UserSite_SiteID
DECLARE @i6 AS bit = 0;	--HFit_Account_AccountID_CI
DECLARE @i7 AS bit = 0;	--HFit_Account_ClientCode_PI
DECLARE @i8 AS bit = 0;	--HFit_Account_SiteID_PI
DECLARE @i9 AS bit = 0;	--ci_HFit_HealthAssesmentUserQuestion_NodeGUID
DECLARE @i10 AS bit = 0;	--HFit_HealthAssesmentUserQuestion_HARiskAreaItemID_PI
DECLARE @i11 AS bit = 0;	--HFit_HealthAssesmentUserRiskArea_HARiskCategoryItemID_PI

--Turn on the DELETE bit to remove the index
DECLARE @d1 AS bit = 0;	--CMS_User.PI_CMS_User_UserIsGlobalAdministrator
DECLARE @d2 AS bit = 0;	--CMS_UserSettings.pi_CMS_UserSettings_IDMPI
DECLARE @d3 AS bit = 0;	--CMS_UserSettings.PI02_view_EDW_RewardUserDetail
DECLARE @d4 AS bit = 0;	--CMS_UserSite.ix_CmsUserSite_Userid_PIHFit_HealthAssesmentUserQuestion_HARiskAreaItemID_PI
DECLARE @d5 AS bit = 0;	--CMS_UserSite.PI_CMS_UserSite_SiteID
DECLARE @d6 AS bit = 0;	--HFit_Account.HFit_Account_AccountID_CI
DECLARE @d7 AS bit = 0;	--HFit_Account.HFit_Account_ClientCode_PI
DECLARE @d8 AS bit = 0;	--HFit_Account.HFit_Account_SiteID_PI
DECLARE @d9 AS bit = 0;	--HFit_HealthAssesmentUserQuestion.ci_HFit_HealthAssesmentUserQuestion_NodeGUID
DECLARE @d10 AS bit = 0;	--HFit_HealthAssesmentUserQuestion.
DECLARE @d11 AS bit = 0;	--HFit_HealthAssesmentUserRiskArea.HFit_HealthAssesmentUserRiskArea_HARiskCategoryItemID_PI
PRINT ' 1498 of 1510 : DECLARES SET';

IF @d11 = 1
    BEGIN
	   DROP INDEX [HFit_HealthAssesmentUserRiskArea_HARiskCategoryItemID_PI] ON [dbo].[HFit_HealthAssesmentUserRiskArea];
    END;
ELSE
    BEGIN IF @i11 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'HFit_HealthAssesmentUserRiskArea_HARiskCategoryItemID_PI') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [HFit_HealthAssesmentUserRiskArea_HARiskCategoryItemID_PI] ON [dbo].[HFit_HealthAssesmentUserRiskArea]
					 (
					 [HARiskCategoryItemID] ASC
					 );
				  END;
		    END;
    END;
PRINT ' 1499 of 1510 :    Processing';
IF @i10 = 1
    BEGIN
	   DROP INDEX [HFit_HealthAssesmentUserQuestion_HARiskAreaItemID_PI] ON [dbo].[HFit_HealthAssesmentUserQuestion];
    END;
ELSE
    BEGIN IF @i10 = 1
		    BEGIN

			   IF @d10 = 1
				  BEGIN
					 IF NOT EXISTS (SELECT [name]
								   FROM [sys].[indexes]
								   WHERE [name] = 'HFit_HealthAssesmentUserQuestion_HARiskAreaItemID_PI') 
						BEGIN
						    CREATE NONCLUSTERED INDEX [HFit_HealthAssesmentUserQuestion_HARiskAreaItemID_PI] ON [dbo].[HFit_HealthAssesmentUserQuestion]
						    (
						    [HARiskAreaItemID] ASC
						    );
						END;
				  END;
		    END;
    END;
PRINT ' 1500 of 1510 :    Processing';
IF @d9 = 1
    BEGIN
	   DROP INDEX [ci_HFit_HealthAssesmentUserQuestion_NodeGUID] ON [dbo].[HFit_HealthAssesmentUserQuestion];
    END;
ELSE
    BEGIN IF @i9 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'ci_HFit_HealthAssesmentUserQuestion_NodeGUID') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [ci_HFit_HealthAssesmentUserQuestion_NodeGUID] ON [dbo].[HFit_HealthAssesmentUserQuestion]
					 (
					 [HAQuestionNodeGUID] ASC
					 ) 
					 INCLUDE ( 	[ItemID] ,
					 [HAQuestionScore] ,
					 [ItemModifiedWhen] ,
					 [HARiskAreaItemID] ,
					 [CodeName] ,
					 [PreWeightedScore] ,
					 [IsProfessionallyCollected]) ;
				  END;
		    END;
    END;
PRINT ' 1501 of 1510 :    Processing';
IF @d8 = 1
    BEGIN
	   DROP INDEX [HFit_Account_SiteID_PI] ON [dbo].[HFit_Account];
    END;
ELSE
    BEGIN IF @i8 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'HFit_Account_SiteID_PI') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [HFit_Account_SiteID_PI] ON [dbo].[HFit_Account]
					 (
					 [SiteID] ASC
					 );
				  END;
		    END;
    END;
PRINT ' 1502 of 1510 :    Processing';
IF @d7 = 1
    BEGIN
	   DROP INDEX [HFit_Account_ClientCode_PI] ON [dbo].[HFit_Account];
    END;
ELSE
    BEGIN IF @i7 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'HFit_Account_ClientCode_PI') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [HFit_Account_ClientCode_PI] ON [dbo].[HFit_Account]
					 (
					 [AccountCD] ASC
					 );
				  END;
		    END;
    END;
PRINT ' 1503 of 1510 :    Processing';
IF @d6 = 1
    BEGIN
	   DROP INDEX [HFit_Account_AccountID_CI] ON [dbo].[HFit_Account];
    END;
ELSE
    BEGIN IF @i6 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'HFit_Account_AccountID_CI') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [HFit_Account_AccountID_CI] ON [dbo].[HFit_Account]
					 (
					 [AccountID] ASC ,
					 [AccountCD] ASC
					 );
				  END;
		    END;
    END;
PRINT ' 1504 of 1510 :    Processing';
IF @d5 = 1
    BEGIN
	   DROP INDEX [PI_CMS_UserSite_SiteID] ON [dbo].[CMS_UserSite];
    END;
ELSE
    BEGIN IF @i5 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'PI_CMS_UserSite_SiteID') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [PI_CMS_UserSite_SiteID] ON [dbo].[CMS_UserSite]
					 (
					 [SiteID] ASC
					 ) 
					 INCLUDE ( 	[UserID]) ;
				  END;
		    END;
    END;
PRINT ' 1505 of 1510 :    Processing';
IF @d4 = 1
    BEGIN
	   DROP INDEX [ix_CmsUserSite_Userid_PI] ON [dbo].[CMS_UserSite];
    END;
ELSE
    BEGIN IF @i4 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'ix_CmsUserSite_Userid_PI') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [ix_CmsUserSite_Userid_PI] ON [dbo].[CMS_UserSite]
					 (
					 [UserID] ASC
					 ) 
					 INCLUDE ( 	[UserSiteID]) ;
				  END;
		    END;
    END;
PRINT ' 1506 of 1510 :    Processing';
IF @d3 = 1
    BEGIN
	   DROP INDEX [PI02_view_EDW_RewardUserDetail] ON [dbo].[CMS_UserSettings];
    END;
ELSE
    BEGIN IF @i3 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'PI02_view_EDW_RewardUserDetail') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [PI02_view_EDW_RewardUserDetail] ON [dbo].[CMS_UserSettings]
					 (
					 [UserSettingsID] ASC ,
					 [HFitUserMpiNumber] ASC
					 );
				  END;
		    END;
    END;
PRINT ' 1507 of 1510 :    Processing';
IF @d2 = 1
    BEGIN
	   DROP INDEX [pi_CMS_UserSettings_IDMPI] ON [dbo].[CMS_UserSettings];
    END;
ELSE
    BEGIN IF @i2 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'pi_CMS_UserSettings_IDMPI') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [pi_CMS_UserSettings_IDMPI] ON [dbo].[CMS_UserSettings]
					 (
					 [UserSettingsID] ASC ,
					 [HFitUserMpiNumber] ASC
					 );
				  END;
		    END;
    END;
PRINT ' 1508 of 1510 :    Processing';
IF @d1 = 1
    BEGIN
	   DROP INDEX [PI_CMS_User_UserIsGlobalAdministrator] ON [dbo].[CMS_User];
    END;
ELSE
    BEGIN IF @i1 = 1
		    BEGIN
			   IF NOT EXISTS (SELECT [name]
							FROM [sys].[indexes]
							WHERE [name] = 'PI_CMS_User_UserIsGlobalAdministrator') 
				  BEGIN
					 CREATE NONCLUSTERED INDEX [PI_CMS_User_UserIsGlobalAdministrator] ON [dbo].[CMS_User]
					 (
					 [UserIsGlobalAdministrator] ASC ,
					 [UserID] ASC
					 );
				  END;
		    END;

    END;

GO

PRINT (' 1510 of 1510 : END OF HAProdTuning.sql') ;

Go



--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Creating view view_EDW_RewardUserLevel';
GO

IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'view_EDW_RewardUserLevel') 
    BEGIN
	   DROP VIEW [view_EDW_RewardUserLevel];
    END;
GO

CREATE VIEW [view_EDW_RewardUserLevel]
AS

--***********************************************************************************************************
--Changes:
--01.20.2015 - (WDM) Added RL_Joined.nodeguid to satisfy #38393
--02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription, SiteGuid
--03.03.2015 : Reviewed by nathan and dale, no change required.
--04.17.2017 : WDM - found the Document Culture was not present and added it after talking with John C.
--***********************************************************************************************************

SELECT DISTINCT [us].[UserId]
		    , [dl].[LevelCompletedDt]
		    , [RL_Joined].[NodeName] AS [LevelName]
		    , [s].[SiteName]
		    , [RL_Joined].[nodeguid]
		    , [s].[SiteGuid]
		    , [RL_Joined].[LevelHeader]
		    , [RL_Joined].[GroupHeadingText]
		    , [RL_Joined].[GroupHeadingDescription]

  FROM
	  [HFit_RewardsUserLevelDetail] AS [dl]
		 INNER JOIN [View_HFit_RewardLevel_Joined] AS [RL_Joined]
			ON [RL_Joined].[NodeId] = [dl].[LevelNodeId]
				AND RL_Joined.DocumentCulture= 'EN-US'
		 JOIN [CMS_UserSite] AS [us]
			ON [us].[UserId] = [dl].[UserId]
		 JOIN [CMS_Site] AS [s]
			ON [s].[SiteId] = [us].[SiteId];

GO

PRINT 'Created view view_EDW_RewardUserLevel';
GO
--  
--  
GO
PRINT '***** FROM: view_EDW_RewardUserLevel.sql';
GO 

--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





print ('Create Table: EDW_PerformanceMeasure');
go

if exists (select name from sys.tables where name = 'EDW_PerformanceMeasure')
BEGIN
	drop table [dbo].[EDW_PerformanceMeasure] ;
END


	CREATE TABLE [dbo].[EDW_PerformanceMeasure](
		[TypeTest] [nvarchar](50) NULL,
		[ObjectName] [nvarchar](80) NULL,
		[RecCount] [int] NULL,
		[StartTime] [datetime] NULL,
		[EndTime] [datetime] NULL,
		[hrs] [int] NULL,
		[mins] [int] NULL,
		[secs] [int] NULL,
		[ms] [nchar](10) NULL
	)


GO

print ('Created Table: EDW_PerformanceMeasure');
go
  --  
  --  
GO 
print('***** FROM: createTableEDW_PerformanceMeasure.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





print ('Processing: EDW_HealthAssessment');
GO

if exists(select name from sys.tables where name = 'EDW_HealthAssessment')
BEGIN	
	drop table EDW_HealthAssessment ;
END

	CREATE TABLE [dbo].[EDW_HealthAssessment]
	(		
		UserStartedItemID  int,
        HealthAssesmentUserStartedNodeGUID  uniqueidentifier,
        UserID  bigint,
        UserGUID  uniqueidentifier,
        HFitUserMpiNumber  bigint,
        SiteGUID  uniqueidentifier,
        AccountID  int,
        AccountCD  nvarchar (8),
        HAStartedDt  datetime,
        HACompletedDt  datetime,
        UserModuleItemId  int,
        UserModuleCodeName  nvarchar(100)
        
		, HAModuleNodeGUID uniqueidentifier	--WDM 8/7/2014 as HAModuleDocumentID
		, CMSNodeGuid uniqueidentifier						--WDM 8/7/2014 as HAModuleDocumentID

        ,HAModuleVersionID  int,
        UserRiskCategoryItemID  int,
        UserRiskCategoryCodeName  nvarchar(100),
        HARiskCategoryNodeGUID  uniqueidentifier,
        HARiskCategoryVersionID  int,
        UserRiskAreaItemID  int,
        UserRiskAreaCodeName  nvarchar(100),
        HARiskAreaNodeGUID  uniqueidentifier,
        HARiskAreaVersionID  int,
        UserQuestionItemID  int,
        Title  nvarchar(4000),
        HAQuestionGuid  uniqueidentifier,
        UserQuestionCodeName  nvarchar(100),
        HAQuestionDocumentID  int,
        HAQuestionVersionID  bigint,
        HAQuestionNodeGUID  uniqueidentifier,
        UserAnswerItemID  int,
        HAAnswerNodeGUID  uniqueidentifier,
        HAAnswerVersionID  bigint,
        UserAnswerCodeName  nvarchar(100),
        HAAnswerValue  nvarchar(255),
        HAModuleScore  float,
        HARiskCategoryScore  float,
        HARiskAreaScore  float,
        HAQuestionScore  float,
        HAAnswerPoints  int,
        PointResults  int,
        UOMCode  nvarchar(10),
        HAScore  int,
        ModulePreWeightedScore  float,
        RiskCategoryPreWeightedScore  float,
        RiskAreaPreWeightedScore  float,
        QuestionPreWeightedScore  float,
        QuestionGroupCodeName  nvarchar(100),
        ChangeType  varchar(1)
       
	   ,IsProfessionallyCollected bit

	   ,ItemCreatedWhen datetime
       ,ItemModifiedWhen  datetime	   
	   ,HARiskCategory_ItemModifiedWhen datetime
	   ,HAUserRiskArea_ItemModifiedWhen datetime
	   ,HAUserQuestion_ItemModifiedWhen datetime
	   ,HAUserAnswers_ItemModifiedWhen datetime
	    ,HAPaperFlg bit
	   ,HATelephonicFlg bit
	)

GO
  --  
  --  
GO 
print('***** FROM: CreateTableEDW_HealthAssessment.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
print 'FROM dropViews.sql' ;
GO

if exists (select table_name from information_schema.tables where table_name = 'view_EDW_HADefinition')
BEGIN
    drop view view_EDW_HADefinition ;
    print 'drop view view_EDW_HADefinition' ;
END

GO

if exists (select table_name from information_schema.tables where table_name = 'view_HFit_TrackerCompositeDetails')
BEGIN
    drop view view_HFit_TrackerCompositeDetails ;
    print 'drop view view_HFit_TrackerCompositeDetails' ;
END

GO 
if exists (select name from sys.objects where name = 'Proc_EDW_HealthAssessmentDefinition')
BEGIN
    drop procedure Proc_EDW_HealthAssessmentDefinition;
    print 'drop procedure Proc_EDW_HealthAssessmentDefinition' ;
END

go

if exists (select name from sys.objects where name = 'proc_EDW_HealthAssessment')
BEGIN
    drop procedure proc_EDW_HealthAssessment;
    print 'drop procedure proc_EDW_HealthAssessment' ;
END

GO

if exists (select name from sys.objects where name = 'proc_getViewsNestedObjects')
BEGIN
    drop procedure proc_getViewsNestedObjects;
    print 'drop procedure proc_getViewsNestedObjects' ;
END

GO

print 'Completed dropViews.sql' ;
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Processing: view_EDW_HealthAssesmentClientView ';
GO

IF EXISTS (SELECT
                  TABLE_NAME
                  FROM INFORMATION_SCHEMA.VIEWS
             WHERE TABLE_NAME = 'view_EDW_HealthAssesmentClientView') 
    BEGIN
        DROP VIEW
             view_EDW_HealthAssesmentClientView;
    END;
GO

--GRANT SELECT
--	ON [dbo].[view_EDW_HealthAssesmentClientView]
--	TO [EDWReader_PRD]
--GO

--******************************************************************************
--8/8/2014 - Generated corrected view in DEV (WDM)
--09.11.2014 (wdm) added to facilitate EDW last mod date
--02.04.2015 (wdm) #48828 added , HACampaign.BiometricCampaignStartDate, 
--		  HACampaign.BiometricCampaignEndDate, HACampaign.CampaignStartDate, 
--		  HACampaign.CampaignEndDate, HACampaign.Name, 
--		  HACampaign.NodeGuid as CampaignNodeGuid
--02.05.2015 Ashwin and I reviewed and approved
-- select top 100 * from view_EDW_HealthAssesmentClientView
--03.27.2015 ( Sowmiya V) - made changes to the view to look at the HealthAssesmentID 
--  only in the join condition.
--  The fix was needed to handle the SR#51281: Platform CampaignNodeGuid missing. 
--	   for view view_EDW_HealthAssesmentClientView
--  Leaving the old code as commented with notes. 
-- 03.13.2015 - (WDM) set the view up for change tracking - the SIMPLE version that does not 
--			 require change tracking tables to be involved.
--select count(*) from view_EDW_HealthAssesmentClientView
--SELECT * FROM   INFORMATION_SCHEMA.VIEWS WHERE  VIEW_DEFINITION like '%view_EDW_HealthAssesmentClientView%'
--******************************************************************************
CREATE VIEW dbo.view_EDW_HealthAssesmentClientView
AS SELECT 
          HFitAcct.AccountID
        , HFitAcct.AccountCD
        , HFitAcct.AccountName
        , HFitAcct.ItemGUID AS ClientGuid
        , CMSSite.SiteGUID
        , NULL AS CompanyID
        , NULL AS CompanyGUID
        , NULL AS CompanyName
        , HAJoined.DocumentName
        , HACampaign.DocumentPublishFrom AS HAStartDate
        , HACampaign.DocumentPublishTo AS HAEndDate
        , HACampaign.NodeSiteID
        , HAAssessmentMod.Title
        , HAAssessmentMod.CodeName
        , HAAssessmentMod.IsEnabled
        , CASE
              WHEN CAST (HACampaign.DocumentCreatedWhen AS date) = CAST (HACampaign.DocumentModifiedWhen AS date) 
                  THEN 'I'
              ELSE 'U'
          END AS ChangeType
        , HACampaign.DocumentCreatedWhen
        , HACampaign.DocumentModifiedWhen
        , HAAssessmentMod.DocumentModifiedWhen AS AssesmentModule_DocumentModifiedWhen     --09.11.2014 (wdm) added to facilitate EDW last mod date
        , HAAssessmentMod.DocumentCulture AS DocumentCulture_HAAssessmentMod
        , HACampaign.DocumentCulture AS DocumentCulture_HACampaign
        , HAJoined.DocumentCulture AS DocumentCulture_HAJoined
        , HACampaign.BiometricCampaignStartDate
        , HACampaign.BiometricCampaignEndDate
        , HACampaign.CampaignStartDate
        , HACampaign.CampaignEndDate
        , HACampaign.Name
        , HACampaign.NodeGuid AS CampaignNodeGuid
        , HACampaign.HACampaignID
          FROM
               dbo.View_HFit_HACampaign_Joined AS HACampaign
                   INNER JOIN dbo.CMS_Site AS CMSSite
                       ON HACampaign.NodeSiteID = CMSSite.SiteID
                   INNER JOIN dbo.HFit_Account AS HFitAcct
                       ON HACampaign.NodeSiteID = HFitAcct.SiteID
                   INNER JOIN dbo.View_HFit_HealthAssessment_Joined AS HAJoined
                       ON HACampaign.HealthAssessmentID = HAJoined.DocumentID      --  added line to handle    SR #51281   
                          -- ON CASE ----03.27.2015 - Commented code to release the SR #51281
                          --WHEN [HACampaign].[HealthAssessmentConfigurationID] < 0
                          --THEN [HACampaign].[HealthAssessmentID]
                          --ELSE [HACampaign].[HealthAssessmentConfigurationID]
                          --END = HAJoined.DocumentID
                      AND HAJoined.DocumentCulture = 'en-US'
                   INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS HAAssessmentMod
                       ON HAJoined.nodeid = HAAssessmentMod.NodeParentID
                      AND HAAssessmentMod.DocumentCulture = 'en-US'
     WHERE HACampaign.DocumentCulture = 'en-US';


GO

PRINT 'Created: view_EDW_HealthAssesmentClientView ';
GO
--  
--  
GO
PRINT '***** FROM: view_EDW_HealthAssesmentClientView.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Processing: view_EDW_RewardAwardDetail ';
GO
IF EXISTS (SELECT
				  TABLE_NAME
				  FROM INFORMATION_SCHEMA.VIEWS
				  WHERE TABLE_NAME = 'view_EDW_RewardAwardDetail') 
	BEGIN
		DROP VIEW
			 view_EDW_RewardAwardDetail;
	END;
GO
CREATE VIEW dbo.view_EDW_RewardAwardDetail
AS

--*************************************************************************************************
--WDM Reviewed 8/6/2014 for needed updates, none required
--09.11.2014 : (wdm) reviewed for EDW last mod date and the view is OK as is
--11.19.2014 : added language to verify returned data
--02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription
--03.03.2015 : (dale/nathan) Added RewardLevelGUID
--03.19.2015 : by request of the EDW team, removed all columns not specificially requested
--			 and verified that was the request before initiating. The commented out columns
--			 were removed as a the solution to this request. 
--			 /*
--			 (WDM) Kept only these coulmns IAW CR-51005
--			 UserGUID
--			 SiteGUID 
--			 HFitUserMPINumber
--			 RewardLevelGUID
--			 RewardValue
--			 ThresholdNumber
--			 UserNotified
--			 IsFulfilled
--			 AccountID
--			 AccountCD
--			 ChangeType
--*/
--04.03.2015 : CR 51853 requested to put back columns that were previously removed. 
--			 AwardDisplayName and AwardType
--*************************************************************************************************

SELECT DISTINCT
	   cu.UserGUID
	 , cs.SiteGUID
	 , cus.HFitUserMpiNumber
	 --, RL_Joined.RewardLevelID
	 , RL_Joined.NodeGuid AS RewardLevelGUID
	   , RL_Joined.AwardType
	 , HFRAUD.AwardDisplayName
	 , HFRAUD.RewardValue
	 , HFRAUD.ThresholdNumber
	 , HFRAUD.UserNotified
	 , HFRAUD.IsFulfilled
	 , hfa.AccountID
	 , HFA.AccountCD
	 , CASE
		   WHEN CAST (HFRAUD.ItemCreatedWhen AS date) = CAST (HFRAUD.ItemModifiedWhen AS date) 
		   THEN 'I'
		   ELSE 'U'
	   END AS                ChangeType
	 --, HFRAUD.ItemCreatedWhen
	 --, HFRAUD.ItemModifiedWhen
	 --, RL_Joined.DocumentCulture 
	 --, HFRAUD.CultureCode
	 --, RL_Joined.LevelName
	 --, RL_Joined.LevelHeader
	 --, RL_Joined.GroupHeadingText
	 --, RL_Joined.GroupHeadingDescription
	   FROM dbo.HFit_RewardsAwardUserDetail AS HFRAUD
				INNER JOIN dbo.View_HFit_RewardLevel_Joined AS RL_Joined
					ON hfraud.RewardLevelNodeId = RL_Joined.NodeID
				   AND RL_Joined.DocumentCulture = 'en-US'
				   AND HFRAUD.CultureCode = 'en-US'
				 INNER JOIN dbo.CMS_User AS CU
					ON hfraud.UserId = cu.UserID
				 INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cu.UserID = cus2.UserID
				 INNER JOIN dbo.HFit_Account AS HFA
					ON cus2.SiteID = HFA.SiteID
				 INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				 INNER JOIN dbo.CMS_UserSettings AS CUS
					ON cu.UserID = cus.UserSettingsUserID;
GO
PRINT 'Processed: view_EDW_RewardAwardDetail ';


GO
PRINT '***** FROM: view_EDW_RewardAwardDetail.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
print ('Processing: view_EDW_RewardTriggerParameters ') ;
go

if exists(select NAME from sys.VIEWS where NAME = 'view_EDW_RewardTriggerParameters')
BEGIN
	drop view view_EDW_RewardTriggerParameters ;
END
GO


--GRANT SELECT
--	ON [dbo].[view_EDW_RewardTriggerParameters]
--	TO [EDWReader_PRD]
--GO


--*******************************************************************************************************************
--8/7/2014  VHFRTJ.DocumentGuid		  --WDM Added in case needed
--8/7/2014  VHFRTJ.NodeGuid			  --WDM Added in case needed
--09.11.2014 : (wdm) Verified last mod date available to EDW - RewardTriggerParameter_DocumentModifiedWhen
--11.17.2014 : (wdm) John C. found that Spanish was being brought across in TriggerName and 
--				ParameterDisplayName. Found that View_HFit_RewardTrigger_Joined has no way to limit the 
--				returned data to Spanish. Created a new view, View_EDW_RewardProgram_Joined, and provided 
--				a FILTER on Document Culture. The, added Launguage fitlers as: 
--					where VHFRTJ.DocumentCulture = 'en-US' AND VHFRTPJ.DocumentCulture = 'en-US'
--				This appears to have eliminated the Spanish.
-- 03.03.2015 : (Dale/Natahn) no changes required.
-- 04.12.2015 : (WDM) In order to implement change tracking on this view, a STAGING table will simply be 
--			 dropped and recreated everytime using this view. It is too small to worry about otherwise.
--SELECT * FROM [view_EDW_RewardTriggerParameters]
--*******************************************************************************************************************
create VIEW [dbo].[view_EDW_RewardTriggerParameters]
AS
--8/7/2014 - added and commented out DocumentGuid and NodeGuid in case needed later
--8/8/2014 - Generated corrected view in DEV (WDM)
	SELECT distinct
		cs.SiteGUID															 --CMS_Site
		, VHFRTJ.RewardTriggerID													 --HFit_RewardTrigger
		, VHFRTJ.TriggerName													 --HFit_RewardTrigger
		, HFLRTPO.RewardTriggerParameterOperatorLKPDisplayName							 --HFit_LKP_RewardTriggerParameterOperator 
		, VHFRTPJ.ParameterDisplayName											 --HFit_RewardTriggerParameter
		, VHFRTPJ.RewardTriggerParameterOperator									 --HFit_RewardTriggerParameter
		, VHFRTPJ.Value														 --HFit_RewardTriggerParameter
		, hfa.AccountID														 --HFit_Account
		, hfa.AccountCD														 --HFit_Account
		, CASE	WHEN CAST(VHFRTJ.DocumentCreatedWhen AS DATE) = CAST(VHFRTJ.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType		
		, VHFRTJ.DocumentGuid													 --CMS_Document
		, VHFRTJ.NodeGuid														 --CMS_Document
		, VHFRTJ.DocumentCreatedWhen												 --CMS_Document
		, VHFRTJ.DocumentModifiedWhen												 --CMS_Document
		,VHFRTPJ.DocumentModifiedWhen as RewardTriggerParameter_DocumentModifiedWhen	  	 --CMS_Document
		,VHFRTPJ.documentculture as documentculture_VHFRTPJ							 --CMS_Document
		,VHFRTJ.documentculture as documentculture_VHFRTJ								 --CMS_Document
	FROM
		dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ 
		--dbo.[View_EDW_RewardProgram_Joined] AS VHFRTJ 		
	INNER JOIN dbo.View_HFit_RewardTriggerParameter_Joined AS VHFRTPJ  ON vhfrtj.NodeID = VHFRTPJ.NodeParentID
	INNER JOIN dbo.HFit_LKP_RewardTriggerParameterOperator AS HFLRTPO  ON VHFRTPJ.RewardTriggerParameterOperator = HFLRTPO.RewardTriggerParameterOperatorLKPID
	INNER JOIN dbo.CMS_Site AS CS  ON VHFRTJ.NodeSiteID = cs.SiteID
	INNER JOIN dbo.HFit_Account AS HFA  ON cs.SiteID = HFA.SiteID
	where VHFRTJ.DocumentCulture = 'en-US'
	AND VHFRTPJ.DocumentCulture = 'en-US'
      

GO


  --  
  --  
GO 
print('***** Created: view_EDW_RewardTriggerParameters.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
print 'FROM dropViews.sql' ;
GO

if exists (select table_name from information_schema.tables where table_name = 'view_EDW_HADefinition')
BEGIN
    drop view view_EDW_HADefinition ;
    print 'drop view view_EDW_HADefinition' ;
END

GO

if exists (select table_name from information_schema.tables where table_name = 'view_HFit_TrackerCompositeDetails')
BEGIN
    drop view view_HFit_TrackerCompositeDetails ;
    print 'drop view view_HFit_TrackerCompositeDetails' ;
END

GO 
if exists (select name from sys.objects where name = 'Proc_EDW_HealthAssessmentDefinition')
BEGIN
    drop procedure Proc_EDW_HealthAssessmentDefinition;
    print 'drop procedure Proc_EDW_HealthAssessmentDefinition' ;
END

go

if exists (select name from sys.objects where name = 'proc_EDW_HealthAssessment')
BEGIN
    drop procedure proc_EDW_HealthAssessment;
    print 'drop procedure proc_EDW_HealthAssessment' ;
END

GO

if exists (select name from sys.objects where name = 'proc_getViewsNestedObjects')
BEGIN
    drop procedure proc_getViewsNestedObjects;
    print 'drop procedure proc_getViewsNestedObjects' ;
END

GO

print 'Completed dropViews.sql' ;
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Creating view view_EDW_RewardUserLevel';
GO

IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'view_EDW_RewardUserLevel') 
    BEGIN
	   DROP VIEW [view_EDW_RewardUserLevel];
    END;
GO

CREATE VIEW [view_EDW_RewardUserLevel]
AS

--***********************************************************************************************************
--Changes:
--01.20.2015 - (WDM) Added RL_Joined.nodeguid to satisfy #38393
--02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription, SiteGuid
--03.03.2015 : Reviewed by nathan and dale, no change required.
--04.17.2017 : WDM - found the Document Culture was not present and added it after talking with John C.
--***********************************************************************************************************

SELECT DISTINCT [us].[UserId]
		    , [dl].[LevelCompletedDt]
		    , [RL_Joined].[NodeName] AS [LevelName]
		    , [s].[SiteName]
		    , [RL_Joined].[nodeguid]
		    , [s].[SiteGuid]
		    , [RL_Joined].[LevelHeader]
		    , [RL_Joined].[GroupHeadingText]
		    , [RL_Joined].[GroupHeadingDescription]

  FROM
	  [HFit_RewardsUserLevelDetail] AS [dl]
		 INNER JOIN [View_HFit_RewardLevel_Joined] AS [RL_Joined]
			ON [RL_Joined].[NodeId] = [dl].[LevelNodeId]
				AND RL_Joined.DocumentCulture= 'EN-US'
		 JOIN [CMS_UserSite] AS [us]
			ON [us].[UserId] = [dl].[UserId]
		 JOIN [CMS_Site] AS [s]
			ON [s].[SiteId] = [us].[SiteId];

GO

PRINT 'Created view view_EDW_RewardUserLevel';
GO
--  
--  
GO
PRINT '***** FROM: view_EDW_RewardUserLevel.sql';
GO 

--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Creating view view_EDW_RewardUserLevel';
GO

IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'view_EDW_RewardUserLevel') 
    BEGIN
	   DROP VIEW [view_EDW_RewardUserLevel];
    END;
GO

CREATE VIEW [view_EDW_RewardUserLevel]
AS

--***********************************************************************************************************
--Changes:
--01.20.2015 - (WDM) Added RL_Joined.nodeguid to satisfy #38393
--02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription, SiteGuid
--03.03.2015 : Reviewed by nathan and dale, no change required.
--04.17.2017 : WDM - found the Document Culture was not present and added it after talking with John C.
--***********************************************************************************************************

SELECT DISTINCT [us].[UserId]
		    , [dl].[LevelCompletedDt]
		    , [RL_Joined].[NodeName] AS [LevelName]
		    , [s].[SiteName]
		    , [RL_Joined].[nodeguid]
		    , [s].[SiteGuid]
		    , [RL_Joined].[LevelHeader]
		    , [RL_Joined].[GroupHeadingText]
		    , [RL_Joined].[GroupHeadingDescription]

  FROM
	  [HFit_RewardsUserLevelDetail] AS [dl]
		 INNER JOIN [View_HFit_RewardLevel_Joined] AS [RL_Joined]
			ON [RL_Joined].[NodeId] = [dl].[LevelNodeId]
				AND RL_Joined.DocumentCulture= 'EN-US'
		 JOIN [CMS_UserSite] AS [us]
			ON [us].[UserId] = [dl].[UserId]
		 JOIN [CMS_Site] AS [s]
			ON [s].[SiteId] = [us].[SiteId];

GO

PRINT 'Created view view_EDW_RewardUserLevel';
GO
--  
--  
GO
PRINT '***** FROM: view_EDW_RewardUserLevel.sql';
GO 

--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




go
print('Creating [view_EDW_RewardUserDetail]') ;
go

if exists (select table_name from information_schema.tables where table_name = 'view_EDW_RewardUserDetail')
BEGIN
    print('Updating [view_EDW_RewardUserDetail]') ;
    drop view view_EDW_RewardUserDetail ;
END
go

CREATE VIEW [dbo].[view_EDW_RewardUserDetail]
AS 
SELECT DISTINCT
--02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription
   [cu].[UserGUID]
 , [CS2].[SiteGUID]
 , [cus2].[HFitUserMpiNumber]
 , [VHFRAJ].[RewardActivityID]
 , [VHFRPJ].[RewardProgramName]
 , [VHFRPJ].[RewardProgramID]
 , [VHFRPJ].[RewardProgramPeriodStart]
 , [VHFRPJ].[RewardProgramPeriodEnd]
 , [VHFRPJ].[DocumentModifiedWhen] AS [RewardModifiedDate]
 , [VHFRGJ].[GroupName]
 , [VHFRGJ].[RewardGroupID]
 , [VHFRGJ].[RewardGroupPeriodStart]
 , [VHFRGJ].[RewardGroupPeriodEnd]
 , [VHFRGJ].[DocumentModifiedWhen] AS [RewardGroupModifieDate]
 , [RL_Joined].[Level]
 , [HFLRLT].[RewardLevelTypeLKPName]
 , [RL_Joined].[DocumentModifiedWhen] AS [RewardLevelModifiedDate]
 , [HFRULD].[LevelCompletedDt]
 , [HFRULD].[LevelVersionHistoryID]
 , [RL_Joined].[RewardLevelPeriodStart]
 , [RL_Joined].[RewardLevelPeriodEnd]
 , [VHFRAJ].[ActivityName]
 , [HFRUAD].[ActivityPointsEarned]
 , [HFRUAD].[ActivityCompletedDt]
 , [HFRUAD].[ActivityVersionID]
 , [HFRUAD].[ItemModifiedWhen] AS [RewardActivityModifiedDate]
 , [VHFRAJ].[RewardActivityPeriodStart]
 , [VHFRAJ].[RewardActivityPeriodEnd]
 , [VHFRAJ].[ActivityPoints]
 , [HFRE].[UserAccepted]
 , [HFRE].[UserExceptionAppliedTo]
 , [HFRE].[ItemModifiedWhen] AS [RewardExceptionModifiedDate]
 , [VHFRTJ].[TriggerName]
 , [VHFRTJ].[RewardTriggerID]
 , [HFLRT2].[RewardTriggerLKPDisplayName]
 , [HFLRT2].[RewardTriggerDynamicValue]
 , [HFLRT2].[ItemModifiedWhen] AS [RewardTriggerModifiedDate]
 , [HFLRT].[RewardTypeLKPName]
 , [HFA].[AccountID]
 , [HFA].[AccountCD]
 , CASE
	  WHEN CAST ([HFRULD].[ItemCreatedWhen] AS date) = CAST ([HFRULD].[ItemModifiedWhen] AS date) 
	  THEN 'I'
	  ELSE 'U'
   END AS [ChangeType]
 , [HFRULD].[ItemCreatedWhen]
 , [HFRULD].[ItemModifiedWhen]

 , [RL_Joined].[LevelName]
 , [RL_Joined].[LevelHeader]
 , [RL_Joined].[GroupHeadingText]
 , [RL_Joined].[GroupHeadingDescription]

	FROM
		[dbo].[View_HFit_RewardProgram_Joined] AS [VHFRPJ]  
		    LEFT OUTER JOIN [dbo].[View_HFit_RewardGroup_Joined] AS [VHFRGJ]  
			   ON [VHFRPJ].[NodeID] = [VHFRGJ].[NodeParentID]
		    LEFT OUTER JOIN [dbo].[View_HFit_RewardLevel_Joined] AS [RL_Joined]  
			   ON [VHFRGJ].[NodeID] = [RL_Joined].[NodeParentID]
		    LEFT OUTER JOIN [dbo].[HFit_LKP_RewardType] AS [HFLRT]  
			   ON [RL_Joined].[AwardType] = [HFLRT].[RewardTypeLKPID]
		    LEFT OUTER JOIN [dbo].[HFit_LKP_RewardLevelType] AS [HFLRLT]  
			   ON [RL_Joined].[LevelType] = [HFLRLT].[RewardLevelTypeLKPID]
		    INNER JOIN [dbo].[HFit_RewardsUserLevelDetail] AS [HFRULD]  
			   ON [RL_Joined].[NodeID] = [HFRULD].[LevelNodeID]
		    INNER JOIN [dbo].[CMS_User] AS [CU]  
			   ON [hfruld].[UserID] = [cu].[UserID]
		    INNER JOIN [dbo].[CMS_UserSite] AS [CUS]  
			   ON [CU].[UserID] = [CUS].[UserID]
		    INNER JOIN [dbo].[CMS_Site] AS [CS2]  
			   ON [CUS].[SiteID] = [CS2].[SiteID]
		    INNER JOIN [dbo].[HFit_Account] AS [HFA]  
			   ON [cs2].[SiteID] = [HFA].[SiteID]
		    INNER JOIN [dbo].[CMS_UserSettings] AS [CUS2]  
			   ON [cu].[UserID] = [cus2].[UserSettingsUserID]
		    LEFT OUTER JOIN [dbo].[View_HFit_RewardActivity_Joined] AS [VHFRAJ]  
			   ON [RL_Joined].[NodeID] = [VHFRAJ].[NodeParentID]
		    INNER JOIN [dbo].[HFit_RewardsUserActivityDetail] AS [HFRUAD]  
			   ON [VHFRAJ].[NodeID] = [HFRUAD].[ActivityNodeID]
		    LEFT OUTER JOIN [dbo].[View_HFit_RewardTrigger_Joined] AS [VHFRTJ]  
			   ON [VHFRAJ].[NodeID] = [VHFRTJ].[NodeParentID]
		    LEFT OUTER JOIN [dbo].[HFit_LKP_RewardTrigger] AS [HFLRT2]  
			   ON [VHFRTJ].[RewardTriggerLKPID] = [HFLRT2].[RewardTriggerLKPID]
		    LEFT OUTER JOIN [dbo].[HFit_RewardException] AS [HFRE]  
			   ON [HFRE].[RewardActivityID] = [VHFRAJ].[RewardActivityID]
			  AND [HFRE].[UserID] = [cu].[UserID];

GO


print('CREATED [view_EDW_RewardUserDetail]') ;
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





go
print('Creating [view_EDW_RewardsDefinition]') ;
go

if exists (select table_name from information_schema.tables where table_name = 'view_EDW_RewardsDefinition')
BEGIN
    print('Updating [view_EDW_RewardsDefinition]') ;
    drop view view_EDW_RewardsDefinition ;
END
go

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



create VIEW [dbo].[view_EDW_RewardsDefinition]
AS
--02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription
	SELECT DISTINCT
		cs.SiteGUID
		, HFA.AccountID
		, hfa.AccountCD
		, RewardProgramID
		, RewardProgramName
		, RewardProgramPeriodStart
		, RewardProgramPeriodEnd
		, ProgramDescription
		, RewardGroupID
		, GroupName
		, RewardContactGroups
		, RewardGroupPeriodStart
		, RewardGroupPeriodEnd
		, RewardLevelID
		, Level
		, RewardLevelTypeLKPName
		, RewardLevelPeriodStart
		, RewardLevelPeriodEnd
		, FrequencyMenu
		, AwardDisplayName
		, AwardType
		, AwardThreshold1
		, AwardThreshold2
		, AwardThreshold3
		, AwardThreshold4
		, AwardValue1
		, AwardValue2
		, AwardValue3
		, AwardValue4
		, CompletionText
		, ExternalFulfillmentRequired
		, RewardHistoryDetailDescription
		, VHFRAJ.RewardActivityID
		, VHFRAJ.ActivityName
		, VHFRAJ.ActivityFreqOrCrit
		, VHFRAJ.RewardActivityPeriodStart
		, VHFRAJ.RewardActivityPeriodEnd
		, VHFRAJ.RewardActivityLKPID
		, VHFRAJ.ActivityPoints
		, VHFRAJ.IsBundle
		, VHFRAJ.IsRequired
		, VHFRAJ.MaxThreshold
		, VHFRAJ.AwardPointsIncrementally
		, VHFRAJ.AllowMedicalExceptions
		, VHFRAJ.BundleText
		, RewardTriggerID
		, HFLRT.RewardTriggerDynamicValue
		, TriggerName
		, RequirementDescription
		, VHFRTPJ.RewardTriggerParameterOperator
		, VHFRTPJ.Value
		, vhfrtpj.ParameterDisplayName
		, CASE	WHEN CAST(VHFRPJ.DocumentCreatedWhen AS DATE) = CAST(VHFRPJ.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, VHFRPJ.DocumentCreatedWhen
		, VHFRPJ.DocumentModifiedWhen

		    , [RL_Joined].[LevelName]
		    , [RL_Joined].[LevelHeader]
		    , [RL_Joined].[GroupHeadingText]
		    , [RL_Joined].[GroupHeadingDescription]

	FROM
		dbo.View_HFit_RewardProgram_Joined AS VHFRPJ
	INNER JOIN dbo.View_HFit_RewardGroup_Joined AS VHFRGJ ON VHFRPJ.NodeID = VHFRGJ.NodeParentID
	INNER JOIN dbo.View_HFit_RewardLevel_Joined AS RL_Joined ON VHFRGJ.NodeID = RL_Joined.NodeParentID
	INNER JOIN dbo.HFit_LKP_RewardLevelType AS HFLRLT ON RL_Joined.LevelType = HFLRLT.RewardLevelTypeLKPID
	INNER JOIN dbo.View_HFit_RewardActivity_Joined AS VHFRAJ ON RL_Joined.NodeID = VHFRAJ.NodeParentID
	INNER JOIN dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ ON VHFRAJ.NodeID = VHFRTJ.NodeParentID
	INNER JOIN dbo.View_HFit_RewardTriggerParameter_Joined AS VHFRTPJ ON vhfrtj.nodeid = vhfrtpj.nodeparentid
	INNER JOIN dbo.HFit_LKP_RewardTrigger AS HFLRT ON VHFRTJ.RewardTriggerLKPID = HFLRT.RewardTriggerLKPID
	INNER JOIN dbo.CMS_Site AS CS ON VHFRPJ.NodeSiteID = cs.SiteID
	INNER JOIN dbo.HFit_Account AS HFA ON cs.SiteID = HFA.SiteID

	  



GO


print('Created [view_EDW_RewardsDefinition]') ;

go 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Processing: view_EDW_HealthAssesmentClientView ';
GO

IF EXISTS (SELECT
                  TABLE_NAME
                  FROM INFORMATION_SCHEMA.VIEWS
             WHERE TABLE_NAME = 'view_EDW_HealthAssesmentClientView') 
    BEGIN
        DROP VIEW
             view_EDW_HealthAssesmentClientView;
    END;
GO

--GRANT SELECT
--	ON [dbo].[view_EDW_HealthAssesmentClientView]
--	TO [EDWReader_PRD]
--GO

--******************************************************************************
--8/8/2014 - Generated corrected view in DEV (WDM)
--09.11.2014 (wdm) added to facilitate EDW last mod date
--02.04.2015 (wdm) #48828 added , HACampaign.BiometricCampaignStartDate, 
--		  HACampaign.BiometricCampaignEndDate, HACampaign.CampaignStartDate, 
--		  HACampaign.CampaignEndDate, HACampaign.Name, 
--		  HACampaign.NodeGuid as CampaignNodeGuid
--02.05.2015 Ashwin and I reviewed and approved
-- select top 100 * from view_EDW_HealthAssesmentClientView
--03.27.2015 ( Sowmiya V) - made changes to the view to look at the HealthAssesmentID 
--  only in the join condition.
--  The fix was needed to handle the SR#51281: Platform CampaignNodeGuid missing. 
--	   for view view_EDW_HealthAssesmentClientView
--  Leaving the old code as commented with notes. 
-- 03.13.2015 - (WDM) set the view up for change tracking - the SIMPLE version that does not 
--			 require change tracking tables to be involved.
--select count(*) from view_EDW_HealthAssesmentClientView
--SELECT * FROM   INFORMATION_SCHEMA.VIEWS WHERE  VIEW_DEFINITION like '%view_EDW_HealthAssesmentClientView%'
--******************************************************************************
CREATE VIEW dbo.view_EDW_HealthAssesmentClientView
AS SELECT 
          HFitAcct.AccountID
        , HFitAcct.AccountCD
        , HFitAcct.AccountName
        , HFitAcct.ItemGUID AS ClientGuid
        , CMSSite.SiteGUID
        , NULL AS CompanyID
        , NULL AS CompanyGUID
        , NULL AS CompanyName
        , HAJoined.DocumentName
        , HACampaign.DocumentPublishFrom AS HAStartDate
        , HACampaign.DocumentPublishTo AS HAEndDate
        , HACampaign.NodeSiteID
        , HAAssessmentMod.Title
        , HAAssessmentMod.CodeName
        , HAAssessmentMod.IsEnabled
        , CASE
              WHEN CAST (HACampaign.DocumentCreatedWhen AS date) = CAST (HACampaign.DocumentModifiedWhen AS date) 
                  THEN 'I'
              ELSE 'U'
          END AS ChangeType
        , HACampaign.DocumentCreatedWhen
        , HACampaign.DocumentModifiedWhen
        , HAAssessmentMod.DocumentModifiedWhen AS AssesmentModule_DocumentModifiedWhen     --09.11.2014 (wdm) added to facilitate EDW last mod date
        , HAAssessmentMod.DocumentCulture AS DocumentCulture_HAAssessmentMod
        , HACampaign.DocumentCulture AS DocumentCulture_HACampaign
        , HAJoined.DocumentCulture AS DocumentCulture_HAJoined
        , HACampaign.BiometricCampaignStartDate
        , HACampaign.BiometricCampaignEndDate
        , HACampaign.CampaignStartDate
        , HACampaign.CampaignEndDate
        , HACampaign.Name
        , HACampaign.NodeGuid AS CampaignNodeGuid
        , HACampaign.HACampaignID
          FROM
               dbo.View_HFit_HACampaign_Joined AS HACampaign
                   INNER JOIN dbo.CMS_Site AS CMSSite
                       ON HACampaign.NodeSiteID = CMSSite.SiteID
                   INNER JOIN dbo.HFit_Account AS HFitAcct
                       ON HACampaign.NodeSiteID = HFitAcct.SiteID
                   INNER JOIN dbo.View_HFit_HealthAssessment_Joined AS HAJoined
                       ON HACampaign.HealthAssessmentID = HAJoined.DocumentID      --  added line to handle    SR #51281   
                          -- ON CASE ----03.27.2015 - Commented code to release the SR #51281
                          --WHEN [HACampaign].[HealthAssessmentConfigurationID] < 0
                          --THEN [HACampaign].[HealthAssessmentID]
                          --ELSE [HACampaign].[HealthAssessmentConfigurationID]
                          --END = HAJoined.DocumentID
                      AND HAJoined.DocumentCulture = 'en-US'
                   INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS HAAssessmentMod
                       ON HAJoined.nodeid = HAAssessmentMod.NodeParentID
                      AND HAAssessmentMod.DocumentCulture = 'en-US'
     WHERE HACampaign.DocumentCulture = 'en-US';


GO

PRINT 'Created: view_EDW_HealthAssesmentClientView ';
GO
--  
--  
GO
PRINT '***** FROM: view_EDW_HealthAssesmentClientView.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO

PRINT '***** EXecute : DropViewCleanUp.sql';
GO

--11.03.2014 Executed against PROD with Mike K.
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_CDC_HealthAssesmentUserAnswers') 
    BEGIN
	   DROP VIEW [View_EDW_CDC_HealthAssesmentUserAnswers]
    END;
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_HAModuleNodeGUID') 
    BEGIN
	   DROP VIEW [View_EDW_HAModuleNodeGUID]
    END;
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_HARiskCategoryNodeGUID') 
    BEGIN
	   DROP VIEW [View_EDW_HARiskCategoryNodeGUID]
    END;
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_HFit_HealthAssesmentUserAnswers') 
    BEGIN
	   DROP VIEW [View_EDW_HFit_HealthAssesmentUserAnswers]
    END;
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_HFit_HealthAssesmentUserModule') 
    BEGIN
	   DROP VIEW [View_EDW_HFit_HealthAssesmentUserModule]
    END;
GO
if exists(select name from sys.views where name = 'View_EDW_HFit_HealthAssesmentUserQuestion')
DROP VIEW View_EDW_HFit_HealthAssesmentUserQuestion
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_HFit_HealthAssesmentUserRiskArea') 
    BEGIN
	   DROP VIEW [View_EDW_HFit_HealthAssesmentUserRiskArea]
    END;
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_HFit_HealthAssesmentUserRiskCategory') 
    BEGIN
	   DROP VIEW [View_EDW_HFit_HealthAssesmentUserRiskCategory]
    END;
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_HFit_HealthAssesmentUserStarted') 
    BEGIN
	   DROP VIEW [View_EDW_HFit_HealthAssesmentUserStarted]
    END;
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_QuestionNodeGuid') 
    BEGIN
	   DROP VIEW [View_EDW_QuestionNodeGuid]
    END;
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_EDW_RiskAreaNodeGuid') 
    BEGIN
	   DROP VIEW [View_EDW_RiskAreaNodeGuid]
    END;
GO
IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'View_HFit_HealthAssesmentUserModule') 
    BEGIN
	   DROP VIEW [View_HFit_HealthAssesmentUserModule]
    END;
GO
--  
--  
PRINT '***** FROM: DropViewCleanUp.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





--select * From HFit_LKP_HES_AwardType
--select * From HFit_LKP_RewardTrigger

GO
PRINT 'FROM view_EDW_Awards';
PRINT 'Creating view_EDW_Awards';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.views
			 WHERE name = 'view_EDW_Awards') 
	BEGIN
		DROP VIEW
			 view_EDW_Awards;
	END;
GO
CREATE VIEW view_EDW_Awards
AS

	 --*************************************************************************************
	 -- 2.3.2015 : WDM - Created the initial view for Awards (HEW)
	 -- 2.3.2015 : WDM - Laura B. had objections as to how the data was pulled, Nate agreed
	 --					to look at it again.
	 --*************************************************************************************

	 SELECT
			AWARD.*
		  , ATYPE.AwardType
		  , ATRIGGER.RewardTriggerLKPName
		  , ATRIGGER.RewardTriggerRewardActivityLKPID
		  , ATRIGGER.RewardTriggerLKPDisplayName
		  , ATRIGGER.HESCode
	   FROM HFit_HES_Award AS AWARD
				JOIN HFit_LKP_RewardTrigger AS ATRIGGER
					ON AWARD.RewardTriggerID = ATRIGGER.RewardTriggerLKPID
				JOIN HFit_LKP_HES_AwardType AS ATYPE
					ON AWARD.HESAwardID = ATYPE.itemID;
GO
PRINT 'Created view_EDW_Awards';
GO

--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO

DECLARE @DBN nvarchar(200) ;
set @DBN = (SELECT DB_NAME()) ;

--USE [msdb]
GO

IF EXISTS (SELECT job_id FROM msdb.dbo.sysjobs_view WHERE name = N'JOB_Update_EDW_Eligibility')
BEGIN
    print ('Dropping JOB JOB_Update_EDW_Eligibility');
    EXEC msdb.dbo.sp_delete_job @job_name=N'JOB_Update_EDW_Eligibility', @delete_unused_schedule=1
END
ELSE
    print ('JOB_Update_EDW_Eligibility DOES NOT exists.');
GO

print ('Creating JOB JOB_Update_EDW_Eligibility');
GO

DECLARE @jobId BINARY(16)
EXEC  msdb.dbo.sp_add_job @job_name=N'JOB_Update_EDW_Eligibility', 
		@enabled=1, 
		@notify_level_eventlog=0, 
		@notify_level_email=2, 
		@notify_level_netsend=2, 
		@notify_level_page=2, 
		@delete_level=0, 
		@description=N'Updates the daily status of the PPT eligibility allowing for the EDW to track current and expired eligibilities.', 
		@category_name=N'[Uncategorized (Local)]', 
		@owner_login_name=N'SA', @job_id = @jobId OUTPUT
--select @jobId
GO

declare @ServerName nvarchar(80);
set @ServerName = (SELECT @@SERVERNAME ) ;
EXEC msdb.dbo.sp_add_jobserver @job_name=N'JOB_Update_EDW_Eligibility', @server_name = @ServerName
GO
--USE [msdb]
GO


DECLARE @DBN nvarchar(200) ;
set @DBN = (SELECT DB_NAME()) ;
EXEC msdb.dbo.sp_add_jobstep @job_name=N'JOB_Update_EDW_Eligibility', @step_name=N'update the eligibility history', 
		@step_id=1, 
		@cmdexec_success_code=0, 
		@on_success_action=1, 
		@on_fail_action=2, 
		@retry_attempts=0, 
		@retry_interval=0, 
		@os_run_priority=0, @subsystem=N'TSQL', 
		@command=N'exec proc_build_EDW_Eligibility', 
		@database_name=@DBN, 
		@flags=0
GO
--USE [msdb]


GO
EXEC msdb.dbo.sp_update_job @job_name=N'JOB_Update_EDW_Eligibility', 
		@enabled=1, 
		@start_step_id=1, 
		@notify_level_eventlog=0, 
		@notify_level_email=2, 
		@notify_level_netsend=2, 
		@notify_level_page=2, 
		@delete_level=0, 
		@description=N'Updates the daily status of the PPT eligibility allowing for the EDW to track current and expired eligibilities.', 
		@category_name=N'[Uncategorized (Local)]', 
		@owner_login_name=N'SA', 
		@notify_email_operator_name=N'', 
		@notify_netsend_operator_name=N'', 
		@notify_page_operator_name=N''
GO
--USE [msdb]
GO
DECLARE @schedule_id int
EXEC msdb.dbo.sp_add_jobschedule @job_name=N'JOB_Update_EDW_Eligibility', @name=N'Schedule for Update EDW Eligibility', 
		@enabled=1, 
		@freq_type=4, 
		@freq_interval=1, 
		@freq_subday_type=1, 
		@freq_subday_interval=0, 
		@freq_relative_interval=0, 
		@freq_recurrence_factor=1, 
		@active_start_date=20150204, 
		@active_end_date=99991231, 
		@active_start_time=190000, 
		@active_end_time=235959, @schedule_id = @schedule_id OUTPUT
--select @schedule_id
GO


--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO

PRINT '****************************************************************************************************************';
PRINT 'FROM: C:\Users\wmiller\Documents\SQL Server Management Studio\HFit_Rewrite\CurrentWork\DataUpdates\RejectList';

GO

IF EXISTS (SELECT [name]
		   FROM [sys].[procedures]
		   WHERE [name] = 'proc_Insert_EDW_BiometricViewRejectCriteria') 
    BEGIN
	   PRINT 'proc_Insert_EDW_BiometricViewRejectCriteria found, updating.';
	   DROP PROCEDURE [proc_Insert_EDW_BiometricViewRejectCriteria];
    END;
ELSE
    BEGIN
	   PRINT 'Creating proc_Insert_EDW_BiometricViewRejectCriteria';
    END;
GO

CREATE PROC [proc_Insert_EDW_BiometricViewRejectCriteria] (
	  @AccountCD AS nvarchar (50) , @ItemCreatedWhen AS datetime , @SiteID AS int) 
AS
BEGIN

    if (@SiteID is null)
	   set @SiteID = -1 ;

    DECLARE @iCnt integer = 0;
    SET @iCnt = (SELECT COUNT (*) 
			    FROM [EDW_BiometricViewRejectCriteria]
			    WHERE [AccountCD] = @AccountCD
				 AND [SiteID] = @SiteID) ;
    IF @iCnt <= 0
	   BEGIN
		  INSERT INTO [dbo].[EDW_BiometricViewRejectCriteria]
		  ([AccountCD]
		 , [ItemCreatedWhen]
		 , [SiteID]
		  ) 
		  VALUES
		  (@AccountCD
		  , @ItemCreatedWhen
		  , @SiteID
		  );
		  PRINT 'ADDED ' + @AccountCD + ' to EDW_BiometricViewRejectCriteria.';
	   END;
    ELSE
	   BEGIN
		  PRINT 'Account ' + @AccountCD + ' already defined to EDW_BiometricViewRejectCriteria.';
	   END;
END;

GO

IF EXISTS (SELECT [name]
		   FROM [sys].[procedures]
		   WHERE [name] = 'proc_Insert_EDW_BiometricViewRejectCriteria') 
    BEGIN
	   PRINT 'proc_Insert_EDW_BiometricViewRejectCriteria found, executing updates.';

	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'brunswic' , '01/20/2015' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'NWEnergy' , '02/10/15' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'Fluor' , '02/5/15' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'Gerdau' , '01/22/2015' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'trstmark' , '10/31/2013' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'entergy' , '2/4/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'mcwp' , '2/1/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'stateneb' , '4/7/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'jnj' , '5/13/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'coopers' , '6/13/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'cnh' , '7/29/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'amat' , '7/29/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'dupont' , '8/7/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'ejones' , '8/20/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'avera' , '9/2/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'sprvalu' , '9/10/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'firstgrp' , '9/21/2014' , -1;
	   EXEC [proc_Insert_EDW_BiometricViewRejectCriteria] 'rexnord' , '10/20/2014' , -1;
    END;
ELSE
    BEGIN
	   PRINT 'ERROR - **********************************************************';
	   PRINT 'ERROR - proc_Insert_EDW_BiometricViewRejectCriteria NOT FOUND';
	   PRINT 'ERROR - **********************************************************';
    END;

GO

--select * from EDW_BiometricViewRejectCriteria--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




print('Processing: EDW_HealthAssessmentDefinition');
GO

if exists(select name from sys.tables where name = 'EDW_HealthAssessmentDefinition')
BEGIN	
	drop table EDW_HealthAssessmentDefinition ;
END

	CREATE TABLE [dbo].[EDW_HealthAssessmentDefinition](
		[SiteGuid] [int] NULL,
		[AccountCD] [int] NULL,
		[HANodeID] [int] NOT NULL,
		[HANodeName] [nvarchar](100) NOT NULL,
		[HADocumentID] [int] NOT NULL,
		[HANodeSiteID] [int] NOT NULL,
		[HADocPubVerID] [int] NULL,
		[ModTitle] [nvarchar](150) NOT NULL,
		[IntroText] [varchar](4000) NULL,
		[ModDocGuid] [uniqueidentifier] NULL,
		[ModWeight] [int] NOT NULL,
		[ModIsEnabled] [bit] NOT NULL,
		[ModCodeName] [nvarchar](100) NOT NULL,
		[ModDocPubVerID] [int] NULL,
		[RCTitle] [nvarchar](150) NOT NULL,
		[RCWeight] [int] NOT NULL,
		[RCDocumentGUID] [uniqueidentifier] NULL,
		[RCIsEnabled] [bit] NOT NULL,
		[RCCodeName] [nvarchar](100) NOT NULL,
		[RCDocPubVerID] [int] NULL,
		[RATytle] [nvarchar](150) NOT NULL,
		[RAWeight] [int] NOT NULL,
		[RADocumentGuid] [uniqueidentifier] NULL,
		[RAIsEnabled] [bit] NOT NULL,
		[RACodeName] [nvarchar](100) NOT NULL,
		[RAScoringStrategyID] [int] NOT NULL,
		[RADocPubVerID] [int] NULL,
		[QuestionType] [nvarchar](100) NOT NULL,
		[QuesTitle] [varchar](max) NULL,
		[QuesWeight] [int] NOT NULL,
		[QuesIsRequired] [bit] NOT NULL,
		[QuesDocumentGuid] [uniqueidentifier] NULL,
		[QuesIsEnabled] [bit] NOT NULL,
		[QuesIsVisible] [nvarchar](max) NULL,
		[QuesIsSTaging] [bit] NOT NULL,
		[QuestionCodeName] [nvarchar](100) NOT NULL,
		[QuesDocPubVerID] [int] NULL,
		[AnsValue] [nvarchar](150) NULL,
		[AnsPoints] [int] NULL,
		[AnsDocumentGuid] [uniqueidentifier] NULL,
		[AnsIsEnabled] [bit] NULL,
		[AnsCodeName] [nvarchar](100) NULL,
		[AnsUOM] [nvarchar](5) NULL,
		[AnsDocPUbVerID] [int] NULL,
		[ChangeType] [varchar](1) NOT NULL,
		[DocumentCreatedWhen] [datetime2] (7) NULL,
		[DocumentModifiedWhen] [datetime2] (7) NULL,
		[CmsTreeNodeGuid] [uniqueidentifier] NOT NULL,
		[HANodeGUID] [uniqueidentifier] NOT NULL
	)

print('Processed: EDW_HealthAssessmentDefinition');
GO
  --  
  --  
GO 
print('***** FROM: CreateEDW_HealthAssessmentDefinition.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





print('Processing: Tracker_EDW_Metadata');
go


--create proc CreateTracker_EDW_Metadata
--as
GO 
if exists(Select name from sys.tables where name = 'Tracker_EDW_Metadata')
BEGIN
	print ('MAY NEED TO DROP the Tracker_EDW_Metadata table');
	drop table Tracker_EDW_Metadata;
END
go
if not exists(Select name from sys.tables where name = 'Tracker_EDW_Metadata')
BEGIN
	print ('Creating the Tracker_EDW_Metadata table');
	CREATE TABLE [dbo].[Tracker_EDW_Metadata] (
			[TableName]             [nvarchar](100) NOT NULL,
			[ColName]               [nvarchar](100) NOT NULL,
			[AttrName]              [nvarchar](100) NOT NULL,
			[AttrVal]               [nvarchar](250) NULL,
			[CreatedDate]           [datetime2] (7) NULL,
			[LastModifiedDate]      [datetime2] (7) NULL,
			[ID]                    [int] IDENTITY(1, 1) NOT NULL,
			[ClassLastModified]     [datetime] NULL
	) ON [PRIMARY]

	ALTER TABLE [dbo].[Tracker_EDW_Metadata]
	ADD
	CONSTRAINT [DF_Tracker_EDW_Metadata_CreatedDate]
	DEFAULT (getdate()) FOR [CreatedDate]

	ALTER TABLE [dbo].[Tracker_EDW_Metadata]
		ADD
		CONSTRAINT [DF_Tracker_EDW_Metadata_LastModifiedDate]
		DEFAULT (getdate()) FOR [LastModifiedDate]

	CREATE UNIQUE CLUSTERED INDEX [PK_Tracker_EDW_Metadata]
		ON [dbo].[Tracker_EDW_Metadata] ([TableName], [ColName], [AttrName]) ON [PRIMARY]

	ALTER TABLE [dbo].[Tracker_EDW_Metadata] SET (LOCK_ESCALATION = TABLE)

END
GO

print ('Created the Tracker_EDW_Metadata table');
  --  
  --  
GO 
print('***** FROM: CreateTracker_EDW_Metadata.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
Print ('Building Tracker_EDW_Metadata process') ;
drop view [dbo].[view_EDW_TrackerMetadata] ;
go

ALTER TABLE [dbo].[Tracker_EDW_Metadata] DROP CONSTRAINT [DF_Tracker_EDW_Metadata_LastModifiedDate]
GO

ALTER TABLE [dbo].[Tracker_EDW_Metadata] DROP CONSTRAINT [DF_Tracker_EDW_Metadata_CreatedDate]
GO

/****** Object:  Table [dbo].[Tracker_EDW_Metadata]    Script Date: 7/30/2014 3:34:02 PM ******/
DROP TABLE [dbo].[Tracker_EDW_Metadata]
GO

/****** Object:  Table [dbo].[Tracker_EDW_Metadata]    Script Date: 7/30/2014 3:34:02 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Tracker_EDW_Metadata](
	[TableName] [nvarchar](100) NOT NULL,
	[ColName] [nvarchar](100) NOT NULL,
	[AttrName] [nvarchar](100) NOT NULL,
	[AttrVal] [nvarchar](250) NULL,
	[CreatedDate] [datetime2] (7) NULL,
	[LastModifiedDate] [datetime2] (7) NULL,
	[ID] [int] IDENTITY(1,1) NOT NULL
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[Tracker_EDW_Metadata] ADD  CONSTRAINT [DF_Tracker_EDW_Metadata_CreatedDate]  DEFAULT (getdate()) FOR [CreatedDate]
GO

ALTER TABLE [dbo].[Tracker_EDW_Metadata] ADD  CONSTRAINT [DF_Tracker_EDW_Metadata_LastModifiedDate]  DEFAULT (getdate()) FOR [LastModifiedDate]
GO

/****** Object:  Index [PK_Tracker_EDW_Metadata]    Script Date: 7/30/2014 3:34:43 PM ******/
CREATE UNIQUE CLUSTERED INDEX [PK_Tracker_EDW_Metadata] ON [dbo].[Tracker_EDW_Metadata]
(
	[TableName] ASC,
	[ColName] ASC,
	[AttrName] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO

create View [dbo].[view_EDW_TrackerMetadata]
as
SELECT TableName, ColName, AttrName, AttrVal, CreatedDate, LastModifiedDate, ID
FROM     Tracker_EDW_Metadata

 GO
Print ('COMPLETED Tracker_EDW_Metadata process') ;
GO 
print('***** FROM: HFIT_Build_Tracker_Metadata_Environment.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





print ('Processing: Proc_EDW_HealthAssessment') ;
go

if exists (select * from sysobjects where name = 'Proc_EDW_HealthAssessment' and Xtype = 'P')
BEGIN
	drop procedure Proc_EDW_HealthAssessment ;
END 
go

CREATE procedure [dbo].[Proc_EDW_HealthAssessment] (@StartDate as datetime, @EndDate as datetime, @TrackPerf as nvarchar(1))
--WITH EXECUTE AS OWNER
as

--***********************************************************************************************
--NOTE: This proc is currently set up to enter records into a staging table "EDW_HealthAssessment".
--		It runs in about the same time as the non-staging query, This allows the EDW instant access
--		to the HA records once this proc has completed. No changes would be required to the EDW
--		processing as the column names and ordinals are the same. A job can be set up to run this 
--		procedure on a scheduled basis. IT IS NOT IN PRODUCTION YET.

--7/15/2014 17:19 min. 46,750 Rows DEV
--7/15/2014 per Mark Turner:
--	HAModuleDocumentID is on its way out, so is Module, RiskCategory, RiskArea, Question, Answer 
--	all the "DocumentID" fields are deprecated and replaced by corresponding NodeGUID fields
--08/08/2014 - Executed in DEV with GUID changes, new views
--08/08/2014 - Generated corrected view in DEV
--08/08/2014 - 18:06 min. 51,282 Rows DEV
--08/08/2014 - 00:35 sec. 51,282 Rows DEV after conversion to SP (wdm)
--08/08/2014 - 00:35 sec. 51,282 Rows QA after conversion to SP (wdm)
--08/19/2014 - Found this proc missing some of the views created yesterday - recreated the 2 missing views and all works well
--08/29/2014 - 00:35 sec. 51,282 Rows LAB/Prod1 (wdm)
--(52480 row(s) affected)  @EndTime: Sep  2 2014  3:24PM / 1:41 exec time (not using insert into staging table)
--(52480 row(s) affected)  @EndTime: Sep  2 2014  3:24PM / 1:40 exec time (using insert into staging table)
--USE: exec Proc_EDW_HealthAssessment '2013-05-22', '2014-09-23', 'Y'	--This causes between dates to be pulled
--     exec Proc_EDW_HealthAssessment NULL, NULL, 'Y'					--This causes one day's previous data to be pulled

--Auth:	GRANT EXECUTE ON dbo.Proc_EDW_HealthAssessment TO <UserID>;
--Action: This proc creates table EDW_HealthAssessment and a view to access the table view_EDW_HAassessment.
--			Select on the view is granted to PUBLIC. This provides EDW with instant access to data.


-- 09.11.2014 : (wdm) Verified DATES to resolve EDW last mod date issue
--***********************************************************************************************
begin

	IF OBJECT_ID('tempdb..#View_EDW_HealthAssesmentQuestions') IS NULL 
	BEGIN
		create TABLE #View_EDW_HealthAssesmentQuestions
		(
			Title nvarchar(4000),
			NodeGUID uniqueidentifier,
			DocumentGUID uniqueidentifier,
			DocumentCulture nvarchar(50)
		);
		INSERT INTO #View_EDW_HealthAssesmentQuestions (Title, NodeGUID, DocumentGUID, DocumentCulture)
			SELECT Title, NodeGUID, DocumentGUID, DocumentCulture
		FROM View_EDW_HealthAssesmentQuestions ;

		CREATE CLUSTERED INDEX [TEMPIX_View_EDW_HealthAssesmentQuestions] ON #View_EDW_HealthAssesmentQuestions
		(
			DocumentGUID ASC,
			NodeGUID ASC,
			DocumentCulture
		)
	END

	IF OBJECT_ID('tempdb..#View_CMS_Tree_Joined') IS NULL 
	BEGIN
		create TABLE #View_CMS_Tree_Joined
		(
			DocumentGUID uniqueidentifier,
			NodeGUID uniqueidentifier,
			DocumentCulture nvarchar(50)
		);
		INSERT INTO #View_CMS_Tree_Joined (DocumentGUID, NodeGUID, DocumentCulture)
			SELECT DocumentGUID, NodeGUID, DocumentCulture
		FROM View_CMS_Tree_Joined ;

		CREATE CLUSTERED INDEX [TEMPIX_View_CMS_Tree_Joined] ON #View_CMS_Tree_Joined
		(
			DocumentGUID ASC,
			NodeGUID ASC,
			DocumentCulture
		)
	END
	

	set @TrackPerf = 'Y' ;
	set @StartDate = '2001-04-08';
	set @EndDate = '2015-07-02';

	declare @P0Start as datetime2 ;
	declare @P0End as datetime2 ;
	declare @P1Start as datetime2 ;
	declare @P1End as datetime2 ;
	
	set @P0Start = getdate() ;
	set @P1Start = getdate() ;
	
--select * from EDW_HealthAssessment	

if exists(select name from sys.tables where name = 'EDW_HealthAssessment')
BEGIN	
	drop table EDW_HealthAssessment ;
END


CREATE TABLE [dbo].[EDW_HealthAssessment](
	[UserStartedItemID] [int] NOT NULL,
	[HealthAssesmentUserStartedNodeGUID] [uniqueidentifier] NULL,
	[UserID] [bigint] NOT NULL,
	[UserGUID] [uniqueidentifier] NOT NULL,
	[HFitUserMpiNumber] [bigint] NULL,
	[SiteGUID] [uniqueidentifier] NOT NULL,
	[AccountID] [int] NOT NULL,
	[AccountCD] [nvarchar](8) NULL,
	[HAStartedDt] [datetime2] (7)  NOT NULL,
	[HACompletedDt] [datetime2] (7)  NULL,
	[UserModuleItemId] [int] NOT NULL,
	[UserModuleCodeName] [nvarchar](100) NOT NULL,
	[HAModuleNodeGUID] [uniqueidentifier] NOT NULL,
	[CMSNodeGuid] [uniqueidentifier] NOT NULL,
	[HAModuleVersionID] [int] NULL,
	[UserRiskCategoryItemID] [int] NOT NULL,
	[UserRiskCategoryCodeName] [nvarchar](100) NOT NULL,
	[HARiskCategoryNodeGUID] [uniqueidentifier] NOT NULL,
	[HARiskCategoryVersionID] [int] NULL,
	[UserRiskAreaItemID] [int] NOT NULL,
	[UserRiskAreaCodeName] [nvarchar](100) NOT NULL,
	[HARiskAreaNodeGUID] [uniqueidentifier] NOT NULL,
	[HARiskAreaVersionID] [int] NULL,
	[UserQuestionItemID] [int] NOT NULL,
	[Title] [nvarchar](max) NOT NULL,
	[HAQuestionGuid] [uniqueidentifier] NOT NULL,
	[UserQuestionCodeName] [nvarchar](100) NOT NULL,
	[HAQuestionDocumentID] [int] NULL,
	[HAQuestionVersionID] [int] NULL,
	[HAQuestionNodeGUID] [uniqueidentifier] NOT NULL,
	[UserAnswerItemID] [int] NOT NULL,
	[HAAnswerNodeGUID] [uniqueidentifier] NOT NULL,
	[HAAnswerVersionID] [int] NULL,
	[UserAnswerCodeName] [nvarchar](100) NOT NULL,
	[HAAnswerValue] [nvarchar](255) NULL,
	[HAModuleScore] [float] NOT NULL,
	[HARiskCategoryScore] [float] NULL,
	[HARiskAreaScore] [float] NULL,
	[HAQuestionScore] [float] NULL,
	[HAAnswerPoints] [int] NULL,
	[PointResults] [int] NULL,
	[UOMCode] [nvarchar](10) NULL,
	[HAScore] [int] NULL,
	[ModulePreWeightedScore] [float] NULL,
	[RiskCategoryPreWeightedScore] [float] NULL,
	[RiskAreaPreWeightedScore] [float] NULL,
	[QuestionPreWeightedScore] [float] NULL,
	[QuestionGroupCodeName] [nvarchar](100) NULL,
	[ChangeType] [varchar](1) NOT NULL,
	[ItemCreatedWhen] [datetime2] (7)  NULL,
	[ItemModifiedWhen] [datetime2] (7)  NULL,
	[IsProfessionallyCollected] [bit] NOT NULL,
	[HARiskCategory_ItemModifiedWhen] [datetime2] (7)  NULL,
	[HAUserRiskArea_ItemModifiedWhen] [datetime2] (7)  NULL,
	[HAUserQuestion_ItemModifiedWhen] [datetime2] (7)  NULL,
	[HAUserAnswers_ItemModifiedWhen] [datetime2] (7)  NULL,
	[HAPaperFlg] [bit] NOT NULL,
	[HATelephonicFlg] [bit] NOT NULL
	--[HAStartedMode] [int] NOT NULL,
	--[HACompletedMode] [int] NOT NULL
) ;


declare @SQL as varchar(2000) ;

if not exists(select name from sys.views where name = 'view_EDW_HAassessment')
BEGIN
	set @SQL = 
		'create view view_EDW_HAassessment
			as
			SELECT [UserStartedItemID]
		  ,[HealthAssesmentUserStartedNodeGUID]
		  ,[UserID]
		  ,[UserGUID]
		  ,[HFitUserMpiNumber]
		  ,[SiteGUID]
		  ,[AccountID]
		  ,[AccountCD]
		  ,[HAStartedDt]
		  ,[HACompletedDt]
		  ,[UserModuleItemId]
		  ,[UserModuleCodeName]
		  ,[HAModuleNodeGUID]
		  ,[CMSNodeGuid]
		  ,[HAModuleVersionID]
		  ,[UserRiskCategoryItemID]
		  ,[UserRiskCategoryCodeName]
		  ,[HARiskCategoryNodeGUID]
		  ,[HARiskCategoryVersionID]
		  ,[UserRiskAreaItemID]
		  ,[UserRiskAreaCodeName]
		  ,[HARiskAreaNodeGUID]
		  ,[HARiskAreaVersionID]
		  ,[UserQuestionItemID]
		  ,[Title]
		  ,[HAQuestionGuid]
		  ,[UserQuestionCodeName]
		  ,[HAQuestionDocumentID]
		  ,[HAQuestionVersionID]
		  ,[HAQuestionNodeGUID]
		  ,[UserAnswerItemID]
		  ,[HAAnswerNodeGUID]
		  ,[HAAnswerVersionID]
		  ,[UserAnswerCodeName]
		  ,[HAAnswerValue]
		  ,[HAModuleScore]
		  ,[HARiskCategoryScore]
		  ,[HARiskAreaScore]
		  ,[HAQuestionScore]
		  ,[HAAnswerPoints]
		  ,[PointResults]
		  ,[UOMCode]
		  ,[HAScore]
		  ,[ModulePreWeightedScore]
		  ,[RiskCategoryPreWeightedScore]
		  ,[RiskAreaPreWeightedScore]
		  ,[QuestionPreWeightedScore]
		  ,[QuestionGroupCodeName]
		  ,[ChangeType]
		  ,[ItemCreatedWhen]
		  ,[ItemModifiedWhen]
		  ,[IsProfessionallyCollected]
		  ,[HARiskCategory_ItemModifiedWhen]
		  ,[HAUserRiskArea_ItemModifiedWhen]
		  ,[HAUserQuestion_ItemModifiedWhen]
		  ,[HAUserAnswers_ItemModifiedWhen]
		  ,[HAPaperFlg]
		  ,[HATelephonicFlg]
		  --,[HAStartedMode]
		  --,[HACompletedMode]
	  FROM [dbo].[EDW_HealthAssessment]'; 
			  
	  exec (@SQL) ;

	  GRANT SELECT ON view_EDW_HAassessment TO public;

END

	IF @StartDate is null 
		BEGIN
			--set @StartDate = getdate() - 1 ;
			set @StartDate  =DATEADD(Day, 0, DATEDIFF(Day, 0, GetDate())) -1 ;	--Midnight yesterday;	
			set @StartDate = @StartDate  -1 ;	
		END
		IF @EndDate is null 
		BEGIN
			set @EndDate = getdate();
			--set @StartDate  =DATEADD(Day, 0, DATEDIFF(Day, 0, GetDate())) ;	--Midnight today;		
		END

--select top 10 * from view_EDW_HealthAssesment
	INSERT INTO [dbo].[EDW_HealthAssessment]
           ([UserStartedItemID]
           ,[HealthAssesmentUserStartedNodeGUID]
           ,[UserID]
           ,[UserGUID]
           ,[HFitUserMpiNumber]
           ,[SiteGUID]
           ,[AccountID]
           ,[AccountCD]
           ,[HAStartedDt]
           ,[HACompletedDt]
           ,[UserModuleItemId]
           ,[UserModuleCodeName]
           ,[HAModuleNodeGUID]
           ,[CMSNodeGuid]
           ,[HAModuleVersionID]
           ,[UserRiskCategoryItemID]
           ,[UserRiskCategoryCodeName]
           ,[HARiskCategoryNodeGUID]
           ,[HARiskCategoryVersionID]
           ,[UserRiskAreaItemID]
           ,[UserRiskAreaCodeName]
           ,[HARiskAreaNodeGUID]
           ,[HARiskAreaVersionID]
           ,[UserQuestionItemID]
           ,[Title]
           ,[HAQuestionGuid]
           ,[UserQuestionCodeName]
           ,[HAQuestionDocumentID]
           ,[HAQuestionVersionID]
           ,[HAQuestionNodeGUID]
           ,[UserAnswerItemID]
           ,[HAAnswerNodeGUID]
           ,[HAAnswerVersionID]
           ,[UserAnswerCodeName]
           ,[HAAnswerValue]
           ,[HAModuleScore]
           ,[HARiskCategoryScore]
           ,[HARiskAreaScore]
           ,[HAQuestionScore]
           ,[HAAnswerPoints]
           ,[PointResults]
           ,[UOMCode]
           ,[HAScore]
           ,[ModulePreWeightedScore]
           ,[RiskCategoryPreWeightedScore]
           ,[RiskAreaPreWeightedScore]
           ,[QuestionPreWeightedScore]
           ,[QuestionGroupCodeName]
           ,[ChangeType]
           ,[ItemCreatedWhen]
           ,[ItemModifiedWhen]
           ,[IsProfessionallyCollected]
           ,[HARiskCategory_ItemModifiedWhen]
           ,[HAUserRiskArea_ItemModifiedWhen]
           ,[HAUserQuestion_ItemModifiedWhen]
           ,[HAUserAnswers_ItemModifiedWhen]
           ,[HAPaperFlg]
           ,[HATelephonicFlg]
           --,[HAStartedMode]
           --,[HACompletedMode]
		   )
	
			SELECT  --distinct
			HAUserStarted.ItemID AS UserStartedItemID				
			, VHAJ.NodeGUID as  HealthAssesmentUserStartedNodeGUID	--Per John C. 10.16.2014 requested that this be put back into the view.	
																	--11.05.2014 - Changed from CMS_TREE Joined to View_HFit_HealthAssessment_Joined Mark T. / Dale M.
			, HAUserStarted.UserID
			, CMSUser.UserGUID
			, UserSettings.HFitUserMpiNumber
			, CMSSite.SiteGUID
			, ACCT.AccountID
			, ACCT.AccountCD
			, HAUserStarted.HAStartedDt
			, HAUserStarted.HACompletedDt
			, HAUserModule.ItemID AS UserModuleItemId
			, HAUserModule.CodeName AS UserModuleCodeName
		
			--, VCTJ.DocumentGUID as HAModuleNodeGUID	--WDM 8/7/2014 as HAModuleDocumentID
			--, VCTJ.NodeGUID as HAModuleNodeGUID		--WDM 9/30/2014 as HAModuleDocumentID	--Mark and Dale use NodeGUID instead of Doc GUID
			--, VCTJ.NodeGUID as CMSNodeGuid			--WDM 8/7/2014 as HAModuleDocumentID	--Left this and the above to kepp existing column structure

			, HAUserModule.HAModuleNodeGUID				--WDM 9/30/2014 as HAModuleDocumentID	--Mark and Dale use NodeGUID instead of Doc GUID
		
			--, NULL as CMSNodeGuid						--WDM 8/7/2014 as HAModuleDocumentID	--WDM 10.02.2014 place holder for EDW ETL
			, VHAJ.NodeGUID as CMSNodeGuid				--WDM 8/7/2014 as HAModuleDocumentID	--WDM 10.02.2014 place holder for EDW ETL per John C., Added back per John C. 10.16.2014

			, NULL as HAModuleVersionID		--WDM 10.02.2014 place holder for EDW ETL
			, HARiskCategory.ItemID AS UserRiskCategoryItemID
			, HARiskCategory.CodeName AS UserRiskCategoryCodeName
			, HARiskCategory.HARiskCategoryNodeGUID						--WDM 8/7/2014 as HARiskCategoryDocumentID
			, NULL as HARiskCategoryVersionID			--WDM 10.02.2014 place holder for EDW ETL
			, HAUserRiskArea.ItemID AS UserRiskAreaItemID
			, HAUserRiskArea.CodeName AS UserRiskAreaCodeName
			, HAUserRiskArea.HARiskAreaNodeGUID							--WDM 8/7/2014 as HARiskAreaDocumentID
			, NULL as HARiskAreaVersionID			--WDM 10.02.2014 place holder for EDW ETL
			, HAUserQuestion.ItemID AS UserQuestionItemID
			, HAQuestionsView.Title
			, HAUserQuestion.HAQuestionNodeGUID	as HAQuestionGuid		--WDM 9.2.2014	This is a repeat field but had to stay to match the previous view - this is the NODE GUID 
			--															and matches to the definition file to get the question. This tells you the question, language agnostic.
			, HAUserQuestion.CodeName AS UserQuestionCodeName
			, NULL as HAQuestionDocumentID	--WDM 10.1.2014 - this is GOING AWAY 		--WDM 10.02.2014 place holder for EDW ETL
			, NULL as HAQuestionVersionID			--WDM 10.1.2014 - this is GOING AWAY - no versions across environments 		--WDM 10.02.2014 place holder for EDW ETL
			, HAUserQuestion.HAQuestionNodeGUID		--WDM 10.01.2014	Left this in place to preserve column structure.		
			, HAUserAnswers.ItemID AS UserAnswerItemID
			, HAUserAnswers.HAAnswerNodeGUID								--WDM 8/7/2014 as HAAnswerDocumentID
			, NULL as HAAnswerVersionID		--WDM 10.1.2014 - this is GOING AWAY - no versions across environments		--WDM 10.02.2014 place holder for EDW ETL
			, HAUserAnswers.CodeName AS UserAnswerCodeName
			, HAUserAnswers.HAAnswerValue
			, HAUserModule.HAModuleScore
			, HARiskCategory.HARiskCategoryScore
			, HAUserRiskArea.HARiskAreaScore
			, HAUserQuestion.HAQuestionScore
			, HAUserAnswers.HAAnswerPoints
			, HAUserQuestionGroupResults.PointResults
			, HAUserAnswers.UOMCode
			, HAUserStarted.HAScore
			, HAUserModule.PreWeightedScore AS ModulePreWeightedScore
			, HARiskCategory.PreWeightedScore AS RiskCategoryPreWeightedScore
			, HAUserRiskArea.PreWeightedScore AS RiskAreaPreWeightedScore
			, HAUserQuestion.PreWeightedScore AS QuestionPreWeightedScore
			, HAUserQuestionGroupResults.CodeName AS QuestionGroupCodeName       
		   ,CASE WHEN HAUserAnswers.ItemCreatedWhen = HAUserAnswers.ItemModifiedWhen THEN 'I'
				 ELSE 'U'
			END AS ChangeType
			,HAUserAnswers.ItemCreatedWhen
		   ,HAUserAnswers.ItemModifiedWhen
		   ,HAUserQuestion.IsProfessionallyCollected

		   ,HARiskCategory.ItemModifiedWhen as HARiskCategory_ItemModifiedWhen
		   ,HAUserRiskArea.ItemModifiedWhen as HAUserRiskArea_ItemModifiedWhen
		   ,HAUserQuestion.ItemModifiedWhen as HAUserQuestion_ItemModifiedWhen
		   ,HAUserAnswers.ItemModifiedWhen as HAUserAnswers_ItemModifiedWhen
		   ,HAUserStarted.HAPaperFlg
		   ,HAUserStarted.HATelephonicFlg
		   --,HAUserStarted.HAStartedMode
		   --,HAUserStarted.HACompletedMode
		FROM
		dbo.HFit_HealthAssesmentUserStarted AS HAUserStarted
		INNER JOIN dbo.CMS_User AS CMSUser ON HAUserStarted.UserID = CMSUser.UserID
		INNER JOIN dbo.CMS_UserSettings AS UserSettings ON UserSettings.UserSettingsUserID = CMSUser.UserID
		INNER JOIN dbo.CMS_UserSite AS UserSite ON CMSUser.UserID = UserSite.UserID
		INNER JOIN dbo.CMS_Site AS CMSSite ON UserSite.SiteID = CMSSite.SiteID
		INNER JOIN dbo.HFit_Account AS ACCT ON ACCT.SiteID = CMSSite.SiteID	
		INNER JOIN dbo.HFit_HealthAssesmentUserModule AS HAUserModule ON HAUserStarted.ItemID = HAUserModule.HAStartedItemID
		
		inner join View_HFit_HACampaign_Joined VHCJ on VHCJ.NodeGUID = HAUserStarted.HACampaignNodeGUID 
			AND VHCJ.NodeSiteID = UserSite.SiteID AND VHCJ.DocumentCulture = 'en-US'	--11.05.2014 - Mark T. / Dale M. - 
	
		--11.05.2014 - Mark T. / Dale M. needed to get the Document for the user
		inner join View_HFit_HealthAssessment_Joined VHAJ on VHAJ.DocumentID = VHCJ.HealthAssessmentID
	
		--11.05.2014 - Mark T. / Dale M. removed the link to View_CMS_Tree_Joined and replaced with View_HFit_HealthAssessment_Joined
		--inner join View_CMS_Tree_Joined as VCTJ on VCTJ.NodeGUID = HAUserModule.HAModuleNodeGUID
		--	and VCTJ.DocumentCulture = 'en-US'	--10.01.2014 put here to match John C. req. for language agnostic.

		INNER JOIN dbo.HFit_HealthAssesmentUserRiskCategory AS HARiskCategory ON HAUserModule.ItemID = HARiskCategory.HAModuleItemID
		INNER JOIN dbo.HFit_HealthAssesmentUserRiskArea AS HAUserRiskArea ON HARiskCategory.ItemID = HAUserRiskArea.HARiskCategoryItemID
		INNER JOIN dbo.HFit_HealthAssesmentUserQuestion AS HAUserQuestion ON HAUserRiskArea.ItemID = HAUserQuestion.HARiskAreaItemID
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS HAQuestionsView ON HAUserQuestion.HAQuestionNodeGUID = HAQuestionsView.NodeGUID
			AND HAQuestionsView.DocumentCulture = 'en-US'
		LEFT OUTER JOIN dbo.HFit_HealthAssesmentUserQuestionGroupResults AS HAUserQuestionGroupResults ON HAUserRiskArea.ItemID = HAUserQuestionGroupResults.HARiskAreaItemID
		INNER JOIN dbo.HFit_HealthAssesmentUserAnswers AS HAUserAnswers ON HAUserQuestion.ItemID = HAUserAnswers.HAQuestionItemID

		WHERE HAUserAnswers.ItemModifiedWhen BETWEEN @StartDate AND @EndDate
		OR HARiskCategory.ItemModifiedWhen BETWEEN @StartDate AND @EndDate
		OR HAUserRiskArea.ItemModifiedWhen BETWEEN @StartDate AND @EndDate
		OR HAUserQuestion.ItemModifiedWhen BETWEEN @StartDate AND @EndDate
		
if @TrackPerf is not null 
BEGIN
	set @P1End = getdate() ;
	exec proc_EDW_MeasurePerf 'ElapsedTime','HealthAssessment-P1',0, @P1Start, @P1End;
	print ('Perf Details Recorded') ;
END
ELSE
	print ('No Perf Details Requested') ;
	
END	--END of PROC

GO

print ('Processed: Proc_EDW_HealthAssessment') ;
go

  --  
  --  
GO 
print('***** FROM: Proc_EDW_HealthAssessment.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





print ('Processing: Proc_EDW_HealthAssessmentDefinition') ;
go


if exists (select * from sysobjects where name = 'Proc_EDW_HealthAssessmentDefinition' and Xtype = 'P')
BEGIN
	drop procedure Proc_EDW_HealthAssessmentDefinition ;
END 
go

create proc [dbo].[Proc_EDW_HealthAssessmentDefinition] (@StartDate as datetime, @EndDate as datetime, @TrackPerf as nvarchar(1))
as
BEGIN
--*********************************************************************************************************************
--Action: This proc creates table EDW_HealthAssessmentDefinition and a view to access the table view_EDW_HADefinition.
--			Select on the view is granted to PUBLIC. This provides EDW with instant access to data.
--		Creates a staging table EDW_HealthAssessmentDefinition.
--USE:	exec Proc_EDW_HealthAssessmentDefinition NULL, NULL
--		exec Proc_EDW_HealthAssessmentDefinition '2013-11-14', '2013-11-15', 'Y'
--exec Proc_EDW_HealthAssessmentDefinition NULL, NULL, 'Y'
--exec Proc_EDW_HealthAssessmentDefinition '2010-11-14', '2014-11-15', 'Y'
--exec Proc_EDW_HealthAssessmentDefinition '2014-06-10', '2014-08-30', NULL
--*********************************************************************************************************************
--exec Proc_EDW_HealthAssessmentDefinition '2010-11-14', '2014-11-15', 'Y'
--08/12/2014 - ProdStaging 00:00:12 @ 2442
--*********************************************************************************************************************

--USE: exec Proc_EDW_HealthAssessmentDefinition '2001-04-08', '2015-07-02'	--This causes one between dates to be pulled
--     exec Proc_EDW_HealthAssessmentDefinition NULL, NULL					--This causes one day's previous data to be pulled
--Auth:	GRANT EXECUTE ON dbo.Proc_EDW_HealthAssessmentDefinition TO <UserID>;


-- ----FOR DEBUG PURPOSES, UNCOMMENT
--declare @TrackPerf as nvarchar(1);
--declare @StartDate as datetime;
--declare @EndDate as datetime;
--set @StartDate = '2010-11-14';
--set @EndDate = '2014-11-15';
----set @StartDate = NULL ;
----set @EndDate = NULL ;
--set @TrackPerf = 'Y' ;

if exists(select name from sys.tables where name = 'EDW_HealthAssessmentDefinition')
BEGIN	
	truncate table EDW_HealthAssessmentDefinition ;
END
ELSE
BEGIN
	CREATE TABLE [dbo].[EDW_HealthAssessmentDefinition](
		[SiteGuid] [int] NULL,
		[AccountCD] [int] NULL,
		[HANodeID] [int] NOT NULL,
		[HANodeName] [nvarchar](100) NOT NULL,
		[HADocumentID] [int] NOT NULL,
		[HANodeSiteID] [int] NOT NULL,
		[HADocPubVerID] [int] NULL,
		[ModTitle] [nvarchar](150) NOT NULL,
		[IntroText] [varchar](4000) NULL,
		[ModDocGuid] [uniqueidentifier] NULL,
		[ModWeight] [int] NOT NULL,
		[ModIsEnabled] [bit] NOT NULL,
		[ModCodeName] [nvarchar](100) NOT NULL,
		[ModDocPubVerID] [int] NULL,
		[RCTitle] [nvarchar](150) NOT NULL,
		[RCWeight] [int] NOT NULL,
		[RCDocumentGUID] [uniqueidentifier] NULL,
		[RCIsEnabled] [bit] NOT NULL,
		[RCCodeName] [nvarchar](100) NOT NULL,
		[RCDocPubVerID] [int] NULL,
		[RATytle] [nvarchar](150) NOT NULL,
		[RAWeight] [int] NOT NULL,
		[RADocumentGuid] [uniqueidentifier] NULL,
		[RAIsEnabled] [bit] NOT NULL,
		[RACodeName] [nvarchar](100) NOT NULL,
		[RAScoringStrategyID] [int] NOT NULL,
		[RADocPubVerID] [int] NULL,
		[QuestionType] [nvarchar](100) NOT NULL,
		[QuesTitle] [varchar](max) NULL,
		[QuesWeight] [int] NOT NULL,
		[QuesIsRequired] [bit] NOT NULL,
		[QuesDocumentGuid] [uniqueidentifier] NULL,
		[QuesIsEnabled] [bit] NOT NULL,
		[QuesIsVisible] [nvarchar](max) NULL,
		[QuesIsSTaging] [bit] NOT NULL,
		[QuestionCodeName] [nvarchar](100) NOT NULL,
		[QuesDocPubVerID] [int] NULL,
		[AnsValue] [nvarchar](150) NULL,
		[AnsPoints] [int] NULL,
		[AnsDocumentGuid] [uniqueidentifier] NULL,
		[AnsIsEnabled] [bit] NULL,
		[AnsCodeName] [nvarchar](100) NULL,
		[AnsUOM] [nvarchar](5) NULL,
		[AnsDocPUbVerID] [int] NULL,
		[ChangeType] [varchar](1) NOT NULL,
		[DocumentCreatedWhen] [datetime2] (7)  NULL,
		[DocumentModifiedWhen] [datetime2] (7)  NULL,
		[CmsTreeNodeGuid] [uniqueidentifier] NOT NULL,
		[HANodeGUID] [uniqueidentifier] NOT NULL
	)
END

declare @SQL as varchar(2000) ;

if not exists(select name from sys.views where name = 'view_EDW_HADefinition')
BEGIN
set @SQL = 
	'create view [view_EDW_HADefinition]
	as
	SELECT [SiteGuid]
		  ,[AccountCD]
		  ,[HANodeID]
		  ,[HANodeName]
		  ,[HADocumentID]
		  ,[HANodeSiteID]
		  ,[HADocPubVerID]
		  ,[ModTitle]
		  ,[IntroText]
		  ,[ModDocGuid]
		  ,[ModWeight]
		  ,[ModIsEnabled]
		  ,[ModCodeName]
		  ,[ModDocPubVerID]
		  ,[RCTitle]
		  ,[RCWeight]
		  ,[RCDocumentGUID]
		  ,[RCIsEnabled]
		  ,[RCCodeName]
		  ,[RCDocPubVerID]
		  ,[RATytle]
		  ,[RAWeight]
		  ,[RADocumentGuid]
		  ,[RAIsEnabled]
		  ,[RACodeName]
		  ,[RAScoringStrategyID]
		  ,[RADocPubVerID]
		  ,[QuestionType]
		  ,[QuesTitle]
		  ,[QuesWeight]
		  ,[QuesIsRequired]
		  ,[QuesDocumentGuid]
		  ,[QuesIsEnabled]
		  ,[QuesIsVisible]
		  ,[QuesIsSTaging]
		  ,[QuestionCodeName]
		  ,[QuesDocPubVerID]
		  ,[AnsValue]
		  ,[AnsPoints]
		  ,[AnsDocumentGuid]
		  ,[AnsIsEnabled]
		  ,[AnsCodeName]
		  ,[AnsUOM]
		  ,[AnsDocPUbVerID]
		  ,[ChangeType]
		  ,[DocumentCreatedWhen]
		  ,[DocumentModifiedWhen]
		  ,[CmsTreeNodeGuid]
		  ,[HANodeGUID]
	  FROM [dbo].[EDW_HealthAssessmentDefinition]' ; 
	  exec (@SQL) ;

	  GRANT SELECT ON view_EDW_HADefinition TO public;

END

declare @P0Start as datetime ;
declare @P0End as datetime ;
declare @P1Start as datetime ;
declare @P1End as datetime ;
declare @P2Start as datetime ;
declare @P2End as datetime ;
declare @P3Start as datetime ;
declare @P3End as datetime ;
declare @P4Start as datetime ;
declare @P4End as datetime ;
declare @P5Start as datetime ;
declare @P5End as datetime ;
declare @P6Start as datetime ;
declare @P6End as datetime ;
declare @P7Start as datetime ;
declare @P7End as datetime ;
declare @P8Start as datetime ;
declare @P8End as datetime ;

set @P0Start = getdate() ;

	IF @StartDate is null 
	BEGIN
		set @StartDate  =DATEADD(Day, 0, DATEDIFF(Day, 0, GetDate()));	--Midnight yesterday;	
		set @StartDate = @StartDate  -1 ;
	END
	
	IF @EndDate is null 
	BEGIN
		set @EndDate = cast (getdate() as date);
	END
	print ('Start Date: ' + cast(@StartDate as nvarchar(50)))
	print ('End Date: ' + cast(@EndDate as nvarchar(50))) 
	/****************************************************************************************/
	--Build the temporary tables. This should take under 10 seconds as a general rule.
	/****************************************************************************************/
	IF EXISTS
		(
			SELECT name
			FROM tempdb.dbo.sysobjects
			WHERE ID = OBJECT_ID(N'tempdb..#Temp_View_HFit_HealthAssessment_Joined')
		)
	BEGIN
		drop table #Temp_View_HFit_HealthAssessment_Joined ;
	END
	--GO
	select DocumentGUID, NodeGuid, NodeID, DocumentID, NodeName, NodeSiteID, DocumentPublishedVersionHistoryID
	into #Temp_View_HFit_HealthAssessment_Joined 
	from View_HFit_HealthAssessment_Joined 
	where View_HFit_HealthAssessment_Joined .DocumentCulture = 'en-us' ;
	--GO

	create clustered index PI_Temp_View_HFit_HealthAssessment_Joined on #Temp_View_HFit_HealthAssessment_Joined 
	(
	DocumentGUID, NodeGuid
	)
	--GO 

	IF EXISTS
		(
			SELECT name
			FROM tempdb.dbo.sysobjects
			WHERE ID = OBJECT_ID(N'tempdb..#Temp_View_HFit_HACampaign_Joined')
		)
	BEGIN
		drop table #Temp_View_HFit_HACampaign_Joined ;
	END
	--GO
	select DISTINCT NodeParentID, HealthAssessmentID
	into #Temp_View_HFit_HACampaign_Joined
	from 
	View_HFit_HACampaign_Joined
	--GO

	CREATE CLUSTERED INDEX [PI_Temp_View_HFit_HACampaign_Joined] ON #Temp_View_HFit_HACampaign_Joined 
	(
	[NodeParentID] ASC,
	HealthAssessmentID )
	--GO

	IF EXISTS
		(
			SELECT name
			FROM tempdb.dbo.sysobjects
			WHERE ID = OBJECT_ID(N'tempdb..#Temp_View_CMS_Tree_Joined')
		)
	BEGIN
		drop table #Temp_View_CMS_Tree_Joined ;
	END
	--GO
		SELECT DISTINCT
			VCTJ.NodeGuid
			, VCTJ.NodeID
			, VCTJ.NodeName
			, VCTJ.DocumentGUID
			, VCTJ.NodeSiteID 
			, VCTJ.DocumentPublishedVersionHistoryID
			, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
					THEN 'I'
					ELSE 'U'
				END AS ChangeType
			, VCTJ.DocumentCreatedWhen
			, VCTJ.DocumentModifiedWhen
			, VCTJ.DocumentCulture
		INTO #Temp_View_CMS_Tree_Joined
		FROM
		View_CMS_Tree_Joined AS VCTJ
		--where VCTJ.DocumentCulture = 'en-us'

		--GO 
		CREATE CLUSTERED INDEX PI_Temp_View_CMS_Tree_Joined
		ON [dbo].#Temp_View_CMS_Tree_Joined (
			[NodeID], 
			NodeSiteID,
			[NodeName],
			[DocumentGUID], 
			[DocumentPublishedVersionHistoryID],
			[DocumentCreatedWhen],
			[DocumentModifiedWhen]
		)
		--GO 

	IF EXISTS
		(
			SELECT name
			FROM tempdb.dbo.sysobjects
			WHERE ID = OBJECT_ID(N'tempdb..#Temp_View_HFit_HealthAssesmentModule_Joined')
		)
	BEGIN
		drop table #Temp_View_HFit_HealthAssesmentModule_Joined ;
	END
		--GO
		SELECT 
			VHFHAMJ.Title AS ModTitle
			, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
			, VHFHAMJ.DocumentGUID
			, VHFHAMJ.Weight
			, VHFHAMJ.IsEnabled
			, VHFHAMJ.CodeName AS ModCodeName
			, VHFHAMJ.DocumentPublishedVersionHistoryID AS ModDocPubVerID
			, VHFHAMJ.NodeParentID
			, VHFHAMJ.DocumentNodeID
			, VHFHAMJ.Title
			, VHFHAMJ.CodeName
			, VHFHAMJ.DocumentPublishedVersionHistoryID
			,VHFHAMJ.DocumentCulture
		INTO #Temp_View_HFit_HealthAssesmentModule_Joined
		FROM
		View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
		--where VHFHAMJ.DocumentCulture = 'en-us'
		--GO
		Create clustered index PI_Temp_View_HFit_HealthAssesmentModule_Joined on #Temp_View_HFit_HealthAssesmentModule_Joined
		(
			NodeParentID, DocumentNodeID	,
			DocumentGUID, 
			Weight, 
			IsEnabled, 
			Title, 
			CodeName, 
			DocumentPublishedVersionHistoryID	
		)
		--GO
 
	 IF EXISTS
		(
			SELECT name
			FROM tempdb.dbo.sysobjects
			WHERE ID = OBJECT_ID(N'tempdb..#Temp_View_HFit_HealthAssesmentRiskCategory_Joined')
		)
	BEGIN
		drop table #Temp_View_HFit_HealthAssesmentRiskCategory_Joined ;
	END

	 --GO
		SELECT VHFHARCJ.Title
			, VHFHARCJ.Weight
			, VHFHARCJ.DocumentGUID
			, VHFHARCJ.IsEnabled
			, VHFHARCJ.CodeName
			, VHFHARCJ.DocumentPublishedVersionHistoryID
			, VHFHARCJ.NodeParentID
			, VHFHARCJ.DocumentNodeID
			, VHFHARCJ.DocumentCulture
		INTO #Temp_View_HFit_HealthAssesmentRiskCategory_Joined
		FROM
		View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
		--where VHFHARCJ.DocumentCulture = 'en-us'	
		--GO

		create clustered index PI_Temp_View_HFit_HealthAssesmentRiskCategory_Joined on #Temp_View_HFit_HealthAssesmentRiskCategory_Joined
		(
			NodeParentID, DocumentGUID, DocumentNodeID
		)

	
	IF EXISTS
		(
			SELECT name
			FROM tempdb.dbo.sysobjects
			WHERE ID = OBJECT_ID(N'tempdb..#Temp_View_HFit_HealthAssesmentRiskArea_Joined')
		)
	BEGIN
		drop table #Temp_View_HFit_HealthAssesmentRiskArea_Joined ;
	END

		--GO
		SELECT 
			VHFHARAJ.Title
			, VHFHARAJ.Weight 
			, VHFHARAJ.DocumentGUID
			, VHFHARAJ.IsEnabled
			, VHFHARAJ.CodeName
			, VHFHARAJ.ScoringStrategyID
			, VHFHARAJ.DocumentPublishedVersionHistoryID
			, VHFHARAJ.NodeParentID
			, VHFHARAJ.DocumentNodeID
			, VHFHARAJ.DocumentCulture
		INTO #Temp_View_HFit_HealthAssesmentRiskArea_Joined
		FROM
		View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
		--where VHFHARAJ.DocumentCulture = 'en-us'
 
	 --GO
	 Create clustered index PI_Temp_View_HFit_HealthAssesmentRiskArea_Joined on #Temp_View_HFit_HealthAssesmentRiskArea_Joined
	 (
		DocumentNodeID, NodeParentID, DocumentGUID
	 )
  	
	IF EXISTS
		(
			SELECT name
			FROM tempdb.dbo.sysobjects
			WHERE ID = OBJECT_ID(N'tempdb..#Temp_View_EDW_HealthAssesmentQuestions')
		)
	BEGIN
		drop table #Temp_View_EDW_HealthAssesmentQuestions ;
	END

	 --GO
	 SELECT 
			VHFHAQ.QuestionType
			, dbo.udf_StripHTML(left(VHFHAQ.Title,4000)) AS Title
			, VHFHAQ.[Weight]
			, VHFHAQ.IsRequired
			, VHFHAQ.DocumentGUID
			, VHFHAQ.IsEnabled
			--, VHFHAQ.IsVisible
			, left(VHFHAQ.IsVisible,4000) AS IsVisible
			, VHFHAQ.IsStaging
			, VHFHAQ.CodeName
			, VHFHAQ.DocumentPublishedVersionHistoryID
			, VHFHAQ.NodeParentID
			, VHFHAQ.NodeGuid
			, VHFHAQ.NodeID
			, VHFHAQ.DocumentCulture
		INTO #Temp_View_EDW_HealthAssesmentQuestions
		FROM
		View_EDW_HealthAssesmentQuestions AS VHFHAQ
		--where VHFHAQ.DocumentCulture = 'en-us'

		--GO
		Create clustered index  PI_Temp_View_HFit_HealthAssesmentQuestions on #Temp_View_EDW_HealthAssesmentQuestions
		(
			NodeGuid, NodeParentID
		)

		--GO
	IF EXISTS
		(
			SELECT name
			FROM tempdb.dbo.sysobjects
			WHERE ID = OBJECT_ID(N'tempdb..#Temp_View_EDW_HealthAssesmentAnswers')
		)
	BEGIN
		drop table #Temp_View_EDW_HealthAssesmentAnswers ;
	END

		--GO
		SELECT 
			VHFHAA.Value
			, VHFHAA.Points
			, VHFHAA.DocumentGUID
			, VHFHAA.IsEnabled 
			, VHFHAA.CodeName 
			, VHFHAA.UOM 
			, VHFHAA.DocumentPublishedVersionHistoryID 
			, VHFHAA.NodeParentID
			, VHFHAA.NodeGuid
			, VHFHAA.NodeID
			, VHFHAA.DocumentCulture
		INTO #Temp_View_EDW_HealthAssesmentAnswers
		FROM
		View_EDW_HealthAssesmentAnswers AS VHFHAA 
		--where VHFHAA.DocumentCulture = 'en-us'
		--GO 

		create clustered index PI_Temp_View_HFit_HealthAssesmentAnswers on #Temp_View_EDW_HealthAssesmentAnswers
		(
			NodeParentID, DocumentGUID, DocumentPublishedVersionHistoryID,
			Value, Points, IsEnabled, CodeName, UOM
		)

	--GO  

	IF NOT EXISTS
	(
		SELECT name
		FROM sys.indexes
		WHERE name = N'PI04_View_CMS_Tree_Joined_Linked'
	)
	BEGIN
		CREATE NONCLUSTERED INDEX PI04_View_CMS_Tree_Joined_Linked
		ON [dbo].[View_CMS_Tree_Joined_Linked] ([ClassName])
		INCLUDE ([NodeParentID],[DocumentGUID],[DocumentForeignKeyValue],[DocumentPublishedVersionHistoryID],[DocumentNodeID])
		--GO 
	END

	IF NOT EXISTS
	(
		SELECT name
		FROM sys.indexes
		WHERE name = N'PI_Temp_View_HFit_HealthAssesmentModule_Joined'
	)
	BEGIN
		drop index #Temp_View_HFit_HealthAssesmentModule_Joined.PI_Temp_View_HFit_HealthAssesmentModule_Joined ;
	END
	IF NOT EXISTS
	(
		SELECT name
		FROM sys.indexes
		WHERE name = N'PI_Temp_View_HFit_HealthAssesmentModule_Joined'
	)
	BEGIN
		create clustered index PI_Temp_View_HFit_HealthAssesmentModule_Joined 
		on #Temp_View_HFit_HealthAssesmentModule_Joined
		(
			DocumentGUID, 
			Weight, 
			IsEnabled, 
			Title, 
			CodeName, 
			DocumentPublishedVersionHistoryID	
		)
	END

	IF NOT EXISTS
		(
			SELECT name
			FROM sys.indexes
			WHERE name = N'PI01_HFit_Account'
		)
	BEGIN
			CREATE index PI01_HFit_Account on HFit_Account
			(
				SiteID
			)
	END

	IF NOT EXISTS
		(
			SELECT name
			FROM sys.indexes
			where name = N'CI01_View_CMS_Tree_Joined_Linked'
		)
	BEGIN
		CREATE NONCLUSTERED INDEX [CI01_View_CMS_Tree_Joined_Linked]
		ON [dbo].[View_CMS_Tree_Joined_Linked] 
		([ClassName]) INCLUDE ([NodeGuid],[DocumentGUID],[DocumentForeignKeyValue])
	END
	--GO 

if @TrackPerf is not null 
BEGIN
	set @P0End = getdate() ;
	exec proc_EDW_MeasurePerf 'ElapsedTime','HADef-P0',0, @P0Start, @P0End;
END

set @P1Start = getdate() ;


	/****************************************************************************************/
	--Begin the view using the TEMP tables
	/****************************************************************************************/

insert into EDW_HealthAssessmentDefinition
	(
	[SiteGuid],
		[AccountCD],
		[HANodeID],
		[HANodeName],
		[HADocumentID],
		[HANodeSiteID],
		[HADocPubVerID],
		[ModTitle],
		[IntroText],
		[ModDocGuid],
		[ModWeight],
		[ModIsEnabled],
		[ModCodeName],
		[ModDocPubVerID],
		[RCTitle],
		[RCWeight],
		[RCDocumentGUID],
		[RCIsEnabled],
		[RCCodeName],
		[RCDocPubVerID],
		[RATytle],
		[RAWeight],
		[RADocumentGuid],
		[RAIsEnabled],
		[RACodeName],
		[RAScoringStrategyID],
		[RADocPubVerID],
		[QuestionType],
		[QuesTitle],
		[QuesWeight],
		[QuesIsRequired],
		[QuesDocumentGuid],
		[QuesIsEnabled],
		[QuesIsVisible],
		[QuesIsSTaging],
		[QuestionCodeName],
		[QuesDocPubVerID],
		[AnsValue],
		[AnsPoints],
		[AnsDocumentGuid],
		[AnsIsEnabled],
		[AnsCodeName],
		[AnsUOM],
		[AnsDocPUbVerID],
		[ChangeType],
		[DocumentCreatedWhen],
		[DocumentModifiedWhen],
		[CmsTreeNodeGuid],
		[HANodeGUID]
	)

		SELECT Distinct 
		NULL as SiteGuid --cs.SiteGUID		--WDM 08.07.2014 per conversation with John Croft
		, NULL as AccountCD     --, HFA.AccountCD		--WDM 08.07.2014 per conversation with John Croft
		, HA.NodeID AS HANodeID		--WDM 08.07.2014
		, HA.NodeName AS HANodeName		--WDM 08.07.2014
		, HA.DocumentID AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID AS HANodeSiteID		--WDM 08.07.2014
		, HA.DocumentPublishedVersionHistoryID AS HADocPubVerID		--WDM 08.07.2014
		, VHFHAMJ.Title AS ModTitle
		--Per EDW Team, HTML text is truncated to 4000 bytes - we'll just do it here
		--, dbo.udf_StripHTML(left(left(VHFHAMJ.IntroText,4000),4000)) AS IntroText
		, VHFHAMJ.IntroText 
		, VHFHAMJ.DocumentGuid AS ModDocGuid	--, VHFHAMJ.DocumentID AS ModDocID	--WDM 08.07.2014
		, VHFHAMJ.Weight AS ModWeight
		, VHFHAMJ.IsEnabled AS ModIsEnabled
		, VHFHAMJ.CodeName AS ModCodeName
		, VHFHAMJ.DocumentPublishedVersionHistoryID AS ModDocPubVerID
		, VHFHARCJ.Title AS RCTitle
		, VHFHARCJ.Weight AS RCWeight
		, VHFHARCJ.DocumentGuid AS RCDocumentGUID	--, VHFHARCJ.DocumentID AS RCDocumentID	--WDM 08.07.2014
		, VHFHARCJ.IsEnabled AS RCIsEnabled
		, VHFHARCJ.CodeName AS RCCodeName
		, VHFHARCJ.DocumentPublishedVersionHistoryID AS RCDocPubVerID
		, VHFHARAJ.Title AS RATytle
		, VHFHARAJ.Weight AS RAWeight
		, VHFHARAJ.DocumentGuid AS RADocumentGuid	--, VHFHARAJ.DocumentID AS RADocumentID	--WDM 08.07.2014
		, VHFHARAJ.IsEnabled AS RAIsEnabled
		, VHFHARAJ.CodeName AS RACodeName
		, VHFHARAJ.ScoringStrategyID AS RAScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID AS RADocPubVerID
		, VHFHAQ.QuestionType
		--, dbo.udf_StripHTML(left(VHFHAQ.Title,4000)) AS QuesTitle
		, VHFHAQ.Title AS QuesTitle
		, VHFHAQ.Weight AS QuesWeight
		, VHFHAQ.IsRequired AS QuesIsRequired

		, VHFHAQ.DocumentGuid AS QuesDocumentGuid	--, VHFHAQ.DocumentID AS QuesDocumentID	--WDM 08.07.2014
		
		, VHFHAQ.IsEnabled AS QuesIsEnabled
		, left(VHFHAQ.IsVisible,4000) AS QuesIsVisible
		, VHFHAQ.IsStaging AS QuesIsSTaging
		, VHFHAQ.CodeName AS QuestionCodeName
		, VHFHAQ.DocumentPublishedVersionHistoryID AS QuesDocPubVerID
		, VHFHAA.Value AS AnsValue
		, VHFHAA.Points AS AnsPoints
		
		, VHFHAA.DocumentGuid AS AnsDocumentGuid	--, VHFHAA.DocumentID AS AnsDocumentID	--WDM 08.07.2014
		
		, VHFHAA.IsEnabled AS AnsIsEnabled
		, VHFHAA.CodeName AS AnsCodeName
		, VHFHAA.UOM AS AnsUOM
		, VHFHAA.DocumentPublishedVersionHistoryID AS AnsDocPUbVerID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
			THEN 'I'
			ELSE 'U'
		END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014 ADDED TO the returned Columns
		, HA.NodeGUID as HANodeGUID
	 FROM
		dbo.#Temp_View_CMS_Tree_Joined AS VCTJ
		INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		INNER JOIN dbo.#Temp_View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 
		INNER JOIN #Temp_View_HFit_HealthAssessment_Joined as HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
		--WDM 08.07.2014
		INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID		
		INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID
	where VCTJ.DocumentCulture = 'en-us'	--WDM 08.07.2014
		and VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND (VCTJ.DocumentCreatedWhen between @StartDate and @EndDate OR VCTJ.DocumentModifiedWhen between @StartDate and @EndDate)

UNION ALL
--WDM Retrieve Matrix Level 1 Question Group
	SELECT Distinct
		NULL as SiteGuid --cs.SiteGUID
		, NULL as AccountCD     --, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		--, dbo.udf_StripHTML(left(left(VHFHAMJ.IntroText,4000),4000)) AS IntroText
		, VHFHAMJ.IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ2.QuestionType
		--, dbo.udf_StripHTML(left(VHFHAQ2.Title,4000)) AS QuesTitle
		, VHFHAQ2.Title AS QuesTitle
		, VHFHAQ2.Weight
		, VHFHAQ2.IsRequired
		, VHFHAQ2.DocumentGUID
		, VHFHAQ2.IsEnabled
		, left(VHFHAQ2.IsVisible,4000)
		, VHFHAQ2.IsStaging
		, VHFHAQ2.CodeName AS QuestionCodeName
       --,VHFHAQ2.NodeAliasPath
		, VHFHAQ2.DocumentPublishedVersionHistoryID
		, VHFHAA2.Value
		, VHFHAA2.Points
		, VHFHAA2.DocumentGUID
		, VHFHAA2.IsEnabled
		, VHFHAA2.CodeName
		, VHFHAA2.UOM
       --,VHFHAA2.NodeAliasPath
		, VHFHAA2.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
	 FROM
		dbo.#Temp_View_CMS_Tree_Joined AS VCTJ

		INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
		INNER JOIN dbo.#Temp_View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
		INNER JOIN #Temp_View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
		INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
		INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID
		--matrix level 1 questiongroup
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
	where VCTJ.DocumentCulture = 'en-us'	--WDM 08.07.2014
		and VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		AND (VCTJ.DocumentCreatedWhen between @StartDate and @EndDate OR VCTJ.DocumentModifiedWhen between @StartDate and @EndDate)

UNION ALL
--WDM Retrieve Branching Level 1 Question and Matrix Level 1 Question Group
	SELECT Distinct
		NULL as SiteGuid --cs.SiteGUID
		, NULL as AccountCD     --, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		--, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.IntroText 
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ3.QuestionType
		--, dbo.udf_StripHTML(left(VHFHAQ3.Title,4000)) AS QuesTitle
		, VHFHAQ3.Title AS QuesTitle
		, VHFHAQ3.Weight
		, VHFHAQ3.IsRequired
		, VHFHAQ3.DocumentGUID
		, VHFHAQ3.IsEnabled
		, left(VHFHAQ3.IsVisible,4000)
		, VHFHAQ3.IsStaging
		, VHFHAQ3.CodeName AS QuestionCodeName
       --,VHFHAQ3.NodeAliasPath
		, VHFHAQ3.DocumentPublishedVersionHistoryID
		, VHFHAA3.Value
		, VHFHAA3.Points
		, VHFHAA3.DocumentGUID
		, VHFHAA3.IsEnabled
		, VHFHAA3.CodeName
		, VHFHAA3.UOM
       --,VHFHAA3.NodeAliasPath
		, VHFHAA3.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 FROM
  dbo.#Temp_View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.#Temp_View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN #Temp_View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

--matrix level 1 questiongroup
--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

--Branching Level 1 Question 
	INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
	LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID
where VCTJ.DocumentCulture = 'en-us'	--WDM 08.07.2014
		and VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
AND (VCTJ.DocumentCreatedWhen between @StartDate and @EndDate OR VCTJ.DocumentModifiedWhen between @StartDate and @EndDate)

UNION ALL
--WDM Retrieve Branching Level 1 Question and Matrix Level 2 Question Group
	SELECT Distinct
		NULL as SiteGuid --cs.SiteGUID
		, NULL as AccountCD     --, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		--, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ7.QuestionType
		--, dbo.udf_StripHTML(left(VHFHAQ7.Title,4000)) AS QuesTitle
		, VHFHAQ7.Title AS QuesTitle
		, VHFHAQ7.Weight
		, VHFHAQ7.IsRequired
		, VHFHAQ7.DocumentGUID
		, VHFHAQ7.IsEnabled
		, left(VHFHAQ7.IsVisible,4000)
		, VHFHAQ7.IsStaging
		, VHFHAQ7.CodeName AS QuestionCodeName
       --,VHFHAQ7.NodeAliasPath
		, VHFHAQ7.DocumentPublishedVersionHistoryID
		, VHFHAA7.Value
		, VHFHAA7.Points
		, VHFHAA7.DocumentGUID
		, VHFHAA7.IsEnabled
		, VHFHAA7.CodeName
		, VHFHAA7.UOM
       --,VHFHAA7.NodeAliasPath
		, VHFHAA7.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 FROM
 dbo.#Temp_View_CMS_Tree_Joined AS VCTJ
 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.#Temp_View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN #Temp_View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

--matrix level 1 questiongroup
--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

--Branching Level 1 Question 
	INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
--LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

--Matrix Level 2 Question Group
	INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
	INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID
where VCTJ.DocumentCulture = 'en-us'	--WDM 08.07.2014
		and VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
AND (VCTJ.DocumentCreatedWhen between @StartDate and @EndDate OR VCTJ.DocumentModifiedWhen between @StartDate and @EndDate)

UNION ALL
	--****************************************************
	--WDM 6/25/2014 Retrieve the Branching level 1 Question Group
	--THE PROBLEM LIES HERE in this part of query : 1:40 minute
	-- Added two perf indexes to the first query: 25 Sec
	--****************************************************
	SELECT Distinct
		NULL as SiteGuid --cs.SiteGUID
		, NULL as AccountCD     --, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		--, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.IntroText 
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ8.QuestionType
		--, dbo.udf_StripHTML(left(VHFHAQ8.Title,4000)) AS QuesTitle
		, VHFHAQ8.Title AS QuesTitle
		, VHFHAQ8.Weight
		, VHFHAQ8.IsRequired
		, VHFHAQ8.DocumentGUID
		, VHFHAQ8.IsEnabled
		, left(VHFHAQ8.IsVisible,4000)
		, VHFHAQ8.IsStaging
		, VHFHAQ8.CodeName AS QuestionCodeName
       --,VHFHAQ8.NodeAliasPath
		, VHFHAQ8.DocumentPublishedVersionHistoryID
		, VHFHAA8.Value
		, VHFHAA8.Points
		, VHFHAA8.DocumentGUID
		, VHFHAA8.IsEnabled
		, VHFHAA8.CodeName
		, VHFHAA8.UOM
       --,VHFHAA8.NodeAliasPath
		, VHFHAA8.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
	FROM
  dbo.#Temp_View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.#Temp_View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN #Temp_View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

			--matrix level 1 questiongroup
			--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
			--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

			--Branching Level 1 Question 
			INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
			--LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

			--Matrix Level 2 Question Group
			INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
			INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

			--Matrix branching level 1 question group
			INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
			INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID
where VCTJ.DocumentCulture = 'en-us'	--WDM 08.07.2014
		and VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us' OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
AND (VCTJ.DocumentCreatedWhen between @StartDate and @EndDate OR VCTJ.DocumentModifiedWhen between @StartDate and @EndDate)

UNION ALL
	--****************************************************
	--WDM 6/25/2014 Retrieve the Branching level 2 Question Group
	--THE PROBLEM LIES HERE in this part of query : 1:48  minutes
	--With the new indexes: 29 Secs
	--****************************************************
	SELECT Distinct
		NULL as SiteGuid --cs.SiteGUID
		, NULL as AccountCD     --, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		--, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ4.QuestionType
		--, dbo.udf_StripHTML(left(VHFHAQ4.Title,4000)) AS QuesTitle
		, VHFHAQ4.Title AS QuesTitle
		, VHFHAQ4.Weight
		, VHFHAQ4.IsRequired
		, VHFHAQ4.DocumentGUID
		, VHFHAQ4.IsEnabled
		, left(VHFHAQ4.IsVisible,4000)
		, VHFHAQ4.IsStaging
		, VHFHAQ4.CodeName AS QuestionCodeName
       --,VHFHAQ4.NodeAliasPath
		, VHFHAQ4.DocumentPublishedVersionHistoryID
		, VHFHAA4.Value
		, VHFHAA4.Points
		, VHFHAA4.DocumentGUID
		, VHFHAA4.IsEnabled
		, VHFHAA4.CodeName
		, VHFHAA4.UOM
       --,VHFHAA4.NodeAliasPath
		, VHFHAA4.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 FROM
  dbo.#Temp_View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.#Temp_View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN #Temp_View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

			--matrix level 1 questiongroup
			--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
			--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

			--Branching Level 1 Question 
			INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
			LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

			--Matrix Level 2 Question Group
			--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
			--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

			--Matrix branching level 1 question group
			--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
			--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

			--Branching level 2 Question Group
			INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
			INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID
where VCTJ.DocumentCulture = 'en-us'	--WDM 08.07.2014
		and VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us'  OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
AND (VCTJ.DocumentCreatedWhen between @StartDate and @EndDate OR VCTJ.DocumentModifiedWhen between @StartDate and @EndDate)

UNION ALL
--WDM 6/25/2014 Retrieve the Branching level 3 Question Group
	SELECT Distinct
		NULL as SiteGuid --cs.SiteGUID
		, NULL as AccountCD     --, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		--, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ5.QuestionType
		, VHFHAQ5.Title AS QuesTitle
		, VHFHAQ5.Weight
		, VHFHAQ5.IsRequired
		, VHFHAQ5.DocumentGUID
		, VHFHAQ5.IsEnabled
		, left(VHFHAQ5.IsVisible,4000)
		, VHFHAQ5.IsStaging
		, VHFHAQ5.CodeName AS QuestionCodeName
       --,VHFHAQ5.NodeAliasPath
		, VHFHAQ5.DocumentPublishedVersionHistoryID
		, VHFHAA5.Value
		, VHFHAA5.Points
		, VHFHAA5.DocumentGUID
		, VHFHAA5.IsEnabled
		, VHFHAA5.CodeName
		, VHFHAA5.UOM
       --,VHFHAA5.NodeAliasPath
		, VHFHAA5.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 FROM
  dbo.#Temp_View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.#Temp_View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN #Temp_View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

		--matrix level 1 questiongroup
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

		--Branching Level 1 Question 
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

		--Matrix Level 2 Question Group
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

		--Matrix branching level 1 question group
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

		--Branching level 2 Question Group
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

		--Branching level 3 Question Group
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ5 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA5 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID
where VCTJ.DocumentCulture = 'en-us'	--WDM 08.07.2014
		and VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us'  OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
AND (VCTJ.DocumentCreatedWhen between @StartDate and @EndDate OR VCTJ.DocumentModifiedWhen between @StartDate and @EndDate)

UNION ALL
--WDM 6/25/2014 Retrieve the Branching level 4 Question Group
	SELECT Distinct
		NULL as SiteGuid --cs.SiteGUID
		, NULL as AccountCD     --, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		--, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ6.QuestionType
		--, dbo.udf_StripHTML(left(VHFHAQ6.Title,4000)) AS QuesTitle
		, VHFHAQ6.Title AS QuesTitle
		, VHFHAQ6.Weight
		, VHFHAQ6.IsRequired
		, VHFHAQ6.DocumentGUID
		, VHFHAQ6.IsEnabled
		, left(VHFHAQ6.IsVisible,4000)
		, VHFHAQ6.IsStaging
		, VHFHAQ6.CodeName AS QuestionCodeName
       --,VHFHAQ6.NodeAliasPath
		, VHFHAQ6.DocumentPublishedVersionHistoryID
		, VHFHAA6.Value
		, VHFHAA6.Points
		, VHFHAA6.DocumentGUID
		, VHFHAA6.IsEnabled
		, VHFHAA6.CodeName
		, VHFHAA6.UOM
       --,VHFHAA6.NodeAliasPath
		, VHFHAA6.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 FROM
	  dbo.#Temp_View_CMS_Tree_Joined AS VCTJ

	 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 INNER JOIN dbo.#Temp_View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
	 INNER JOIN #Temp_View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
	 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
	 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
	 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
	 INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
	 LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

		--matrix level 1 questiongroup
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

		--Branching Level 1 Question 
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

		--Matrix Level 2 Question Group
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

		--Matrix branching level 1 question group
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

		--Branching level 2 Question Group
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

		--Branching level 3 Question Group
		--select count(*) from dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA4
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ5 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA5 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID

		--Branching level 4 Question Group
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ6 ON VHFHAA5.NodeID = VHFHAQ6.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA6 ON VHFHAQ6.NodeID = VHFHAA6.NodeParentID
where VCTJ.DocumentCulture = 'en-us'	--WDM 08.07.2014
		and VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us'  OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
AND (VCTJ.DocumentCreatedWhen between @StartDate and @EndDate OR VCTJ.DocumentModifiedWhen between @StartDate and @EndDate)

UNION ALL
	--WDM 6/25/2014 Retrieve the Branching level 5 Question Group
	SELECT Distinct
		NULL as SiteGuid --cs.SiteGUID
		, NULL as AccountCD     --, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		--, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ9.QuestionType
		--, dbo.udf_StripHTML(left(VHFHAQ9.Title,4000)) AS QuesTitle
		, VHFHAQ9.Title AS QuesTitle
		, VHFHAQ9.Weight
		, VHFHAQ9.IsRequired
		, VHFHAQ9.DocumentGUID
		, VHFHAQ9.IsEnabled
		, left(VHFHAQ9.IsVisible,4000)
		, VHFHAQ9.IsStaging
		, VHFHAQ9.CodeName AS QuestionCodeName
       --,VHFHAQ9.NodeAliasPath
		, VHFHAQ9.DocumentPublishedVersionHistoryID
		, VHFHAA9.Value
		, VHFHAA9.Points
		, VHFHAA9.DocumentGUID
		, VHFHAA9.IsEnabled
		, VHFHAA9.CodeName
		, VHFHAA9.UOM
       --,VHFHAA9.NodeAliasPath
		, VHFHAA9.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
		, HA.NodeGUID as HANodeGUID
 FROM
  dbo.#Temp_View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.#Temp_View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN #Temp_View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.#Temp_View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

		--matrix level 1 questiongroup
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

		--Branching Level 1 Question 
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		LEFT OUTER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

		--Matrix Level 2 Question Group
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

		--Matrix branching level 1 question group
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		--INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

		--Branching level 2 Question Group
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

		--Branching level 3 Question Group
		--select count(*) from dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA4
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ5 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA5 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID

		--Branching level 4 Question Group
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ6 ON VHFHAA5.NodeID = VHFHAQ6.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA6 ON VHFHAQ6.NodeID = VHFHAA6.NodeParentID

		--Branching level 5 Question Group
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentQuestions AS VHFHAQ9 ON VHFHAA6.NodeID = VHFHAQ9.NodeParentID
		INNER JOIN dbo.#Temp_View_EDW_HealthAssesmentAnswers AS VHFHAA9 ON VHFHAQ9.NodeID = VHFHAA9.NodeParentID
where VCTJ.DocumentCulture = 'en-us'	--WDM 08.07.2014
		and VHFHAQ.DocumentCulture = 'en-us'	--WDM 08.12.2014	
		and (VHFHAA.DocumentCulture = 'en-us'  OR VHFHAA.DocumentCulture is null)	--WDM 08.12.2014		
		and VHFHARCJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHARAJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
		and VHFHAMJ.DocumentCulture = 'en-us'	--WDM 08.12.2014		
AND (VCTJ.DocumentCreatedWhen between @StartDate and @EndDate OR VCTJ.DocumentModifiedWhen between @StartDate and @EndDate)

		--GO 
	
		drop index [View_CMS_Tree_Joined_Linked].PI04_View_CMS_Tree_Joined_Linked
		--GO

		drop index HFit_Account.PI01_HFit_Account
		--GO

		drop index [View_CMS_Tree_Joined_Linked].[CI01_View_CMS_Tree_Joined_Linked]

declare @cnt as int = (select count(*) from EDW_HealthAssessmentDefinition) ;
print('Processed Recs: ' + cast(@cnt as nvarchar(50)));
if @TrackPerf is not null 
BEGIN
	set @P1End = getdate() ;
	exec proc_EDW_MeasurePerf 'ElapsedTime','HADef-P1',0, @P1Start, @P1End;
END
ELSE
	print('No Perf details requested');


END	
  --  
  --  
GO 
print('***** FROM: Proc_EDW_HealthAssessmentDefinition.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




PRINT 'Processing: Proc_EDW_TrackerMetadataExtract';
GO
IF EXISTS (SELECT
				  *
				  FROM sysobjects
				  WHERE name = 'Proc_EDW_TrackerMetadataExtract'
					AND Xtype = 'P') 
	BEGIN
		DROP PROCEDURE
			 Proc_EDW_TrackerMetadataExtract;
	END;
GO

--exec Proc_EDW_TrackerMetadataExtract 'HFit.TrackerWater'
--select * from #Temp_TrackerMetaData
--select * from Tracker_EDW_Metadata
--truncate table Tracker_EDW_Metadata

CREATE PROCEDURE dbo.Proc_EDW_TrackerMetadataExtract (
	   @TrackerClassName AS nvarchar (250)) 
AS
BEGIN
	IF EXISTS (SELECT
					  name
					  FROM tempdb.dbo.sysobjects
					  WHERE ID = OBJECT_ID (N'tempdb..#Temp_TrackerMetaData')) 
		BEGIN
			DROP TABLE
				 #Temp_TrackerMetaData;
		END;
	DECLARE @MetaDataLastLoadDate datetime;
	DECLARE @ClassLastModified datetime;
	DECLARE @Xml xml;
	DECLARE @docHandle int;
	DECLARE @form nvarchar (250) ;
	DECLARE @dbForm nvarchar (250) ;
	DECLARE @id int;
	DECLARE @parent int;
	DECLARE @nodetype int;
	DECLARE @localname nvarchar (250) ;
	DECLARE @prefix nvarchar (250) ;
	DECLARE @namespaceuri nvarchar (250) ;
	DECLARE @datatype nvarchar (250) ;
	DECLARE @prev nvarchar (250) ;
	DECLARE @dbText nvarchar (250) ;
	DECLARE @ParentName nvarchar (250) ;
	DECLARE @TableName nvarchar (100) ;
	DECLARE @ColName nvarchar (100) ;
	DECLARE @AttrName nvarchar (100) ;
	DECLARE @AttrVal nvarchar (250) ;
	DECLARE @CurrName nvarchar (250) ;
	DECLARE @SkipIfNoChange bit;

		--alter table [Tracker_EDW_Metadata] add ClassLastModified datetime null
	--drop table Tracker_EDW_Metadata; 
	IF NOT EXISTS (SELECT
						  name
						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'Tracker_EDW_Metadata')) 
		BEGIN
			CREATE TABLE dbo.Tracker_EDW_Metadata (
						 TableName nvarchar (100) NOT NULL
					   , ColName nvarchar (100) NOT NULL
					   , AttrName nvarchar (100) NOT NULL
					   , AttrVal nvarchar (250) NULL
					   , CreatedDate datetime2 (7) NULL
					   , LastModifiedDate datetime2 (7) NULL
					   , ID int IDENTITY (1, 1) 
								NOT NULL
					   , ClassLastModified datetime2 (7) NULL) ;
			ALTER TABLE dbo.Tracker_EDW_Metadata
			ADD
						CONSTRAINT DF_Tracker_EDW_Metadata_CreatedDate DEFAULT GETDATE () FOR CreatedDate;
			ALTER TABLE dbo.Tracker_EDW_Metadata
			ADD
						CONSTRAINT DF_Tracker_EDW_Metadata_LastModifiedDate DEFAULT GETDATE () FOR LastModifiedDate;
			CREATE UNIQUE CLUSTERED INDEX PK_Tracker_EDW_Metadata ON dbo.Tracker_EDW_Metadata (TableName ASC, ColName ASC, AttrName ASC) ;
		END;
	IF NOT EXISTS (SELECT
						  column_name
						  FROM information_schema.columns
						  WHERE column_name = 'ClassLastModified'
							AND table_name = 'Tracker_EDW_Metadata') 
		BEGIN
			PRINT 'MISSING: Tracker_EDW_Metadata ClassLastModified, added to table.';
			ALTER TABLE Tracker_EDW_Metadata
			ADD
						ClassLastModified datetime NULL;
		END;
	ELSE
		BEGIN
			PRINT 'FOUND: Tracker_EDW_Metadata ClassLastModified';
		END;

	SELECT
		   @form = @TrackerClassName;

	--select * from information_schema.columns where column_name = 'ClassLastModified'

	IF EXISTS (SELECT
					  column_name
					  FROM information_schema.columns
					  WHERE column_name = 'ClassLastModified'
						AND table_name = 'Tracker_EDW_Metadata') 
		BEGIN
			SELECT
				   @MetaDataLastLoadDate = (
											SELECT TOP 1
												   ClassLastModified
												   FROM Tracker_EDW_Metadata
												   WHERE TableName = @form) ;
			SELECT
				   @ClassLastModified = (
										 SELECT TOP 1
												ClassLastModified
												FROM CMS_CLASS
												WHERE ClassName = @form) ;
			SET @SkipIfNoChange = 1;
			IF @SkipIfNoChange = 1
				BEGIN
					IF @MetaDataLastLoadDate = @ClassLastModified
						BEGIN
							PRINT 'No Change in ' + @form + ', no updates needed.';
							RETURN;
						END;
					ELSE
						BEGIN
							PRINT 'Changes found in ' + @form + ', processing.';
						END;
				END;
			PRINT '@MetaDataLastLoadDate: ' + CAST (@MetaDataLastLoadDate AS varchar (50)) ;
			PRINT '@ClassLastModified: ' + CAST (@ClassLastModified AS varchar (50)) ;
		END;
	SELECT
		   @Xml = (
				   SELECT
						  ClassFormDefinition
						  FROM CMS_Class
						  WHERE ClassName LIKE @form) ;

	--print (cast( @Xml as varchar(max)));

	EXEC sp_xml_preparedocument @docHandle OUTPUT, @Xml;


	IF NOT EXISTS (SELECT
						  name
						  FROM tempdb.dbo.sysobjects
						  WHERE ID = OBJECT_ID (N'tempdb..#Temp_TrackerMetaData')) 
		BEGIN
			SELECT
				   @form AS form
				 , id
				 , parentid
				 , nodetype
				 , localname
				 , prefix
				 , namespaceuri
				 , datatype
				 , prev
				 , text INTO
							 #Temp_TrackerMetaData
				   FROM OPENXML (@docHandle, N'/form/field') AS XMLDATA;

			--WHERE localname not in ('isPK');		

			CREATE INDEX TMPPI_HealthAssesmentUserQuestion ON #Temp_TrackerMetaData (parentid) ;
			CREATE INDEX TMPPI2_HealthAssesmentUserQuestion ON #Temp_TrackerMetaData (id) ;
		END;
	ELSE
		BEGIN
			truncate TABLE #Temp_TrackerMetaData;
			INSERT INTO #Temp_TrackerMetaData
			SELECT
				   @form AS form
				 , id
				 , parentid
				 , nodetype
				 , localname
				 , prefix
				 , namespaceuri
				 , datatype
				 , prev
				 , text
				   FROM OPENXML (@docHandle, N'/form/field') AS XMLDATA;
		END;
	DELETE FROM Tracker_EDW_Metadata
	WHERE
		  TableName = @form;
	SET @ClassLastModified = (SELECT
									 ClassLastModified
									 FROM CMS_CLASS
									 WHERE ClassName = @Form) ;
	PRINT '@ClassLastModified: ' + CAST (@ClassLastModified AS varchar (250)) ;
	DECLARE C CURSOR
		FOR SELECT
				   @form AS form
				 , id
				 , parentid
				 , nodetype
				 , localname
				 , prefix
				 , namespaceuri
				 , datatype
				 , prev
				 , text
				   FROM #Temp_TrackerMetaData AS XMLDATA;
	OPEN C;
	FETCH NEXT FROM C INTO @dbForm, @id, @parent, @nodetype, @localname, @prefix, @namespaceuri, @datatype, @prev, @dbText;
	WHILE @@FETCH_STATUS = 0
		BEGIN

			--print ('* @localname :' + @localname) ;
			--print ('* @ColName :' + isnull(@ColName, 'XX') + ':') ;
			--print ('* @dbText :' + @dbText + ':') ;

			IF @localname = 'column'
				BEGIN

					--print ('** START COLUMN DEF: ') ;

					SET @ColName = (SELECT
										   text
										   FROM #Temp_TrackerMetaData
										   WHERE parentid = @id) ;

				--print ('** COLUMN DEF: ' + @form + ' : ' + @colname) ;

				END;
			IF @dbText IS NOT NULL
				BEGIN

					--print ('* ENTER @dbText :' + @dbText + ':' + cast(@parent as varchar(10))) ;

					SET @AttrName = (SELECT
											localname
											FROM #Temp_TrackerMetaData
											WHERE id = @parent) ;

					--set @ParentName = (select [localname] FROM OPENXML(@docHandle, N'/form/field') where id = @parent);	
					--print ('1 - @AttrName: ' + @form +' : ' + isnull(@ColName, 'NA') + ' : ' + @AttrName + ' : ' + @dbText) ;	

					IF EXISTS (SELECT
									  TableName
									  FROM Tracker_EDW_Metadata
									  WHERE Tablename = @form
										AND ColName = @ColName
										AND AttrName = @dbText) 
						BEGIN

							--print('Update Tracker_EDW_Metadata set AttrVal = ' + @dbText + ' Where Tablename = ' + @form + ' and ColName = ' + @ColName + ' and AttrName = ' + @AttrName + ';');

							UPDATE Tracker_EDW_Metadata
							SET
								AttrVal = @dbText
							  ,
								ClassLastModified = @ClassLastModified
							WHERE
								  Tablename = @form
							  AND ColName = @ColName
							  AND AttrName = @dbText;
						END;
					ELSE
						BEGIN

							--print ('insert into Tracker_EDW_Metadata (TableName, ColName, AttrName, AttrVal, ClassLastModified) values ('+@form+', '+@ColName+', '+@AttrName+', '+@dbText +', ' + cast(@ClassLastModified as varchar(50))+ ') ') ;

							INSERT INTO Tracker_EDW_Metadata (
										TableName
									  , ColName
									  , AttrName
									  , AttrVal
									  , ClassLastModified) 
							VALUES
								 (@form, @ColName, @AttrName, @dbText, @ClassLastModified) ;
							UPDATE Tracker_EDW_Metadata
							SET
								ClassLastModified = @ClassLastModified
							WHERE
								  Tablename = @form
							  AND ColName = @ColName
							  AND AttrName = @dbText;
						END;
				END;
			IF @localname = 'columntype'
		   AND @ColName IS NOT NULL
				BEGIN
					PRINT '---- COLUMN TYPE DEF: ' + @form + ' : ' + @colname + ' : ' + @dbText;
				END;
			IF @localname = 'field'
				BEGIN
					SET @ParentName = NULL;
					SET @ColName = NULL;

				--print ('***** field @ParentName: ' + @ParentName) ;

				END;
			FETCH NEXT FROM C INTO @dbForm, @id, @parent, @nodetype, @localname, @prefix, @namespaceuri, @datatype, @prev, @dbText;
		END;
	CLOSE C;
	DEALLOCATE C;
END;

--Clean up the EDW Tracker MetaData
--delete from Tracker_EDW_Metadata where colname in ('ItemID','ItemCreatedBy','ItemCreatedWhen','ItemModifiedBy','ItemModifiedWhen','EventDate','IsProfessionally Collected','TrackerCollectionSourceId','UserID','Notes','IsProcessedForHA');

GO
PRINT 'ProcessED and created : Proc_EDW_TrackerMetadataExtract';
GO
PRINT '***** FROM: Proc_EDW_TrackerMetadataExtract.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Creating TRIGGER trgSchemaMonitor.';
GO
IF EXISTS (SELECT
				  name
				  FROM sys.triggers
				  WHERE name = 'trgSchemaMonitor') 
	BEGIN
		PRINT 'DISABELING TRIGGER trgSchemaMonitor.';
		DECLARE @S nvarchar (200) ;
		SET @S = 'DISABLE TRIGGER trgSchemaMonitor ON DATABASE';
		EXEC (@S) ;
	END;
GO
PRINT 'Creating trgSchemaMonitor for #44945';
PRINT 'Dropping trgSchemaMonitor if it exists';
IF EXISTS (SELECT
				  name
				  FROM sys.triggers
				  WHERE name = 'trgSchemaMonitor') 
	BEGIN
		PRINT 'Dropping trgSchemaMonitor';
		DROP TRIGGER
			 trgSchemaMonitor ON DATABASE;
	END;
GO

--print('CHANGING to the instrument DB.');
--GO
--use instrument
--go

PRINT 'FQN: trgSchemaMonitor.SQL';
PRINT 'Processing trgSchemaMonitor.sql';
GO

--if exists(Select name from sys.triggers where name = 'trgSchemaMonitor')
--BEGIN
--	drop trigger trgSchemaMonitor ;
--	print('TRIGGER trgSchemaMonitor found and removed, continuing.');
--END
--go

IF EXISTS (SELECT
				  name
				  FROM sys.tables
				  WHERE name = 'SchemaChangeMonitor') 
	BEGIN
		DROP TABLE
			 dbo.SchemaChangeMonitor;
		PRINT 'Table SchemaChangeMonitor found, continuing.';
	END;
GO
SET ANSI_NULLS ON;
SET ANSI_PADDING ON;
SET ANSI_WARNINGS ON;
SET ARITHABORT ON;
SET CONCAT_NULL_YIELDS_NULL ON;
SET NUMERIC_ROUNDABORT OFF;

--WDM

SET QUOTED_IDENTIFIER ON;
IF NOT EXISTS (SELECT
					  name
					  FROM sys.tables
					  WHERE name = 'SchemaChangeMonitor') 
	BEGIN
		PRINT 'Creating table SchemaChangeMonitor.';

		--drop TABLE SchemaChangeMonitor 
		--go

		CREATE TABLE dbo.SchemaChangeMonitor (
					 PostTime datetime2 (7) NULL
				   , DB_User nvarchar (254) NULL
				   , IP_Address nvarchar (254) NULL
				   , CUR_User nvarchar (254) NULL
				   , Event nvarchar (254) NULL
				   , TSQL nvarchar (max) NULL
				   , OBJ nvarchar (254) NULL
				   , RowNbr int IDENTITY (1, 1) 
								NOT NULL
				   , ServerName nvarchar (254) NULL) ;

	--ON [PRIMARY] TEXTIMAGE_ON [PRIMARY];
	--ALTER TABLE dbo.SchemaChangeMonitor
	--ADD
	--			CONSTRAINT DF_SchemaChangeMonitor_ServerName DEFAULT @@servername FOR ServerName;
	--CREATE NONCLUSTERED INDEX PI_SchemaChangeMonitor ON dbo.SchemaChangeMonitor (OBJ ASC) ;
	--GRANT SELECT ON [dbo].[SchemaChangeMonitor] TO [platformuser_dev] ;
	--GRANT INSERT ON [dbo].[SchemaChangeMonitor] TO [platformuser_dev] ;
	--REVOKE DELETE ON [dbo].[SchemaChangeMonitor] TO [platformuser_dev] ;
	--REVOKE UPDATE ON [dbo].[SchemaChangeMonitor] TO [platformuser_dev] ;

	END;
GO
IF EXISTS (SELECT
				  name
				  FROM sys.tables
				  WHERE name = 'SchemaMonitorObjectName') 
	BEGIN
		PRINT 'Table SchemaMonitorObjectName FOUND, continuing.';
	END;
IF NOT EXISTS (SELECT
					  name
					  FROM sys.tables
					  WHERE name = 'SchemaMonitorObjectName') 
	BEGIN
		PRINT 'Creating table SchemaMonitorObjectName';
		SET ANSI_NULLS ON;
		SET ANSI_PADDING ON;
		SET ANSI_WARNINGS ON;
		SET ARITHABORT ON;
		SET CONCAT_NULL_YIELDS_NULL ON;
		SET NUMERIC_ROUNDABORT OFF;
		SET QUOTED_IDENTIFIER ON;

		--drop TABLE dbo.SchemaMonitorObjectName
		--go

		CREATE TABLE dbo.SchemaMonitorObjectName (
					 ObjectName nvarchar (254) 
				   , ObjectType nvarchar (25)) ;
		CREATE UNIQUE CLUSTERED INDEX PKI_SchemaMonitorObjectName ON dbo.SchemaMonitorObjectName (ObjectName ASC, ObjectType ASC) ;
	END;
GO
IF EXISTS (SELECT
				  name
				  FROM sys.tables
				  WHERE name = 'SchemaMonitorObjectNotify') 
	BEGIN
		PRINT 'Table SchemaMonitorObjectNotify NOT FOUND, continuing.';
	END;
IF NOT EXISTS (SELECT
					  name
					  FROM sys.tables
					  WHERE name = 'SchemaMonitorObjectNotify') 
	BEGIN		
		SET ANSI_NULLS ON;
		SET ANSI_PADDING ON;
		SET ANSI_WARNINGS ON;
		SET ARITHABORT ON;
		SET CONCAT_NULL_YIELDS_NULL ON;
		SET NUMERIC_ROUNDABORT OFF;
		SET QUOTED_IDENTIFIER ON;
		CREATE TABLE dbo.SchemaMonitorObjectNotify (
					 EmailAddr nvarchar (254)) ;
		CREATE UNIQUE CLUSTERED INDEX PCI_SchemaMonitorObjectNotify ON dbo.SchemaMonitorObjectNotify (EmailAddr ASC) ;

		--GRANT SELECT ON [dbo].SchemaMonitorObjectNotify TO [platformuser_dev] ;
		--GRANT INSERT ON [dbo].SchemaMonitorObjectNotify TO [platformuser_dev] ;
		--REVOKE DELETE ON [dbo].SchemaMonitorObjectNotify TO [platformuser_dev] ;
		--REVOKE UPDATE ON [dbo].SchemaMonitorObjectNotify TO [platformuser_dev] ;		

		INSERT INTO dbo.SchemaMonitorObjectNotify (
					EmailAddr) 
		VALUES
			 ('wdalemiller@gmail.com') ;
	END;
GO
PRINT 'Creating view_SchemaChangeMonitor';
GO

--DROP TRIGGER trgSchemaMonitor on DATABASE
--disable TRIGGER trgSchemaMonitor on DATABASE
--enable TRIGGER trgSchemaMonitor on DATABASE

IF EXISTS (SELECT
				  name
				  FROM sys.views
				  WHERE name = 'view_SchemaChangeMonitor') 
	BEGIN
		PRINT 'Creating view_SchemaChangeMonitor, continuing';
		DROP VIEW
			 view_SchemaChangeMonitor;
	END;
GO
CREATE VIEW view_SchemaChangeMonitor
AS SELECT
		  PostTime
		, DB_User
		, IP_Address
		, CUR_User
		, Event
		, TSQL
		, OBJ
		  FROM SchemaChangeMonitor;
GO

--GRANT SELECT ON  [dbo].view_SchemaChangeMonitor TO [platformuser_dev] ;
--GRANT INSERT ON  [Schema].[Table] TO [User] ;
--REVOKE DELETE ON  [Schema].[Table] TO [User] ;
--REVOKE UPDATE ON  [Schema].[Table] TO [User] ;

PRINT 'Created view_SchemaChangeMonitor';
GO
IF EXISTS (SELECT
				  name
				  FROM sys.triggers
				  WHERE name = 'trgSchemaMonitor') 
	BEGIN
		PRINT 'creating trgSchemaMonitor';
		DROP TRIGGER
			 trgSchemaMonitor;
	END;
GO
PRINT 'Updating trgSchemaMonitor';
GO

--disable TRIGGER dbo.trgSchemaMonitor database

DECLARE @DB nvarchar (100) = (SELECT
									 DB_NAME ()) ;
PRINT 'Current DB: ' + @DB;
IF @DB = 'KenticoCMS_QA'
	BEGIN
		DECLARE @I int = 0;
		SET @i = (SELECT
						 COUNT (*) 
						 FROM SchemaMonitorObjectNotify
						 WHERE EmailAddr = 'John.Croft@hfit.com') ;
		IF @i = 0
			BEGIN
				INSERT INTO dbo.SchemaMonitorObjectNotify (
							EmailAddr) 
				VALUES
					 ('John.Croft@hfit.com') ;
			END;
		ELSE
			BEGIN
				PRINT 'Croft already exists in GREEN.';
			END;
		GRANT SELECT ON dbo.view_SchemaDiff TO JCroft;
		GRANT SELECT ON dbo.view_SchemaChangeMonitor TO JCroft;
		PRINT 'Added John Croft to the Schema Monitor system.';
	END;
GO
CREATE TRIGGER trgSchemaMonitor ON DATABASE
	FOR DDL_DATABASE_LEVEL_EVENTS
AS
SET ANSI_NULLS ON;
SET ANSI_PADDING ON;
SET ANSI_WARNINGS ON;
SET ARITHABORT ON;
SET CONCAT_NULL_YIELDS_NULL ON;
SET NUMERIC_ROUNDABORT OFF;
SET QUOTED_IDENTIFIER ON;
DECLARE @data xml;
DECLARE @IPADDR nvarchar (254) ;
DECLARE @CUR_User nvarchar (254) ;
SET @CUR_User = SYSTEM_USER;
SET @IPADDR = (SELECT
					  CONVERT (nvarchar (254) , CONNECTIONPROPERTY ('client_net_address'))) ;
SET @data = EVENTDATA () ;
SET NOCOUNT ON;
INSERT INTO SchemaChangeMonitor (
			PostTime
		  , DB_User
		  , IP_Address
		  , CUR_User
		  , OBJ
		  , Event
		  , TSQL) 
VALUES
	 (GETDATE () , CONVERT (nvarchar (254) , CURRENT_USER) , @IPADDR, @CUR_User, @data.value ('(/EVENT_INSTANCE/ObjectName)[1]', 'nvarchar(254)') , @data.value ('(/EVENT_INSTANCE/EventType)[1]', 'nvarchar(254)') , @data.value ('(/EVENT_INSTANCE/TSQLCommand)[1]', 'nvarchar(max)')) ;

--THIS WILL DELETE records older than 90 days.
--delete from SchemaChangeMonitor where PostTime < getdate() - 90 ;

SET NOCOUNT OFF;
GO

--grant execute on trgSchemaMonitor to PUBLIC ;
--go
--grant execute on sp_SchemaMonitorReport to platformuser_dev ; 
--GO

DISABLE TRIGGER
 trgSchemaMonitor ON DATABASE;
PRINT '********************************************************************';
PRINT 'DATABASE trgSchemaMonitor HAS BEEN DISABLED       ******************';
PRINT '********************************************************************';
PRINT 'Processed trgSchemaMonitor.sql';
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





--drop table [TBL_DIFF1] ;
--drop table [TBL_DIFF2] ;
--drop table [TBL_DIFF3] ;
--drop table [TBL_DIFF4] ;

GO
PRINT 'Creating Proc_EDW_Compare_Views';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.procedures
			 WHERE name = 'Proc_EDW_Compare_Views') 
	BEGIN
		DROP PROCEDURE
			 Proc_EDW_Compare_Views;
	END;
GO
CREATE PROCEDURE Proc_EDW_Compare_Views (@LinkedSVR AS nvarchar (254) 
									   , @LinkedDB AS nvarchar (254) 
									   , @LinkedVIEW AS nvarchar (254) 
									   , @CurrDB AS nvarchar (254) 
									   , @CurrVIEW AS nvarchar (254) 
									   , @NewRun AS int) 
AS
	 BEGIN
		 DECLARE @ParmDefinition AS nvarchar (max) ;
		 DECLARE @retval int = 0;
		 DECLARE @S AS nvarchar (250) = '';
		 DECLARE @SVR AS varchar (254) = @LinkedSVR;
		 DECLARE @iCnt AS int;
		 DECLARE @iRetval AS int = 0;
		 DECLARE @Note AS nvarchar (max) = '';
		 SET @S = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ';
		 SET @ParmDefinition = N'@TgtSVR nvarchar(254), @retval bit OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;
		 IF @iCnt = 1
			 BEGIN EXEC master.sys.sp_dropserver @LinkedSVR, 'droplogins'
			 END;
		 EXEC sp_addlinkedserver @LinkedSVR, 'SQL Server';
		 SET @S = 'select @retval = count(*) from [' + @LinkedSVR + '].[' + @LinkedDB + '].sys.views where NAME = @TgtVIEW ';
		 SET @ParmDefinition = N'@TgtVIEW nvarchar(254), @retval int OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtVIEW = @LinkedVIEW, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;

		 --print ('Step01');

		 IF @iCnt = 0
			 BEGIN
				 PRINT @LinkedVIEW + ' : VIEW does not exist on server ' + @LinkedSVR + ' in database ' + @LinkedDB + '.';
				 DECLARE @SSQL AS nvarchar (max) = '';
				 DECLARE @msg AS nvarchar (max) = '';
				 SET @msg = @LinkedVIEW + ' : VIEW does not exist on server ' + @LinkedSVR + ' in database ' + @LinkedDB + '.';
				 SET @SSQL = 'INSERT INTO TBL_DIFF1 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
				 SET @SSQL = @SSQL + 'VALUES ( ';
				 SET @SSQL = @SSQL + '''' + @CurrVIEW + ''', null, null , null, null ,null,null, null, ''' + @msg + ''' ';
				 SET @SSQL = @SSQL + ')';
				 EXEC (@SSQL) ;
				 RETURN;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF1')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF1 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF2')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF2 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF3')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF3 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF4')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF4 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF @NewRun = 1
			 BEGIN
				 truncate TABLE TBL_DIFF1;
				 truncate TABLE TBL_DIFF2;
				 truncate TABLE TBL_DIFF3;
			 END;
		 DECLARE @MySQL AS nvarchar (max) ;
		 SET @MySQL = 'INSERT INTO TBL_DIFF1 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySql + 'select c1.table_name, c1.COLUMN_NAME, c1.DATA_TYPE , cast (c1.CHARACTER_MAXIMUM_LENGTH as nvarchar(254)) as CHARACTER_MAXIMUM_LENGTH, c2.table_name as table_name2 ,c2.DATA_TYPE as DATA_TYPE2 ,c2.COLUMN_NAME as COLUMN_NAME2, c2.CHARACTER_MAXIMUM_LENGTH as CHARACTER_MAXIMUM_LENGTH2, ''Data Types or Data Length Differ'' ';
		 SET @MySQL = @MySQL + 'from [' + @LinkedSVR + '].[' + @LinkedDB + '].[INFORMATION_SCHEMA].[COLUMNS] c1 ';
		 SET @MySQL = @MySQL + 'left join ' + @CurrDB + '.[INFORMATION_SCHEMA].[COLUMNS] c2 on c1.TABLE_NAME = c2.TABLE_NAME ';
		 SET @MySQL = @MySQL + 'where c1.TABLE_NAME= ''' + @LinkedVIEW + ''' and c2.TABLE_NAME = ''' + @CurrVIEW + ''' ';
		 SET @MySQL = @MySQL + 'and C1.column_name = c2.column_name ';
		 SET @MySQL = @MySQL + 'and ((c1.data_type <> c2.DATA_TYPE) ';
		 SET @MySQL = @MySQL + '		OR (c1.data_type = c2.DATA_TYPE AND c1.CHARACTER_MAXIMUM_LENGTH <> c2.CHARACTER_MAXIMUM_LENGTH))';
		 EXEC (@MySql) ;

		 --print ('Step05');

		 SET @MySQL = '';
		 SET @MySQL = 'INSERT INTO TBL_DIFF2 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySQL + 'SELECT c1.TABLE_NAME, c1.COLUMN_NAME, c1.DATA_TYPE, ''' + @CurrDB + ''' as DBNAME, ''MISSING'' as C1, ''NA'' as C2 , ''NA'' as C3, 0 as I1, ''Column ''+c1.COLUMN_NAME+'' Missing in: ' + @CurrDB + '/' + @CurrVIEW + ' ''  ';
		 SET @MySQL = @MySQL + ' FROM  [' + @LinkedSVR + '].[' + @LinkedDB + '].INFORMATION_SCHEMA.COLUMNS AS c1 ';
		 SET @MySQL = @MySQL + ' WHERE  C1.table_name = ''' + @CurrVIEW + ''' ';
		 SET @MySQL = @MySQL + ' 	AND c1.column_name not in ';
		 SET @MySQL = @MySQL + ' 	(select column_name from ' + @CurrDB + '.INFORMATION_SCHEMA.columns C2 where C2.table_name = ''' + @LinkedVIEW + ''') ';
		 PRINT @MySql;
		 EXEC (@MySql) ;

		 --print ('Step06');

		 SET @MySQL = 'INSERT INTO TBL_DIFF3 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySQL + 'SELECT c1.TABLE_NAME, c1.COLUMN_NAME, c1.DATA_TYPE, ''' + @LinkedDB + ''' as DBNAME, ''MISSING'' as C1, ''NA'' as C2, ''NA'' as C3, -1 as I1, ''Column ''+c1.COLUMN_NAME+'' Missing in: ' + @LinkedDB + '/' + @LinkedVIEW + ' ''  ';
		 SET @MySQL = @MySQL + ' FROM [' + @CurrDB + '].INFORMATION_SCHEMA.COLUMNS as C1 ';
		 SET @MySQL = @MySQL + ' WHERE  C1.table_name = ''' + @CurrVIEW + ''' ';
		 SET @MySQL = @MySQL + ' AND c1.column_name not in ';
		 SET @MySQL = @MySQL + ' (select column_name from [' + @LinkedSVR + '].[' + @LinkedDB + '].INFORMATION_SCHEMA.columns C2 where C2.table_name = ''' + @LinkedVIEW + ''') ';
		 EXEC (@MySql) ;

		 --print ('Step07');

		 SET @S = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ';
		 SET @ParmDefinition = N'@TgtSVR nvarchar(254), @retval bit OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;
		 IF @iCnt = 1
			 BEGIN EXEC master.sys.sp_dropserver @LinkedSVR, 'droplogins'
			 END;

		 --print ('Step08');

		 IF NOT EXISTS (SELECT
							   name
						  FROM sys.views
						  WHERE name = 'view_SchemaDiff') 
			 BEGIN
				 DECLARE @sTxt AS nvarchar (max) = '';
				 SET @sTxt = @sTxt + 'Create view view_SchemaDiff AS ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF1 ';
				 SET @sTxt = @sTxt + 'union ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF2  ';
				 SET @sTxt = @sTxt + 'union ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF3  ';
				 EXEC (@sTxt) ;
				 PRINT 'Created view view_SchemaDiff.';
			 END;

		 --Select * from TBL_DIFF1 
		 --union
		 --Select * from TBL_DIFF2 
		 --union
		 --Select * from TBL_DIFF3 

		 PRINT 'To see "deltas" - select * from view_SchemaDiff';
		 PRINT '_________________________________________________';

	 --print ('Step09');

	 END;
GO
PRINT 'Created Proc_EDW_Compare_Views';
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





--drop table [TBL_DIFF1] ;
--drop table [TBL_DIFF2] ;
--drop table [TBL_DIFF3] ;
--drop table [TBL_DIFF4] ;

GO
PRINT 'Processing Proc_EDW_Compare_Tables';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.procedures
			 WHERE name = 'Proc_EDW_Compare_Tables') 
	BEGIN
		PRINT 'Updating Proc_EDW_Compare_Tables';
		DROP PROCEDURE
			 Proc_EDW_Compare_Tables;
	END;
GO
CREATE PROCEDURE Proc_EDW_Compare_Tables (@LinkedSVR AS nvarchar (254) 
										, @LinkedDB AS nvarchar (254) 
										, @LinkedTBL AS nvarchar (254) 
										, @CurrDB AS nvarchar (254) 
										, @CurrTBL AS nvarchar (254) 
										, @NewRun AS int) 
AS
	 BEGIN
		 PRINT 'Comparing: ' + @LinkedSVR + ' : ' + @LinkedDB + ' : ' + @LinkedTBL;
		 PRINT 'TO: ' + @CurrDB + ' : ' + @CurrTBL;
		 DECLARE @ParmDefinition AS nvarchar (max) ;
		 DECLARE @retval int = 0;
		 DECLARE @S AS nvarchar (254) = '';
		 DECLARE @SVR AS varchar (254) = @LinkedSVR;
		 DECLARE @iCnt AS int;
		 DECLARE @iRetval AS int = 0;
		 DECLARE @Note AS nvarchar (max) = '';
		 SET @S = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ';
		 SET @ParmDefinition = N'@TgtSVR nvarchar(254), @retval bit OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;
		 IF @iCnt = 1
			 BEGIN EXEC master.sys.sp_dropserver @LinkedSVR, 'droplogins'
			 END;
		 EXEC sp_addlinkedserver @LinkedSVR, 'SQL Server';
		 SET @S = 'select @retval = count(*) from [' + @LinkedSVR + '].[' + @LinkedDB + '].sys.tables where NAME = @TgtTBL ';
		 SET @ParmDefinition = N'@TgtTBL nvarchar(254), @retval int OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtTBL = @LinkedTBL, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;

		 --print ('Step01');

		 IF @iCnt = 0
			 BEGIN
				 PRINT @LinkedTBL + ' : Table does not exist on server ' + @LinkedSVR + ' in database ' + @LinkedDB + '.';
				 DECLARE @SSQL AS nvarchar (max) = '';
				 DECLARE @msg AS nvarchar (max) = '';
				 SET @msg = @LinkedTBL + ' : Table does not exist on server ' + @LinkedSVR + ' in database ' + @LinkedDB + '.';
				 SET @SSQL = 'INSERT INTO TBL_DIFF1 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
				 SET @SSQL = @SSQL + 'VALUES ( ';
				 SET @SSQL = @SSQL + '''' + @CurrTBL + ''', null, null , null, null ,null,null, null, ''' + @msg + ''' ';
				 SET @SSQL = @SSQL + ')';
				 EXEC (@SSQL) ;
				 RETURN;
			 END;

		 --set @S  = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ' ;
		 --set @ParmDefinition  = N'@TgtSVR nvarchar(254), @retval bit OUTPUT' ;
		 --exec sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT ;
		 --set @iCnt = (select @iRetval) ;
		 --IF (@iCnt = 1)
		 --	EXEC master.sys.sp_dropserver @LinkedSVR,'droplogins'  ;
		 --print ('Step02');

		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF1')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF1 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) NULL
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF2')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF2 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) NULL
							, CreateDate datetime2 (7) NULL
												  DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF3')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF3 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2(7) DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF NOT EXISTS (SELECT
							   name

						--FROM tempdb.dbo.sysobjects

						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'TBL_DIFF4')) 
			 BEGIN
				 CREATE TABLE dbo.TBL_DIFF4 (
							  table_name sysname NOT NULL
							, COLUMN_NAME sysname NULL
							, DATA_TYPE nvarchar (254) NULL
							, CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
							, table_name2 sysname NULL
							, DATA_TYPE2 nvarchar (254) NULL
							, COLUMN_NAME2 sysname NULL
							, CHARACTER_MAXIMUM_LENGTH2 int NULL
							, NOTE varchar (max) 
							, CreateDate datetime2(7) DEFAULT GETDATE () 
							, RowNbr int IDENTITY) ;
			 END;
		 IF @NewRun = 1
			 BEGIN
				 truncate TABLE TBL_DIFF1;
				 truncate TABLE TBL_DIFF2;
				 truncate TABLE TBL_DIFF3;
			 END;
		 DECLARE @MySQL AS nvarchar (max) ;
		 SET @MySQL = 'INSERT INTO TBL_DIFF1 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySql + 'select c1.table_name, c1.COLUMN_NAME, c1.DATA_TYPE , cast (c1.CHARACTER_MAXIMUM_LENGTH as nvarchar(254)) as CHARACTER_MAXIMUM_LENGTH, c2.table_name as table_name2 ,c2.DATA_TYPE as DATA_TYPE2 ,c2.COLUMN_NAME as COLUMN_NAME2, c2.CHARACTER_MAXIMUM_LENGTH as CHARACTER_MAXIMUM_LENGTH2, ''Data Types or Data Length Differ'' ';
		 SET @MySQL = @MySQL + 'from [' + @LinkedSVR + '].[' + @LinkedDB + '].[INFORMATION_SCHEMA].[COLUMNS] c1 ';
		 SET @MySQL = @MySQL + 'left join ' + @CurrDB + '.[INFORMATION_SCHEMA].[COLUMNS] c2 on c1.TABLE_NAME = c2.TABLE_NAME ';
		 SET @MySQL = @MySQL + 'where c1.TABLE_NAME= ''' + @LinkedTBL + ''' and c2.TABLE_NAME = ''' + @CurrTBL + ''' ';
		 SET @MySQL = @MySQL + 'and C1.column_name = c2.column_name ';
		 SET @MySQL = @MySQL + 'and ((c1.data_type <> c2.DATA_TYPE) ';
		 SET @MySQL = @MySQL + '		OR (c1.data_type = c2.DATA_TYPE AND c1.CHARACTER_MAXIMUM_LENGTH <> c2.CHARACTER_MAXIMUM_LENGTH))';
		 EXEC (@MySql) ;

		 --print ('Step05');

		 SET @MySQL = '';
		 SET @MySQL = 'INSERT INTO TBL_DIFF2 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySQL + 'SELECT c1.TABLE_NAME, c1.COLUMN_NAME, c1.DATA_TYPE, ''' + @CurrDB + ''' as DBNAME, ''MISSING'' as C1, ''NA'' as C2 , ''NA'' as C3, 0 as I1, ''Column ''+c1.COLUMN_NAME+'' Missing in: ' + @CurrDB + ' / ' + @CurrTBL + ' ''  ';
		 SET @MySQL = @MySQL + ' FROM  [' + @LinkedSVR + '].[' + @LinkedDB + '].INFORMATION_SCHEMA.COLUMNS AS c1 ';
		 SET @MySQL = @MySQL + ' WHERE  C1.table_name = ''' + @CurrTBL + ''' ';
		 SET @MySQL = @MySQL + ' 	AND c1.column_name not in ';
		 SET @MySQL = @MySQL + ' 	(select column_name from ' + @CurrDB + '.INFORMATION_SCHEMA.columns C2 where C2.table_name = ''' + @LinkedTBL + ''') ';
		 EXEC (@MySql) ;

		 --print ('Step06');

		 SET @MySQL = 'INSERT INTO TBL_DIFF3 (table_name, COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, table_name2, DATA_TYPE2, COLUMN_NAME2, CHARACTER_MAXIMUM_LENGTH2, Note) ';
		 SET @MySQL = @MySQL + 'SELECT c1.TABLE_NAME, c1.COLUMN_NAME, c1.DATA_TYPE, ''' + @LinkedDB + ''' as DBNAME, ''MISSING'' as C1, ''NA'' as C2, ''NA'' as C3, -1 as I1, ''Column ''+c1.COLUMN_NAME+'' Missing in: ' + @LinkedDB + ' / ' + @LinkedTBL + ' ''  ';
		 SET @MySQL = @MySQL + ' FROM [' + @CurrDB + '].INFORMATION_SCHEMA.COLUMNS as C1 ';
		 SET @MySQL = @MySQL + ' WHERE  C1.table_name = ''' + @CurrTBL + ''' ';
		 SET @MySQL = @MySQL + ' AND c1.column_name not in ';
		 SET @MySQL = @MySQL + ' (select column_name from [' + @LinkedSVR + '].[' + @LinkedDB + '].INFORMATION_SCHEMA.columns C2 where C2.table_name = ''' + @LinkedTBL + ''') ';
		 EXEC (@MySql) ;

		 --print ('Step07');

		 SET @S = 'SELECT @retval = count(*) FROM sys.servers WHERE name = @TgtSVR ';
		 SET @ParmDefinition = N'@TgtSVR nvarchar(254), @retval bit OUTPUT';
		 EXEC sp_executesql @S, @ParmDefinition, @TgtSVR = @LinkedSVR, @retval = @iRetval OUTPUT;
		 SET @iCnt = (SELECT
							 @iRetval) ;
		 IF @iCnt = 1
			 BEGIN EXEC master.sys.sp_dropserver @LinkedSVR, 'droplogins'
			 END;

		 --print ('Step08');

		 IF NOT EXISTS (SELECT
							   name
						  FROM sys.views
						  WHERE name = 'view_SchemaDiff') 
			 BEGIN
				 DECLARE @sTxt AS nvarchar (max) = '';
				 SET @sTxt = @sTxt + 'Create view view_SchemaDiff AS ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF1 ';
				 SET @sTxt = @sTxt + 'union ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF2  ';
				 SET @sTxt = @sTxt + 'union ';
				 SET @sTxt = @sTxt + 'Select * from TBL_DIFF3  ';
				 EXEC (@sTxt) ;
				 PRINT 'Created view view_SchemaDiff.';
			 END;

		 --Select * from TBL_DIFF1 
		 --union
		 --Select * from TBL_DIFF2 
		 --union
		 --Select * from TBL_DIFF3 

		 PRINT 'To see "deltas" - select * from view_SchemaDiff';
		 PRINT '_________________________________________________';
	 END;
GO
PRINT 'Created Proc_EDW_Compare_Tables';
GO

	--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Creating the AUDIT tables.';
GO

--CreateDdlAuditTables

IF NOT EXISTS (SELECT
					  name

			   --FROM tempdb.dbo.sysobjects

				 FROM sysobjects
				 WHERE ID = OBJECT_ID (N'TBL_DIFF1')) 
	BEGIN
		CREATE TABLE dbo.TBL_DIFF1 (
					 table_name sysname NOT NULL
				   , COLUMN_NAME sysname NULL
				   , DATA_TYPE nvarchar (254) NULL
				   , CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
				   , table_name2 sysname NULL
				   , DATA_TYPE2 nvarchar (254) NULL
				   , COLUMN_NAME2 sysname NULL
				   , CHARACTER_MAXIMUM_LENGTH2 int NULL
				   , NOTE varchar (max) NULL
				   , CreateDate datetime2 (7) NULL
										 DEFAULT GETDATE () 
				   , RowNbr int IDENTITY) ;
	END;
GO
PRINT 'Created AUDIT table TBL_DIFF1 of 4.';
GO
IF NOT EXISTS (SELECT
					  name

			   --FROM tempdb.dbo.sysobjects

				 FROM sysobjects
				 WHERE ID = OBJECT_ID (N'TBL_DIFF2')) 
	BEGIN
		CREATE TABLE dbo.TBL_DIFF2 (
					 table_name sysname NOT NULL
				   , COLUMN_NAME sysname NULL
				   , DATA_TYPE nvarchar (254) NULL
				   , CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
				   , table_name2 sysname NULL
				   , DATA_TYPE2 nvarchar (254) NULL
				   , COLUMN_NAME2 sysname NULL
				   , CHARACTER_MAXIMUM_LENGTH2 int NULL
				   , NOTE varchar (max) NULL
				   , CreateDate datetime2 (7) NULL
										 DEFAULT GETDATE () 
				   , RowNbr int IDENTITY) ;
	END;
GO
PRINT 'Created AUDIT table TBL_DIFF2 of 4.';
GO
IF NOT EXISTS (SELECT
					  name

			   --FROM tempdb.dbo.sysobjects

				 FROM sysobjects
				 WHERE ID = OBJECT_ID (N'TBL_DIFF3')) 
	BEGIN
		CREATE TABLE dbo.TBL_DIFF3 (
					 table_name sysname NOT NULL
				   , COLUMN_NAME sysname NULL
				   , DATA_TYPE nvarchar (254) NULL
				   , CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
				   , table_name2 sysname NULL
				   , DATA_TYPE2 nvarchar (254) NULL
				   , COLUMN_NAME2 sysname NULL
				   , CHARACTER_MAXIMUM_LENGTH2 int NULL
				   , NOTE varchar (max) 
				   , CreateDate datetime2 (7) DEFAULT GETDATE () 
				   , RowNbr int IDENTITY) ;
	END;
GO
PRINT 'Created AUDIT table TBL_DIFF3 of 4.';
GO
IF NOT EXISTS (SELECT
					  name

			   --FROM tempdb.dbo.sysobjects

				 FROM sysobjects
				 WHERE ID = OBJECT_ID (N'TBL_DIFF4')) 
	BEGIN
		CREATE TABLE dbo.TBL_DIFF4 (
					 table_name sysname NOT NULL
				   , COLUMN_NAME sysname NULL
				   , DATA_TYPE nvarchar (254) NULL
				   , CHARACTER_MAXIMUM_LENGTH nvarchar (254) NULL
				   , table_name2 sysname NULL
				   , DATA_TYPE2 nvarchar (254) NULL
				   , COLUMN_NAME2 sysname NULL
				   , CHARACTER_MAXIMUM_LENGTH2 int NULL
				   , NOTE varchar (max) 
				   , CreateDate datetime2 (7) DEFAULT GETDATE () 
				   , RowNbr int IDENTITY) ;
	END;
GO
PRINT 'Created AUDIT table TBL_DIFF4 of 4.';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.views
			 WHERE name = 'view_SchemaDiff') 
	BEGIN
		DROP VIEW
			 view_SchemaDiff;
		PRINT 'Removed view_SchemaDiff.';
	END;
GO
PRINT 'Created view_SchemaDiff.';
GO
CREATE VIEW view_SchemaDiff
AS
	 SELECT
			*
	   FROM TBL_DIFF1
	 UNION
	 SELECT
			*
	   FROM TBL_DIFF2
	 UNION
	 SELECT
			*
	   FROM TBL_DIFF3;
GO
PRINT 'Create View view_SchemaChangeMonitor';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.views
			 WHERE name = 'view_SchemaChangeMonitor') 
	BEGIN
		DROP VIEW
			 view_SchemaChangeMonitor;
	END;
GO
CREATE VIEW view_SchemaChangeMonitor
AS
	 SELECT
			PostTime
		  , DB_User
		  , IP_Address
		  , CUR_User
		  , Event
		  , TSQL
		  , OBJ
		  , RowNbr
	   FROM SchemaChangeMonitor;
GO
PRINT 'Created View view_SchemaChangeMonitor';
GO
PRINT 'Create View SchemaChangeMonitor_rptData';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.views
			 WHERE name = 'view_SchemaChangeMonitor_rptData ') 
	BEGIN
		DROP VIEW
			 view_SchemaChangeMonitor_rptData;
	END;
GO
CREATE VIEW view_SchemaChangeMonitor_rptData
AS
	 SELECT
			label
		  , sText
		  , DisplayOrder
		  , RowNbr
	   FROM dbo.SchemaChangeMonitor_rptData;
GO
PRINT 'Created View view_SchemaChangeMonitor_rptData ';
PRINT 'AUDIT Tables created successfully';
GO



--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'FQN: SchemaChangeMonitor.SQL';
PRINT 'Creating SchemaChangeMonitor table';
GO
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
SET ARITHABORT ON
SET CONCAT_NULL_YIELDS_NULL ON
SET NUMERIC_ROUNDABORT OFF
SET QUOTED_IDENTIFIER ON
IF EXISTS (SELECT
				  name
			 FROM sys.tables
			 WHERE name = 'SchemaChangeMonitor') 
	BEGIN
		PRINT 'DROP SchemaChangeMonitor table';
		DROP TABLE
			 dbo.SchemaChangeMonitor;
	END;
IF NOT EXISTS (SELECT
					  name
				 FROM sys.tables
				 WHERE name = 'SchemaChangeMonitor') 
	BEGIN
		
CREATE TABLE [dbo].[SchemaChangeMonitor](
	[PostTime] [datetime2](7) NULL,
	[DB_User] [nvarchar](254) NULL,
	[IP_Address] [nvarchar](254) NULL,
	[CUR_User] [nvarchar](254) NULL,
	[Event] [nvarchar](254) NULL,
	[TSQL] [nvarchar](max) NULL,
	[OBJ] [nvarchar](254) NULL,
	[RowNbr] [int] IDENTITY(1,1) NOT NULL,
	[ServerName] [nvarchar](254) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY] ;

ALTER TABLE [dbo].[SchemaChangeMonitor] ADD  CONSTRAINT [DF_SchemaChangeMonitor_ServerName]  DEFAULT (@@servername) FOR [ServerName];

	END;
GO
GO
PRINT 'Created SchemaChangeMonitor table';
GO

--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




print ('Processing: view_EDW_CoachingDefinition ') ;
go

if exists(select TABLE_NAME from INFORMATION_SCHEMA.VIEWS where TABLE_NAME = 'view_EDW_CoachingDefinition')
BEGIN
	drop view view_EDW_CoachingDefinition ;
END
GO


--GRANT SELECT
--	ON [dbo].[view_EDW_CoachingDefinition]
--	TO [EDWReader_PRD]
--GO


CREATE VIEW [dbo].[view_EDW_CoachingDefinition]
AS
--********************************************************************************************************
--8/7/2014 - added DocumentGuid 
--8/8/2014 - Generated corrected view in DEV (WDM)
-- Verified last mod date available to EDW 9.10.2014
--11.17.2014 - (wdm) John Croft found an issue with multiple languages being returned.
--		View_EDW_CoachingDefinition pulls its data from a nested view View_HFit_Tobacco_Goal_Joined. I added 
--		a Document Culture filter on the SELECT STATEMENT pulling the data from View_HFit_Tobacco_Goal_Joined.
--		In LAB DB, when the view is executed W/O the filter, I get 90 rows. When executed with the filter, I 
--		get 89 rows. This would indicate the filter can be applied at the SELCT statement level. The view has 
--		the change applied and is ready to be regenerated. Also, I needed to add a language filter to 
--		View_HFit_Goal_Joined. Additionally, I allow the view to return the Document Culture as a column so 
--		that we can see the associated language. This can be removed if not wanted, but for troubleshooting 
--		it is useful.
--********************************************************************************************************
SELECT
	GJ.GoalID
	, GJ.DocumentGuid	--, GJ.DocumentID
	, GJ.NodeSiteID
	, cs.SiteGUID
	, GJ.GoalImage
	, GJ.Goal
	, dbo.udf_StripHTML(GJ.GoalText) GoalText --
	, dbo.udf_StripHTML(GJ.GoalSummary) GoalSummary --
	, GJ.TrackerAssociation  --GJ.TrackerAssociation
	, GJ.GoalFrequency
	, HFLF.FrequencySingular
	, HFLF.FrequencyPlural
	, GJ.GoalUnitOfMeasure
	, HFLUOM.UnitOfMeasure
	, GJ.GoalDirection
	, GJ.GoalPrecision
	, GJ.GoalAbsoluteMin
	, GJ.GoalAbsoluteMax
	, dbo.udf_StripHTML(GJ.SetGoalText) SetGoalText --
	, dbo.udf_StripHTML(GJ.HelpText) HelpText --
	, GJ.EvaluationType
	, GJ.CatalogDisplay
	, GJ.AllowModification
	, GJ.ActivityText
	, dbo.udf_StripHTML(GJ.SetGoalModifyText) SetgoalModifyText
	, GJ.IsLifestyleGoal
	, GJ.CodeName
	, CASE	WHEN CAST(gj.DocumentCreatedWhen AS DATE) = CAST(gj.DocumentModifiedWhen AS DATE)
			THEN 'I'
			ELSE 'U'
		END AS ChangeType
	, GJ.DocumentCreatedWhen
	, GJ.DocumentModifiedWhen
	, GJ.DocumentCulture
FROM
	(
		SELECT
			VHFGJ.GoalID
			, VHFGJ.DocumentGuid	--, VHFGJ.DocumentID
			, VHFGJ.NodeSiteID
			, VHFGJ.GoalImage
			, VHFGJ.Goal
			, VHFGJ.GoalText
			, VHFGJ.GoalSummary
			, VHFGJ.TrackerNodeGUID as TrackerAssociation  --VHFGJ.TrackerAssociation
			, VHFGJ.GoalFrequency
			, VHFGJ.GoalUnitOfMeasure
			, VHFGJ.GoalDirection
			, VHFGJ.GoalPrecision
			, VHFGJ.GoalAbsoluteMin
			, VHFGJ.GoalAbsoluteMax
			, VHFGJ.SetGoalText
			, VHFGJ.HelpText
			, VHFGJ.EvaluationType
			, VHFGJ.CatalogDisplay
			, VHFGJ.AllowModification
			, VHFGJ.ActivityText
			, VHFGJ.SetGoalModifyText
			, VHFGJ.IsLifestyleGoal
			, VHFGJ.CodeName
			, VHFGJ.DocumentCreatedWhen
			, VHFGJ.DocumentModifiedWhen
			, VHFGJ.DocumentCulture
		FROM
			dbo.View_HFit_Goal_Joined AS VHFGJ
			where VHFGJ.DocumentCulture = 'en-US'
		UNION ALL
		SELECT
			VHFTGJ.GoalID
			, VHFTGJ.DocumentGuid	--, VHFTGJ.DocumentID
			, VHFTGJ.NodeSiteID
			, VHFTGJ.GoalImage
			, VHFTGJ.Goal
			, NULL AS GoalText
			, VHFTGJ.GoalSummary
			, VHFTGJ.TrackerNodeGUID as TrackerAssociation  --VHFTGJ.TrackerAssociation
			, VHFTGJ.GoalFrequency
			, NULL AS GoalUnitOfMeasure
			, VHFTGJ.GoalDirection
			, VHFTGJ.GoalPrecision
			, VHFTGJ.GoalAbsoluteMin
			, VHFTGJ.GoalAbsoluteMax
			, NULL AS SetGoalText
			, NULL AS HelpText
			, VHFTGJ.EvaluationType
			, VHFTGJ.CatalogDisplay
			, VHFTGJ.AllowModification
			, VHFTGJ.ActivityText
			, NULL SetGoalModifyText
			, VHFTGJ.IsLifestyleGoal
			, VHFTGJ.CodeName
			, VHFTGJ.DocumentCreatedWhen
			, VHFTGJ.DocumentModifiedWhen
			, VHFTGJ.DocumentCulture
		FROM
			dbo.View_HFit_Tobacco_Goal_Joined AS VHFTGJ
			where VHFTGJ.DocumentCulture = 'en-US'
	) AS GJ
LEFT OUTER JOIN dbo.HFit_LKP_UnitOfMeasure AS HFLUOM ON GJ.GoalUnitOfMeasure = HFLUOM.UnitOfMeasureID
LEFT OUTER JOIN dbo.HFit_LKP_Frequency AS HFLF ON GJ.GoalFrequency = HFLF.FrequencyID
INNER JOIN cms_site AS CS ON gj.nodesiteid = cs.siteid
--INNER JOIN cms_site AS CS ON gj.siteguid = cs.siteguid
WHERE
	gj.DocumentCreatedWhen IS NOT NULL
	AND gj.DocumentModifiedWhen IS NOT NULL 

GO

--select * from view_EDW_CoachingDefinition  --  
  --  
GO 
print('Completed: view_EDW_CoachingDefinition.sql'); 
print('***** FROM: view_EDW_CoachingDefinition.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





go
print ('Processing: View_EDW_HealthAssesmentQuestions ') ;
go


if exists(select TABLE_NAME from INFORMATION_SCHEMA.VIEWS where TABLE_NAME = 'View_EDW_HealthAssesmentQuestions')
BEGIN
	drop view View_EDW_HealthAssesmentQuestions ;
END
GO

create VIEW [dbo].[View_EDW_HealthAssesmentQuestions]

AS 
--**********************************************************************************
--09.11.2014 (wdm) Added the DocumentModifiedWhen to facilitate the EDW need to 
--		determine the last mod date of a record.
--10.17.2014 (wdm)
-- view_EDW_HealthAssesmentDeffinition calls 
-- View_EDW_HealthAssesmentQuestions which calls
-- View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined
--		and two other JOINED views.
--View view_EDW_HealthAssesmentDeffinition has a filter on document culture of 'EN-US'
--		which limits the retured data to Engoish only.
--Today, John found a number of TITLES in view_EDW_HealthAssesmentDeffinition that were Spanish.
--The problem seems to come from sevel levels of nesting causing intersection data to seep through 
--the EN-US filter if placed at the highest level of a set of nested views.
--I took the filter and applied it to all the joined views within View_EDW_HealthAssesmentQuestions 
--		and the issue seems to have resolved itself.
--10.17.2014 (wdm) Added a filter "DocumentCulture" - the issue appears to be 
--			caused in view view_EDW_HealthAssesmentDeffinition becuase
--			the FILTER at that level on EN-US allows a portion of the intersection 
--			data to be missed for whatever reason. Adding the filter at this level
--			of the nesting seems to omit the non-english titles found by John Croft.
--**********************************************************************************
SELECT 
	VHFHAMCQJ.ClassName AS QuestionType,
	VHFHAMCQJ.Title,
	VHFHAMCQJ.Weight,
	VHFHAMCQJ.IsRequired,
	VHFHAMCQJ.QuestionImageLeft,
	VHFHAMCQJ.QuestionImageRight,
	VHFHAMCQJ.NodeGUID,	
	VHFHAMCQJ.DocumentCulture,
	VHFHAMCQJ.IsEnabled,
	VHFHAMCQJ.IsVisible,
	VHFHAMCQJ.IsStaging,
	VHFHAMCQJ.CodeName,
	VHFHAMCQJ.QuestionGroupCodeName,
	VHFHAMCQJ.NodeAliasPath,
	VHFHAMCQJ.DocumentPublishedVersionHistoryID,
	VHFHAMCQJ.NodeLevel,
	VHFHAMCQJ.NodeOrder,
	VHFHAMCQJ.NodeID,
	VHFHAMCQJ.NodeParentID,
	VHFHAMCQJ.NodeLinkedNodeID, 
	0 AS DontKnowEnabled, 
	'' AS DontKnowLabel,
	(select pp.NodeOrder from dbo.CMS_Tree pp inner join dbo.CMS_Tree p on p.NodeParentID = pp.NodeID where p.NodeID = VHFHAMCQJ.NodeParentID) AS ParentNodeOrder
	,VHFHAMCQJ.DocumentGuid
	,VHFHAMCQJ.DocumentModifiedWhen	--(WDM) 09.11.2014 added to facilitate determining document last mod date 
FROM dbo.View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS VHFHAMCQJ WITH(NOLOCK)
where VHFHAMCQJ.DocumentCulture = 'en-US'   --(WDM) 10.19.2014 added to filter at this level of nesting

UNION ALL 
SELECT 
	VHFHAMQJ.ClassName AS QuestionType,
	VHFHAMQJ.Title,
	VHFHAMQJ.Weight,
	VHFHAMQJ.IsRequired,
	VHFHAMQJ.QuestionImageLeft,
	VHFHAMQJ.QuestionImageRight,
	VHFHAMQJ.NodeGUID,
	VHFHAMQJ.DocumentCulture,
	VHFHAMQJ.IsEnabled,
	VHFHAMQJ.IsVisible,
	VHFHAMQJ.IsStaging,
	VHFHAMQJ.CodeName,
	VHFHAMQJ.QuestionGroupCodeName,
	VHFHAMQJ.NodeAliasPath,
	VHFHAMQJ.DocumentPublishedVersionHistoryID,
	VHFHAMQJ.NodeLevel,
	VHFHAMQJ.NodeOrder,
	VHFHAMQJ.NodeID,
	VHFHAMQJ.NodeParentID,
	VHFHAMQJ.NodeLinkedNodeID,
	0 AS DontKnowEnabled, 
	'' AS DontKnowLabel,
		(select pp.NodeOrder from dbo.CMS_Tree pp inner join dbo.CMS_Tree p on p.NodeParentID = pp.NodeID where p.NodeID = VHFHAMQJ.NodeParentID) AS ParentNodeOrder
	,VHFHAMQJ.DocumentGuid
	,VHFHAMQJ.DocumentModifiedWhen	--(WDM) 09.11.2014 added to facilitate determining document last mod date 
FROM dbo.View_HFit_HealthAssesmentMatrixQuestion_Joined AS VHFHAMQJ WITH(NOLOCK)
where VHFHAMQJ.DocumentCulture = 'en-US'   --(WDM) 10.19.2014 added to filter at this level of nesting

UNION ALL 
SELECT 
	VHFHAFFJ.ClassName AS QuestionType,
	VHFHAFFJ.Title,
	VHFHAFFJ.Weight,
	VHFHAFFJ.IsRequired,
	VHFHAFFJ.QuestionImageLeft,
	'' AS QuestionImageRight,
	VHFHAFFJ.NodeGUID,
	VHFHAFFJ.DocumentCulture,
	VHFHAFFJ.IsEnabled,
	VHFHAFFJ.IsVisible,
	VHFHAFFJ.IsStaging,
	VHFHAFFJ.CodeName,
	VHFHAFFJ.QuestionGroupCodeName,
	VHFHAFFJ.NodeAliasPath,
	VHFHAFFJ.DocumentPublishedVersionHistoryID,
	VHFHAFFJ.NodeLevel,
	VHFHAFFJ.NodeOrder,
	VHFHAFFJ.NodeID,
	VHFHAFFJ.NodeParentID,
	VHFHAFFJ.NodeLinkedNodeID,
	VHFHAFFJ.DontKnowEnabled,
	VHFHAFFJ.DontKnowLabel,
	(select pp.NodeOrder from dbo.CMS_Tree pp inner join dbo.CMS_Tree p on p.NodeParentID = pp.NodeID where p.NodeID = VHFHAFFJ.NodeParentID) AS ParentNodeOrder
	,VHFHAFFJ.DocumentGuid
	,VHFHAFFJ.DocumentModifiedWhen	--(WDM) 09.11.2014 added to facilitate determining document last mod date 
FROM dbo.View_HFit_HealthAssessmentFreeForm_Joined AS VHFHAFFJ WITH(NOLOCK)
where VHFHAFFJ.DocumentCulture = 'en-US'   --(WDM) 10.19.2014 added to filter at this level of nesting

GO
print ('Processed: View_EDW_HealthAssesmentQuestions ') ;
go



  --  
  --  
GO 
print('***** FROM: View_EDW_HealthAssesmentQuestions.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;






GO
PRINT 'Processing view_EDW_HealthAssessment_Staged';
GO

IF EXISTS (SELECT
                  name
                  FROM sys.views
             WHERE name = 'view_EDW_HealthAssessment_Staged') 
    BEGIN
        DROP VIEW
             view_EDW_HealthAssessment_Staged;
    END;
GO
--select top 100 * from [view_EDW_HealthAssessment_Staged]
CREATE VIEW dbo.view_EDW_HealthAssessment_Staged
AS SELECT
          UserStartedItemID
        , HealthAssesmentUserStartedNodeGUID
        , UserID
        , UserGUID
        , HFitUserMpiNumber
        , SiteGUID
        , AccountID
        , AccountCD
        , AccountName
        , HAStartedDt
        , HACompletedDt
        , UserModuleItemId
        , UserModuleCodeName
        , HAModuleNodeGUID
        , CMSNodeGuid
        , HAModuleVersionID
        , UserRiskCategoryItemID
        , UserRiskCategoryCodeName
        , HARiskCategoryNodeGUID						--WDM 8/7/2014 as HARiskCategoryDocumentID
        , HARiskCategoryVersionID			--WDM 10.02.2014 place holder for EDW ETL
        , UserRiskAreaItemID
        , UserRiskAreaCodeName
        , HARiskAreaNodeGUID							--WDM 8/7/2014 as HARiskAreaDocumentID
        , HARiskAreaVersionID			--WDM 10.02.2014 place holder for EDW ETL
        , UserQuestionItemID
        , Title			--WDM 47619 12.29.2014
        , HAQuestionGuid		--WDM 9.2.2014	This is a repeat field but had to stay to match the previous view - this is the NODE GUID and matches to the definition file to get the question. This tells you the question, language agnostic.
        , UserQuestionCodeName
        , HAQuestionDocumentID	--WDM 10.1.2014 - this is GOING AWAY 		--WDM 10.02.2014 place holder for EDW ETL
        , HAQuestionVersionID			--WDM 10.1.2014 - this is GOING AWAY - no versions across environments 		--WDM 10.02.2014 place holder for EDW ETL
        , HAQuestionNodeGUID		--WDM 10.01.2014	Left this in place to preserve column structure.		
        , UserAnswerItemID
        , HAAnswerNodeGUID								--WDM 8/7/2014 as HAAnswerDocumentID
        , HAAnswerVersionID		--WDM 10.1.2014 - this is GOING AWAY - no versions across environments		--WDM 10.02.2014 place holder for EDW ETL
        , UserAnswerCodeName
        , HAAnswerValue
        , HAModuleScore
        , HARiskCategoryScore
        , HARiskAreaScore
        , HAQuestionScore
        , HAAnswerPoints
        , PointResults
        , UOMCode
        , HAScore
        , ModulePreWeightedScore
        , RiskCategoryPreWeightedScore
        , RiskAreaPreWeightedScore
        , QuestionPreWeightedScore
        , QuestionGroupCodeName
        , ChangeType
        , ItemCreatedWhen
        , ItemModifiedWhen
        , IsProfessionallyCollected
        , HARiskCategory_ItemModifiedWhen
        , HAUserRiskArea_ItemModifiedWhen
        , HAUserQuestion_ItemModifiedWhen
        , HAUserAnswers_ItemModifiedWhen
        , HAPaperFlg
        , HATelephonicFlg
        , HAStartedMode		--12.11.2014 WDM Sowmiya and dale talked and decided to implement this column 12.17.2014 - Added 
        , HACompletedMode	--12.11.2014 WDM Sowmiya and dale talked and decided to implement this column 12.17.2014 - Added 

        , DocumentCulture_VHCJ
        , DocumentCulture_HAQuestionsView
        , CampaignNodeGUID
	   ,LastModifiedDate
          FROM Staging_EDW_HealthAssessment;

GO

PRINT 'Processed view_EDW_HealthAssessment_Staged';
GO
--  
--  
GO
PRINT '***** FROM: view_EDW_HealthAssessment_Staged.sql';
GO 


--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;






GO 
print('***** FROM: view_EDW_HealthInterestDetail.sql'); 
GO 
print ('Creating view_EDW_HealthInterestDetail');
GO

if exists(select name from sys.views where name = 'view_EDW_HealthInterestDetail')
BEGIN 
	drop view view_EDW_HealthInterestDetail ;
END
go

CREATE VIEW [dbo].[view_EDW_HealthInterestDetail]
AS
	--12/03/2014 1526 (wdm) this view was created by Chad Gurka and passed over to Team P to incloude into the build
	--12/03/2014 1845 (wdm) INSTALLATION: In running the script on Prod 1, an error was encountered when creating the 
	--view view_EDW_HealthInterestDetail. A base table, HFit_CoachingHealthInterest, referenced by the view on 
	--all prod servers was missing two columns, ItemCreatedWhen and ItemModifiedWhen.
	--In order to get the view created, I nulled out these two columns and a FIX will have to be applied to the 
	--view after these two columns are added to the base table. Chad had no way of knowing these columns were 
	--missing in Prod when he developed the view. And, it tested perfectly for John C. in Prod Staging this afternoon. 
	--This table, HFit_CoachingHealthInterest, will have these columns applied as part of the upcoming migration and 
	--are not available in Prod currently. However, the fix will be very minor and should correct itself as part of 
	--coming migration. Please take note that these columns will return only NULLS until the base table is modified 
	--to contain these columns.

	SELECT
		HI.UserID
		,U.UserGUID
		,US.HFitUserMpiNumber
		,S.SiteGUID
		,HI.CoachingHealthInterestID

		,HA1.CoachingHealthAreaID AS FirstHealthAreaID
		,HA1.NodeID AS FirstNodeID
		,HA1.NodeGuid AS FirstNodeGuid
		,HA1.DocumentName AS FirstHealthAreaName
		,HA1.HealthAreaDescription AS FirstHealthAreaDescription
		,HA1.CodeName AS FirstCodeName
	
		,HA2.CoachingHealthAreaID AS SecondHealthAreaID
		,HA2.NodeID AS SecondNodeID
		,HA2.NodeGuid AS SecondNodeGuid
		,HA2.DocumentName AS SecondHealthAreaName
		,HA2.HealthAreaDescription AS SecondHealthAreaDescription
		,HA2.CodeName AS SecondCodeName
	
		,HA3.CoachingHealthAreaID AS ThirdHealthAreaID
		,HA3.NodeID AS ThirdNodeID
		,HA3.NodeGuid AS ThirdNodeGuid
		,HA3.DocumentName AS ThirdHealthAreaName
		,HA3.HealthAreaDescription AS ThirdHealthAreaDescription
		,HA3.CodeName AS ThirdCodeName

		,HI.ItemCreatedWhen
		,HI.ItemModifiedWhen
	FROM
		HFit_CoachingHealthInterest AS HI
		JOIN CMS_User AS U ON HI.UserID = U.UserID
		JOIN CMS_UserSettings AS US ON HI.UserID = US.UserSettingsUserID
		JOIN CMS_UserSite AS US1 ON HI.UserID = US1.UserID
		JOIN CMS_Site AS S ON US1.SiteID = S.SiteID
		LEFT JOIN View_HFit_CoachingHealthArea_Joined AS HA1 ON HI.FirstInterest = HA1.NodeID
			AND HA1.DocumentCulture = 'en-us'
		LEFT JOIN View_HFit_CoachingHealthArea_Joined AS HA2 ON HI.SecondInterest = HA2.NodeID	
			AND HA2.DocumentCulture = 'en-us'
		LEFT JOIN View_HFit_CoachingHealthArea_Joined AS HA3 ON HI.ThirdInterest = HA3.NodeID
			AND HA3.DocumentCulture = 'en-us'
GO

print ('Created view_EDW_HealthInterestDetail');
GO


--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




GO
print('Creating view_EDW_HealthInterestList'); 
GO

if exists(select name from sys.views where name = 'view_EDW_HealthInterestList')
BEGIN 
	drop view view_EDW_HealthInterestList ;
END
go

CREATE VIEW [dbo].[view_EDW_HealthInterestList]
AS
	--12/03/2014 (wdm) this view was created by Chad Gurka and passed over to Team P to incloude into the build
	SELECT
		CHA.CoachingHealthAreaID AS HealthAreaID
		,CHA.NodeID
		,CHA.NodeGuid
		,A.AccountCD
		,CHA.NodeName AS HealthAreaName
		,CHA.HealthAreaDescription
		,CHA.CodeName
		,CHA.DocumentCreatedWhen
		,CHA.DocumentModifiedWhen
	FROM
		View_HFit_CoachingHealthArea_Joined AS CHA
		JOIN HFit_Account AS A ON A.SiteID = CHA.NodeSiteID
	WHERE DocumentCulture = 'en-us'

GO
print('Created view_EDW_HealthInterestList'); 
GO
  --  
  --  
GO 
print('***** FROM: view_EDW_HealthInterestList.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
print ('Processing: view_EDW_RewardTriggerParameters ') ;
go

if exists(select NAME from sys.VIEWS where NAME = 'view_EDW_RewardTriggerParameters')
BEGIN
	drop view view_EDW_RewardTriggerParameters ;
END
GO


--GRANT SELECT
--	ON [dbo].[view_EDW_RewardTriggerParameters]
--	TO [EDWReader_PRD]
--GO


--*******************************************************************************************************************
--8/7/2014  VHFRTJ.DocumentGuid		  --WDM Added in case needed
--8/7/2014  VHFRTJ.NodeGuid			  --WDM Added in case needed
--09.11.2014 : (wdm) Verified last mod date available to EDW - RewardTriggerParameter_DocumentModifiedWhen
--11.17.2014 : (wdm) John C. found that Spanish was being brought across in TriggerName and 
--				ParameterDisplayName. Found that View_HFit_RewardTrigger_Joined has no way to limit the 
--				returned data to Spanish. Created a new view, View_EDW_RewardProgram_Joined, and provided 
--				a FILTER on Document Culture. The, added Launguage fitlers as: 
--					where VHFRTJ.DocumentCulture = 'en-US' AND VHFRTPJ.DocumentCulture = 'en-US'
--				This appears to have eliminated the Spanish.
-- 03.03.2015 : (Dale/Natahn) no changes required.
-- 04.12.2015 : (WDM) In order to implement change tracking on this view, a STAGING table will simply be 
--			 dropped and recreated everytime using this view. It is too small to worry about otherwise.
--SELECT * FROM [view_EDW_RewardTriggerParameters]
--*******************************************************************************************************************
create VIEW [dbo].[view_EDW_RewardTriggerParameters]
AS
--8/7/2014 - added and commented out DocumentGuid and NodeGuid in case needed later
--8/8/2014 - Generated corrected view in DEV (WDM)
	SELECT distinct
		cs.SiteGUID															 --CMS_Site
		, VHFRTJ.RewardTriggerID													 --HFit_RewardTrigger
		, VHFRTJ.TriggerName													 --HFit_RewardTrigger
		, HFLRTPO.RewardTriggerParameterOperatorLKPDisplayName							 --HFit_LKP_RewardTriggerParameterOperator 
		, VHFRTPJ.ParameterDisplayName											 --HFit_RewardTriggerParameter
		, VHFRTPJ.RewardTriggerParameterOperator									 --HFit_RewardTriggerParameter
		, VHFRTPJ.Value														 --HFit_RewardTriggerParameter
		, hfa.AccountID														 --HFit_Account
		, hfa.AccountCD														 --HFit_Account
		, CASE	WHEN CAST(VHFRTJ.DocumentCreatedWhen AS DATE) = CAST(VHFRTJ.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType		
		, VHFRTJ.DocumentGuid													 --CMS_Document
		, VHFRTJ.NodeGuid														 --CMS_Document
		, VHFRTJ.DocumentCreatedWhen												 --CMS_Document
		, VHFRTJ.DocumentModifiedWhen												 --CMS_Document
		,VHFRTPJ.DocumentModifiedWhen as RewardTriggerParameter_DocumentModifiedWhen	  	 --CMS_Document
		,VHFRTPJ.documentculture as documentculture_VHFRTPJ							 --CMS_Document
		,VHFRTJ.documentculture as documentculture_VHFRTJ								 --CMS_Document
	FROM
		dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ 
		--dbo.[View_EDW_RewardProgram_Joined] AS VHFRTJ 		
	INNER JOIN dbo.View_HFit_RewardTriggerParameter_Joined AS VHFRTPJ  ON vhfrtj.NodeID = VHFRTPJ.NodeParentID
	INNER JOIN dbo.HFit_LKP_RewardTriggerParameterOperator AS HFLRTPO  ON VHFRTPJ.RewardTriggerParameterOperator = HFLRTPO.RewardTriggerParameterOperatorLKPID
	INNER JOIN dbo.CMS_Site AS CS  ON VHFRTJ.NodeSiteID = cs.SiteID
	INNER JOIN dbo.HFit_Account AS HFA  ON cs.SiteID = HFA.SiteID
	where VHFRTJ.DocumentCulture = 'en-US'
	AND VHFRTPJ.DocumentCulture = 'en-US'
      

GO


  --  
  --  
GO 
print('***** Created: view_EDW_RewardTriggerParameters.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Creating view view_EDW_SmallStepResponses';
PRINT 'Generated FROM: view_EDW_SmallStepResponses.SQL';
GO
IF EXISTS (SELECT
                  name
                  FROM sys.views
             WHERE name = 'view_EDW_SmallStepResponses') 
    BEGIN
        PRINT 'VIEW view_EDW_SmallStepResponses, replacing.';
        DROP VIEW
             view_EDW_SmallStepResponses;
    END;
GO

CREATE VIEW dbo.view_EDW_SmallStepResponses
AS

--********************************************************************************************************
--IVP Version NO: 1.0
--02.13.2014 : (Sowmiya Venkiteswaran) : Updated the view to include  the fields:
--AccountCD, SiteGUID,SSOutcomeMessage as info. text,
-- Small Steps Program Info( HACampaignNodeGUID,HACampaignName,HACampaignStartDate,HACampaignEndDate)
-- HAUserStartedRecord Info (HAStartedDate,HACompletedDate,HAStartedMode,HACompletedMode)
-- Added filters by document culture and replacing HTML quote with a SQL single quote
--********************************************************************************************************
--02.23.2014 : (Dale Miller & Sowmiya V) : Performance tuning - removed the following WHERE clause and 
--			incorporated them into the JOIN statements for perfoamnce enhancement.
--			 WHERE vwOutcome.DocumentCulture = 'en-US' AND vwCamp.DocumentCulture = 'en-US';
--********************************************************************************************************
--02.23.2014 : (Dale Miller & Sowmiya V) : Performance tuning
--	Prod1, 2 and 3 Labs - Incorporated doc. culture to the Joins
-- 1 - executed DBCC dropcleanbuffers everytime
-- 2 - Tested REPLACE against No REPLACE, insignificant perf. hit.
-- Test Controls:
-- Prod1 Lab - NO SQL DISTINCT - 184311 ( rows) - 14 (seconds) 
-- Prod1 Lab - WITH SQL DISTINCT - 184311 ( rows) - 32 (seconds) 
-- Prod2 Lab - NO SQL DISTINCT -  81120( rows) -  10(seconds) 
-- Prod2 Lab - WITH SQL DISTINCT - 81120 ( rows) -  22(seconds) 
-- Prod3 Lab - NO SQL DISTINCT - 136763 ( rows) - 10 (seconds) 
-- Prod3 Lab - WITH SQL DISTINCT - 136763 ( rows) -  21(seconds)  
--02.24.2015 (SV) - Added column SSHealthAssesmentUserStartedItemID per request from John C.
--02.24.2015 (WDM) - Verified changes applied correctly from within the IVP
--02.24.2015 (WDM) - Verified changes are tracked from within the Schema Change Monitor
--02.24.2015 (WDM) - Add the view to the Data/View IVP
--03.02.2015 (WDM) - The view got out of sync most likely due to multiple users with CRUD capability.
--		Re-executed the master DDL.
--03.03.2015 (WDM/SV) - Added new columns HaCodeName and HFitUserMPINumber.
--03.04.2015 (WDM/SV) - Tested view and reviewed output - added DISTINCT and tuned for perf.
--03.04.2015 (WDM/Ashwin) - Ashwin started testing. Modified the JOIN for UserID - now returns expected MPI.
--03.04.2015 (WDM/Ashwin) - Ashwin certified the view as tested.
--04.06.2015 (WDM/JC) John found an error in the JOIN of user ID - changed to CMS_US.UserSettingsUserID = ss.UserID
--04.15.2015 (WDM/Shane) Found an issue with duplicate rows. Added the SiteID to the JOIN (eg.
--			  vwCamp.NodeSiteID = usrste.SiteID and moved the join down in the list.)
--04.16.2015 (WDM) completed CR-51962
--********************************************************************************************************

SELECT DISTINCT
       ss.UserID
     , acct.AccountCD
     , ste.SiteGUID
     , ss.ItemID AS SSItemID
     , ss.ItemCreatedBy AS SSItemCreatedBy
     , ss.ItemCreatedWhen AS SSItemCreatedWhen
     , ss.ItemModifiedBy AS SSItemModifiedBy
     , ss.ItemModifiedWhen AS SSItemModifiedWhen
     , ss.ItemOrder AS SSItemOrder
     , ss.ItemGUID AS SSItemGUID
     , ss.HealthAssesmentUserStartedItemID AS SSHealthAssesmentUserStartedItemID
     , ss.OutComeMessageGUID AS SSOutcomeMessageGuid
     , REPLACE (vwOutcome.Message, '&#39;', '''') AS SSOutcomeMessage
     , usrstd.HACampaignNodeGUID
     , vwCamp.Name AS HACampaignName
     , vwCamp.CampaignStartDate AS HACampaignStartDate
     , vwCamp.CampaignEndDate AS HACampaignEndDate
     , usrstd.HAStartedDt AS HAStartedDate
     , usrstd.HACompletedDt AS HACompletedDate
     , usrstd.HAStartedMode
     , usrstd.HACompletedMode
     , TODO.HaCodeName
     , CMS_US.HFitUserMPINumber

       FROM
           dbo.Hfit_SmallStepResponses AS ss
               JOIN HFit_HealthAssesmentUserStarted AS usrstd
                   ON usrstd.UserID = ss.UserID
                  AND usrstd.ItemID = ss.HealthAssesmentUserStartedItemID
                 JOIN View_HFit_OutComeMessages_Joined AS vwOutcome
                   ON vwOutcome.NodeGUID = ss.OutComeMessageGUID
                  AND vwOutcome.DocumentCulture = 'en-US'
                 JOIN CMS_UserSite AS usrste
                   ON usrste.UserID = ss.UserID
                 JOIN CMS_Site AS ste
                   ON ste.SiteID = usrste.SiteID
                 JOIN View_HFit_HACampaign_Joined AS vwCamp
                   ON vwCamp.NodeGuid = usrstd.HACampaignNodeGUID
                  AND vwCamp.DocumentCulture = 'en-US'
                  AND vwCamp.NodeSiteID = usrste.SiteID
                 JOIN HFit_Account AS acct
                   ON acct.SiteID = usrste.SiteID
                 JOIN HFit_ToDoSmallSteps AS TODO
                   ON ss.OutComeMessageGUID = TODO.OutComeMessageGUID
                 JOIN CMS_UserSettings AS CMS_US
                   ON CMS_US.UserSettingsUserID = ss.UserID
                  AND CMS_US.HFitUserMPINumber > 0
                  AND CMS_US.HFitUserMPINumber IS NOT NULL;

GO
PRINT 'Created view view_EDW_SmallStepResponses';
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Processing: view_EDW_RewardUserDetail ';
GO

--IF NOT EXISTS (SELECT
--					  name
--				 FROM sys.indexes
--				 WHERE name = 'CI_HFit_RewardsUserActivityDetail_Activity') 
--	BEGIN
--		CREATE NONCLUSTERED INDEX CI_HFit_RewardsUserActivityDetail_Activity ON dbo.HFit_RewardsUserActivityDetail (ActivityNodeID) INCLUDE (
--			   UserID
--			 , ActivityVersionID
--			 , ActivityPointsEarned
--			 , ActivityCompletedDt
--			 , ItemModifiedWhen) ;
--	END;
--GO

IF EXISTS (SELECT
                  NAME
                  FROM sys.VIEWS
             WHERE NAME = 'view_EDW_RewardUserDetail') 
    BEGIN
        DROP VIEW
             view_EDW_RewardUserDetail;
    END;
GO

/*************************************************
 TESTS
select top 1000 * from [view_EDW_RewardUserDetail]
select count(*) from [view_EDW_RewardUserDetail]
select * from [view_EDW_RewardUserDetail]
Where VHFRPJ_DocumentCulture <> 'en-us'
			AND VHFRGJ_DocumentCulture <> 'en-us'
			AND VHFRLJ_DocumentCulture <> 'en-us'
			AND VHFRAJ_DocumentCulture <> 'en-us'
			AND VHFRTJ_DocumentCulture <> 'en-us'
select top 1000 * from [view_EDW_RewardUserDetail]
select count(*) from [view_EDW_RewardUserDetail]
*************************************************/

CREATE VIEW dbo.view_EDW_RewardUserDetail
AS

--**************************************************************************************************************************************************
--select * from [view_EDW_RewardUserDetail] where ItemModifiedWhen between '2000-11-14' and '2014-11-15'
--select * from [view_EDW_RewardUserDetail] where ItemModifiedWhen between '2014-05-12' and '2014-05-13' 
--8/7/2014 - added and commented out DocumentGuid and NodeGuid in case needed later
--8/08/2014 - Generated corrected view in DEV (WDM)
--8/12/2014 - Performance Issue - 00:06:49 @ 258502
--8/12/2014 - Performance Issue - Add PI01_view_EDW_RewardUserDetail
--8/12/2014 - Performance Issue - 00:03:46 @ 258502
--8/12/2014 - Performance Issue - Add PI02_view_EDW_RewardUserDetail
--8/12/2014 - Performance Issue - 00:03:45 @ 258502
--8/19/2014 - (WDM) Added where clause to make the query return english data only.	
--09.11.2014 : (wdm) Verified last mod date available to EDW - RewardsUserActivity_ItemModifiedWhen
--				RewardExceptionModifiedDate, RewardTrigger_DocumentModifiedWhen. Warned Laura this might create many dups.
--11.14.2014 : (wdm) The dups have surfaced. The combination of  HFRUAD.ActivityCompletedDt, 
--				HFRUAD.ItemModifiedWhen, HFRE.ItemModifiedWhen, HFRUAD.ItemModifiedWhen, VHFRTJ.DocumentModifiedWhen has exposed
--				tens of thousands of semi-redundant rows. Today, I commented these dates out and added a distinct and went from \
--				returning more than 100,000 rows for a given MPI and Client to 4 rows. I left in place the original dates of 
--				HFRULD.ItemCreatedWhen and HFRULD.ItemModifiedWhen. This gives us whether it is an insert or update. If multiple 
--				dates are used to determine changes, then it will be necessary to use a DATE filter to bring back only the 
--				rows indicating a change.
--11.18.2014 : (wdm) Found a USERID qualifier missing on the join of HFit_RewardsUserActivityDetail. Added this qualifier to USERID
--				and the view now appears to be functioning correctly returning about 160K rows in 2.5 minutes. The DISTINCT clause
--				made no difference in the number of returned rows, so it was removed and the execution time of the query was cut in half.
--11.18.2014 (wdm) added this filter so that only USER Detail was returned.
--01.01.2015 (WDM) added left outer join HFit_LKP_RewardActivity AND VHFRAJ.RewardActivityLKPName to the view - reference CR-47520
--01.01.2015 (WDM) Tested modifications - reference CR-47520
--02.17.2015 (WDM) and (SR) - modified the indexes and moved the where into a join to force the execution plan to modifiy itself. The 
--				view would not run in several hours since the deployment of this past Friday. Now, runs in a few minutes (less than 2).
-- 03.03.2015 Reviewed by nathan and dale and changes made as noted within.
--			ADDED THE FOLLOWING:
--				VHFRAJ.NodeGuid as RewardActivityGUID	--(03.03.2015 dale/nathan corrected)
--				VHFRPJ.DocumentGuid 	--(03.03.2015 dale/nathan corrected)
--				VHFRPJ.NodeGuid		--as RewardProgramGUID	--(03.03.2015 dale/nathan corrected)
--				VHFRGJ.NodeGuid	as RewardGroupGUID	--(03.03.2015 dale/nathan corrected)
--				VHFRTJ.NodeGuid AS RewardTriggerGUID	--(03.03.2015 dale/nathan corrected)
--03.19.2015 : by request of the EDW team, removed all columns not specificially requested
--			 and verified that was the request before initiating. The commented out columns
--			 were removed as a the solution to this request. 
--03.26.2015 : RewardGroupGUID removed per Shankar
--03.26.2015 : RewardExceptionModifiedDate Removed per Shankar
--03.12.2015 : WDM - modified view for change tracking implementation
--**************************************************************************************************************************************************

SELECT DISTINCT
       cu.UserGUID
     , CS2.SiteGUID
     , cus2.HFitUserMpiNumber
     , VHFRAJ.NodeGuid AS RewardActivityGUID	--(03.03.2015 dale/nathan corrected)
     , VHFRPJ.RewardProgramName
     , VHFRPJ.DocumentModifiedWhen AS RewardModifiedDate
     , VHFRGJ.NodeGuid AS RewardGroupGUID	 --(03.03.2015 dale/nathan corrected) and removed 03.26.2015 per Shankar
     , VHFRLJ.DocumentModifiedWhen AS RewardLevelModifiedDate
     , HFRULD.LevelCompletedDt
     , HFRUAD.ActivityPointsEarned
     , HFRUAD.ActivityCompletedDt
     , HFRUAD.ItemModifiedWhen AS RewardActivityModifiedDate
     , VHFRAJ.ActivityPoints
     , HFRE.UserAccepted
     , HFRE.UserExceptionAppliedTo
     , VHFRTJ.NodeGuid AS RewardTriggerGUID	--(03.03.2015 dale/nathan corrected)
     , HFA.AccountID
     , HFA.AccountCD
     , CASE
           WHEN CAST (HFRULD.ItemCreatedWhen AS date) = CAST (HFRULD.ItemModifiedWhen AS date) 
               THEN 'I'
           ELSE 'U'
       END AS ChangeType
	 , HASHBYTES ('sha1',
				isnull (cast(RewardProgramName as nvarchar(50)) , '-')
				+ isnull (cast( VHFRPJ.DocumentModifiedWhen as nvarchar(50)) , '-')
				+ isnull (cast(VHFRLJ.DocumentModifiedWhen as nvarchar(50)) , '-')
				+ isnull (cast(HFRULD.LevelCompletedDt as nvarchar(50)) , '-')
				+ isnull (cast(HFRUAD.ActivityPointsEarned as nvarchar(50)) , '-')
				+ isnull (cast(HFRUAD.ActivityCompletedDt as nvarchar(50)) , '-')
				+ isnull (cast(HFRUAD.ItemModifiedWhen as nvarchar(50)) , '-')
				+ isnull (cast(VHFRAJ.ActivityPoints as nvarchar(50)) , '-')
				+ isnull (cast(HFRE.UserAccepted as nvarchar(50)) , '-')
				+ isnull (cast(HFRE.UserExceptionAppliedTo as nvarchar(50)) , '-')
				+ isnull (cast(HFA.AccountID as nvarchar(50)) , '-')
				+ isnull (cast(HFA.AccountCD as nvarchar(50)) , '-')	   
				) as HashCode	   
	   ,NULL as DeletedFlg

	   --, VHFRAJ.RewardActivityID	 
	   --, VHFRPJ.RewardProgramID
	   --, VHFRPJ.DocumentGuid --(03.03.2015 dale/nathan corrected)
	   --, VHFRPJ.NodeGuid --(03.03.2015 dale/nathan corrected) RewardProgramGUID: View_HFit_RewardProgram_Joined
	   --, VHFRPJ.RewardProgramPeriodStart
	   --, VHFRPJ.RewardProgramPeriodEnd
	   --, VHFRGJ.GroupName
	   --, VHFRGJ.RewardGroupID
	   --, VHFRGJ.RewardGroupPeriodStart
	   --, VHFRGJ.RewardGroupPeriodEnd
	   --, VHFRGJ.DocumentModifiedWhen AS RewardGroupModifieDate
	   --, VHFRLJ.Level
	   --, HFLRLT.RewardLevelTypeLKPName
	   --, HFRULD.LevelVersionHistoryID
	   --, VHFRLJ.RewardLevelPeriodStart
	   --, VHFRLJ.RewardLevelPeriodEnd
	   --, VHFRAJ.ActivityName
	   --, HFRUAD.ActivityVersionID
	   --, VHFRAJ.RewardActivityPeriodStart
	   --, VHFRAJ.RewardActivityPeriodEnd
	   --, VHFRTJ.TriggerName
	   --, VHFRTJ.RewardTriggerID
	   --, HFLRT2.RewardTriggerLKPDisplayName
	   --, HFLRT2.RewardTriggerDynamicValue
	   --, HFLRT2.ItemModifiedWhen AS     RewardTriggerModifiedDate
	   --, HFLRT.RewardTypeLKPName
	   --, HFRULD.ItemCreatedWhen
	   --, HFRULD.ItemModifiedWhen

	   --, HFRE.ItemModifiedWhen AS       RewardExceptionModifiedDate	  --Removed 03.26.2015 per Shankar

	   --, HFRUAD.ItemModifiedWhen AS     RewardsUserActivity_ItemModifiedWhen
	   --, VHFRTJ.DocumentModifiedWhen AS RewardTrigger_DocumentModifiedWhen	 --01.01.2015 (WDM) added for CR-47520

	   --, LKPRA.RewardActivityLKPName
	   --, VHFRPJ.DocumentCulture AS      VHFRPJ_DocumentCulture
	   --, VHFRGJ.DocumentCulture AS      VHFRGJ_DocumentCulture
	   --, VHFRLJ.DocumentCulture AS      VHFRLJ_DocumentCulture
	   --, VHFRAJ.DocumentCulture AS      VHFRAJ_DocumentCulture
	   --, VHFRTJ.DocumentCulture AS      VHFRTJ_DocumentCulture
       FROM
            dbo.View_HFit_RewardProgram_Joined AS VHFRPJ WITH (NOLOCK) 
                LEFT OUTER JOIN dbo.View_HFit_RewardGroup_Joined AS VHFRGJ WITH (NOLOCK) 
                    ON VHFRPJ.NodeID = VHFRGJ.NodeParentID
                LEFT OUTER JOIN dbo.View_HFit_RewardLevel_Joined AS VHFRLJ WITH (NOLOCK) 
                    ON VHFRGJ.NodeID = VHFRLJ.NodeParentID
                   AND VHFRLJ.DocumentCulture = 'en-us'
                LEFT OUTER JOIN dbo.HFit_LKP_RewardType AS HFLRT WITH (NOLOCK) 
                    ON VHFRLJ.AwardType = HFLRT.RewardTypeLKPID
                LEFT OUTER JOIN dbo.HFit_LKP_RewardLevelType AS HFLRLT WITH (NOLOCK) 
                    ON vhfrlj.LevelType = HFLRLT.RewardLevelTypeLKPID
                INNER JOIN dbo.HFit_RewardsUserLevelDetail AS HFRULD WITH (NOLOCK) 
                    ON VHFRLJ.NodeID = HFRULD.LevelNodeID
                INNER JOIN dbo.CMS_User AS CU WITH (NOLOCK) 
                    ON hfruld.UserID = cu.UserID
                INNER JOIN dbo.CMS_UserSite AS CUS WITH (NOLOCK) 
                    ON CU.UserID = CUS.UserID
                INNER JOIN dbo.CMS_Site AS CS2 WITH (NOLOCK) 
                    ON CUS.SiteID = CS2.SiteID
                INNER JOIN dbo.HFit_Account AS HFA WITH (NOLOCK) 
                    ON cs2.SiteID = HFA.SiteID
                INNER JOIN dbo.CMS_UserSettings AS CUS2 WITH (NOLOCK) 
                    ON cu.UserID = cus2.UserSettingsUserID
                LEFT OUTER JOIN dbo.View_HFit_RewardActivity_Joined AS VHFRAJ WITH (NOLOCK) 
                    ON VHFRLJ.NodeID = VHFRAJ.NodeParentID
                   AND VHFRAJ.DocumentCulture = 'en-us'
                LEFT OUTER JOIN HFit_LKP_RewardActivity AS LKPRA
                    ON LKPRA.RewardActivityLKPID = VHFRAJ.RewardActivityLKPID
                INNER JOIN dbo.HFit_RewardsUserActivityDetail AS HFRUAD WITH (NOLOCK) 
                    ON VHFRAJ.NodeID = HFRUAD.ActivityNodeID
                   AND cu.UserID = HFRUAD.userid
                LEFT OUTER JOIN dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ WITH (NOLOCK) 
                    ON VHFRAJ.NodeID = VHFRTJ.NodeParentID
                   AND VHFRTJ.DocumentCulture = 'en-us'
                LEFT OUTER JOIN dbo.HFit_LKP_RewardTrigger AS HFLRT2 WITH (NOLOCK) 
                    ON VHFRTJ.RewardTriggerLKPID = HFLRT2.RewardTriggerLKPID
                LEFT OUTER JOIN dbo.HFit_RewardException AS HFRE WITH (NOLOCK) 
                    ON HFRE.RewardActivityID = VHFRAJ.RewardActivityID
                   AND HFRE.UserID = cu.UserID
  WHERE VHFRPJ.DocumentCulture = 'en-us'
    AND VHFRGJ.DocumentCulture = 'en-us';

GO
PRINT 'Completed : view_EDW_RewardUserDetail ';
GO

/*
(WDM) Kept only these coulmns IAW CR-51005
UserGUID
SiteGUID 
HFitUserMPINumber
RewardActivityGUID
RewardProgramName
RewardModifiedDate
RewardGroupGUID
RewardLevelModifiedDate
LevelCompletedDt
ActivityPointsEarned
ActivityCompletedDt
RewardActivityModifiedDate
ActivityPoints
UserAccepted
UserExceptionAppliedTo
RewardTriggerGUID
AccountID
AccountCD 
ChangeType
RewardExceptionModifiedDate
*/

PRINT '***** FROM: view_EDW_RewardUserDetail.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;






GO
PRINT '***** FROM: view_EDW_RewardsDefinition.sql';
GO 
PRINT 'Processing: view_EDW_RewardsDefinition:';
GO
IF EXISTS (SELECT
				  NAME
				  FROM sys.VIEWS
				  WHERE NAME = 'view_EDW_RewardsDefinition') 
	BEGIN
		DROP VIEW
			 view_EDW_RewardsDefinition;
	END;
GO

--GRANT SELECT
--	ON [dbo].[view_EDW_RewardsDefinition]
--	TO [EDWReader_PRD]
--GO

CREATE VIEW dbo.view_EDW_RewardsDefinition
AS

--****************************************************************************************************************************************************
--WDM Reviewed 8/6/2014 for needed updates, may be needed
--	My question - Is NodeGUID going to be passed onto the children
--8/7/2014 - added and commented out DocumentGuid in case needed later
--8/8/2014 - Generated corrected view in DEV (WDM)
--8/19/2014 - (WDM) Added where clause to make the query return english data only.	
--09.11.2014 : Added to facilitate EDW Last Mod Date determination and added language filters
--11.14.2014 : Found that this view was in PRod Staging and not in Prod.
--11.17.2014 : John C. found that Spanish was coming across. This was due to the view
--				View_HFit_RewardProgram_Joined not having the capability to FITER at the 
--				Document Culture level. Created a view, View_EDW_RewardProgram_Joined, that
--				used View_HFit_RewardProgram_Joined and added the capability to fiter languages.
--12.31.2014 (WDM) added left outer join HFit_LKP_RewardActivity AND VHFRAJ.RewardActivityLKPName to the view reference CR-47520
--01.01.2014 (WDM) tested changes for CR-47520
--02.16.2015 (WDM) Requested by John C. added as all required is a reference to the name
--		    ,[LevelName]
--			,[LevelHeader]
--		    ,[GroupHeadingText]
--		    ,[GroupHeadingDescription]
-- 03.03.2015 (WDM/NJ) added VHFRPJ.NodeGuid as RewardProgramGUID, RewardGroupGuid, RewardLevelGuid, VHFRAJ.RewardActivityGuid, VHFRAJ.RewardActivityLKPGuid
--			RewardTriggerGuid, VHFRTPJ.NodeGuid,LKPRTP.ItemGuid as OperatorGUID, RewardTriggerGuid
-- 03.03.2015 (WDM/NJ) added new joined table LKPRTP
-- 
--****************************************************************************************************************************************************
--select * from information_schema.columns where column_name = 'RewardProgramGuid' 
--select top 100 * from View_EDW_RewardProgram_Joined 

SELECT DISTINCT
	   cs.SiteGUID
	 , HFA.AccountID
	 , hfa.AccountCD
	 --, RewardProgramID
	 , VHFRPJ.NodeGuid AS             RewardProgramGUID --(WDM/NJ) added 03.03.2015     
	 , RewardProgramName
	 , RewardProgramPeriodStart
	 , RewardProgramPeriodEnd
	 --, ProgramDescription
	 --, RewardGroupID
	 , VHFRGJ.NodeGuid AS             RewardGroupGuid --(WDM/NJ) added 03.03.2015     
	 , GroupName
	 --, RewardContactGroups
	 --, RewardGroupPeriodStart
	 --, RewardGroupPeriodEnd
	 --, RewardLevelID
	 , VHFRLJ.NodeGuid AS             RewardLevelGuid --(WDM/NJ) added 03.03.2015     
	 , Level
	 , RewardLevelTypeLKPName
	 --, RewardLevelPeriodStart
	 --, RewardLevelPeriodEnd
	 --, FrequencyMenu
	 , AwardDisplayName
	 , AwardType
	 , AwardThreshold1
	 , AwardThreshold2
	 , AwardThreshold3
	 , AwardThreshold4
	 , AwardValue1
	 , AwardValue2
	 , AwardValue3
	 , AwardValue4
	 --, CompletionText
	 , ExternalFulfillmentRequired
	 --, RewardHistoryDetailDescription
	 --, VHFRAJ.RewardActivityID
	 , VHFRAJ.NodeGuid AS             RewardActivityGuid --(WDM/NJ) added 03.03.2015     
	 , VHFRAJ.ActivityName
	 , VHFRAJ.ActivityFreqOrCrit
	 --, VHFRAJ.RewardActivityPeriodStart
	 --, VHFRAJ.RewardActivityPeriodEnd
	 --, VHFRAJ.RewardActivityLKPID
	 --, LKPRA.ItemGuid AS              RewardActivityLKPGuid --(WDM/NJ) added 03.03.2015     
	 --, LKPRA.RewardActivityLKPName
	 , VHFRAJ.ActivityPoints
	 , VHFRAJ.IsBundle
	 , VHFRAJ.IsRequired
	 , VHFRAJ.MaxThreshold
	 , VHFRAJ.AwardPointsIncrementally
	 , VHFRAJ.AllowMedicalExceptions
	 --, VHFRAJ.BundleText
	 --, RewardTriggerID
	 , VHFRTJ.NodeGuid AS             RewardTriggerGuid --(WDM/NJ) added 03.03.2015     
	 , HFLRT.RewardTriggerDynamicValue
	 , TriggerName
	 --, RequirementDescription
	 --, LKPRTP.ItemGuid AS             OperatorGUID --(WDM/NJ) added 03.03.2015     
	 , VHFRTPJ.RewardTriggerParameterOperator
	 , VHFRTPJ.NodeGuid AS            RewardTriggerParmGUID --(WDM/NJ) added 03.03.2015     
	 , VHFRTPJ.Value
	 --, vhfrtpj.ParameterDisplayName
	 , CASE
		   WHEN CAST (VHFRPJ.DocumentCreatedWhen AS date) = CAST (VHFRPJ.DocumentModifiedWhen AS date) 
		   THEN 'I'
		   ELSE 'U'
	   END AS                         ChangeType
	 --, VHFRPJ.DocumentGuid --WDM Added 8/7/2014 in case needed
	 --, VHFRPJ.DocumentCreatedWhen
	 --, VHFRPJ.DocumentModifiedWhen
	 --, VHFRAJ.DocumentModifiedWhen AS RewardActivity_DocumentModifiedWhen --09.11.2014 : Added to facilitate EDW Last Mod Date determination
	 , VHFRAJ.DocumentCulture AS      DocumentCulture_VHFRAJ
	 , VHFRPJ.DocumentCulture AS      DocumentCulture_VHFRPJ
	 , VHFRGJ.DocumentCulture AS      DocumentCulture_VHFRGJ
	 , VHFRLJ.DocumentCulture AS      DocumentCulture_VHFRLJ
	 , VHFRTPJ.DocumentCulture AS     DocumentCulture_VHFRTPJ
	 , LevelName
	 --, LevelHeader
	 --, GroupHeadingText
	 --, GroupHeadingDescription
	   FROM dbo.View_EDW_RewardProgram_Joined AS VHFRPJ
				INNER JOIN dbo.View_HFit_RewardGroup_Joined AS VHFRGJ
					ON VHFRPJ.NodeID = VHFRGJ.NodeParentID
				   AND VHFRPJ.DocumentCulture = 'en-US'
				   AND VHFRGJ.DocumentCulture = 'en-US'
				 INNER JOIN dbo.View_HFit_RewardLevel_Joined AS VHFRLJ
					ON VHFRGJ.NodeID = VHFRLJ.NodeParentID
				   AND VHFRLJ.DocumentCulture = 'en-US'
				 INNER JOIN dbo.HFit_LKP_RewardLevelType AS HFLRLT
					ON VHFRLJ.LevelType = HFLRLT.RewardLevelTypeLKPID
				 INNER JOIN dbo.View_HFit_RewardActivity_Joined AS VHFRAJ
					ON VHFRLJ.NodeID = VHFRAJ.NodeParentID
				   AND VHFRAJ.DocumentCulture = 'en-US'
				 LEFT OUTER JOIN HFit_LKP_RewardActivity AS LKPRA
					ON LKPRA.RewardActivityLKPID = VHFRAJ.RewardActivityLKPID   --Added 1.2.2015 for SR-47520
				 INNER JOIN dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ
					ON VHFRAJ.NodeID = VHFRTJ.NodeParentID
				   AND VHFRTJ.DocumentCulture = 'en-US'
				 INNER JOIN dbo.View_HFit_RewardTriggerParameter_Joined AS VHFRTPJ
					ON vhfrtj.nodeid = vhfrtpj.nodeparentid
				   AND VHFRTPJ.DocumentCulture = 'en-US'
				 INNER JOIN dbo.HFit_LKP_RewardTrigger AS HFLRT
					ON VHFRTJ.RewardTriggerLKPID = HFLRT.RewardTriggerLKPID
				 INNER JOIN dbo.CMS_Site AS CS
					ON VHFRPJ.NodeSiteID = cs.SiteID
				 INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				 INNER JOIN HFit_LKP_RewardTriggerParameterOperator AS LKPRTP
					ON LKPRTP.RewardTriggerParameterOperatorLKPID = VHFRTPJ.RewardTriggerParameterOperator;
GO
PRINT 'Processed: view_EDW_RewardsDefinition ';
GO
/*
(WDM) Kept only these coulmns IAW CR-51005
SiteGUID 
AccountID
AccountCD 
RewardProgramGUID
RewardProgramName
RewardProgramPeriodStart
RewardProgramPeriodEnd
RewardGroupGUID
GroupName
RewardLevelGUID
Level
RewardLevelTypeLKPName
AwardDisplayName
AwardType
AwardThreshold1
AwardThreshold2
AwardThreshold3
AwardThreshold4
AwardValue1
AwardValue2
AwardValue3
AwardValue4
ExternalFulfillmentRequired
RewardActivityGUID
RewardActivityName	--VHFRAJ.ActivityName
ActivityFreqOrCrit
ActivityPoints
IsBundle
IsRequired
MaxThreshold
AwardPointsIncrementally
AllowMedicalExceptions
RewardTriggerGUID
RewardTriggerDynamicValue
TriggerName
RewardTriggerParameterOperator
RewardTriggerParameterGUID  --RewardTriggerParmGUID
Value
ChangeType
DocumentCulture_VHFRAJ
DocumentCulture_VHFRPJ
DocumentCulture_VHFRGJ
DocumentCulture_
DocumentCulture_VHFRTPJ
LevelName
*/
GO
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





PRINT 'Processing: view_EDW_TrackerCompositeDetails ';
GO
--select * from view_EDW_TrackerCompositeDetails
IF EXISTS (SELECT TABLE_NAME
			 FROM INFORMATION_SCHEMA.VIEWS
			 WHERE TABLE_NAME = 'view_EDW_TrackerCompositeDetails') 
	BEGIN
		DROP VIEW view_EDW_TrackerCompositeDetails;
	END;
GO

CREATE VIEW dbo.view_EDW_TrackerCompositeDetails
AS
	--************************************************************************************************************************************
	-- NOTES:
	--************************************************************************************************************************************
	 --WDM 6/26/2014
	 --This view is needed by EDW in order to process the Tracker tables' data.
	 --As of now, the Tracker tables are representative of objects and that would cause 
	 --	large volumes of ETL to be devloped and maintained. 
	 --This view represents a columnar representation of all tracker tables in a Key/Value pair representation.
	 --Each tracker table to be processed into the EDW must be represented in this view.
	 --ALL new tracker tables need only be entered once using the structure contained within this view
	 --	and the same EDW ETL should be able to process it.
	 --If there is a change to the strucuture of any one query in this view, then all have to be modified 
	 --	to be support the change.
	 --Column TrackerNameAggregratetable (AggregateTableName) will be NULL if the Tracker is not a member 
	 --		of the DISPLAYED Trackers. This allows us to capture all trackers, displayed or not.

	 --7/29/2014
	 --ISSUE: HFit_TrackerBMI,  HFit_TrackerCholesterol, and HFit_TrackerHeight are not in the HFIT_Tracker
	 --		table. This causes T.IsAvailable, T.IsCustom, T.UniqueName to be NULL. 
	 --		This raises the need for the Tracker Definition Table.

	 --NOTE: It is a goal to keep this view using BASE tables in order to gain max performance. Nested views will 
	 --		be avoided here if possible.

	 --**************** SPECIFIC TRACKER DATA **********************
	 --**************** on 7/29/2014          **********************
	 --Tracker GUID or Unique ID across all DB Instances (ItemGuid)
	 --Tracker NodeID (we use it for the External ID for Audit and error Triage)  (John: can use ItemID in this case)
	 --Tracker Table Name or Value Group Name (e.g. Body Measurements) - Categorization (TrackerNameAggregateTable)
	 --Tracker Column Unique Name ( In English)  Must be consistent across all DB Instances  ([UniqueName] will be 
	 --		the TABLE NAME if tracker name not found in the HFIT_Tracker table)
	 --Tracker Column Description (In English) (???)
	 --Tracker Column Data Type (e.g. Character, Numeric, Date, Bit or Yes/No)  so that we can set up the answer type
	 --	NULLS accepted for No Answer?	(KEY1, KEY2, VAL1, VAL2, etc)
	 --Tracker Active flag (IsAvailable will be null if tracker name not found in the HFIT_Tracker table)
	 --Tracker Unit of Measure (character) (Currently, the UOM is supplied in the view based on the table and type of Tracker)
	 --Tracker Insert Date ([ItemCreatedWhen])
	 --Tracker Last Update Date ([ItemModifiedWhen])
	 --NOTE: Convert all numerics to floats 7/30/2104 John/Dale
	 --****************************************************************************************************************************
	 -- 12.23.2014 - Added the Vendor ID and Vendor name to the view via the HFit_LKP_TrackerVendor table
	 -- 12.25.2014 - Tested the view to see that it returned the correct VendorID description
	 --****************************************************************************************************************************
	-- NEW ADDITIONS: 02.01.2015	Need for the updates to be completed and then we add.
	--HFit_TrackerTobaccoAttestation
	--HFit_TrackerPreventiveCare
	--HFit_TrackerCotinine
--****************************************************************************************************************************
	 --USE:
	 --select * from view_EDW_TrackerCompositeDetails where EventDate between '2013-11-01 15:02:00.000' and '2013-12-01 15:02:00.000'

	 --Set statistics IO ON
	 --GO

	 SELECT 'HFit_TrackerBloodPressure' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'mm/Hg' AS UOM ,
			'Systolic' AS KEY1 ,
			CAST (Systolic AS float) AS VAL1 ,
			'Diastolic' AS KEY2 ,
			CAST (Diastolic AS float) AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			ISNULL (T.UniqueName , 'bp') AS UniqueName ,
			ISNULL (T.UniqueName , 'bp') AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerBloodPressure AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerBloodPressure'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerBloodSugarAndGlucose' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'mmol/L' AS UOM ,
			'Units' AS KEY1 ,
			CAST (Units AS float) AS VAL1 ,
			'FastingState' AS KEY2 ,
			CAST (FastingState AS float) AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			ISNULL (T.UniqueName , 'glucose') AS UniqueName ,
			ISNULL (T.UniqueName , 'glucose') AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerBloodSugarAndGlucose AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerBloodSugarAndGlucose'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerBMI' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'kg/m2' AS UOM ,
			'BMI' AS KEY1 ,
			CAST (BMI AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			0 AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			TT.ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			ISNULL (T.UniqueName , 'HFit_TrackerBMI') AS UniqueName ,
			ISNULL (T.UniqueName , 'HFit_TrackerBMI') AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerBMI AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerBMI'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerBodyFat' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'PCT' AS UOM ,
			'Value' AS KEY1 ,
			CAST ([Value] AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			0 AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			ISNULL (T.UniqueName , 'HFit_TrackerBodyFat') AS UniqueName ,
			ISNULL (T.UniqueName , 'HFit_TrackerBodyFat') AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerBodyFat AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerBodyFat'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 --******************************************************************************
	 SELECT 'HFit_TrackerBodyMeasurements' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Inch' AS UOM ,
			'WaistInches' AS KEY1 ,
			CAST (WaistInches AS float) AS VAL1 ,
			'HipInches' AS KEY2 ,
			CAST (HipInches AS float) AS VAL2 ,
			'ThighInches' AS KEY3 ,
			CAST (ThighInches AS float) AS VAL3 ,
			'ArmInches' AS KEY4 ,
			CAST (ArmInches AS float) AS VAL4 ,
			'ChestInches' AS KEY5 ,
			CAST (ChestInches AS float) AS VAL5 ,
			'CalfInches' AS KEY6 ,
			CAST (CalfInches AS float) AS VAL6 ,
			'NeckInches' AS KEY7 ,
			CAST (NeckInches AS float) AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerBodyMeasurements AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerBodyMeasurements'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 --******************************************************************************
	 UNION ALL
	 SELECT 'HFit_TrackerCardio' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA' AS UOM ,
			'Minutes' AS KEY1 ,
			CAST (Minutes AS float) AS VAL1 ,
			'Distance' AS KEY2 ,
			CAST (Distance AS float) AS VAL2 ,
			'DistanceUnit' AS KEY3 ,
			CAST (DistanceUnit AS float) AS VAL3 ,
			'Intensity' AS KEY4 ,
			CAST (Intensity AS float) AS VAL4 ,
			'ActivityID' AS KEY5 ,
			CAST (ActivityID AS float) AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerCardio AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerCardio'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerCholesterol' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'mg/dL' AS UOM ,
			'HDL' AS KEY1 ,
			CAST (HDL AS float) AS VAL1 ,
			'LDL' AS KEY2 ,
			CAST (LDL AS float) AS VAL2 ,
			'Total' AS KEY3 ,
			CAST (Total AS float) AS VAL3 ,
			'Tri' AS KEY4 ,
			CAST (Tri AS float) AS VAL4 ,
			'Ratio' AS KEY5 ,
			CAST (Ratio AS float) AS VAL5 ,
			'Fasting' AS KEY6 ,
			CAST (Fasting AS float) AS VAL6 ,
			'VLDL' AS VLDL ,
			CAST (VLDL AS float) AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			ISNULL (T.UniqueName , 'HFit_TrackerCholesterol') AS UniqueName ,
			ISNULL (T.UniqueName , 'HFit_TrackerCholesterol') AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerCholesterol AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerCholesterol'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerDailySteps' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Step' AS UOM ,
			'Steps' AS KEY1 ,
			CAST (Steps AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			ISNULL (T.UniqueName , 'HFit_TrackerDailySteps') AS UniqueName ,
			ISNULL (T.UniqueName , 'HFit_TrackerDailySteps') AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerDailySteps AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerDailySteps'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerFlexibility' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Y/N' AS UOM ,
			'HasStretched' AS KEY1 ,
			CAST (HasStretched AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'Activity' AS TXTKEY1 ,
			Activity AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerFlexibility AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerFlexibility'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerFruits' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'CUP(8oz)' AS UOM ,
			'Cups' AS KEY1 ,
			CAST (Cups AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerFruits AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerFruits'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerHbA1c' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'mmol/mol' AS UOM ,
			'Value' AS KEY1 ,
			CAST ([Value] AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerHbA1c AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerHbA1c'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerHeight' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'inch' AS UOM ,
			'Height' AS KEY1 ,
			Height AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			TT.ItemOrder ,
			TT.ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			ISNULL (T.UniqueName , 'HFit_TrackerHeight') AS UniqueName ,
			ISNULL (T.UniqueName , 'HFit_TrackerHeight') AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerHeight AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerHeight'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerHighFatFoods' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Occurs' AS UOM ,
			'Times' AS KEY1 ,
			CAST (Times AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerHighFatFoods AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerHighFatFoods'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerHighSodiumFoods' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Occurs' AS UOM ,
			'Times' AS KEY1 ,
			CAST (Times AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerHighSodiumFoods AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerHighSodiumFoods'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerInstance_Tracker' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Y/N' AS UOM ,
			'TrackerDefID' AS KEY1 ,
			CAST (TrackerDefID AS float) AS VAL1 ,
			'YesNoValue' AS KEY2 ,
			CAST (YesNoValue AS float) AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerInstance_Tracker AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerInstance_Tracker'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerMealPortions' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA-portion' AS UOM ,
			'Portions' AS KEY1 ,
			CAST (Portions AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerMealPortions AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerMealPortions'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerMedicalCarePlan' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Y/N' AS UOM ,
			'FollowedPlan' AS KEY1 ,
			CAST (FollowedPlan AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerMedicalCarePlan AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerMedicalCarePlan'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerRegularMeals' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Occurs' AS UOM ,
			'Units' AS KEY1 ,
			CAST (Units AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerRegularMeals AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerRegularMeals'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerRestingHeartRate' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'BPM' AS UOM ,
			'HeartRate' AS KEY1 ,
			CAST (HeartRate AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerRestingHeartRate AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerRestingHeartRate'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerShots' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Y/N' AS UOM ,
			'FluShot' AS KEY1 ,
			CAST (FluShot AS float) AS VAL1 ,
			'PneumoniaShot' AS KEY2 ,
			CAST (PneumoniaShot AS float) AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			TT.ItemOrder ,
			TT.ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerShots AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerShots'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerSitLess' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Occurs' AS UOM ,
			'Times' AS KEY1 ,
			CAST (Times AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerSitLess AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerSitLess'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerSleepPlan' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'HR' AS UOM ,
			'DidFollow' AS KEY1 ,
			CAST (DidFollow AS float) AS VAL1 ,
			'HoursSlept' AS KEY2 ,
			HoursSlept AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'Techniques' AS TXTKEY1 ,
			Techniques AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerSleepPlan AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerSleepPlan'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerStrength' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Y/N' AS UOM ,
			'HasTrained' AS KEY1 ,
			CAST (HasTrained AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'Activity' AS TXTKEY1 ,
			Activity AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerStrength AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerStrength'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerStress' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'gradient' AS UOM ,
			'Intensity' AS KEY1 ,
			CAST (Intensity AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'Awareness' AS TXTKEY1 ,
			Awareness AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerStress AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerStress'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerStressManagement' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'gradient' AS UOM ,
			'HasPracticed' AS KEY1 ,
			CAST (HasPracticed AS float) AS VAL1 ,
			'Effectiveness' AS KEY2 ,
			CAST (Effectiveness AS float) AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'Activity' AS TXTKEY1 ,
			Activity AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerStressManagement AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerStressManagement'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerSugaryDrinks' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'OZ' AS UOM ,
			'Ounces' AS KEY1 ,
			CAST (Ounces AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerSugaryDrinks AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerSugaryDrinks'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerSugaryFoods' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA-portion' AS UOM ,
			'Portions' AS KEY1 ,
			CAST (Portions AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerSugaryFoods AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerSugaryFoods'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerTests' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA' AS UOM ,
			'PSATest' AS KEY1 ,
			CAST (PSATest AS float) AS VAL1 ,
			'OtherExam' AS KEY1 ,
			CAST (OtherExam AS float) AS VAL2 ,
			'TScore' AS KEY3 ,
			CAST (TScore AS float) AS VAL3 ,
			'DRA' AS KEY4 ,
			CAST (DRA AS float) AS VAL4 ,
			'CotinineTest' AS KEY5 ,
			CAST (CotinineTest AS float) AS VAL5 ,
			'ColoCareKit' AS KEY6 ,
			CAST (ColoCareKit AS float) AS VAL6 ,
			'CustomTest' AS KEY7 ,
			CAST (CustomTest AS float) AS VAL7 ,
			'TSH' AS KEY8 ,
			CAST (TSH AS float) AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'CustomDesc' AS TXTKEY1 ,
			CustomDesc AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			TT.ItemOrder ,
			TT.ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerTests AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerTests'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerTobaccoFree' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'Y/N' AS UOM ,
			'WasTobaccoFree' AS KEY1 ,
			CAST (WasTobaccoFree AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'QuitAids' AS TXTKEY1 ,
			QuitAids AS TXTVAL1 ,
			'QuitMeds' AS TXTKEY2 ,
			QuitMeds AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerTobaccoFree AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerTobaccoFree'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerVegetables' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'CUP(8oz)' AS UOM ,
			'Cups' AS KEY1 ,
			CAST (Cups AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerVegetables AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerVegetables'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerWater' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'OZ' AS UOM ,
			'Ounces' AS KEY1 ,
			CAST (Ounces AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerWater AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerWater'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerWeight' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'LBS' AS UOM ,
			'Value' AS KEY1 ,
			[Value] AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerWeight AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerWeight'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerWholeGrains' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			CollectionSourceName_Internal ,
			CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA-serving' AS UOM ,
			'Servings' AS KEY1 ,
			CAST (Servings AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			NULL AS VendorID	--VENDOR.ItemID as VendorID
			,
			NULL AS VendorName --VENDOR.VendorName
	   FROM dbo.HFit_TrackerWholeGrains AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerWholeGrains'
	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerShots' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			NULL AS CollectionSourceName_Internal ,
			NULL AS CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA' AS UOM ,
			'FluShot' AS KEY1 ,
			CAST (FluShot AS float) AS VAL1 ,
			'PneumoniaShot' AS KEY2 ,
			CAST (PneumoniaShot AS float) AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerShots AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerShots'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION ALL
	 SELECT 'HFit_TrackerTests' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			NULL AS CollectionSourceName_Internal ,
			NULL AS CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA' AS UOM ,
			'PSATest' AS KEY1 ,
			CAST (PSATest AS float) AS VAL1 ,
			'OtherExam' AS KEY2 ,
			CAST (OtherExam AS float) AS VAL2 ,
			'TScore' AS KEY3 ,
			CAST (TScore AS float) AS VAL3 ,
			'DRA' AS KEY4 ,
			CAST (DRA AS float) AS VAL4 ,
			'CotinineTest' AS KEY5 ,
			CAST (CotinineTest AS float) AS VAL5 ,
			'ColoCareKit' AS KEY6 ,
			CAST (ColoCareKit AS float) AS VAL6 ,
			'CustomTest' AS KEY7 ,
			CAST (CustomTest AS float) AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			NULL AS IsProcessedForHa ,
			'CustomDesc' AS TXTKEY1 ,
			CustomDesc AS TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			VENDOR.ItemID AS VendorID ,
			VENDOR.VendorName
	   FROM dbo.HFit_TrackerTests AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerTests'
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
 UNION ALL
 	 SELECT 'HFit_TrackerCotinine' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			NULL AS CollectionSourceName_Internal ,
			NULL AS CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA' AS UOM ,
			'NicotineAssessment' AS KEY1 ,
			CAST (NicotineAssessment AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL as TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			--VENDOR.ItemID AS VendorID ,
			--VENDOR.VendorName,
			NULL AS VendorID,
			NULL AS VendorName
	   FROM dbo.HFit_TrackerCotinine AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerTests'
				--LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
				--	ON TT.VendorID = VENDOR.ItemID;

UNION ALL
 	 SELECT 'HFit_TrackerPreventiveCare' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			NULL AS CollectionSourceName_Internal ,
			NULL AS CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA' AS UOM ,
			'PreventiveCare' AS KEY1 ,
			CAST (PreventiveCare AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL as TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			--VENDOR.ItemID AS VendorID ,
			--VENDOR.VendorName,
			NULL AS VendorID,
			NULL AS VendorName
	   FROM dbo.HFit_TrackerPreventiveCare AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerTests'
				--LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
				--	ON TT.VendorID = VENDOR.ItemID;
UNION ALL
 	 SELECT 'HFit_TrackerTobaccoAttestation' AS TrackerNameAggregateTable ,
			TT.ItemID ,
			EventDate ,
			TT.IsProfessionallyCollected ,
			TT.TrackerCollectionSourceID ,
			Notes ,
			TT.UserID ,
			NULL AS CollectionSourceName_Internal ,
			NULL AS CollectionSourceName_External ,
			'MISSING' AS EventName ,
			'NA' AS UOM ,
			'TobaccoAttestation' AS KEY1 ,
			CAST (TobaccoAttestation AS float) AS VAL1 ,
			'NA' AS KEY2 ,
			NULL AS VAL2 ,
			'NA' AS KEY3 ,
			NULL AS VAL3 ,
			'NA' AS KEY4 ,
			NULL AS VAL4 ,
			'NA' AS KEY5 ,
			NULL AS VAL5 ,
			'NA' AS KEY6 ,
			NULL AS VAL6 ,
			'NA' AS KEY7 ,
			NULL AS VAL7 ,
			'NA' AS KEY8 ,
			NULL AS VAL8 ,
			'NA' AS KEY9 ,
			NULL AS VAL9 ,
			'NA' AS KEY10 ,
			NULL AS VAL10 ,
			TT.ItemCreatedBy ,
			TT.ItemCreatedWhen ,
			TT.ItemModifiedBy ,
			TT.ItemModifiedWhen ,
			IsProcessedForHa ,
			'NA' AS TXTKEY1 ,
			NULL as TXTVAL1 ,
			'NA' AS TXTKEY2 ,
			NULL AS TXTVAL2 ,
			'NA' AS TXTKEY3 ,
			NULL AS TXTVAL3 ,
			NULL AS ItemOrder ,
			NULL AS ItemGuid ,
			C.UserGuid ,
			PP.MPI ,
			PP.ClientCode ,
			S.SiteGUID ,
			ACCT.AccountID ,
			ACCT.AccountCD ,
			T.IsAvailable ,
			T.IsCustom ,
			T.UniqueName ,
			T.UniqueName AS ColDesc ,
			--VENDOR.ItemID AS VendorID ,
			--VENDOR.VendorName,
			NULL AS VendorID,
			NULL AS VendorName
	   FROM dbo.HFit_TrackerTobaccoAttestation AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = 'HFit_TrackerTests'
				--LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
				--	ON TT.VendorID = VENDOR.ItemID;



GO

--  
--  
GO
PRINT '***** FROM: view_EDW_TrackerCompositeDetails.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





print ('Creating View_EDW_RewardProgram_Joined: ' +  cast(getdate() as nvarchar(50)));
go
if exists (select name from sys.views where name = 'View_EDW_RewardProgram_Joined')
BEGIN
	print ('Re-creating View_EDW_RewardProgram_Joined' +  cast(getdate() as nvarchar(50)));
	drop view View_EDW_RewardProgram_Joined ;
END
go

--This view is created in place of View_Hfit_RewardProgram_Joined so that 
--Document Culture can be taken into consideration. 
CREATE VIEW [dbo].[View_EDW_RewardProgram_Joined] AS 

--03.03.2015 : Reviewed by NAthan and Dale, no change required.

SELECT View_CMS_Tree_Joined.*, HFit_RewardProgram.* 
	FROM View_CMS_Tree_Joined 
	INNER JOIN HFit_RewardProgram 
		ON View_CMS_Tree_Joined.DocumentForeignKeyValue = HFit_RewardProgram.[RewardProgramID] 
WHERE ClassName = 'HFit.RewardProgram'
AND View_CMS_Tree_Joined.documentculture = 'en-US'
GO

print ('Created View_EDW_RewardProgram_Joined: ' + cast(getdate() as nvarchar(50)));
go  --  
  --  
GO 
print('***** FROM: View_EDW_RewardProgram_Joined.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
print ('Processing: view_EDW_RewardTriggerParameters ') ;
go

if exists(select NAME from sys.VIEWS where NAME = 'view_EDW_RewardTriggerParameters')
BEGIN
	drop view view_EDW_RewardTriggerParameters ;
END
GO


--GRANT SELECT
--	ON [dbo].[view_EDW_RewardTriggerParameters]
--	TO [EDWReader_PRD]
--GO


--*******************************************************************************************************************
--8/7/2014  VHFRTJ.DocumentGuid		  --WDM Added in case needed
--8/7/2014  VHFRTJ.NodeGuid			  --WDM Added in case needed
--09.11.2014 : (wdm) Verified last mod date available to EDW - RewardTriggerParameter_DocumentModifiedWhen
--11.17.2014 : (wdm) John C. found that Spanish was being brought across in TriggerName and 
--				ParameterDisplayName. Found that View_HFit_RewardTrigger_Joined has no way to limit the 
--				returned data to Spanish. Created a new view, View_EDW_RewardProgram_Joined, and provided 
--				a FILTER on Document Culture. The, added Launguage fitlers as: 
--					where VHFRTJ.DocumentCulture = 'en-US' AND VHFRTPJ.DocumentCulture = 'en-US'
--				This appears to have eliminated the Spanish.
-- 03.03.2015 : (Dale/Natahn) no changes required.
-- 04.12.2015 : (WDM) In order to implement change tracking on this view, a STAGING table will simply be 
--			 dropped and recreated everytime using this view. It is too small to worry about otherwise.
--SELECT * FROM [view_EDW_RewardTriggerParameters]
--*******************************************************************************************************************
create VIEW [dbo].[view_EDW_RewardTriggerParameters]
AS
--8/7/2014 - added and commented out DocumentGuid and NodeGuid in case needed later
--8/8/2014 - Generated corrected view in DEV (WDM)
	SELECT distinct
		cs.SiteGUID															 --CMS_Site
		, VHFRTJ.RewardTriggerID													 --HFit_RewardTrigger
		, VHFRTJ.TriggerName													 --HFit_RewardTrigger
		, HFLRTPO.RewardTriggerParameterOperatorLKPDisplayName							 --HFit_LKP_RewardTriggerParameterOperator 
		, VHFRTPJ.ParameterDisplayName											 --HFit_RewardTriggerParameter
		, VHFRTPJ.RewardTriggerParameterOperator									 --HFit_RewardTriggerParameter
		, VHFRTPJ.Value														 --HFit_RewardTriggerParameter
		, hfa.AccountID														 --HFit_Account
		, hfa.AccountCD														 --HFit_Account
		, CASE	WHEN CAST(VHFRTJ.DocumentCreatedWhen AS DATE) = CAST(VHFRTJ.DocumentModifiedWhen AS DATE)
				THEN 'I'
				ELSE 'U'
			END AS ChangeType		
		, VHFRTJ.DocumentGuid													 --CMS_Document
		, VHFRTJ.NodeGuid														 --CMS_Document
		, VHFRTJ.DocumentCreatedWhen												 --CMS_Document
		, VHFRTJ.DocumentModifiedWhen												 --CMS_Document
		,VHFRTPJ.DocumentModifiedWhen as RewardTriggerParameter_DocumentModifiedWhen	  	 --CMS_Document
		,VHFRTPJ.documentculture as documentculture_VHFRTPJ							 --CMS_Document
		,VHFRTJ.documentculture as documentculture_VHFRTJ								 --CMS_Document
	FROM
		dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ 
		--dbo.[View_EDW_RewardProgram_Joined] AS VHFRTJ 		
	INNER JOIN dbo.View_HFit_RewardTriggerParameter_Joined AS VHFRTPJ  ON vhfrtj.NodeID = VHFRTPJ.NodeParentID
	INNER JOIN dbo.HFit_LKP_RewardTriggerParameterOperator AS HFLRTPO  ON VHFRTPJ.RewardTriggerParameterOperator = HFLRTPO.RewardTriggerParameterOperatorLKPID
	INNER JOIN dbo.CMS_Site AS CS  ON VHFRTJ.NodeSiteID = cs.SiteID
	INNER JOIN dbo.HFit_Account AS HFA  ON cs.SiteID = HFA.SiteID
	where VHFRTJ.DocumentCulture = 'en-US'
	AND VHFRTPJ.DocumentCulture = 'en-US'
      

GO


  --  
  --  
GO 
print('***** Created: view_EDW_RewardTriggerParameters.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Creating view view_EDW_RewardUserLevel';
GO

IF EXISTS (SELECT [name]
		   FROM [sys].[views]
		   WHERE [name] = 'view_EDW_RewardUserLevel') 
    BEGIN
	   DROP VIEW [view_EDW_RewardUserLevel];
    END;
GO

CREATE VIEW [view_EDW_RewardUserLevel]
AS

--***********************************************************************************************************
--Changes:
--01.20.2015 - (WDM) Added RL_Joined.nodeguid to satisfy #38393
--02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription, SiteGuid
--03.03.2015 : Reviewed by nathan and dale, no change required.
--04.17.2017 : WDM - found the Document Culture was not present and added it after talking with John C.
--***********************************************************************************************************

SELECT DISTINCT [us].[UserId]
		    , [dl].[LevelCompletedDt]
		    , [RL_Joined].[NodeName] AS [LevelName]
		    , [s].[SiteName]
		    , [RL_Joined].[nodeguid]
		    , [s].[SiteGuid]
		    , [RL_Joined].[LevelHeader]
		    , [RL_Joined].[GroupHeadingText]
		    , [RL_Joined].[GroupHeadingDescription]

  FROM
	  [HFit_RewardsUserLevelDetail] AS [dl]
		 INNER JOIN [View_HFit_RewardLevel_Joined] AS [RL_Joined]
			ON [RL_Joined].[NodeId] = [dl].[LevelNodeId]
				AND RL_Joined.DocumentCulture= 'EN-US'
		 JOIN [CMS_UserSite] AS [us]
			ON [us].[UserId] = [dl].[UserId]
		 JOIN [CMS_Site] AS [s]
			ON [s].[SiteId] = [us].[SiteId];

GO

PRINT 'Created view view_EDW_RewardUserLevel';
GO
--  
--  
GO
PRINT '***** FROM: view_EDW_RewardUserLevel.sql';
GO 

--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO
PRINT 'Processing: view_EDW_RewardAwardDetail ';
GO
IF EXISTS (SELECT
				  TABLE_NAME
				  FROM INFORMATION_SCHEMA.VIEWS
				  WHERE TABLE_NAME = 'view_EDW_RewardAwardDetail') 
	BEGIN
		DROP VIEW
			 view_EDW_RewardAwardDetail;
	END;
GO
CREATE VIEW dbo.view_EDW_RewardAwardDetail
AS

--*************************************************************************************************
--WDM Reviewed 8/6/2014 for needed updates, none required
--09.11.2014 : (wdm) reviewed for EDW last mod date and the view is OK as is
--11.19.2014 : added language to verify returned data
--02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription
--03.03.2015 : (dale/nathan) Added RewardLevelGUID
--03.19.2015 : by request of the EDW team, removed all columns not specificially requested
--			 and verified that was the request before initiating. The commented out columns
--			 were removed as a the solution to this request. 
--			 /*
--			 (WDM) Kept only these coulmns IAW CR-51005
--			 UserGUID
--			 SiteGUID 
--			 HFitUserMPINumber
--			 RewardLevelGUID
--			 RewardValue
--			 ThresholdNumber
--			 UserNotified
--			 IsFulfilled
--			 AccountID
--			 AccountCD
--			 ChangeType
--*/
--04.03.2015 : CR 51853 requested to put back columns that were previously removed. 
--			 AwardDisplayName and AwardType
--*************************************************************************************************

SELECT DISTINCT
	   cu.UserGUID
	 , cs.SiteGUID
	 , cus.HFitUserMpiNumber
	 --, RL_Joined.RewardLevelID
	 , RL_Joined.NodeGuid AS RewardLevelGUID
	   , RL_Joined.AwardType
	 , HFRAUD.AwardDisplayName
	 , HFRAUD.RewardValue
	 , HFRAUD.ThresholdNumber
	 , HFRAUD.UserNotified
	 , HFRAUD.IsFulfilled
	 , hfa.AccountID
	 , HFA.AccountCD
	 , CASE
		   WHEN CAST (HFRAUD.ItemCreatedWhen AS date) = CAST (HFRAUD.ItemModifiedWhen AS date) 
		   THEN 'I'
		   ELSE 'U'
	   END AS                ChangeType
	 --, HFRAUD.ItemCreatedWhen
	 --, HFRAUD.ItemModifiedWhen
	 --, RL_Joined.DocumentCulture 
	 --, HFRAUD.CultureCode
	 --, RL_Joined.LevelName
	 --, RL_Joined.LevelHeader
	 --, RL_Joined.GroupHeadingText
	 --, RL_Joined.GroupHeadingDescription
	   FROM dbo.HFit_RewardsAwardUserDetail AS HFRAUD
				INNER JOIN dbo.View_HFit_RewardLevel_Joined AS RL_Joined
					ON hfraud.RewardLevelNodeId = RL_Joined.NodeID
				   AND RL_Joined.DocumentCulture = 'en-US'
				   AND HFRAUD.CultureCode = 'en-US'
				 INNER JOIN dbo.CMS_User AS CU
					ON hfraud.UserId = cu.UserID
				 INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cu.UserID = cus2.UserID
				 INNER JOIN dbo.HFit_Account AS HFA
					ON cus2.SiteID = HFA.SiteID
				 INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				 INNER JOIN dbo.CMS_UserSettings AS CUS
					ON cu.UserID = cus.UserSettingsUserID;
GO
PRINT 'Processed: view_EDW_RewardAwardDetail ';


GO
PRINT '***** FROM: view_EDW_RewardAwardDetail.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;




PRINT 'Processing: Proc_EDW_TrackerMetadataExtract';
GO
IF EXISTS (SELECT
				  *
				  FROM sysobjects
				  WHERE name = 'Proc_EDW_TrackerMetadataExtract'
					AND Xtype = 'P') 
	BEGIN
		DROP PROCEDURE
			 Proc_EDW_TrackerMetadataExtract;
	END;
GO

--exec Proc_EDW_TrackerMetadataExtract 'HFit.TrackerWater'
--select * from #Temp_TrackerMetaData
--select * from Tracker_EDW_Metadata
--truncate table Tracker_EDW_Metadata

CREATE PROCEDURE dbo.Proc_EDW_TrackerMetadataExtract (
	   @TrackerClassName AS nvarchar (250)) 
AS
BEGIN
	IF EXISTS (SELECT
					  name
					  FROM tempdb.dbo.sysobjects
					  WHERE ID = OBJECT_ID (N'tempdb..#Temp_TrackerMetaData')) 
		BEGIN
			DROP TABLE
				 #Temp_TrackerMetaData;
		END;
	DECLARE @MetaDataLastLoadDate datetime;
	DECLARE @ClassLastModified datetime;
	DECLARE @Xml xml;
	DECLARE @docHandle int;
	DECLARE @form nvarchar (250) ;
	DECLARE @dbForm nvarchar (250) ;
	DECLARE @id int;
	DECLARE @parent int;
	DECLARE @nodetype int;
	DECLARE @localname nvarchar (250) ;
	DECLARE @prefix nvarchar (250) ;
	DECLARE @namespaceuri nvarchar (250) ;
	DECLARE @datatype nvarchar (250) ;
	DECLARE @prev nvarchar (250) ;
	DECLARE @dbText nvarchar (250) ;
	DECLARE @ParentName nvarchar (250) ;
	DECLARE @TableName nvarchar (100) ;
	DECLARE @ColName nvarchar (100) ;
	DECLARE @AttrName nvarchar (100) ;
	DECLARE @AttrVal nvarchar (250) ;
	DECLARE @CurrName nvarchar (250) ;
	DECLARE @SkipIfNoChange bit;

		--alter table [Tracker_EDW_Metadata] add ClassLastModified datetime null
	--drop table Tracker_EDW_Metadata; 
	IF NOT EXISTS (SELECT
						  name
						  FROM sysobjects
						  WHERE ID = OBJECT_ID (N'Tracker_EDW_Metadata')) 
		BEGIN
			CREATE TABLE dbo.Tracker_EDW_Metadata (
						 TableName nvarchar (100) NOT NULL
					   , ColName nvarchar (100) NOT NULL
					   , AttrName nvarchar (100) NOT NULL
					   , AttrVal nvarchar (250) NULL
					   , CreatedDate datetime2 (7) NULL
					   , LastModifiedDate datetime2 (7) NULL
					   , ID int IDENTITY (1, 1) 
								NOT NULL
					   , ClassLastModified datetime2 (7) NULL) ;
			ALTER TABLE dbo.Tracker_EDW_Metadata
			ADD
						CONSTRAINT DF_Tracker_EDW_Metadata_CreatedDate DEFAULT GETDATE () FOR CreatedDate;
			ALTER TABLE dbo.Tracker_EDW_Metadata
			ADD
						CONSTRAINT DF_Tracker_EDW_Metadata_LastModifiedDate DEFAULT GETDATE () FOR LastModifiedDate;
			CREATE UNIQUE CLUSTERED INDEX PK_Tracker_EDW_Metadata ON dbo.Tracker_EDW_Metadata (TableName ASC, ColName ASC, AttrName ASC) ;
		END;
	IF NOT EXISTS (SELECT
						  column_name
						  FROM information_schema.columns
						  WHERE column_name = 'ClassLastModified'
							AND table_name = 'Tracker_EDW_Metadata') 
		BEGIN
			PRINT 'MISSING: Tracker_EDW_Metadata ClassLastModified, added to table.';
			ALTER TABLE Tracker_EDW_Metadata
			ADD
						ClassLastModified datetime NULL;
		END;
	ELSE
		BEGIN
			PRINT 'FOUND: Tracker_EDW_Metadata ClassLastModified';
		END;

	SELECT
		   @form = @TrackerClassName;

	--select * from information_schema.columns where column_name = 'ClassLastModified'

	IF EXISTS (SELECT
					  column_name
					  FROM information_schema.columns
					  WHERE column_name = 'ClassLastModified'
						AND table_name = 'Tracker_EDW_Metadata') 
		BEGIN
			SELECT
				   @MetaDataLastLoadDate = (
											SELECT TOP 1
												   ClassLastModified
												   FROM Tracker_EDW_Metadata
												   WHERE TableName = @form) ;
			SELECT
				   @ClassLastModified = (
										 SELECT TOP 1
												ClassLastModified
												FROM CMS_CLASS
												WHERE ClassName = @form) ;
			SET @SkipIfNoChange = 1;
			IF @SkipIfNoChange = 1
				BEGIN
					IF @MetaDataLastLoadDate = @ClassLastModified
						BEGIN
							PRINT 'No Change in ' + @form + ', no updates needed.';
							RETURN;
						END;
					ELSE
						BEGIN
							PRINT 'Changes found in ' + @form + ', processing.';
						END;
				END;
			PRINT '@MetaDataLastLoadDate: ' + CAST (@MetaDataLastLoadDate AS varchar (50)) ;
			PRINT '@ClassLastModified: ' + CAST (@ClassLastModified AS varchar (50)) ;
		END;
	SELECT
		   @Xml = (
				   SELECT
						  ClassFormDefinition
						  FROM CMS_Class
						  WHERE ClassName LIKE @form) ;

	--print (cast( @Xml as varchar(max)));

	EXEC sp_xml_preparedocument @docHandle OUTPUT, @Xml;


	IF NOT EXISTS (SELECT
						  name
						  FROM tempdb.dbo.sysobjects
						  WHERE ID = OBJECT_ID (N'tempdb..#Temp_TrackerMetaData')) 
		BEGIN
			SELECT
				   @form AS form
				 , id
				 , parentid
				 , nodetype
				 , localname
				 , prefix
				 , namespaceuri
				 , datatype
				 , prev
				 , text INTO
							 #Temp_TrackerMetaData
				   FROM OPENXML (@docHandle, N'/form/field') AS XMLDATA;

			--WHERE localname not in ('isPK');		

			CREATE INDEX TMPPI_HealthAssesmentUserQuestion ON #Temp_TrackerMetaData (parentid) ;
			CREATE INDEX TMPPI2_HealthAssesmentUserQuestion ON #Temp_TrackerMetaData (id) ;
		END;
	ELSE
		BEGIN
			truncate TABLE #Temp_TrackerMetaData;
			INSERT INTO #Temp_TrackerMetaData
			SELECT
				   @form AS form
				 , id
				 , parentid
				 , nodetype
				 , localname
				 , prefix
				 , namespaceuri
				 , datatype
				 , prev
				 , text
				   FROM OPENXML (@docHandle, N'/form/field') AS XMLDATA;
		END;
	DELETE FROM Tracker_EDW_Metadata
	WHERE
		  TableName = @form;
	SET @ClassLastModified = (SELECT
									 ClassLastModified
									 FROM CMS_CLASS
									 WHERE ClassName = @Form) ;
	PRINT '@ClassLastModified: ' + CAST (@ClassLastModified AS varchar (250)) ;
	DECLARE C CURSOR
		FOR SELECT
				   @form AS form
				 , id
				 , parentid
				 , nodetype
				 , localname
				 , prefix
				 , namespaceuri
				 , datatype
				 , prev
				 , text
				   FROM #Temp_TrackerMetaData AS XMLDATA;
	OPEN C;
	FETCH NEXT FROM C INTO @dbForm, @id, @parent, @nodetype, @localname, @prefix, @namespaceuri, @datatype, @prev, @dbText;
	WHILE @@FETCH_STATUS = 0
		BEGIN

			--print ('* @localname :' + @localname) ;
			--print ('* @ColName :' + isnull(@ColName, 'XX') + ':') ;
			--print ('* @dbText :' + @dbText + ':') ;

			IF @localname = 'column'
				BEGIN

					--print ('** START COLUMN DEF: ') ;

					SET @ColName = (SELECT
										   text
										   FROM #Temp_TrackerMetaData
										   WHERE parentid = @id) ;

				--print ('** COLUMN DEF: ' + @form + ' : ' + @colname) ;

				END;
			IF @dbText IS NOT NULL
				BEGIN

					--print ('* ENTER @dbText :' + @dbText + ':' + cast(@parent as varchar(10))) ;

					SET @AttrName = (SELECT
											localname
											FROM #Temp_TrackerMetaData
											WHERE id = @parent) ;

					--set @ParentName = (select [localname] FROM OPENXML(@docHandle, N'/form/field') where id = @parent);	
					--print ('1 - @AttrName: ' + @form +' : ' + isnull(@ColName, 'NA') + ' : ' + @AttrName + ' : ' + @dbText) ;	

					IF EXISTS (SELECT
									  TableName
									  FROM Tracker_EDW_Metadata
									  WHERE Tablename = @form
										AND ColName = @ColName
										AND AttrName = @dbText) 
						BEGIN

							--print('Update Tracker_EDW_Metadata set AttrVal = ' + @dbText + ' Where Tablename = ' + @form + ' and ColName = ' + @ColName + ' and AttrName = ' + @AttrName + ';');

							UPDATE Tracker_EDW_Metadata
							SET
								AttrVal = @dbText
							  ,
								ClassLastModified = @ClassLastModified
							WHERE
								  Tablename = @form
							  AND ColName = @ColName
							  AND AttrName = @dbText;
						END;
					ELSE
						BEGIN

							--print ('insert into Tracker_EDW_Metadata (TableName, ColName, AttrName, AttrVal, ClassLastModified) values ('+@form+', '+@ColName+', '+@AttrName+', '+@dbText +', ' + cast(@ClassLastModified as varchar(50))+ ') ') ;

							INSERT INTO Tracker_EDW_Metadata (
										TableName
									  , ColName
									  , AttrName
									  , AttrVal
									  , ClassLastModified) 
							VALUES
								 (@form, @ColName, @AttrName, @dbText, @ClassLastModified) ;
							UPDATE Tracker_EDW_Metadata
							SET
								ClassLastModified = @ClassLastModified
							WHERE
								  Tablename = @form
							  AND ColName = @ColName
							  AND AttrName = @dbText;
						END;
				END;
			IF @localname = 'columntype'
		   AND @ColName IS NOT NULL
				BEGIN
					PRINT '---- COLUMN TYPE DEF: ' + @form + ' : ' + @colname + ' : ' + @dbText;
				END;
			IF @localname = 'field'
				BEGIN
					SET @ParentName = NULL;
					SET @ColName = NULL;

				--print ('***** field @ParentName: ' + @ParentName) ;

				END;
			FETCH NEXT FROM C INTO @dbForm, @id, @parent, @nodetype, @localname, @prefix, @namespaceuri, @datatype, @prev, @dbText;
		END;
	CLOSE C;
	DEALLOCATE C;
END;

--Clean up the EDW Tracker MetaData
--delete from Tracker_EDW_Metadata where colname in ('ItemID','ItemCreatedBy','ItemCreatedWhen','ItemModifiedBy','ItemModifiedWhen','EventDate','IsProfessionally Collected','TrackerCollectionSourceId','UserID','Notes','IsProcessedForHA');

GO
PRINT 'ProcessED and created : Proc_EDW_TrackerMetadataExtract';
GO
PRINT '***** FROM: Proc_EDW_TrackerMetadataExtract.sql';
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;






GO
PRINT 'Creating table HFit_LKP_GoalCloseReason for SR-47923 ';
GO

-- 01.02.2014 (WDM) added column HFUG.CloseReasonLKPID in order to satisfy Story #47923

IF EXISTS (SELECT name
			 FROM sys.tables
			 WHERE name = 'HFit_LKP_GoalCloseReason') 
	BEGIN
		PRINT 'Dropping table HFit_LKP_GoalCloseReason';
		DROP TABLE dbo.HFit_LKP_GoalCloseReason;
	END;
GO
CREATE TABLE dbo.HFit_LKP_GoalCloseReason (
	ItemID int IDENTITY (1, 1) NOT NULL, 
	CloseReasonID int NOT NULL, 
	CloseReason varchar (250) NOT NULL, 
	ItemCreatedBy int NULL, 
	ItemCreatedWhen datetime2 (7) NULL, 
	ItemModifiedBy int NULL, 
	ItemModifiedWhen datetime2 (7) NULL, 
	ItemOrder int NULL, 
	ItemGUID uniqueidentifier NOT NULL, 
	CONSTRAINT PK_HFit_LKP_GoalCloseReason PRIMARY KEY CLUSTERED (CloseReasonID ASC) 
		WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) 
		ON [PRIMARY]) 
ON [PRIMARY];
GO
SET ANSI_PADDING OFF;
GO
ALTER TABLE dbo.HFit_LKP_GoalCloseReason
ADD CONSTRAINT DEFAULT_HFit_LKP_GoalCloseReason_ItemGUID DEFAULT '00000000-0000-0000-0000-000000000000' FOR ItemGUID;
GO
IF NOT EXISTS (SELECT name
				 FROM sys.indexes
				 WHERE name = 'CI_HFit_LKP_GoalCloseReason') 
	BEGIN
		PRINT 'Creating index [CI_HFit_LKP_GoalCloseReason]';
		CREATE UNIQUE NONCLUSTERED INDEX CI_HFit_LKP_GoalCloseReason ON dbo.HFit_LKP_GoalCloseReason (CloseReasonID ASC) INCLUDE (CloseReason) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ;
	END;
GO
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (0, 'Not Set', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (1, 'Achieved Personal target', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (2, 'Change In Tx Plan', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (3, 'Setback', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (4, 'Not Interested', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (5, 'Not Eligible', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
INSERT INTO dbo.HFit_LKP_GoalCloseReason (CloseReasonID, CloseReason, ItemCreatedBy, ItemCreatedWhen, ItemModifiedBy, ItemModifiedWhen, ItemOrder, ItemGUID) 
VALUES
	   (6, 'Program Period End', -1, GETDATE () , -1, GETDATE () , 0, NEWID ()) ;
GO
--SELECT * FROM HFit_LKP_GoalCloseReason;
GO
PRINT 'Created HFit_LKP_GoalCloseReason';
GO--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





print('Processing: Tracker_EDW_Metadata');
go


--create proc CreateTracker_EDW_Metadata
--as
GO 
if exists(Select name from sys.tables where name = 'Tracker_EDW_Metadata')
BEGIN
	print ('MAY NEED TO DROP the Tracker_EDW_Metadata table');
	drop table Tracker_EDW_Metadata;
END
go
if not exists(Select name from sys.tables where name = 'Tracker_EDW_Metadata')
BEGIN
	print ('Creating the Tracker_EDW_Metadata table');
	CREATE TABLE [dbo].[Tracker_EDW_Metadata] (
			[TableName]             [nvarchar](100) NOT NULL,
			[ColName]               [nvarchar](100) NOT NULL,
			[AttrName]              [nvarchar](100) NOT NULL,
			[AttrVal]               [nvarchar](250) NULL,
			[CreatedDate]           [datetime2] (7) NULL,
			[LastModifiedDate]      [datetime2] (7) NULL,
			[ID]                    [int] IDENTITY(1, 1) NOT NULL,
			[ClassLastModified]     [datetime] NULL
	) ON [PRIMARY]

	ALTER TABLE [dbo].[Tracker_EDW_Metadata]
	ADD
	CONSTRAINT [DF_Tracker_EDW_Metadata_CreatedDate]
	DEFAULT (getdate()) FOR [CreatedDate]

	ALTER TABLE [dbo].[Tracker_EDW_Metadata]
		ADD
		CONSTRAINT [DF_Tracker_EDW_Metadata_LastModifiedDate]
		DEFAULT (getdate()) FOR [LastModifiedDate]

	CREATE UNIQUE CLUSTERED INDEX [PK_Tracker_EDW_Metadata]
		ON [dbo].[Tracker_EDW_Metadata] ([TableName], [ColName], [AttrName]) ON [PRIMARY]

	ALTER TABLE [dbo].[Tracker_EDW_Metadata] SET (LOCK_ESCALATION = TABLE)

END
GO

print ('Created the Tracker_EDW_Metadata table');
  --  
  --  
GO 
print('***** FROM: CreateTracker_EDW_Metadata.sql'); 
GO 
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





/***********************************************************
Copyright @ DMA Limited, June 2012, all rights reserved.
FIND a top level view's nested tables and views using a CTE.
Author: W. Dale Miller
Description:
  A recursive CTE requires four elements in order to work properly.
  Anchor query (runs once and the results seed the Recursive query)
  Recursive query (runs multiple times and is the criteria for the remaining results)
  UNION ALL statement to bind the Anchor and Recursive queries together.
  INNER JOIN statement to bind the Recursive query to the results of the CTE.
***********************************************************/


/***************************************************************
exec proc_GetViewBaseTables 'view_EDW_HealthAssesment'
exec proc_GetViewBaseTablesExpanded 'view_EDW_HealthAssesment'
exec proc_GetViewBaseTables 'View_EDW_HealthAssesmentQuestions'
exec proc_GetViewBaseTables 'view_EDW_BioMetrics'
exec proc_GetViewBaseTables 'view_EDW_TrackerCompositeDetails'
***************************************************************/

go

if exists (select name from sys.procedures where name = 'proc_GetViewBaseTables')
BEGIN
    drop procedure proc_GetViewBaseTables ;
END

GO
create procedure proc_GetViewBaseTables (@tgtView as nvarchar(100))
as 
begin
WITH mycte
    AS (SELECT 
               --TU.view_name
             TU.Table_Name
             , IST.TABLE_TYPE
               FROM
                    INFORMATION_SCHEMA.VIEW_TABLE_USAGE AS TU WITH (NOLOCK) 
                        JOIN INFORMATION_SCHEMA.tables AS IST
                            ON IST.TABLE_NAME = TU.TABLE_NAME
          WHERE view_name = @tgtView

        UNION ALL

        SELECT 
             --  ISV.view_name
             ISV.Table_Name
             , IST.TABLE_TYPE
               FROM
                    INFORMATION_SCHEMA.VIEW_TABLE_USAGE AS ISV
                        JOIN INFORMATION_SCHEMA.tables AS IST
                            ON IST.TABLE_NAME = ISV.TABLE_NAME
                        INNER JOIN mycte
                            ON ISV.view_name = mycte.table_name
    ) 

    SELECT DISTINCT  table_name, table_type
           FROM mycte
      ORDER BY
               table_name;
end 

go


if exists (select name from sys.procedures where name = 'proc_GetViewBaseTablesExpanded')
BEGIN
    drop procedure proc_GetViewBaseTablesExpanded ;
END
go
--exec proc_GetViewBaseTablesExpanded 'view_EDW_HealthAssesment'
create procedure proc_GetViewBaseTablesExpanded (@tgtView as nvarchar(100))
as 
begin
WITH mycte
    AS (SELECT 
               TU.view_name
             , TU.Table_Name
             , IST.TABLE_TYPE
               FROM
                    INFORMATION_SCHEMA.VIEW_TABLE_USAGE AS TU WITH (NOLOCK) 
                        JOIN INFORMATION_SCHEMA.tables AS IST
                            ON IST.TABLE_NAME = TU.TABLE_NAME
          WHERE view_name = @tgtView

        UNION ALL

        SELECT 
               ISV.view_name
             , ISV.Table_Name
             , IST.TABLE_TYPE
               FROM
                    INFORMATION_SCHEMA.VIEW_TABLE_USAGE AS ISV
                        JOIN INFORMATION_SCHEMA.tables AS IST
                            ON IST.TABLE_NAME = ISV.TABLE_NAME
                        INNER JOIN mycte
                            ON ISV.view_name = mycte.table_name
    ) 

    SELECT DISTINCT view_name, table_name, table_type
           FROM mycte
      ORDER BY
               view_name, table_name;
end 

go
--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





--Test Cases
--exec IVP_DataValidation 'view_EDW_RewardUserDetail' ;
--exec IVP_DataValidation 'view_EDW_SmallStepResponses' 
--exec IVP_DataValidation 'view_EDW_Coaches';
--go

GO
PRINT 'Executing C:\Users\wmiller\Documents\SQL Server Management Studio\HFit_Rewrite\CurrentWork\IVP_Views.sql ';
GO
PRINT 'Creating procedure IVP_DataValidation';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.procedures
			 WHERE name = 'IVP_DataValidation') 
	BEGIN
		DROP PROCEDURE
			 IVP_DataValidation;
	END;
GO
CREATE PROCEDURE IVP_DataValidation @vname AS nvarchar (250) 
AS

	 --02.23.2015 (WDM) - Started development if the IVP procedure.
	 --02.24.2015 (WDM) - Completed and generated the procedure in the different environments.

	 BEGIN
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_II')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_II;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_III')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_III;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_V')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_V;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF NOT EXISTS (SELECT
							   name
						  FROM sys.views
						  WHERE name = @vname) 
			 BEGIN
				 PRINT '<><><><><><><><><><><><><><><><><><><><><><><><><>';
				 PRINT 'ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ';
				 PRINT '<><><><><><><><><><><><><><><><><><><><><><><><><>';
				 PRINT ' ';
				 PRINT 'ERROR: ' + @vname + ' is missing.';
				 PRINT '<><><><><><><><><><><><><><><><><><><><><><><><><>';
				 RETURN;
			 END;
		 DECLARE @iTotal AS int = 0;
		 DECLARE @mysql AS nvarchar (2000) = '';
		 DECLARE @ProcStartTime AS datetime = GETDATE () ;
		 DECLARE @StartTime AS datetime = GETDATE () ;
		 DECLARE @EndTime AS datetime = GETDATE () ;
		 DECLARE @ETime AS nvarchar (200) = '';
		 DECLARE @CurrSvr nvarchar (250) = (SELECT
												   @@servername) ;
		 DECLARE @CurrDB nvarchar (250) = (SELECT
												  DB_NAME ()) ;
		 SET NOCOUNT ON;

		 --select count(*) as cnt into IVP_Temp_II from view_EDW_SmallStepResponses

		 PRINT '**************************************************************************************';
		 PRINT 'Veryfying Data From: ' + @vname + ' on server ' + @CurrSvr + ' within DB: ' + @CurrDB;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_II')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_II;
			 END;

		 --select count(*) as cnt into IVP_Temp_II from view_EDW_Coaches;		

		 SET @mysql = 'select count(*) as cnt into IVP_Temp_II from ' + @vname;
		 EXEC (@mysql) ;
		 DECLARE @rowcount int = (SELECT TOP (1) 
										 cnt
									FROM IVP_Temp_II) ;
		 SET @EndTime = GETDATE () ;

		 --hours over 24, minutes,  seconds, milliseconds

		 SET @ETime = (SELECT
							  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
		 PRINT 'TOTAL Records in ' + @vname + ': ' + CAST (@rowcount AS nvarchar (50)) + '.';
		 PRINT 'Execution Time: ' + @ETime;

		 --********************************************

		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_III')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_III;
			 END;
		 SET @StartTime = GETDATE () ;
		 SET @mysql = 'select top 100 * into IVP_Temp_III from ' + @vname;
		 EXEC (@mysql) ;
		 SET @EndTime = GETDATE () ;

		 --hours over 24, minutes,  seconds, milliseconds

		 SET @ETime = (SELECT
							  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
		 PRINT '-------------------';
		 PRINT 'Execution Time to Select 100 Rows into TEMP TABLE: ' + @ETime;

		 --********************************************

		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF @rowcount > 1000
			 BEGIN
				 SET @StartTime = GETDATE () ;
				 SET @mysql = 'select top 1000 * into IVP_Temp_IV from ' + @vname;
				 EXEC (@mysql) ;
				 SET @EndTime = GETDATE () ;

				 --hours over 24, minutes,  seconds, milliseconds

				 SET @ETime = (SELECT
									  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
				 PRINT '-------------------';
				 PRINT 'Execution Time to Select 1,000 Rows into TEMP TABLE: ' + @ETime;
			 END;

		 --********************************************

		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_V')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_V;
			 END;
		 IF @rowcount > 10000
			 BEGIN
				 SET @StartTime = GETDATE () ;
				 SET @mysql = 'select top 10000 * into IVP_Temp_V from ' + @vname;
				 EXEC (@mysql) ;
				 SET @EndTime = GETDATE () ;

				 --hours over 24, minutes,  seconds, milliseconds

				 SET @ETime = (SELECT
									  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
				 PRINT '-------------------';
				 PRINT 'Execution Time to Select 10,000 Rows into TEMP TABLE: ' + @ETime;
			 END;

		 --********************************************

		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF @rowcount > 100000
			 BEGIN
				 SET @StartTime = GETDATE () ;
				 SET @mysql = 'select top 100000 * into IVP_Temp_IV from ' + @vname;
				 EXEC (@mysql) ;
				 SET @EndTime = GETDATE () ;

				 --hours over 24, minutes,  seconds, milliseconds

				 SET @ETime = (SELECT
									  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
				 PRINT '-------------------';
				 PRINT 'Execution Time to Select 100,000 Rows into TEMP TABLE: ' + @ETime;
			 END;
		 PRINT '**************************************************************************************';
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_II')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_II;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_III')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_III;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_V')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_V;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 SET NOCOUNT OFF;
	 END;
GO
PRINT 'CREATED procedure IVP_DataValidation';
GO--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_Awards') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_Awards , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW view_EDW_Awards
AS

	 --*************************************************************************************
	 -- 2.3.2015 : WDM - Created the initial view for Awards (HEW)
	 -- 2.3.2015 : WDM - Laura B. had objections as to how the data was pulled, Nate agreed
	 --					to look at it again.
	 --*************************************************************************************

	 SELECT
			AWARD.*
		  , ATYPE.AwardType
		  , ATRIGGER.RewardTriggerLKPName
		  , ATRIGGER.RewardTriggerRewardActivityLKPID
		  , ATRIGGER.RewardTriggerLKPDisplayName
		  , ATRIGGER.HESCode
	   FROM HFit_HES_Award AS AWARD
				JOIN HFit_LKP_RewardTrigger AS ATRIGGER
					ON AWARD.RewardTriggerID = ATRIGGER.RewardTriggerLKPID
				JOIN HFit_LKP_HES_AwardType AS ATYPE
					ON AWARD.HESAwardID = ATYPE.itemID;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_Awards found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_BioMetrics') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_BioMetrics , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW dbo.view_EDW_BioMetrics
AS

	 --*****************************************************************************************************************************************
	 --************** TEST Criteria and Results for view_EDW_BioMetrics ************************************************************************
	 --INSERT INTO [dbo].[EDW_BiometricViewRejectCriteria] ([AccountCD],[ItemCreatedWhen],[SiteID]) VALUES(''XX'',''2013-12-01'',17  )  
	 --NOTE:		XX is used so that the AccountCD is NOT taken into account and only SiteID and ItemCreatedWhen is used.
	 --GO	--Tested by wdm on 11.21.2014
	 -- select count(*) from view_EDW_BioMetrics		--(wdm) & (jc) : testing on {ProdStaging = 136348} / With reject on 136339 = 9
	 --select * from view_EDW_BioMetrics	 where AccountCD = ''peabody'' AND COALESCE (EventDate,ItemCreatedWhen) is not NULL and COALESCE (EventDate,ItemCreatedWhen) < ''2013-12-01''	: 9 
	 --select * from view_Hfit_BioMetrics where AccountCD = ''peabody'' AND COALESCE (EventDate,ItemCreatedWhen) is not NULL and COALESCE (EventDate,ItemCreatedWhen) < ''2013-12-01''	: 9 
	 --select * from view_EDW_BioMetrics	where AccountCD = ''peabody'' and ItemCreatedWhen < ''2013-12-01 00:00:00.000''		: 7 
	 --select * from view_EDW_BioMetrics	where AccountCD = ''peaboOK dy'' and EventDate < ''2013-12-01 00:00:00.000''		: 9 
	 --select count(*) from view_EDW_BioMetrics		--NO REJECT FILTER : 136348
	 --select count(*) from view_EDW_BioMetrics		--REJECT FILTER ON : 136339 == 9 GOOD TEST
	 --select count(*) from view_Hfit_BioMetrics	:136393
	 --select count(*) from view_Hfit_BioMetrics where COALESCE (EventDate,ItemCreatedWhen) is not NULL 	:136348
	 --NOTE: All tests passed 11.21.2014, 11.23.2014, 12.2.2014, 12,4,2014
	 --truncate table EDW_BiometricViewRejectCriteria
	 --INSERT INTO [dbo].[EDW_BiometricViewRejectCriteria]([AccountCD],[ItemCreatedWhen],[SiteID])VALUES(''peabody'',''2013-12-01'',-1)         
	 --NOTE:		-1 is used so that the SiteID is NOT taken into account and only AccountCD and ItemCreatedWhen is used.
	 --GO	--Tested by wdm on 11.21.2014
	 --select * from view_EDW_BioMetrics where ItemCreatedWhen < ''2013-12-01'' and AccountCD = ''peabody'' returns 1034
	 --		so the number should be 43814 - 1034 = 42780 with AccountCD = ''peabody'' and ItemCreatedWhen = ''2014-03-19''
	 --		in table EDW_BiometricViewRejectCriteria. And it worked (wdm) 11.21.2014
	 --GO	--Tested by wdm on 11.21.2014
	 --select * from view_EDW_BioMetrics where SiteID = 17 and ItemCreatedWhen < ''2014-03-19'' returns 22,974
	 --		so the number should be 43814 - 22974 = 20840 with SIteID = 17 and ItemCreatedWhen = ''2014-03-19''
	 --		in table EDW_BiometricViewRejectCriteria. And it worked (wdm) 11.21.2014
	 --GO	--Tested by wdm on 11.21.2014
	 --	11.24.2014 (wdm) -	requested a review of this code and validation with EDW.
	 -- 12.22.2014 - Received an SR from John C. via Richard to add two fields to the view, Table name and Item ID.
	 -- 12.23.2014 - Added the Vendor ID and Vendor name to the view via the HFit_LKP_TrackerVendor table
	 -- 12.25.2014 - Added the EDW_BiometricViewRejectCriteria to allow selective rejection of historical records
	 -- 01.19.2014 - Prepared for Simpson Willams
	 --*****************************************************************************************************************************************

	 SELECT DISTINCT

	 --HFit_UserTracker

			HFUT.UserID
   , cus.UserSettingsUserGUID AS UserGUID
   , cus.HFitUserMpiNumber
   , cus2.SiteID
   , cs.SiteGUID
   , NULL AS CreatedDate
   , NULL AS ModifiedDate
   , NULL AS Notes
   , NULL AS IsProfessionallyCollected
   , NULL AS EventDate
   , ''Not Build Yet'' AS EventName

			--HFit_TrackerWeight

   , NULL AS PPTWeight

			--HFit_TrackerHbA1C

   , NULL AS PPTHbA1C

			--HFit_TrackerCholesterol

   , NULL AS Fasting
   , NULL AS HDL
   , NULL AS LDL
   , NULL AS Ratio
   , NULL AS Total
   , NULL AS Triglycerides

			--HFit_TrackerBloodSugarandGlucose

   , NULL AS Glucose
   , NULL AS FastingState

			--HFit_TrackerBloodPressure

   , NULL AS Systolic
   , NULL AS Diastolic

			--HFit_TrackerBodyFat

   , NULL AS PPTBodyFatPCT

			--HFit_TrackerBMI

   , NULL AS BMI

			--HFit_TrackerBodyMeasurements

   , NULL AS WaistInches
   , NULL AS HipInches
   , NULL AS ThighInches
   , NULL AS ArmInches
   , NULL AS ChestInches
   , NULL AS CalfInches
   , NULL AS NeckInches

			--HFit_TrackerHeight

   , NULL AS Height

			--HFit_TrackerRestingHeartRate

   , NULL AS HeartRate
   ,

			--HFit_TrackerShots

			NULL AS FluShot
   , NULL AS PneumoniaShot

			--HFit_TrackerTests

   , NULL AS PSATest
   , NULL AS OtherExam
   , NULL AS TScore
   , NULL AS DRA
   , NULL AS CotinineTest
   , NULL AS ColoCareKit
   , NULL AS CustomTest
   , NULL AS CustomDesc
   , NULL AS CollectionSource
   , HFA.AccountID
   , HFA.AccountCD
   , CASE
		 WHEN HFUT.ItemCreatedWhen = COALESCE (HFUT.ItemModifiedWhen, hfut.ItemCreatedWhen) 
		 THEN ''I''
		 ELSE ''U''
	 END AS ChangeType
   , HFUT.ItemCreatedWhen
   , HFUT.ItemModifiedWhen
   , 0 AS TrackerCollectionSourceID
   , HFUT.itemid
   , ''HFit_UserTracker'' AS TBL
   , NULL AS VendorID

			--VENDOR.ItemID as VendorID

   , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_UserTracker AS HFUT
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON hfut.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID

	   --left outer join HFit_LKP_TrackerVendor as VENDOR on HFUT.VendorID = VENDOR.ItemID
	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE HFUT.ItemCreatedWhen < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND HFUT.ItemCreatedWhen < ItemCreatedWhen) 

			 --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified within table EDW_BiometricViewRejectCriteria

		 AND HFUT.ItemCreatedWhen IS NOT NULL

	 --Add per Robert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			hftw.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTW.ItemCreatedWhen
		  , HFTW.ItemModifiedWhen
		  , HFTW.Notes
		  , HFTW.IsProfessionallyCollected
		  , HFTW.EventDate
		  , ''Not Build Yet'' AS EventName
		  , hftw.Value AS PPTWeight
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTW.ItemCreatedWhen = COALESCE (HFTW.ItemModifiedWhen, HFTW.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTW.ItemCreatedWhen
		  , HFTW.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTW.itemid
		  , ''HFit_TrackerWeight'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerWeight AS HFTW
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTW.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTW.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTW.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria	  

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTW.EventDate, HFTW.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTW.EventDate, HFTW.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTW.ItemCreatedWhen IS NOT NULL
		   OR HFTW.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014			

	 UNION ALL
	 SELECT
			HFTHA.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTHA.ItemCreatedWhen
		  , HFTHA.ItemModifiedWhen
		  , HFTHA.Notes
		  , HFTHA.IsProfessionallyCollected
		  , HFTHA.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , HFTHA.Value AS PPTHbA1C
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTHA.ItemCreatedWhen = COALESCE (HFTHA.ItemModifiedWhen, HFTHA.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTHA.ItemCreatedWhen
		  , HFTHA.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTHA.itemid
		  , ''HFit_TrackerHbA1c'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerHbA1c AS HFTHA
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTHA.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTHA.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTHA.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTHA.EventDate, HFTHA.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTHA.EventDate, HFTHA.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTHA.ItemCreatedWhen IS NOT NULL
		   OR HFTHA.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTC.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTC.ItemCreatedWhen
		  , HFTC.ItemModifiedWhen
		  , HFTC.Notes
		  , HFTC.IsProfessionallyCollected
		  , HFTC.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , HFTC.Fasting
		  , HFTC.HDL
		  , HFTC.LDL
		  , HFTC.Ratio
		  , HFTC.Total
		  , HFTC.Tri
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTC.ItemCreatedWhen = COALESCE (HFTC.ItemModifiedWhen, HFTC.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTC.ItemCreatedWhen
		  , HFTC.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTC.itemid
		  , ''HFit_TrackerCholesterol'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerCholesterol AS HFTC
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTC.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTC.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTC.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTC.EventDate, HFTC.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTC.EventDate, HFTC.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTC.ItemCreatedWhen IS NOT NULL
		   OR HFTC.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTBSAG.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTBSAG.ItemCreatedWhen
		  , HFTBSAG.ItemModifiedWhen
		  , HFTBSAG.Notes
		  , HFTBSAG.IsProfessionallyCollected
		  , HFTBSAG.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTBSAG.Units
		  , HFTBSAG.FastingState
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTBSAG.ItemCreatedWhen = COALESCE (HFTBSAG.ItemModifiedWhen, HFTBSAG.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTBSAG.ItemCreatedWhen
		  , HFTBSAG.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTBSAG.itemid
		  , ''HFit_TrackerBloodSugarAndGlucose'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBloodSugarAndGlucose AS HFTBSAG
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTBSAG.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTBSAG.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTBSAG.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTBSAG.EventDate, HFTBSAG.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTBSAG.EventDate, HFTBSAG.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTBSAG.ItemCreatedWhen IS NOT NULL
		   OR HFTBSAG.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTBP.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTBP.ItemCreatedWhen
		  , HFTBP.ItemModifiedWhen
		  , HFTBP.Notes
		  , HFTBP.IsProfessionallyCollected
		  , HFTBP.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTBP.Systolic
		  , HFTBP.Diastolic
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTBP.ItemCreatedWhen = COALESCE (HFTBP.ItemModifiedWhen, HFTBP.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTBP.ItemCreatedWhen
		  , HFTBP.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTBP.itemid
		  , ''HFit_TrackerBloodPressure'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBloodPressure AS HFTBP
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTBP.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTBP.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTBP.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTBP.EventDate, HFTBP.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTBP.EventDate, HFTBP.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTBP.ItemCreatedWhen IS NOT NULL
		   OR HFTBP.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTBF.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTBF.ItemCreatedWhen
		  , HFTBF.ItemModifiedWhen
		  , HFTBF.Notes
		  , HFTBF.IsProfessionallyCollected
		  , HFTBF.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTBF.Value AS PPTBodyFatPCT
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTBF.ItemCreatedWhen = COALESCE (HFTBF.ItemModifiedWhen, HFTBF.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTBF.ItemCreatedWhen
		  , HFTBF.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTBF.itemid
		  , ''HFit_TrackerBodyFat'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBodyFat AS HFTBF
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTBF.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTBF.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTBF.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTBF.EventDate, HFTBF.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTBF.EventDate, HFTBF.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTBF.ItemCreatedWhen IS NOT NULL
		   OR HFTBF.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTB.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTB.ItemCreatedWhen
		  , HFTB.ItemModifiedWhen
		  , HFTB.Notes
		  , HFTB.IsProfessionallyCollected
		  , HFTB.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTB.BMI
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTB.ItemCreatedWhen = COALESCE (HFTB.ItemModifiedWhen, HFTB.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTB.ItemCreatedWhen
		  , HFTB.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTB.itemid
		  , ''HFit_TrackerBMI'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBMI AS HFTB
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTB.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTB.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTB.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTB.EventDate, HFTB.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTB.EventDate, HFTB.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTB.ItemCreatedWhen IS NOT NULL
		   OR HFTB.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTBM.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTBM.ItemCreatedWhen
		  , HFTBM.ItemModifiedWhen
		  , HFTBM.Notes
		  , HFTBM.IsProfessionallyCollected
		  , HFTBM.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTBM.WaistInches
		  , HFTBM.HipInches
		  , HFTBM.ThighInches
		  , HFTBM.ArmInches
		  , HFTBM.ChestInches
		  , HFTBM.CalfInches
		  , HFTBM.NeckInches
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTBM.ItemCreatedWhen = COALESCE (HFTBM.ItemModifiedWhen, HFTBM.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTBM.ItemCreatedWhen
		  , HFTBM.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTBM.itemid
		  , ''HFit_TrackerBodyMeasurements'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBodyMeasurements AS HFTBM
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTBM.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTBM.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTBM.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTBM.EventDate, HFTBM.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTBM.EventDate, HFTBM.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTBM.ItemCreatedWhen IS NOT NULL
		   OR HFTBM.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTH.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTH.ItemCreatedWhen
		  , HFTH.ItemModifiedWhen
		  , HFTH.Notes
		  , HFTH.IsProfessionallyCollected
		  , HFTH.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTH.Height
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTH.ItemCreatedWhen = COALESCE (HFTH.ItemModifiedWhen, HFTH.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTH.ItemCreatedWhen
		  , HFTH.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTH.itemid
		  , ''HFit_TrackerHeight'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerHeight AS HFTH
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTH.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTH.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTH.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria		

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTH.EventDate, HFTH.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTH.EventDate, HFTH.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTH.ItemCreatedWhen IS NOT NULL
		   OR HFTH.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTRHR.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTRHR.ItemCreatedWhen
		  , HFTRHR.ItemModifiedWhen
		  , HFTRHR.Notes
		  , HFTRHR.IsProfessionallyCollected
		  , HFTRHR.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTRHR.HeartRate
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTRHR.ItemCreatedWhen = COALESCE (HFTRHR.ItemModifiedWhen, HFTRHR.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTRHR.ItemCreatedWhen
		  , HFTRHR.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTRHR.itemid
		  , ''HFit_TrackerRestingHeartRate'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerRestingHeartRate AS HFTRHR
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTRHR.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTRHR.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTRHR.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTRHR.EventDate, HFTRHR.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTRHR.EventDate, HFTRHR.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTRHR.ItemCreatedWhen IS NOT NULL
		   OR HFTRHR.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTS.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTS.ItemCreatedWhen
		  , HFTS.ItemModifiedWhen
		  , HFTS.Notes
		  , HFTS.IsProfessionallyCollected
		  , HFTS.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTS.FluShot
		  , HFTS.PneumoniaShot
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTS.ItemCreatedWhen = COALESCE (HFTS.ItemModifiedWhen, HFTS.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTS.ItemCreatedWhen
		  , HFTS.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTS.itemid
		  , ''HFit_TrackerShots'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerShots AS HFTS
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTS.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTS.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTS.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTS.EventDate, HFTS.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTS.EventDate, HFTS.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTS.ItemCreatedWhen IS NOT NULL
		   OR HFTS.EventDate IS NOT NULL) 

	 --Add per RObert and Laura 12.4.2014

	 UNION ALL
	 SELECT
			HFTT.UserID
		  , cus.UserSettingsUserGUID
		  , cus.HFitUserMpiNumber
		  , cus2.SiteID
		  , cs.SiteGUID
		  , HFTT.ItemCreatedWhen
		  , HFTT.ItemModifiedWhen
		  , HFTT.Notes
		  , HFTT.IsProfessionallyCollected
		  , HFTT.EventDate
		  , ''Not Build Yet'' AS EventName
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , NULL
		  , HFTT.PSATest
		  , HFTT.OtherExam
		  , HFTT.TScore
		  , HFTT.DRA
		  , HFTT.CotinineTest
		  , HFTT.ColoCareKit
		  , HFTT.CustomTest
		  , HFTT.CustomDesc
		  , HFTCS.CollectionSourceName_External
		  , HFA.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN HFTT.ItemCreatedWhen = COALESCE (HFTT.ItemModifiedWhen, HFTT.ItemCreatedWhen) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFTT.ItemCreatedWhen
		  , HFTT.ItemModifiedWhen
		  , HFTCS.TrackerCollectionSourceID
		  , HFTT.itemid
		  , ''HFit_TrackerTests'' AS TBL
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerTests AS HFTT
				INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS
					ON HFTT.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON HFTT.UserID = cus.UserSettingsUserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cus.UserSettingsUserID = cus2.UserID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON HFTT.VendorID = VENDOR.ItemID

	   --11.21.2014 (wdm) add so that Account or Site data rows could be rejected if prior to a date specified wihtin table EDW_BiometricViewRejectCriteria

	   WHERE CS.SITEID NOT IN (
							   SELECT
									  SiteID
								 FROM EDW_BiometricViewRejectCriteria
								 WHERE COALESCE (HFTT.EventDate, HFTT.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND HFA.AccountCD NOT IN (
								   SELECT
										  AccountCD
									 FROM EDW_BiometricViewRejectCriteria
									 WHERE HFA.AccountCD = AccountCD
									   AND COALESCE (HFTT.EventDate, HFTT.ItemCreatedWhen) < ItemCreatedWhen) 
		 AND (HFTT.ItemCreatedWhen IS NOT NULL
		   OR HFTT.EventDate IS NOT NULL) ;

--Add per RObert and Laura 12.4.2014
--HFit_TrackerBMI
--HFit_TrackerBodyMeasurements
--HFit_TrackerHeight
--HFit_TrackerRestingHeartRate
--HFit_TrackerShots
--HFit_TrackerTests

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_BioMetrics found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_BiometricViewRejectCriteria') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_BiometricViewRejectCriteria , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW view_EDW_BiometricViewRejectCriteria
AS
	 SELECT
			AccountCD
		  , ItemCreatedWhen
		  , SiteID
		  , RejectGUID
	   FROM dbo.EDW_BiometricViewRejectCriteria;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_BiometricViewRejectCriteria found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_ClientCompany') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_ClientCompany , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '


CREATE VIEW [dbo].[view_EDW_ClientCompany]
AS
--************************************************************
--One of the few views in the system that is not nested. 
--It combines the Account, Site and Company data.
--Last Tested: 09/04/2014 WDM
--WDM 9.10.2014 - verified dates were available to the EDW
--************************************************************
	SELECT
		hfa.AccountID
		, HFA.AccountCD
		, HFA.AccountName
		, HFA.ItemCreatedWhen as AccountCreated
		, HFA.ItemModifiedWhen as AccountModified
		, HFA.ItemGUID AccountGUID
		, CS.SiteID
		, CS.SiteGUID
		, CS.SiteLastModified
		, HFC.CompanyID
		, HFC.ParentID
		, HFC.CompanyName
		, HFC.CompanyShortName
		, HFC.CompanyStartDate
		, HFC.CompanyEndDate
		, HFC.CompanyStatus
		, CASE	WHEN CAST(hfa.ItemCreatedWhen AS DATE) = CAST(HFA.ItemModifiedWhen AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, NULL AS CompanyCreated
		, NULL AS CompanyModified
	FROM
		dbo.HFit_Account AS HFA
	INNER JOIN dbo.CMS_Site AS CS ON HFA.SiteID = cs.SiteID
	LEFT OUTER JOIN dbo.HFit_Company AS HFC ON HFA.AccountID = hfc.AccountID






';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_ClientCompany found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_Coaches') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_Coaches , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--****************************************************
-- Verified last mod date available to EDW 9.10.2014
--****************************************************
CREATE VIEW [dbo].[view_EDW_Coaches]

AS

SELECT distinct
    cu.UserGUID
   ,cs.SiteGUID
   ,HFA.AccountID
   ,HFA.AccountCD
   ,CoachID
   ,hfc.LastName
   ,hfc.FirstName
   ,hfc.StartDate
   ,hfc.Phone
   ,hfc.email
   ,hfc.Supervisor
   ,hfc.SuperCoach
   ,hfc.MaxParticipants
   ,hfc.Inactive
   ,hfc.MaxRiskLevel
   ,hfc.Locked
   ,hfc.TimeLocked
   ,hfc.terminated
   ,hfc.APMaxParticipants
   ,hfc.RNMaxParticipants
   ,hfc.RNPMaxParticipants
   ,hfc.Change_Type
   ,hfc.Last_Update_Dt
FROM
    dbo.HFit_Coaches AS HFC
LEFT OUTER JOIN dbo.CMS_User AS CU ON hfc.KenticoUserID = cu.UserID
LEFT OUTER JOIN dbo.CMS_UserSite AS CUS ON cu.userid = cus.UserID
LEFT OUTER JOIN dbo.CMS_Site AS CS ON CS.SiteID = CUS.SiteID
LEFT OUTER JOIN dbo.HFit_Account AS HFA ON cs.SiteID = hfa.SiteID

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_Coaches found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_CoachingDefinition') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_CoachingDefinition , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '

--GRANT SELECT
--	ON [dbo].[view_EDW_CoachingDefinition]
--	TO [EDWReader_PRD]
--GO


CREATE VIEW [dbo].[view_EDW_CoachingDefinition]
AS
--********************************************************************************************************
--8/7/2014 - added DocumentGuid 
--8/8/2014 - Generated corrected view in DEV (WDM)
-- Verified last mod date available to EDW 9.10.2014
--11.17.2014 - (wdm) John Croft found an issue with multiple languages being returned.
--		View_EDW_CoachingDefinition pulls its data from a nested view View_HFit_Tobacco_Goal_Joined. I added 
--		a Document Culture filter on the SELECT STATEMENT pulling the data from View_HFit_Tobacco_Goal_Joined.
--		In LAB DB, when the view is executed W/O the filter, I get 90 rows. When executed with the filter, I 
--		get 89 rows. This would indicate the filter can be applied at the SELCT statement level. The view has 
--		the change applied and is ready to be regenerated. Also, I needed to add a language filter to 
--		View_HFit_Goal_Joined. Additionally, I allow the view to return the Document Culture as a column so 
--		that we can see the associated language. This can be removed if not wanted, but for troubleshooting 
--		it is useful.
--********************************************************************************************************
SELECT
	GJ.GoalID
	, GJ.DocumentGuid	--, GJ.DocumentID
	, GJ.NodeSiteID
	, cs.SiteGUID
	, GJ.GoalImage
	, GJ.Goal
	, dbo.udf_StripHTML(GJ.GoalText) GoalText --
	, dbo.udf_StripHTML(GJ.GoalSummary) GoalSummary --
	, GJ.TrackerAssociation  --GJ.TrackerAssociation
	, GJ.GoalFrequency
	, HFLF.FrequencySingular
	, HFLF.FrequencyPlural
	, GJ.GoalUnitOfMeasure
	, HFLUOM.UnitOfMeasure
	, GJ.GoalDirection
	, GJ.GoalPrecision
	, GJ.GoalAbsoluteMin
	, GJ.GoalAbsoluteMax
	, dbo.udf_StripHTML(GJ.SetGoalText) SetGoalText --
	, dbo.udf_StripHTML(GJ.HelpText) HelpText --
	, GJ.EvaluationType
	, GJ.CatalogDisplay
	, GJ.AllowModification
	, GJ.ActivityText
	, dbo.udf_StripHTML(GJ.SetGoalModifyText) SetgoalModifyText
	, GJ.IsLifestyleGoal
	, GJ.CodeName
	, CASE	WHEN CAST(gj.DocumentCreatedWhen AS DATE) = CAST(gj.DocumentModifiedWhen AS DATE)
			THEN ''I''
			ELSE ''U''
		END AS ChangeType
	, GJ.DocumentCreatedWhen
	, GJ.DocumentModifiedWhen
	, GJ.DocumentCulture
FROM
	(
		SELECT
			VHFGJ.GoalID
			, VHFGJ.DocumentGuid	--, VHFGJ.DocumentID
			, VHFGJ.NodeSiteID
			, VHFGJ.GoalImage
			, VHFGJ.Goal
			, VHFGJ.GoalText
			, VHFGJ.GoalSummary
			, VHFGJ.TrackerNodeGUID as TrackerAssociation  --VHFGJ.TrackerAssociation
			, VHFGJ.GoalFrequency
			, VHFGJ.GoalUnitOfMeasure
			, VHFGJ.GoalDirection
			, VHFGJ.GoalPrecision
			, VHFGJ.GoalAbsoluteMin
			, VHFGJ.GoalAbsoluteMax
			, VHFGJ.SetGoalText
			, VHFGJ.HelpText
			, VHFGJ.EvaluationType
			, VHFGJ.CatalogDisplay
			, VHFGJ.AllowModification
			, VHFGJ.ActivityText
			, VHFGJ.SetGoalModifyText
			, VHFGJ.IsLifestyleGoal
			, VHFGJ.CodeName
			, VHFGJ.DocumentCreatedWhen
			, VHFGJ.DocumentModifiedWhen
			, VHFGJ.DocumentCulture
		FROM
			dbo.View_HFit_Goal_Joined AS VHFGJ
			where VHFGJ.DocumentCulture = ''en-US''
		UNION ALL
		SELECT
			VHFTGJ.GoalID
			, VHFTGJ.DocumentGuid	--, VHFTGJ.DocumentID
			, VHFTGJ.NodeSiteID
			, VHFTGJ.GoalImage
			, VHFTGJ.Goal
			, NULL AS GoalText
			, VHFTGJ.GoalSummary
			, VHFTGJ.TrackerNodeGUID as TrackerAssociation  --VHFTGJ.TrackerAssociation
			, VHFTGJ.GoalFrequency
			, NULL AS GoalUnitOfMeasure
			, VHFTGJ.GoalDirection
			, VHFTGJ.GoalPrecision
			, VHFTGJ.GoalAbsoluteMin
			, VHFTGJ.GoalAbsoluteMax
			, NULL AS SetGoalText
			, NULL AS HelpText
			, VHFTGJ.EvaluationType
			, VHFTGJ.CatalogDisplay
			, VHFTGJ.AllowModification
			, VHFTGJ.ActivityText
			, NULL SetGoalModifyText
			, VHFTGJ.IsLifestyleGoal
			, VHFTGJ.CodeName
			, VHFTGJ.DocumentCreatedWhen
			, VHFTGJ.DocumentModifiedWhen
			, VHFTGJ.DocumentCulture
		FROM
			dbo.View_HFit_Tobacco_Goal_Joined AS VHFTGJ
			where VHFTGJ.DocumentCulture = ''en-US''
	) AS GJ
LEFT OUTER JOIN dbo.HFit_LKP_UnitOfMeasure AS HFLUOM ON GJ.GoalUnitOfMeasure = HFLUOM.UnitOfMeasureID
LEFT OUTER JOIN dbo.HFit_LKP_Frequency AS HFLF ON GJ.GoalFrequency = HFLF.FrequencyID
INNER JOIN cms_site AS CS ON gj.nodesiteid = cs.siteid
--INNER JOIN cms_site AS CS ON gj.siteguid = cs.siteguid
WHERE
	gj.DocumentCreatedWhen IS NOT NULL
	AND gj.DocumentModifiedWhen IS NOT NULL 

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_CoachingDefinition found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_CoachingDetail') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_CoachingDetail , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--GRANT SELECT
--	ON [dbo].[[view_EDW_CoachingDetail]]
--	TO [EDWReader_PRD]
--GO

/******************************************************************
 TEST Queries
select * from [view_EDW_CoachingDetail]
select * from [view_EDW_CoachingDetail] where CloseReasonLKPID != 0
select count(*) from [view_EDW_CoachingDetail]
******************************************************************/

CREATE VIEW dbo.view_EDW_CoachingDetail
AS

	 --********************************************************************************************
	 --8/7/2014 - added and commented out DocumentGuid in case needed later
	 --8/8/2014 - Generated corrected view in DEV (WDM)
	 -- Verified last mod date available to EDW 9.10.2014
	 -- 01.02.2014 (WDM) added column HFUG.CloseReasonLKPID in order to satisfy Story #47923
	 -- 01.06.2014 (WDM) Tested with team B and found that the data was being returned. Stipulating that 
	 --					we converted the inner join to left outer join dbo.HFit_GoalOutcome. This 
	 --					allows data to be returned with the meaning that if NULL HFGO.EvaluationDate
	 --					is returned, the GOAL may exist without any input/update from the coach or
	 --					PPT
	 -- 01.07.2014 (WDM) This also takes care of 47976
	 --********************************************************************************************

	 SELECT
			HFUG.ItemID
		  , HFUG.ItemGUID
		  , GJ.GoalID
		  , HFUG.UserID
		  , cu.UserGUID
		  , cus.HFitUserMpiNumber
		  , cs.SiteGUID
		  , hfa.AccountID
		  , hfa.AccountCD
		  , hfa.AccountName
		  , HFUG.IsCreatedByCoach
		  , HFUG.BaselineAmount
		  , HFUG.GoalAmount
		  , NULL AS DocumentID
		  , HFUG.GoalStatusLKPID
		  , HFLGS.GoalStatusLKPName
		  , HFUG.EvaluationStartDate
		  , HFUG.EvaluationEndDate
		  , HFUG.GoalStartDate
		  , HFUG.CoachDescription
		  , HFGO.EvaluationDate
		  , HFGO.Passed
		  , HFGO.WeekendDate
		  , CASE
				WHEN CAST (HFUG.ItemCreatedWhen AS date) = CAST (HFUG.ItemModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFUG.ItemCreatedWhen
		  , HFUG.ItemModifiedWhen
		  , GJ.NodeGUID
		  , HFUG.CloseReasonLKPID
		  , GRC.CloseReason
	   FROM dbo.HFit_UserGoal AS HFUG WITH (NOLOCK) 
				INNER JOIN (
							SELECT
								   VHFGJ.GoalID
								 , VHFGJ.NodeID
								 , VHFGJ.NodeGUID
								 , VHFGJ.DocumentCulture
								 , VHFGJ.DocumentGuid
								 , VHFGJ.DocumentModifiedWhen

							--WDM added 9.10.2014

							  FROM dbo.View_HFit_Goal_Joined AS VHFGJ WITH (NOLOCK) 
							UNION ALL
							SELECT
								   VHFTGJ.GoalID
								 , VHFTGJ.NodeID
								 , VHFTGJ.NodeGUID
								 , VHFTGJ.DocumentCulture
								 , VHFTGJ.DocumentGuid
								 , VHFTGJ.DocumentModifiedWhen

							--WDM added 9.10.2014

							  FROM dbo.View_HFit_Tobacco_Goal_Joined AS VHFTGJ WITH (NOLOCK)) AS GJ
					ON hfug.NodeID = gj.NodeID
				   AND GJ.DocumentCulture = ''en-us''
				LEFT OUTER JOIN dbo.HFit_GoalOutcome AS HFGO WITH (NOLOCK) 
					ON HFUG.ItemID = HFGO.UserGoalItemID
				INNER JOIN dbo.HFit_LKP_GoalStatus AS HFLGS WITH (NOLOCK) 
					ON HFUG.GoalStatusLKPID = HFLGS.GoalStatusLKPID
				INNER JOIN dbo.CMS_User AS CU WITH (NOLOCK) 
					ON HFUG.UserID = cu.UserID
				INNER JOIN dbo.CMS_UserSettings AS CUS WITH (NOLOCK) 
					ON CU.UserGUID = CUS.UserSettingsUserGUID
				INNER JOIN dbo.CMS_UserSite AS CUS2 WITH (NOLOCK) 
					ON cu.UserID = CUS2.UserID
				INNER JOIN dbo.CMS_Site AS CS WITH (NOLOCK) 
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.HFit_Account AS HFA WITH (NOLOCK) 
					ON cs.SiteID = hfa.SiteID
				LEFT OUTER JOIN HFit_LKP_GoalCloseReason AS GRC
					ON GRC.CloseReasonID = HFUG.CloseReasonLKPID;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_CoachingDetail found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_EDW_TEST_DEL_DelAudit') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_EDW_TEST_DEL_DelAudit , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW view_EDW_EDW_TEST_DEL_DelAudit AS  SELECT * from EDW_TEST_DEL_DelAudit';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_EDW_TEST_DEL_DelAudit found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_Eligibility') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_Eligibility , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--select top 100 * from view_EDW_Eligibility

CREATE VIEW view_EDW_Eligibility
AS

	 --*************************************************************************************************************************
	 --view_EDW_Eligibility is the starting point for the EDW to pull data. As of 11.11.2014, all columns
	 --within the view are just a starting point. We will work with the EDW team to define and pull all the data
	 --they are needing.
	 --A PPT becomes eligible to participate through the Rules
	 --Rules of Engagement:
	 --00: ROLES are tied to a feature ; if the ROLE is not on a Kentico page - you don''t see it.
	 --01: When the Kentico group rebuild executes, all is lost. There is no retained MEMBER/User history.
	 --02: The group does not track when a member enters or leaves a group, simply that they exist in that group.
	 --NOTE: Any data deemed necessary can be added to this view for the EDW
	 --01.27.2015 (WDM) #48941 - Add Client Identifier to View_EDW_Eligibility
	 --	   In analyzing this requirement, found that the PPT.ClientID is nvarchar (alphanumeric)
	 --	   and Hfit_Client.ClientID is integer. A bit of a domain/naming issue.
	 --02.02.2015 (WDM) #44691 - Added the Site ID, Site Name, and Site Display Name to the returned cols of data
	 --	  per the conversation with John C. earlier this morning.
	 --02.05.2015 (WDM) #44691 - Added the Site GUID
	 --*************************************************************************************************************************

	 SELECT
			ROLES.RoleID
		  , ROLES.RoleName
		  , ROLES.RoleDescription
		  , ROLES.RoleGUID
		  , MemberROLE.MembershipID
		  , MemberROLE.RoleID AS MbrRoleID
		  , MemberSHIP.UserID AS MemberShipUserID
		  , MemberSHIP.ValidTo AS MemberShipValidTo
		  , USERSET.HFitUserMpiNumber
		  , USERSET.UserNickName
		  , USERSET.UserDateOfBirth
		  , USERSET.UserGender
		  , PPT.PPTID
		  , PPT.FirstName
		  , PPT.LastName
		  , PPT.City
		  , PPT.State
		  , PPT.PostalCode
		  , PPT.UserID AS PPTUserID
		  , GRPMBR.ContactGroupMemberContactGroupID
		  , GRPMBR.ContactGroupMemberRelatedID
		  , GRPMBR.ContactGroupMemberType
		  , GRP.ContactGroupName
		  , GRP.ContactGroupDisplayName
		  , PPT.ClientCode
		  , ACCT.AccountName
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , ACCT.SiteID
		  , SITE.SiteGUID
		  , SITE.SiteName
		  , SITE.SiteDisplayName
		  , EHIST.GroupName AS EligibilityGroupName
		  , EHIST.StartedDate AS EligibilityStartDate
		  , EHIST.EndedDate AS EligibilityEndDate
		  , GHIST.GroupName AS GroupName
		  , GHIST.StartedDate AS GroupStartDate
		  , GHIST.EndedDate AS GroupEndDate
	   FROM CMS_Role AS ROLES
				JOIN cms_MembershipRole AS MemberROLE
					ON ROLES.RoleID = MemberROLE.RoleID
				JOIN cms_MembershipUser AS MemberSHIP
					ON MemberROLE.MembershipID = MemberSHIP.MembershipID
				JOIN HFit_PPTEligibility AS PPT
					ON PPT.UserID = MemberSHIP.UserID
				JOIN CMS_USERSettings AS USERSET
					ON USERSET.UserSettingsUserID = PPT.UserID
				JOIN OM_ContactGroupMember AS GRPMBR
					ON GRPMBR.ContactGroupMemberRelatedID = USERSET.HFitPrimaryContactID
				JOIN OM_ContactGroup AS GRP
					ON GRP.ContactGroupID = GRPMBR.ContactGroupMemberContactGroupID
				JOIN HFit_ContactGroupMembership AS GroupMBR
					ON GroupMBR.cmsMembershipID = MemberSHIP.MembershipID

	 --LEFT OUTER JOIN [Hfit_Client] AS [CLIENT]
	 --ON [PPT].[ClientCode] = [CLIENT].[ClientName]

				LEFT OUTER JOIN HFit_Account AS ACCT
					ON ROLES.SiteID = ACCT.SiteID
				LEFT OUTER JOIN CMS_Site AS SITE
					ON SITE.SiteID = ACCT.SiteID
				LEFT OUTER JOIN view_EDW_EligibilityHistory AS EHIST
					ON EHIST.UserMpiNumber = USERSET.HFitUserMpiNumber
				LEFT OUTER JOIN EDW_GroupMemberHistory AS GHIST
					ON GHIST.UserMpiNumber = USERSET.HFitUserMpiNumber;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_Eligibility found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_EligibilityHistory') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_EligibilityHistory , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--************************************************************************************
--view_EDW_EligibilityHistory provides users access to the EDW_GroupMemberHistory table.
--************************************************************************************

CREATE VIEW view_EDW_EligibilityHistory
AS
	 SELECT
			GroupName
		  , UserMpiNumber
		  , StartedDate
		  , EndedDate
		  , RowNbr
	   FROM dbo.EDW_GroupMemberHistory;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_EligibilityHistory found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_HealthAssesment') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_HealthAssesment , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--select top 100 * from [view_EDW_HealthAssesment]

CREATE VIEW dbo.view_EDW_HealthAssesment
AS

	 --********************************************************************************************************
	 --7/15/2014 17:19 min. 46,750 Rows DEV
	 --7/15/2014 per Mark Turner
	 --HAModuleDocumentID is on its way out, so is - 
	 --Module - RiskCategory - RiskArea - Question - Answer 
	 --all the "DocumentID" fields are deprecated and replaced by corresponding NodeGUID fields
	 --8/7/2014 - Executed in DEV with GUID changes and returned 51K Rows in 00:43:10.
	 --8/8/2014 - Generated corrected view in DEV
	 -- Verified last mod date available to EDW 9.10.2014
	 --09.08.2014: John Croft and I working together, realized there is a deficit in the ability 
	 --of the EDW to recognize changes to database records based on the last modified date of a row. 
	 --The views that we are currently using in the database or deeply nested. This means that 
	 --several base tables are involved in building a single view of data.
	 --09.30.2014: Verified with John Croft that he does want this view to return multi-languages.
	 --
	 --The views were initially designed to recognize a date change based on a record change very 
	 --high in the data hierarchy, the CMS Tree level which is the top most level. However, John 
	 --and I recognize that data can change at any level in the hierarchy and those changes must be 
	 --recognized as well. Currently, that is not the case. With the new modification to the views, 
	 --changes in CMS documents and base tables will filter up through the hierarchy and the EDW load 
	 --process will be able to realize that a change in this rows data may affect and intrude into 
	 --the warehouse.
	 -- 10.01.2014 - Reviewed by Mark and Dale for use of the GUIDS
	 -- 10.01.2014 - Reviewed by Mark and Dale for use of Joins and fixed two that were incorrect (Thanks to Mark)
	 -- 10.23.2014 - (WDM) added two columns for the EDW HAPaperFlg / HATelephonicFlg
	 --			HAPaperFlg is whether the question was reveived electronically or on paper
	 --			HATelephonicFlg is whether the question was reveived by telephone or not
	 -- FIVE Pieces needed per John C. 10.16.2014
	 --	Document GUID -> HealthAssesmentUserStartedNodeGUID
	 --	Module GUID -> Module -> HAUserModule.HAModuleNodeGUID
	 --	Category GUID -> Category
	 --	RiskArea Node Guid -> RiskArea 
	 --	Question Node Guid -> Question
	 --	Answer Node Guid -> Answer 
	 --   10.30.2014 : Sowmiya 
	 --   The following are the possible values allowed in the HAStartedMode and HACompletedMode columns of the Hfit_HealthAssesmentUserStarted table
	 --      Unknown = 0, 
	 --       Paper = 1,  // Paper HA
	 --       Telephonic = 2, // Telephonic HA
	 --       Online = 3, // Online HA
	 --       Ipad = 4 // iPAD
	 -- 08/07/2014 - (WDM) as HAModuleDocumentID	--WDM 10.02.2014 place holder for EDW ETL per John C., Added back per John C. 10.16.2014
	 -- 09/30/2014 - (WDM) as HAModuleDocumentID	--Mark and Dale use NodeGUID instead of Doc GUID
	 --WDM 10.02.2014 place holder for EDW ETL
	 --Per John C. 10.16.2014 requested that this be put back into the view.	
	 --11.05.2014 - Changed from CMS_TREE Joined to View_HFit_HealthAssessment_Joined Mark T. / Dale M.
	 -- 11.05.2014 - Mark T. / Dale M. needed to get the Document for the user : ADDED inner join View_HFit_HealthAssessment_Joined as VHAJ on VHAJ.DocumentID = VHCJ.HealthAssessmentID
	 -- 11.05.2014 - removed the Distinct - may find it necessary to put it back as duplicates may be there. But the server resources required to do this may not be avail on P5.
	 --11.05.2014 - Mark T. / Dale M. removed the link to View_CMS_Tree_Joined and replaced with View_HFit_HealthAssessment_Joined
	 --inner join View_CMS_Tree_Joined as VCTJ on VCTJ.NodeGUID = HAUserModule.HAModuleNodeGUID
	 --	and VCTJ.DocumentCulture = ''en-US''	--10.01.2014 put here to match John C. req. for language agnostic.
	 -- 12.02.2014 - (wdm)Found that the view was being overwritten between Prod 1 and the copy of Prod 5 / Prod 1. Found a script inside a job on PRod 5 that reverted the view to a previous state. Removed the script and the view migrates correctly (d. miller and m. kimenski)
	 -- 12.02.2014 - (wdm) Found DUPS in Prod 1 and Prod 2, none in Prod 3. 
	 -- 12.17.2014 - Added two columns requested by the EDW team as noted by comments next to each column.
	 -- 12.29.2014 - Stripped HTML out of Title #47619
	 -- 12.31.2014 - Eliminated negative MPI''s in response to CR47516 
	 -- 01.02.2014 - Tested the removal of negative MPI''s in response to CR47516 
	 --01.27.2015 (WDM) #48941 - Add Client Identifier to View_EDW_Eligibility
	 --	   In analyzing this requirement, found that the PPT.ClientID is nvarchar (alphanumeric)
	 --	   and Hfit_Client.ClientID is integer. A bit of a domain/naming issue.
	 --	   This is NOT needed as the data is already contained in columns [AccountID] and [AccountCD]
	 --	   NOTE: Added the column [AccountName], just in case it were to be needed later.
	 --02.04.2015 (WDM) #48828 added:
	 --	    [HAUserStarted].[HACampaignNodeGUID], VCJ.BiometricCampaignStartDate
	 --	   , VCJ.BiometricCampaignEndDate, VCJ.CampaignStartDate
	 --	   , VCJ.CampaignEndDate, VCJ.Name as CampaignName, HACampaignID
	 --02.05.2015 Ashwin and I reviewed and approved
	 --********************************************************************************************************

	 SELECT
			HAUserStarted.ItemID AS UserStartedItemID
		  , VHAJ.NodeGUID AS HealthAssesmentUserStartedNodeGUID
		  , HAUserStarted.UserID
		  , CMSUser.UserGUID
		  , UserSettings.HFitUserMpiNumber
		  , CMSSite.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , ACCT.AccountName
		  , HAUserStarted.HAStartedDt
		  , HAUserStarted.HACompletedDt
		  , HAUserModule.ItemID AS UserModuleItemId
		  , HAUserModule.CodeName AS UserModuleCodeName
		  , HAUserModule.HAModuleNodeGUID
		  , VHAJ.NodeGUID AS CMSNodeGuid
		  , NULL AS HAModuleVersionID
		  , HARiskCategory.ItemID AS UserRiskCategoryItemID
		  , HARiskCategory.CodeName AS UserRiskCategoryCodeName
		  , HARiskCategory.HARiskCategoryNodeGUID

			--WDM 8/7/2014 as HARiskCategoryDocumentID

		  , NULL AS HARiskCategoryVersionID

			--WDM 10.02.2014 place holder for EDW ETL

		  , HAUserRiskArea.ItemID AS UserRiskAreaItemID
		  , HAUserRiskArea.CodeName AS UserRiskAreaCodeName
		  , HAUserRiskArea.HARiskAreaNodeGUID

			--WDM 8/7/2014 as HARiskAreaDocumentID

		  , NULL AS HARiskAreaVersionID

			--WDM 10.02.2014 place holder for EDW ETL

		  , HAUserQuestion.ItemID AS UserQuestionItemID
		  , dbo.udf_StripHTML (HAQuestionsView.Title) AS Title

			--WDM 47619 12.29.2014

		  , HAUserQuestion.HAQuestionNodeGUID AS HAQuestionGuid

			--WDM 9.2.2014	This is a repeat field but had to stay to match the previous view - this is the NODE GUID and matches to the definition file to get the question. This tells you the question, language agnostic.

		  , HAUserQuestion.CodeName AS UserQuestionCodeName
		  , NULL AS HAQuestionDocumentID

			--WDM 10.1.2014 - this is GOING AWAY 		--WDM 10.02.2014 place holder for EDW ETL

		  , NULL AS HAQuestionVersionID

			--WDM 10.1.2014 - this is GOING AWAY - no versions across environments 		--WDM 10.02.2014 place holder for EDW ETL

		  , HAUserQuestion.HAQuestionNodeGUID

			--WDM 10.01.2014	Left this in place to preserve column structure.		

		  , HAUserAnswers.ItemID AS UserAnswerItemID
		  , HAUserAnswers.HAAnswerNodeGUID

			--WDM 8/7/2014 as HAAnswerDocumentID

		  , NULL AS HAAnswerVersionID

			--WDM 10.1.2014 - this is GOING AWAY - no versions across environments		--WDM 10.02.2014 place holder for EDW ETL

		  , HAUserAnswers.CodeName AS UserAnswerCodeName
		  , HAUserAnswers.HAAnswerValue
		  , HAUserModule.HAModuleScore
		  , HARiskCategory.HARiskCategoryScore
		  , HAUserRiskArea.HARiskAreaScore
		  , HAUserQuestion.HAQuestionScore
		  , HAUserAnswers.HAAnswerPoints
		  , HAUserQuestionGroupResults.PointResults
		  , HAUserAnswers.UOMCode
		  , HAUserStarted.HAScore
		  , HAUserModule.PreWeightedScore AS ModulePreWeightedScore
		  , HARiskCategory.PreWeightedScore AS RiskCategoryPreWeightedScore
		  , HAUserRiskArea.PreWeightedScore AS RiskAreaPreWeightedScore
		  , HAUserQuestion.PreWeightedScore AS QuestionPreWeightedScore
		  , HAUserQuestionGroupResults.CodeName AS QuestionGroupCodeName
		  , CASE
				WHEN HAUserAnswers.ItemCreatedWhen = HAUserAnswers.ItemModifiedWhen
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HAUserAnswers.ItemCreatedWhen
		  , HAUserAnswers.ItemModifiedWhen
		  , HAUserQuestion.IsProfessionallyCollected
		  , HARiskCategory.ItemModifiedWhen AS HARiskCategory_ItemModifiedWhen
		  , HAUserRiskArea.ItemModifiedWhen AS HAUserRiskArea_ItemModifiedWhen
		  , HAUserQuestion.ItemModifiedWhen AS HAUserQuestion_ItemModifiedWhen
		  , HAUserAnswers.ItemModifiedWhen AS HAUserAnswers_ItemModifiedWhen
		  , HAUserStarted.HAPaperFlg
		  , HAUserStarted.HATelephonicFlg
		  , HAUserStarted.HAStartedMode

			--12.11.2014 WDM Sowmiya and dale talked and decided to implement this column 12.17.2014 - Added 

		  , HAUserStarted.HACompletedMode

			--12.11.2014 WDM Sowmiya and dale talked and decided to implement this column 12.17.2014 - Added 

		  , VHCJ.DocumentCulture AS DocumentCulture_VHCJ
		  , HAQuestionsView.DocumentCulture AS DocumentCulture_HAQuestionsView
		  , HAUserStarted.HACampaignNodeGUID AS CampaignNodeGUID

	 -- PER John C. 2.6.2015 - Please comment out all columns except the GUID in the Assesment view.  It will reduce the amount of data coming through the delta process.  Thank you
	 --, [VHCJ].BiometricCampaignStartDate
	 --, [VHCJ].BiometricCampaignEndDate
	 --, [VHCJ].CampaignStartDate
	 --, [VHCJ].CampaignEndDate
	 --, [VHCJ].Name as CampaignName 
	 --, [VHCJ].HACampaignID

/****************************************
--the below are need in this view 
, HACampaign.BiometricCampaignStartDate
, HACampaign.BiometricCampaignEndDate
, HACampaign.CampaignStartDate
, HACampaign.CampaignEndDate
, HACampaign.Name

or only the 
select * from HAUserStarted
, HACampaign.NodeGuid as CampaignNodeGuid
****************************************/

	   FROM dbo.HFit_HealthAssesmentUserStarted AS HAUserStarted
				INNER JOIN dbo.CMS_User AS CMSUser
					ON HAUserStarted.UserID = CMSUser.UserID
				INNER JOIN dbo.CMS_UserSettings AS UserSettings
					ON UserSettings.UserSettingsUserID = CMSUser.UserID
				   AND HFitUserMpiNumber >= 0
				   AND HFitUserMpiNumber IS NOT NULL

	 -- (WDM) CR47516 

				INNER JOIN dbo.CMS_UserSite AS UserSite
					ON CMSUser.UserID = UserSite.UserID
				INNER JOIN dbo.CMS_Site AS CMSSite
					ON UserSite.SiteID = CMSSite.SiteID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON ACCT.SiteID = CMSSite.SiteID
				INNER JOIN dbo.HFit_HealthAssesmentUserModule AS HAUserModule
					ON HAUserStarted.ItemID = HAUserModule.HAStartedItemID
				INNER JOIN View_HFit_HACampaign_Joined AS VHCJ
					ON VHCJ.NodeGUID = HAUserStarted.HACampaignNodeGUID
				   AND VHCJ.NodeSiteID = UserSite.SiteID
				   AND VHCJ.DocumentCulture = ''en-US''

	 --11.05.2014 - Mark T. / Dale M. - 

				INNER JOIN View_HFit_HealthAssessment_Joined AS VHAJ
					ON VHAJ.DocumentID = VHCJ.HealthAssessmentID
				INNER JOIN dbo.HFit_HealthAssesmentUserRiskCategory AS HARiskCategory
					ON HAUserModule.ItemID = HARiskCategory.HAModuleItemID
				INNER JOIN dbo.HFit_HealthAssesmentUserRiskArea AS HAUserRiskArea
					ON HARiskCategory.ItemID = HAUserRiskArea.HARiskCategoryItemID
				INNER JOIN dbo.HFit_HealthAssesmentUserQuestion AS HAUserQuestion
					ON HAUserRiskArea.ItemID = HAUserQuestion.HARiskAreaItemID
				INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS HAQuestionsView
					ON HAUserQuestion.HAQuestionNodeGUID = HAQuestionsView.NodeGUID
				   AND HAQuestionsView.DocumentCulture = ''en-US''
				LEFT OUTER JOIN dbo.HFit_HealthAssesmentUserQuestionGroupResults AS HAUserQuestionGroupResults
					ON HAUserRiskArea.ItemID = HAUserQuestionGroupResults.HARiskAreaItemID
				INNER JOIN dbo.HFit_HealthAssesmentUserAnswers AS HAUserAnswers
					ON HAUserQuestion.ItemID = HAUserAnswers.HAQuestionItemID

	   --left outer join View_HFit_HACampaign_Joined as VCJ 
	   --on VCJ.NodeGuid = [HAUserStarted].[HACampaignNodeGUID]

	   WHERE UserSettings.HFitUserMpiNumber NOT IN (
													SELECT
														   RejectMPICode
													  FROM HFit_LKP_EDW_RejectMPI) ;

--CMSUser.UserGUID not in  (Select RejectUserGUID from HFit_LKP_EDW_RejectMPI)	--61788DF7-955D-4A78-B77E-3DA340847AE7

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_HealthAssesment found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'View_EDW_HealthAssesmentAnswers') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW View_EDW_HealthAssesmentAnswers , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '

CREATE VIEW [dbo].[View_EDW_HealthAssesmentAnswers]
AS
--********************************************************************************************************
--WDM 8.8.2014 - Created this view in order to add the DocumentGUID as 
--			required by the EDW team. Was having a bit of push-back
--			from the developers, so created this one in order to 
--			expedite filling the need for runnable views for the EDW.
-- Verified last mod date available to EDW 9.10.2014
--********************************************************************************************************
      SELECT
        VHFHAPAJ.ClassName AS AnswerType
       ,VHFHAPAJ.Value
       ,VHFHAPAJ.Points
       ,VHFHAPAJ.NodeGUID
       ,VHFHAPAJ.IsEnabled
       ,VHFHAPAJ.CodeName
	   ,VHFHAPAJ.InputType
       ,VHFHAPAJ.UOM
       ,VHFHAPAJ.NodeAliasPath
       ,VHFHAPAJ.DocumentPublishedVersionHistoryID
       ,VHFHAPAJ.NodeID
       ,VHFHAPAJ.NodeOrder
       ,VHFHAPAJ.NodeLevel
       ,VHFHAPAJ.NodeParentID
       ,VHFHAPAJ.NodeLinkedNodeID
	   ,VHFHAPAJ.DocumentCulture
	   ,VHFHAPAJ.DocumentGuid
	   ,VHFHAPAJ.DocumentModifiedWhen
      FROM
        dbo.View_HFit_HealthAssesmentPredefinedAnswer_Joined AS VHFHAPAJ WITH(NOLOCK)
	where VHFHAPAJ.DocumentCulture = ''en-US''

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: View_EDW_HealthAssesmentAnswers found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_HealthAssesmentClientView') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_HealthAssesmentClientView , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--GRANT SELECT
--	ON [dbo].[view_EDW_HealthAssesmentClientView]
--	TO [EDWReader_PRD]
--GO
--******************************************************************************
--8/8/2014 - Generated corrected view in DEV (WDM)
--09.11.2014 (wdm) added to facilitate EDW last mod date
--02.04.2015 (wdm) #48828 added , HACampaign.BiometricCampaignStartDate, 
--		  HACampaign.BiometricCampaignEndDate, HACampaign.CampaignStartDate, 
--		  HACampaign.CampaignEndDate, HACampaign.Name, 
--		  HACampaign.NodeGuid as CampaignNodeGuid
--02.05.2015 Ashwin and I reviewed and approved
-- select top 100 * from view_EDW_HealthAssesmentClientView
--******************************************************************************

CREATE VIEW dbo.view_EDW_HealthAssesmentClientView
AS
	 SELECT
			HFitAcct.AccountID
		  , HFitAcct.AccountCD
		  , HFitAcct.AccountName
		  , HFitAcct.ItemGUID AS ClientGuid
		  , CMSSite.SiteGUID
		  , NULL AS CompanyID
		  , NULL AS CompanyGUID
		  , NULL AS CompanyName
		  , HAJoined.DocumentName
		  , HACampaign.DocumentPublishFrom AS HAStartDate
		  , HACampaign.DocumentPublishTo AS HAEndDate
		  , HACampaign.NodeSiteID
		  , HAAssessmentMod.Title
		  , HAAssessmentMod.CodeName
		  , HAAssessmentMod.IsEnabled
		  , CASE
				WHEN CAST (HACampaign.DocumentCreatedWhen AS date) = CAST (HACampaign.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HACampaign.DocumentCreatedWhen
		  , HACampaign.DocumentModifiedWhen
		  , HAAssessmentMod.DocumentModifiedWhen AS AssesmentModule_DocumentModifiedWhen

			--09.11.2014 (wdm) added to facilitate EDW last mod date

		  , HAAssessmentMod.DocumentCulture AS DocumentCulture_HAAssessmentMod
		  , HACampaign.DocumentCulture AS DocumentCulture_HACampaign
		  , HAJoined.DocumentCulture AS DocumentCulture_HAJoined
		  , HACampaign.BiometricCampaignStartDate
		  , HACampaign.BiometricCampaignEndDate
		  , HACampaign.CampaignStartDate
		  , HACampaign.CampaignEndDate
		  , HACampaign.Name
		  , HACampaign.NodeGuid AS CampaignNodeGuid
		  , HACampaign.HACampaignID
	   FROM dbo.View_HFit_HACampaign_Joined AS HACampaign
				INNER JOIN dbo.CMS_Site AS CMSSite
					ON HACampaign.NodeSiteID = CMSSite.SiteID
				INNER JOIN dbo.HFit_Account AS HFitAcct
					ON HACampaign.NodeSiteID = HFitAcct.SiteID
				INNER JOIN dbo.View_HFit_HealthAssessment_Joined AS HAJoined
					ON CASE
						   WHEN HACampaign.HealthAssessmentConfigurationID < 0
						   THEN HACampaign.HealthAssessmentID
						   ELSE HACampaign.HealthAssessmentConfigurationID
					   END = HAJoined.DocumentID
				   AND HAJoined.DocumentCulture = ''en-US''
				INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS HAAssessmentMod
					ON HAJoined.nodeid = HAAssessmentMod.NodeParentID
				   AND HAAssessmentMod.DocumentCulture = ''en-US''
	   WHERE HACampaign.DocumentCulture = ''en-US'';
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_HealthAssesmentClientView found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_HealthAssesmentDeffinition') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_HealthAssesmentDeffinition , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW dbo.view_EDW_HealthAssesmentDeffinition
AS
	 SELECT DISTINCT

	 --**************************************************************************************************************
	 --NOTE: The column DocumentModifiedWhen comes from the CMS_TREE join - it was left 
	 --		unchanged when other dates added for the Last Mod Date additions. 
	 --		Therefore, the ''ChangeType'' was left dependent upon this date only. 09.12.2014 (wdm)
	 --*****************************************************************************************************************************************************
	 --Test Queries:
	 --select * from view_EDW_HealthAssesmentDeffinition where AnsDocumentGuid is not NULL
	 --Changes:
	 --WDM - 6/25/2014
	 --Query was returning a NULL dataset. Found that it is being caused by the AccountCD join.
	 --Worked with Shane to discover the CMS Tree had been modified.
	 --Modified the code so that reads it reads the CMS tree correctly - working.
	 --7/14/2014 1:29 time to run - 79024 rows - DEV
	 --7/14/2014 0:58 time to run - 57472 rows - PROD1
	 --7/15/2014 - Query was returning NodeName of ''Campaigns'' only
	 --	Found the issue in view View_HFit_HACampaign_Joined. Documented the change in the view.
	 --7/16/2014 - Full Select: Using a DocumentModifiedWhen filter 00:17:28 - Record Cnt: 793,520
	 --8/7/2014 - Executed in DEV with GUID changes and returned 1.13M Rows in 23:14.
	 --8/8/2014 - Executed in DEV with GUID changes, new views, and returned 1.13M Rows in 20:16.
	 --8/8/2014 - Generated corrected view in DEV
	 --8/12/2014 - John C. explained that Account Code and Site Guid are not needed, NULLED
	 --				them out. With them in the QRY, returned 43104 rows, with them nulled
	 --				out, returned 43104 rows. Using a DISTINCT, 28736 rows returned and execution
	 --				time doubled approximately.
	 --				Has to add a DISTINCT to all the queries - .
	 --				Original Query 0:25 @ 43104
	 --				Original Query 0:46 @ 28736 (distinct)
	 --				Filter added - VHFHAQ.DocumentCulture 0:22 @ 14368
	 --				Filter added - and VHFHARCJ.DocumentCulture = ''en-us''	 0:06 @ 3568
	 --				Filter added - and VHFHARAJ.DocumentCulture = ''en-us''	 0:03 @ 1784
	 --8/12/2014 - Applied the language filters with John C. and performance improved, as expected,
	 --				such that when running the view in QA: 
	 --8/12/2014 - select * from [view_EDW_HealthAssesmentDeffinition] where DocumentModifiedWhen between ''2000-11-14'' and 
	 --				''2014-11-15'' now runs exceptionally fast
	 --08/12/2014 - ProdStaging 00:21:52 @ 2442
	 --08/12/2014 - ProdStaging 00:21:09 @ 13272 (UNION ALL   --UNION)
	 --08/12/2014 - ProdStaging 00:21:37 @ 13272 (UNION ONLY)
	 --08/12/2014 - ProdStaging 00:06:26 @ 1582 (UNION ONLY & Select Filters Added for Culture)
	 --08/12/2014 - ProdStaging 00:10:07 @ 6636 (UNION ALL   --UNION) and all selected
	 --08/12/2014 - ProdStaging added PI PI_View_CMS_Tree_Joined_Regular_DocumentCulture: 00:2:34 @ 6636 
	 --08/12/2014 - DEV 00:00:58 @ 3792
	 --09.11.2014 - (wdm) added the needed date fields to help EDW in determining the last mod date of a row.
	 --10.01.2014 - Dale and Mark reworked this view to use NodeGUIDS and eliminated the CMS_TREE View from participating as 
	 --				well as Site and Account data
	 --11.25.2014 - (wdm) added multi-select column capability. The values can be 0,1, NULL
	 --12.29.2014 - (wdm) Added HTML stripping to two columns #47619, the others mentioned already had stripping applied
	 --12.31.2014 - (wdm) Started the review to apply CR-47517: Eliminate Matrix Questions with NULL Answer GUID''s
	 --01.07.2014 - (wdm) 47619 The Health Assessment Definition interface view contains HTML tags - corrected with udf_StripHTML
	 --************************************************************************************************************************************************************

			NULL AS SiteGUID

			--cs.SiteGUID								--WDM 08.12.2014 per John C.

   , NULL AS AccountCD

			--, HFA.AccountCD						--WDM 08.07.2014 per John C.

   , HA.NodeID AS HANodeID

			--WDM 08.07.2014

   , HA.NodeName AS HANodeName

			--WDM 08.07.2014
			--, HA.DocumentID AS HADocumentID								--WDM 08.07.2014 commented out and left in place for history

   , NULL AS HADocumentID

			--WDM 08.07.2014; 09.29.2014: Mark and Dale discussed that NODEGUID should be used such that the multi-language/culture is not a problem.

   , HA.NodeSiteID AS HANodeSiteID

			--WDM 08.07.2014

   , HA.DocumentPublishedVersionHistoryID AS HADocPubVerID

			--WDM 08.07.2014

   , dbo.udf_StripHTML (VHFHAMJ.Title) AS ModTitle

			--WDM 47619

   , dbo.udf_StripHTML (LEFT (VHFHAMJ.IntroText, 4000)) AS IntroText

			--WDM 47619

   , VHFHAMJ.NodeGuid AS ModDocGuid

			--, VHFHAMJ.DocumentID AS ModDocID	--WDM 08.07.2014	M&D 10.01.2014

   , VHFHAMJ.Weight AS ModWeight
   , VHFHAMJ.IsEnabled AS ModIsEnabled
   , VHFHAMJ.CodeName AS ModCodeName
   , VHFHAMJ.DocumentPublishedVersionHistoryID AS ModDocPubVerID
   , dbo.udf_StripHTML (VHFHARCJ.Title) AS RCTitle

			--WDM 47619

   , VHFHARCJ.Weight AS RCWeight
   , VHFHARCJ.NodeGuid AS RCDocumentGUID

			--, VHFHARCJ.DocumentID AS RCDocumentID	--WDM 08.07.2014	M&D 10.01.2014

   , VHFHARCJ.IsEnabled AS RCIsEnabled
   , VHFHARCJ.CodeName AS RCCodeName
   , VHFHARCJ.DocumentPublishedVersionHistoryID AS RCDocPubVerID
   , dbo.udf_StripHTML (VHFHARAJ.Title) AS RATytle

			--WDM 47619

   , VHFHARAJ.Weight AS RAWeight
   , VHFHARAJ.NodeGuid AS RADocumentGuid

			--, VHFHARAJ.DocumentID AS RADocumentID	--WDM 08.07.2014	M&D 10.01.2014

   , VHFHARAJ.IsEnabled AS RAIsEnabled
   , VHFHARAJ.CodeName AS RACodeName
   , VHFHARAJ.ScoringStrategyID AS RAScoringStrategyID
   , VHFHARAJ.DocumentPublishedVersionHistoryID AS RADocPubVerID
   , VHFHAQ.QuestionType
   , dbo.udf_StripHTML (LEFT (VHFHAQ.Title, 4000)) AS QuesTitle

			--WDM 47619

   , VHFHAQ.Weight AS QuesWeight
   , VHFHAQ.IsRequired AS QuesIsRequired

			--, VHFHAQ.DocumentGuid AS QuesDocumentGuid	--, VHFHAQ.DocumentID AS QuesDocumentID	--WDM 08.07.2014	M&D 10.01.2014

   , VHFHAQ.NodeGuid AS QuesDocumentGuid

			--, VHFHAQ.DocumentID AS QuesDocumentID	--WDM 08.07.2014

   , VHFHAQ.IsEnabled AS QuesIsEnabled
   , LEFT (VHFHAQ.IsVisible, 4000) AS QuesIsVisible
   , VHFHAQ.IsStaging AS QuesIsSTaging
   , VHFHAQ.CodeName AS QuestionCodeName
   , VHFHAQ.DocumentPublishedVersionHistoryID AS QuesDocPubVerID
   , VHFHAA.Value AS AnsValue
   , VHFHAA.Points AS AnsPoints
   , VHFHAA.NodeGuid AS AnsDocumentGuid

			--ref: #47517

   , VHFHAA.IsEnabled AS AnsIsEnabled
   , VHFHAA.CodeName AS AnsCodeName
   , VHFHAA.UOM AS AnsUOM
   , VHFHAA.DocumentPublishedVersionHistoryID AS AnsDocPUbVerID
   , CASE
		 WHEN CAST (HA.DocumentCreatedWhen AS date) = CAST (HA.DocumentModifiedWhen AS date) 
		 THEN ''I''
		 ELSE ''U''
	 END AS ChangeType
   , HA.DocumentCreatedWhen
   , HA.DocumentModifiedWhen
   , HA.NodeGuid AS CmsTreeNodeGuid

			--WDM 08.07.2014 ADDED TO the returned Columns

   , HA.NodeGUID AS HANodeGUID

			--, NULL as SiteLastModified

   , NULL AS SiteLastModified

			--, NULL as Account_ItemModifiedWhen

   , NULL AS Account_ItemModifiedWhen

			--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen

   , NULL AS Campaign_DocumentModifiedWhen
   , HA.DocumentModifiedWhen AS Assessment_DocumentModifiedWhen
   , VHFHAMJ.DocumentModifiedWhen AS Module_DocumentModifiedWhen
   , VHFHARCJ.DocumentModifiedWhen AS RiskCategory_DocumentModifiedWhen
   , VHFHARAJ.DocumentModifiedWhen AS RiskArea_DocumentModifiedWhen
   , VHFHAQ.DocumentModifiedWhen AS Question_DocumentModifiedWhen
   , VHFHAA.DocumentModifiedWhen AS Answer_DocumentModifiedWhen
   , HAMCQ.AllowMultiSelect
   , ''SID01'' AS LocID
	   FROM

	 --dbo.View_CMS_Tree_Joined AS VCTJ
	 --INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 --INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 --Campaign links Client which links to Assessment
	 --INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 

	 View_HFit_HealthAssessment_Joined AS HA WITH (NOLOCK) 
		 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
			 ON HA.NodeID = VHFHAMJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
			 ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
			 ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ
			 ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA
			 ON VHFHAQ.NodeID = VHFHAA.NodeParentID
		 LEFT OUTER JOIN View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS HAMCQ
			 ON VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = ''en-US''
	   WHERE VHFHAQ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND (VHFHAA.DocumentCulture = ''en-us''
		   OR VHFHAA.DocumentCulture IS NULL) 

			 --WDM 08.12.2014		

		 AND VHFHARCJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHARAJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHAMJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND HA.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND VHFHAA.NodeGuid IS NOT NULL

	 --ref: #47517

	 UNION ALL

	 --UNION
	 --WDM Retrieve Matrix Level 1 Question Group

	 SELECT DISTINCT
			NULL AS SiteGUID

			--cs.SiteGUID		--WDM 08.12.2014

		  , NULL AS AccountCD

			--, HFA.AccountCD												--WDM 08.07.2014

		  , HA.NodeID

			--WDM 08.07.2014

		  , HA.NodeName

			--WDM 08.07.2014

		  , NULL AS HADocumentID

			--WDM 08.07.2014

		  , HA.NodeSiteID

			--WDM 08.07.2014
			--,VCTJ.NodeAliasPath

		  , HA.DocumentPublishedVersionHistoryID

			--WDM 08.07.2014

		  , dbo.udf_StripHTML (VHFHAMJ.Title) 

			--WDM 47619

		  , dbo.udf_StripHTML (LEFT (LEFT (VHFHAMJ.IntroText, 4000) , 4000)) AS IntroText

			--WDM 47619

		  , VHFHAMJ.NodeGuid
		  , VHFHAMJ.Weight
		  , VHFHAMJ.IsEnabled
		  , VHFHAMJ.CodeName

			--,VHFHAMJ.NodeAliasPath

		  , VHFHAMJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARCJ.Title) 

			--WDM 47619

		  , VHFHARCJ.Weight
		  , VHFHARCJ.NodeGuid
		  , VHFHARCJ.IsEnabled
		  , VHFHARCJ.CodeName

			--,VHFHARCJ.NodeAliasPath

		  , VHFHARCJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARAJ.Title) 

			--WDM 47619

		  , VHFHARAJ.Weight
		  , VHFHARAJ.NodeGuid
		  , VHFHARAJ.IsEnabled
		  , VHFHARAJ.CodeName

			--,VHFHARAJ.NodeAliasPath

		  , VHFHARAJ.ScoringStrategyID
		  , VHFHARAJ.DocumentPublishedVersionHistoryID
		  , VHFHAQ2.QuestionType
		  , dbo.udf_StripHTML (LEFT (VHFHAQ2.Title, 4000)) AS QuesTitle

			--WDM 47619

		  , VHFHAQ2.Weight
		  , VHFHAQ2.IsRequired
		  , VHFHAQ2.NodeGuid
		  , VHFHAQ2.IsEnabled
		  , LEFT (VHFHAQ2.IsVisible, 4000) 
		  , VHFHAQ2.IsStaging
		  , VHFHAQ2.CodeName AS QuestionCodeName

			--,VHFHAQ2.NodeAliasPath

		  , VHFHAQ2.DocumentPublishedVersionHistoryID
		  , VHFHAA2.Value
		  , VHFHAA2.Points
		  , VHFHAA2.NodeGuid

			--ref: #47517

		  , VHFHAA2.IsEnabled
		  , VHFHAA2.CodeName
		  , VHFHAA2.UOM

			--,VHFHAA2.NodeAliasPath

		  , VHFHAA2.DocumentPublishedVersionHistoryID
		  , CASE
				WHEN CAST (HA.DocumentCreatedWhen AS date) = CAST (HA.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HA.DocumentCreatedWhen
		  , HA.DocumentModifiedWhen
		  , HA.NodeGuid AS CmsTreeNodeGuid

			--WDM 08.07.2014

		  , HA.NodeGUID AS HANodeGUID
		  , NULL AS SiteLastModified
		  , NULL AS Account_ItemModifiedWhen

			--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen

		  , NULL AS Campaign_DocumentModifiedWhen
		  , HA.DocumentModifiedWhen AS Assessment_DocumentModifiedWhen
		  , VHFHAMJ.DocumentModifiedWhen AS Module_DocumentModifiedWhen
		  , VHFHARCJ.DocumentModifiedWhen AS RiskCategory_DocumentModifiedWhen
		  , VHFHARAJ.DocumentModifiedWhen AS RiskArea_DocumentModifiedWhen
		  , VHFHAQ.DocumentModifiedWhen AS Question_DocumentModifiedWhen
		  , VHFHAA.DocumentModifiedWhen AS Answer_DocumentModifiedWhen
		  , HAMCQ.AllowMultiSelect
		  , ''SID02'' AS LocID
	   FROM

	 --dbo.View_CMS_Tree_Joined AS VCTJ
	 --INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 --INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 --Campaign links Client which links to Assessment
	 --INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 

	 View_HFit_HealthAssessment_Joined AS HA WITH (NOLOCK) 
		 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
			 ON HA.NodeID = VHFHAMJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
			 ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
			 ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ
			 ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA
			 ON VHFHAQ.NodeID = VHFHAA.NodeParentID

	 --matrix level 1 questiongroup

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2
			 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2
			 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
		 LEFT OUTER JOIN View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS HAMCQ
			 ON VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = ''en-US''
	   WHERE VHFHAQ.DocumentCulture = ''en-us''
		 AND (VHFHAA.DocumentCulture = ''en-us''
		   OR VHFHAA.DocumentCulture IS NULL) 

			 --WDM 08.12.2014		

		 AND VHFHARCJ.DocumentCulture = ''en-us''
		 AND VHFHARAJ.DocumentCulture = ''en-us''
		 AND VHFHAMJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND HA.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHAA2.NodeGuid IS NOT NULL

	 --ref: #47517

	 UNION ALL

	 --UNION
	 --WDM Retrieve Branching Level 1 Question and Matrix Level 1 Question Group

	 SELECT DISTINCT
			NULL AS SiteGUID

			--cs.SiteGUID		--WDM 08.12.2014

		  , NULL AS AccountCD

			--, HFA.AccountCD												--WDM 08.07.2014

		  , HA.NodeID

			--WDM 08.07.2014

		  , HA.NodeName

			--WDM 08.07.2014

		  , NULL AS HADocumentID

			--WDM 08.07.2014

		  , HA.NodeSiteID

			--WDM 08.07.2014
			--,VCTJ.NodeAliasPath

		  , HA.DocumentPublishedVersionHistoryID

			--WDM 08.07.2014

		  , dbo.udf_StripHTML (VHFHAMJ.Title) 
		  , dbo.udf_StripHTML (LEFT (VHFHAMJ.IntroText, 4000)) AS IntroText
		  , VHFHAMJ.NodeGuid
		  , VHFHAMJ.Weight
		  , VHFHAMJ.IsEnabled
		  , VHFHAMJ.CodeName

			--,VHFHAMJ.NodeAliasPath

		  , VHFHAMJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARCJ.Title) 
		  , VHFHARCJ.Weight
		  , VHFHARCJ.NodeGuid
		  , VHFHARCJ.IsEnabled
		  , VHFHARCJ.CodeName

			--,VHFHARCJ.NodeAliasPath

		  , VHFHARCJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARAJ.Title) 
		  , VHFHARAJ.Weight
		  , VHFHARAJ.NodeGuid
		  , VHFHARAJ.IsEnabled
		  , VHFHARAJ.CodeName

			--,VHFHARAJ.NodeAliasPath

		  , VHFHARAJ.ScoringStrategyID
		  , VHFHARAJ.DocumentPublishedVersionHistoryID
		  , VHFHAQ3.QuestionType
		  , dbo.udf_StripHTML (LEFT (VHFHAQ3.Title, 4000)) AS QuesTitle
		  , VHFHAQ3.Weight
		  , VHFHAQ3.IsRequired
		  , VHFHAQ3.NodeGuid
		  , VHFHAQ3.IsEnabled
		  , LEFT (VHFHAQ3.IsVisible, 4000) 
		  , VHFHAQ3.IsStaging
		  , VHFHAQ3.CodeName AS QuestionCodeName

			--,VHFHAQ3.NodeAliasPath

		  , VHFHAQ3.DocumentPublishedVersionHistoryID
		  , VHFHAA3.Value
		  , VHFHAA3.Points
		  , VHFHAA3.NodeGuid

			--ref: #47517

		  , VHFHAA3.IsEnabled
		  , VHFHAA3.CodeName
		  , VHFHAA3.UOM

			--,VHFHAA3.NodeAliasPath

		  , VHFHAA3.DocumentPublishedVersionHistoryID
		  , CASE
				WHEN CAST (HA.DocumentCreatedWhen AS date) = CAST (HA.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HA.DocumentCreatedWhen
		  , HA.DocumentModifiedWhen
		  , HA.NodeGuid AS CmsTreeNodeGuid

			--WDM 08.07.2014

		  , HA.NodeGUID AS HANodeGUID
		  , NULL AS SiteLastModified
		  , NULL AS Account_ItemModifiedWhen

			--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen

		  , NULL AS Campaign_DocumentModifiedWhen
		  , HA.DocumentModifiedWhen AS Assessment_DocumentModifiedWhen
		  , VHFHAMJ.DocumentModifiedWhen AS Module_DocumentModifiedWhen
		  , VHFHARCJ.DocumentModifiedWhen AS RiskCategory_DocumentModifiedWhen
		  , VHFHARAJ.DocumentModifiedWhen AS RiskArea_DocumentModifiedWhen
		  , VHFHAQ.DocumentModifiedWhen AS Question_DocumentModifiedWhen
		  , VHFHAA.DocumentModifiedWhen AS Answer_DocumentModifiedWhen
		  , HAMCQ.AllowMultiSelect
		  , ''SID03'' AS LocID
	   FROM

	 --dbo.View_CMS_Tree_Joined AS VCTJ
	 --INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 --INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 --Campaign links Client which links to Assessment
	 --INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 

	 View_HFit_HealthAssessment_Joined AS HA WITH (NOLOCK) 
		 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
			 ON HA.NodeID = VHFHAMJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
			 ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
			 ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ
			 ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA
			 ON VHFHAQ.NodeID = VHFHAA.NodeParentID

	 --matrix level 1 questiongroup
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
	 --Branching Level 1 Question 

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3
			 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3
			 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID
		 LEFT OUTER JOIN View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS HAMCQ
			 ON VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = ''en-US''
	   WHERE VHFHAQ.DocumentCulture = ''en-us''
		 AND (VHFHAA.DocumentCulture = ''en-us''
		   OR VHFHAA.DocumentCulture IS NULL) 

			 --WDM 08.12.2014		

		 AND VHFHARCJ.DocumentCulture = ''en-us''
		 AND VHFHARAJ.DocumentCulture = ''en-us''
		 AND VHFHAMJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND HA.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHAA3.NodeGuid IS NOT NULL

	 --ref: #47517

	 UNION ALL

	 --UNION
	 --WDM Retrieve Branching Level 1 Question and Matrix Level 2 Question Group

	 SELECT DISTINCT
			NULL AS SiteGUID

			--cs.SiteGUID		--WDM 08.12.2014

		  , NULL AS AccountCD

			--, HFA.AccountCD												--WDM 08.07.2014

		  , HA.NodeID

			--WDM 08.07.2014

		  , HA.NodeName

			--WDM 08.07.2014

		  , NULL AS HADocumentID

			--WDM 08.07.2014

		  , HA.NodeSiteID

			--WDM 08.07.2014
			--,VCTJ.NodeAliasPath

		  , HA.DocumentPublishedVersionHistoryID

			--WDM 08.07.2014

		  , dbo.udf_StripHTML (VHFHAMJ.Title) 
		  , dbo.udf_StripHTML (LEFT (VHFHAMJ.IntroText, 4000)) AS IntroText
		  , VHFHAMJ.NodeGuid
		  , VHFHAMJ.Weight
		  , VHFHAMJ.IsEnabled
		  , VHFHAMJ.CodeName

			--,VHFHAMJ.NodeAliasPath

		  , VHFHAMJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARCJ.Title) 
		  , VHFHARCJ.Weight
		  , VHFHARCJ.NodeGuid
		  , VHFHARCJ.IsEnabled
		  , VHFHARCJ.CodeName

			--,VHFHARCJ.NodeAliasPath

		  , VHFHARCJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARAJ.Title) 
		  , VHFHARAJ.Weight
		  , VHFHARAJ.NodeGuid
		  , VHFHARAJ.IsEnabled
		  , VHFHARAJ.CodeName

			--,VHFHARAJ.NodeAliasPath

		  , VHFHARAJ.ScoringStrategyID
		  , VHFHARAJ.DocumentPublishedVersionHistoryID
		  , VHFHAQ7.QuestionType
		  , dbo.udf_StripHTML (LEFT (VHFHAQ7.Title, 4000)) AS QuesTitle
		  , VHFHAQ7.Weight
		  , VHFHAQ7.IsRequired
		  , VHFHAQ7.NodeGuid
		  , VHFHAQ7.IsEnabled
		  , LEFT (VHFHAQ7.IsVisible, 4000) 
		  , VHFHAQ7.IsStaging
		  , VHFHAQ7.CodeName AS QuestionCodeName

			--,VHFHAQ7.NodeAliasPath

		  , VHFHAQ7.DocumentPublishedVersionHistoryID
		  , VHFHAA7.Value
		  , VHFHAA7.Points
		  , VHFHAA7.NodeGuid

			--ref: #47517

		  , VHFHAA7.IsEnabled
		  , VHFHAA7.CodeName
		  , VHFHAA7.UOM

			--,VHFHAA7.NodeAliasPath

		  , VHFHAA7.DocumentPublishedVersionHistoryID
		  , CASE
				WHEN CAST (HA.DocumentCreatedWhen AS date) = CAST (HA.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HA.DocumentCreatedWhen
		  , HA.DocumentModifiedWhen
		  , HA.NodeGuid AS CmsTreeNodeGuid

			--WDM 08.07.2014

		  , HA.NodeGUID AS HANodeGUID
		  , NULL AS SiteLastModified
		  , NULL AS Account_ItemModifiedWhen

			--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen

		  , NULL AS Campaign_DocumentModifiedWhen
		  , HA.DocumentModifiedWhen AS Assessment_DocumentModifiedWhen
		  , VHFHAMJ.DocumentModifiedWhen AS Module_DocumentModifiedWhen
		  , VHFHARCJ.DocumentModifiedWhen AS RiskCategory_DocumentModifiedWhen
		  , VHFHARAJ.DocumentModifiedWhen AS RiskArea_DocumentModifiedWhen
		  , VHFHAQ.DocumentModifiedWhen AS Question_DocumentModifiedWhen
		  , VHFHAA.DocumentModifiedWhen AS Answer_DocumentModifiedWhen
		  , HAMCQ.AllowMultiSelect
		  , ''SID04'' AS LocID
	   FROM

	 --dbo.View_CMS_Tree_Joined AS VCTJ
	 --INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 --INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 --Campaign links Client which links to Assessment
	 --INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 

	 View_HFit_HealthAssessment_Joined AS HA WITH (NOLOCK) 
		 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
			 ON HA.NodeID = VHFHAMJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
			 ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
			 ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ
			 ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA
			 ON VHFHAQ.NodeID = VHFHAA.NodeParentID

	 --matrix level 1 questiongroup
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
	 --Branching Level 1 Question 

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3
			 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID

	 --LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID
	 --Matrix Level 2 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7
			 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7
			 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID
		 LEFT OUTER JOIN View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS HAMCQ
			 ON VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = ''en-US''
	   WHERE VHFHAQ.DocumentCulture = ''en-us''
		 AND (VHFHAA.DocumentCulture = ''en-us''
		   OR VHFHAA.DocumentCulture IS NULL) 

			 --WDM 08.12.2014		

		 AND VHFHARCJ.DocumentCulture = ''en-us''
		 AND VHFHARAJ.DocumentCulture = ''en-us''
		 AND VHFHAMJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND HA.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHAA7.NodeGuid IS NOT NULL

	 --ref: #47517

	 UNION ALL

	 --UNION
	 --****************************************************
	 --WDM 6/25/2014 Retrieve the Branching level 1 Question Group
	 --THE PROBLEM LIES HERE in this part of query : 1:40 minute
	 -- Added two perf indexes to the first query: 25 Sec
	 --****************************************************

	 SELECT DISTINCT
			NULL AS SiteGUID

			--cs.SiteGUID		--WDM 08.12.2014

		  , NULL AS AccountCD

			--, HFA.AccountCD												--WDM 08.07.2014

		  , HA.NodeID

			--WDM 08.07.2014

		  , HA.NodeName

			--WDM 08.07.2014

		  , NULL AS HADocumentID

			--WDM 08.07.2014

		  , HA.NodeSiteID

			--WDM 08.07.2014
			--,VCTJ.NodeAliasPath

		  , HA.DocumentPublishedVersionHistoryID

			--WDM 08.07.2014

		  , dbo.udf_StripHTML (VHFHAMJ.Title) 
		  , dbo.udf_StripHTML (LEFT (VHFHAMJ.IntroText, 4000)) AS IntroText
		  , VHFHAMJ.NodeGuid
		  , VHFHAMJ.Weight
		  , VHFHAMJ.IsEnabled
		  , VHFHAMJ.CodeName

			--,VHFHAMJ.NodeAliasPath

		  , VHFHAMJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARCJ.Title) 
		  , VHFHARCJ.Weight
		  , VHFHARCJ.NodeGuid
		  , VHFHARCJ.IsEnabled
		  , VHFHARCJ.CodeName

			--,VHFHARCJ.NodeAliasPath

		  , VHFHARCJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARAJ.Title) 
		  , VHFHARAJ.Weight
		  , VHFHARAJ.NodeGuid
		  , VHFHARAJ.IsEnabled
		  , VHFHARAJ.CodeName

			--,VHFHARAJ.NodeAliasPath

		  , VHFHARAJ.ScoringStrategyID
		  , VHFHARAJ.DocumentPublishedVersionHistoryID
		  , VHFHAQ8.QuestionType
		  , dbo.udf_StripHTML (LEFT (VHFHAQ8.Title, 4000)) AS QuesTitle
		  , VHFHAQ8.Weight
		  , VHFHAQ8.IsRequired
		  , VHFHAQ8.NodeGuid
		  , VHFHAQ8.IsEnabled
		  , LEFT (VHFHAQ8.IsVisible, 4000) 
		  , VHFHAQ8.IsStaging
		  , VHFHAQ8.CodeName AS QuestionCodeName

			--,VHFHAQ8.NodeAliasPath

		  , VHFHAQ8.DocumentPublishedVersionHistoryID
		  , VHFHAA8.Value
		  , VHFHAA8.Points
		  , VHFHAA8.NodeGuid

			--ref: #47517

		  , VHFHAA8.IsEnabled
		  , VHFHAA8.CodeName
		  , VHFHAA8.UOM

			--,VHFHAA8.NodeAliasPath

		  , VHFHAA8.DocumentPublishedVersionHistoryID
		  , CASE
				WHEN CAST (HA.DocumentCreatedWhen AS date) = CAST (HA.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HA.DocumentCreatedWhen
		  , HA.DocumentModifiedWhen
		  , HA.NodeGuid AS CmsTreeNodeGuid

			--WDM 08.07.2014

		  , HA.NodeGUID AS HANodeGUID
		  , NULL AS SiteLastModified
		  , NULL AS Account_ItemModifiedWhen

			--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen

		  , NULL AS Campaign_DocumentModifiedWhen
		  , HA.DocumentModifiedWhen AS Assessment_DocumentModifiedWhen
		  , VHFHAMJ.DocumentModifiedWhen AS Module_DocumentModifiedWhen
		  , VHFHARCJ.DocumentModifiedWhen AS RiskCategory_DocumentModifiedWhen
		  , VHFHARAJ.DocumentModifiedWhen AS RiskArea_DocumentModifiedWhen
		  , VHFHAQ.DocumentModifiedWhen AS Question_DocumentModifiedWhen
		  , VHFHAA.DocumentModifiedWhen AS Answer_DocumentModifiedWhen
		  , HAMCQ.AllowMultiSelect
		  , ''SID05'' AS LocID
	   FROM

	 --dbo.View_CMS_Tree_Joined AS VCTJ
	 --INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 --INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 --Campaign links Client which links to Assessment
	 --INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 

	 View_HFit_HealthAssessment_Joined AS HA WITH (NOLOCK) 
		 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
			 ON HA.NodeID = VHFHAMJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
			 ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
			 ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ
			 ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA
			 ON VHFHAQ.NodeID = VHFHAA.NodeParentID

	 --matrix level 1 questiongroup
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
	 --Branching Level 1 Question 

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3
			 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID

	 --LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID
	 --Matrix Level 2 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7
			 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7
			 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

	 --Matrix branching level 1 question group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8
			 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8
			 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID
		 LEFT OUTER JOIN View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS HAMCQ
			 ON VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = ''en-US''
	   WHERE VHFHAQ.DocumentCulture = ''en-us''
		 AND (VHFHAA.DocumentCulture = ''en-us''
		   OR VHFHAA.DocumentCulture IS NULL) 

			 --WDM 08.12.2014		

		 AND VHFHARCJ.DocumentCulture = ''en-us''
		 AND VHFHARAJ.DocumentCulture = ''en-us''
		 AND VHFHAMJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND HA.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHAA8.NodeGuid IS NOT NULL

	 --ref: #47517

	 UNION ALL

	 --UNION
	 --****************************************************
	 --WDM 6/25/2014 Retrieve the Branching level 2 Question Group
	 --THE PROBLEM LIES HERE in this part of query : 1:48  minutes
	 --With the new indexes: 29 Secs
	 --****************************************************

	 SELECT DISTINCT
			NULL AS SiteGUID

			--cs.SiteGUID		--WDM 08.12.2014

		  , NULL AS AccountCD

			--, HFA.AccountCD												--WDM 08.07.2014

		  , HA.NodeID

			--WDM 08.07.2014

		  , HA.NodeName

			--WDM 08.07.2014

		  , NULL AS HADocumentID

			--WDM 08.07.2014

		  , HA.NodeSiteID

			--WDM 08.07.2014
			--,VCTJ.NodeAliasPath

		  , HA.DocumentPublishedVersionHistoryID

			--WDM 08.07.2014

		  , dbo.udf_StripHTML (VHFHAMJ.Title) 
		  , dbo.udf_StripHTML (LEFT (VHFHAMJ.IntroText, 4000)) AS IntroText
		  , VHFHAMJ.NodeGuid
		  , VHFHAMJ.Weight
		  , VHFHAMJ.IsEnabled
		  , VHFHAMJ.CodeName

			--,VHFHAMJ.NodeAliasPath

		  , VHFHAMJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARCJ.Title) 
		  , VHFHARCJ.Weight
		  , VHFHARCJ.NodeGuid
		  , VHFHARCJ.IsEnabled
		  , VHFHARCJ.CodeName

			--,VHFHARCJ.NodeAliasPath

		  , VHFHARCJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARAJ.Title) 
		  , VHFHARAJ.Weight
		  , VHFHARAJ.NodeGuid
		  , VHFHARAJ.IsEnabled
		  , VHFHARAJ.CodeName

			--,VHFHARAJ.NodeAliasPath

		  , VHFHARAJ.ScoringStrategyID
		  , VHFHARAJ.DocumentPublishedVersionHistoryID
		  , VHFHAQ4.QuestionType
		  , dbo.udf_StripHTML (LEFT (VHFHAQ4.Title, 4000)) AS QuesTitle
		  , VHFHAQ4.Weight
		  , VHFHAQ4.IsRequired
		  , VHFHAQ4.NodeGuid
		  , VHFHAQ4.IsEnabled
		  , LEFT (VHFHAQ4.IsVisible, 4000) 
		  , VHFHAQ4.IsStaging
		  , VHFHAQ4.CodeName AS QuestionCodeName

			--,VHFHAQ4.NodeAliasPath

		  , VHFHAQ4.DocumentPublishedVersionHistoryID
		  , VHFHAA4.Value
		  , VHFHAA4.Points
		  , VHFHAA4.NodeGuid

			--ref: #47517

		  , VHFHAA4.IsEnabled
		  , VHFHAA4.CodeName
		  , VHFHAA4.UOM

			--,VHFHAA4.NodeAliasPath

		  , VHFHAA4.DocumentPublishedVersionHistoryID
		  , CASE
				WHEN CAST (HA.DocumentCreatedWhen AS date) = CAST (HA.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HA.DocumentCreatedWhen
		  , HA.DocumentModifiedWhen
		  , HA.NodeGuid AS CmsTreeNodeGuid

			--WDM 08.07.2014

		  , HA.NodeGUID AS HANodeGUID
		  , NULL AS SiteLastModified
		  , NULL AS Account_ItemModifiedWhen

			--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen

		  , NULL AS Campaign_DocumentModifiedWhen
		  , HA.DocumentModifiedWhen AS Assessment_DocumentModifiedWhen
		  , VHFHAMJ.DocumentModifiedWhen AS Module_DocumentModifiedWhen
		  , VHFHARCJ.DocumentModifiedWhen AS RiskCategory_DocumentModifiedWhen
		  , VHFHARAJ.DocumentModifiedWhen AS RiskArea_DocumentModifiedWhen
		  , VHFHAQ.DocumentModifiedWhen AS Question_DocumentModifiedWhen
		  , VHFHAA.DocumentModifiedWhen AS Answer_DocumentModifiedWhen
		  , HAMCQ.AllowMultiSelect
		  , ''SID06'' AS LocID
	   FROM

	 --dbo.View_CMS_Tree_Joined AS VCTJ
	 --INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 --INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 --Campaign links Client which links to Assessment
	 --INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 

	 View_HFit_HealthAssessment_Joined AS HA WITH (NOLOCK) 
		 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
			 ON HA.NodeID = VHFHAMJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
			 ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
			 ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ
			 ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA
			 ON VHFHAQ.NodeID = VHFHAA.NodeParentID

	 --matrix level 1 questiongroup
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
	 --Branching Level 1 Question 

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3
			 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3
			 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

	 --Matrix Level 2 Question Group
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID
	 --Matrix branching level 1 question group
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID
	 --Branching level 2 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4
			 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4
			 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID
		 LEFT OUTER JOIN View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS HAMCQ
			 ON VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = ''en-US''
	   WHERE VHFHAQ.DocumentCulture = ''en-us''
		 AND (VHFHAA.DocumentCulture = ''en-us''
		   OR VHFHAA.DocumentCulture IS NULL) 

			 --WDM 08.12.2014		

		 AND VHFHARCJ.DocumentCulture = ''en-us''
		 AND VHFHARAJ.DocumentCulture = ''en-us''
		 AND VHFHAMJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND HA.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHAA4.NodeGuid IS NOT NULL

	 --ref: #47517

	 UNION ALL

	 --UNION
	 --WDM 6/25/2014 Retrieve the Branching level 3 Question Group

	 SELECT DISTINCT
			NULL AS SiteGUID

			--cs.SiteGUID		--WDM 08.12.2014

		  , NULL AS AccountCD

			--, HFA.AccountCD												--WDM 08.07.2014

		  , HA.NodeID

			--WDM 08.07.2014

		  , HA.NodeName

			--WDM 08.07.2014

		  , NULL AS HADocumentID

			--WDM 08.07.2014

		  , HA.NodeSiteID

			--WDM 08.07.2014
			--,VCTJ.NodeAliasPath

		  , HA.DocumentPublishedVersionHistoryID

			--WDM 08.07.2014

		  , dbo.udf_StripHTML (VHFHAMJ.Title) 
		  , dbo.udf_StripHTML (LEFT (VHFHAMJ.IntroText, 4000)) AS IntroText
		  , VHFHAMJ.NodeGuid
		  , VHFHAMJ.Weight
		  , VHFHAMJ.IsEnabled
		  , VHFHAMJ.CodeName

			--,VHFHAMJ.NodeAliasPath

		  , VHFHAMJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARCJ.Title) 
		  , VHFHARCJ.Weight
		  , VHFHARCJ.NodeGuid
		  , VHFHARCJ.IsEnabled
		  , VHFHARCJ.CodeName

			--,VHFHARCJ.NodeAliasPath

		  , VHFHARCJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARAJ.Title) 
		  , VHFHARAJ.Weight
		  , VHFHARAJ.NodeGuid
		  , VHFHARAJ.IsEnabled
		  , VHFHARAJ.CodeName

			--,VHFHARAJ.NodeAliasPath

		  , VHFHARAJ.ScoringStrategyID
		  , VHFHARAJ.DocumentPublishedVersionHistoryID
		  , VHFHAQ5.QuestionType
		  , dbo.udf_StripHTML (LEFT (VHFHAQ5.Title, 4000)) AS QuesTitle
		  , VHFHAQ5.Weight
		  , VHFHAQ5.IsRequired
		  , VHFHAQ5.NodeGuid
		  , VHFHAQ5.IsEnabled
		  , LEFT (VHFHAQ5.IsVisible, 4000) 
		  , VHFHAQ5.IsStaging
		  , VHFHAQ5.CodeName AS QuestionCodeName

			--,VHFHAQ5.NodeAliasPath

		  , VHFHAQ5.DocumentPublishedVersionHistoryID
		  , VHFHAA5.Value
		  , VHFHAA5.Points
		  , VHFHAA5.NodeGuid

			--ref: #47517

		  , VHFHAA5.IsEnabled
		  , VHFHAA5.CodeName
		  , VHFHAA5.UOM

			--,VHFHAA5.NodeAliasPath

		  , VHFHAA5.DocumentPublishedVersionHistoryID
		  , CASE
				WHEN CAST (HA.DocumentCreatedWhen AS date) = CAST (HA.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HA.DocumentCreatedWhen
		  , HA.DocumentModifiedWhen
		  , HA.NodeGuid AS CmsTreeNodeGuid

			--WDM 08.07.2014

		  , HA.NodeGUID AS HANodeGUID
		  , NULL AS SiteLastModified
		  , NULL AS Account_ItemModifiedWhen

			--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen

		  , NULL AS Campaign_DocumentModifiedWhen
		  , HA.DocumentModifiedWhen AS Assessment_DocumentModifiedWhen
		  , VHFHAMJ.DocumentModifiedWhen AS Module_DocumentModifiedWhen
		  , VHFHARCJ.DocumentModifiedWhen AS RiskCategory_DocumentModifiedWhen
		  , VHFHARAJ.DocumentModifiedWhen AS RiskArea_DocumentModifiedWhen
		  , VHFHAQ.DocumentModifiedWhen AS Question_DocumentModifiedWhen
		  , VHFHAA.DocumentModifiedWhen AS Answer_DocumentModifiedWhen
		  , HAMCQ.AllowMultiSelect
		  , ''SID07'' AS LocID
	   FROM

	 --dbo.View_CMS_Tree_Joined AS VCTJ
	 --INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 --INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 --Campaign links Client which links to Assessment
	 --INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 

	 View_HFit_HealthAssessment_Joined AS HA WITH (NOLOCK) 
		 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
			 ON HA.NodeID = VHFHAMJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
			 ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
			 ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ
			 ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA
			 ON VHFHAQ.NodeID = VHFHAA.NodeParentID

	 --matrix level 1 questiongroup
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
	 --Branching Level 1 Question 

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3
			 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3
			 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

	 --Matrix Level 2 Question Group
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID
	 --Matrix branching level 1 question group
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID
	 --Branching level 2 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4
			 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4
			 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

	 --Branching level 3 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ5
			 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA5
			 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID
		 LEFT OUTER JOIN View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS HAMCQ
			 ON VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = ''en-US''
	   WHERE VHFHAQ.DocumentCulture = ''en-us''
		 AND (VHFHAA.DocumentCulture = ''en-us''
		   OR VHFHAA.DocumentCulture IS NULL) 

			 --WDM 08.12.2014		

		 AND VHFHARCJ.DocumentCulture = ''en-us''
		 AND VHFHARAJ.DocumentCulture = ''en-us''
		 AND VHFHAMJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND HA.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHAA5.NodeGuid IS NOT NULL

	 --ref: #47517

	 UNION ALL

	 --UNION
	 --WDM 6/25/2014 Retrieve the Branching level 4 Question Group

	 SELECT DISTINCT
			NULL AS SiteGUID

			--cs.SiteGUID		--WDM 08.12.2014

		  , NULL AS AccountCD

			--, HFA.AccountCD												--WDM 08.07.2014

		  , HA.NodeID

			--WDM 08.07.2014

		  , HA.NodeName

			--WDM 08.07.2014

		  , NULL AS HADocumentID

			--WDM 08.07.2014

		  , HA.NodeSiteID

			--WDM 08.07.2014
			--,VCTJ.NodeAliasPath

		  , HA.DocumentPublishedVersionHistoryID

			--WDM 08.07.2014

		  , dbo.udf_StripHTML (VHFHAMJ.Title) 
		  , dbo.udf_StripHTML (LEFT (VHFHAMJ.IntroText, 4000)) AS IntroText
		  , VHFHAMJ.NodeGuid
		  , VHFHAMJ.Weight
		  , VHFHAMJ.IsEnabled
		  , VHFHAMJ.CodeName

			--,VHFHAMJ.NodeAliasPath

		  , VHFHAMJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARCJ.Title) 
		  , VHFHARCJ.Weight
		  , VHFHARCJ.NodeGuid
		  , VHFHARCJ.IsEnabled
		  , VHFHARCJ.CodeName

			--,VHFHARCJ.NodeAliasPath

		  , VHFHARCJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARAJ.Title) 
		  , VHFHARAJ.Weight
		  , VHFHARAJ.NodeGuid
		  , VHFHARAJ.IsEnabled
		  , VHFHARAJ.CodeName

			--,VHFHARAJ.NodeAliasPath

		  , VHFHARAJ.ScoringStrategyID
		  , VHFHARAJ.DocumentPublishedVersionHistoryID
		  , VHFHAQ6.QuestionType
		  , dbo.udf_StripHTML (LEFT (VHFHAQ6.Title, 4000)) AS QuesTitle
		  , VHFHAQ6.Weight
		  , VHFHAQ6.IsRequired
		  , VHFHAQ6.NodeGuid
		  , VHFHAQ6.IsEnabled
		  , LEFT (VHFHAQ6.IsVisible, 4000) 
		  , VHFHAQ6.IsStaging
		  , VHFHAQ6.CodeName AS QuestionCodeName

			--,VHFHAQ6.NodeAliasPath

		  , VHFHAQ6.DocumentPublishedVersionHistoryID
		  , VHFHAA6.Value
		  , VHFHAA6.Points
		  , VHFHAA6.NodeGuid

			--ref: #47517

		  , VHFHAA6.IsEnabled
		  , VHFHAA6.CodeName
		  , VHFHAA6.UOM

			--,VHFHAA6.NodeAliasPath

		  , VHFHAA6.DocumentPublishedVersionHistoryID
		  , CASE
				WHEN CAST (HA.DocumentCreatedWhen AS date) = CAST (HA.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HA.DocumentCreatedWhen
		  , HA.DocumentModifiedWhen
		  , HA.NodeGuid AS CmsTreeNodeGuid

			--WDM 08.07.2014

		  , HA.NodeGUID AS HANodeGUID
		  , NULL AS SiteLastModified
		  , NULL AS Account_ItemModifiedWhen

			--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen

		  , NULL AS Campaign_DocumentModifiedWhen
		  , HA.DocumentModifiedWhen AS Assessment_DocumentModifiedWhen
		  , VHFHAMJ.DocumentModifiedWhen AS Module_DocumentModifiedWhen
		  , VHFHARCJ.DocumentModifiedWhen AS RiskCategory_DocumentModifiedWhen
		  , VHFHARAJ.DocumentModifiedWhen AS RiskArea_DocumentModifiedWhen
		  , VHFHAQ.DocumentModifiedWhen AS Question_DocumentModifiedWhen
		  , VHFHAA.DocumentModifiedWhen AS Answer_DocumentModifiedWhen
		  , HAMCQ.AllowMultiSelect
		  , ''SID08'' AS LocID
	   FROM

	 --dbo.View_CMS_Tree_Joined AS VCTJ
	 --INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 --INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 --Campaign links Client which links to Assessment
	 --INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 

	 View_HFit_HealthAssessment_Joined AS HA WITH (NOLOCK) 
		 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
			 ON HA.NodeID = VHFHAMJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
			 ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
			 ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ
			 ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA
			 ON VHFHAQ.NodeID = VHFHAA.NodeParentID

	 --matrix level 1 questiongroup
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
	 --Branching Level 1 Question 

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3
			 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3
			 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

	 --Matrix Level 2 Question Group
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID
	 --Matrix branching level 1 question group
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID
	 --Branching level 2 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4
			 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4
			 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

	 --Branching level 3 Question Group
	 --select count(*) from dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ5
			 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA5
			 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID

	 --Branching level 4 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ6
			 ON VHFHAA5.NodeID = VHFHAQ6.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA6
			 ON VHFHAQ6.NodeID = VHFHAA6.NodeParentID
		 LEFT OUTER JOIN View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS HAMCQ
			 ON VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = ''en-US''
	   WHERE VHFHAQ.DocumentCulture = ''en-us''
		 AND (VHFHAA.DocumentCulture = ''en-us''
		   OR VHFHAA.DocumentCulture IS NULL) 

			 --WDM 08.12.2014		

		 AND VHFHARCJ.DocumentCulture = ''en-us''
		 AND VHFHARAJ.DocumentCulture = ''en-us''
		 AND VHFHAMJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND HA.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHAA6.NodeGuid IS NOT NULL

	 --ref: #47517

	 UNION ALL

	 --UNION
	 --WDM 6/25/2014 Retrieve the Branching level 5 Question Group

	 SELECT DISTINCT
			NULL AS SiteGUID

			--cs.SiteGUID		--WDM 08.12.2014

		  , NULL AS AccountCD

			--, HFA.AccountCD												--WDM 08.07.2014

		  , HA.NodeID

			--WDM 08.07.2014

		  , HA.NodeName

			--WDM 08.07.2014

		  , NULL AS HADocumentID

			--WDM 08.07.2014

		  , HA.NodeSiteID

			--WDM 08.07.2014
			--,VCTJ.NodeAliasPath

		  , HA.DocumentPublishedVersionHistoryID

			--WDM 08.07.2014

		  , dbo.udf_StripHTML (VHFHAMJ.Title) 
		  , dbo.udf_StripHTML (LEFT (VHFHAMJ.IntroText, 4000)) AS IntroText
		  , VHFHAMJ.NodeGuid
		  , VHFHAMJ.Weight
		  , VHFHAMJ.IsEnabled
		  , VHFHAMJ.CodeName

			--,VHFHAMJ.NodeAliasPath

		  , VHFHAMJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARCJ.Title) 
		  , VHFHARCJ.Weight
		  , VHFHARCJ.NodeGuid
		  , VHFHARCJ.IsEnabled
		  , VHFHARCJ.CodeName

			--,VHFHARCJ.NodeAliasPath

		  , VHFHARCJ.DocumentPublishedVersionHistoryID
		  , dbo.udf_StripHTML (VHFHARAJ.Title) 
		  , VHFHARAJ.Weight
		  , VHFHARAJ.NodeGuid
		  , VHFHARAJ.IsEnabled
		  , VHFHARAJ.CodeName

			--,VHFHARAJ.NodeAliasPath

		  , VHFHARAJ.ScoringStrategyID
		  , VHFHARAJ.DocumentPublishedVersionHistoryID
		  , VHFHAQ9.QuestionType
		  , dbo.udf_StripHTML (LEFT (VHFHAQ9.Title, 4000)) AS QuesTitle
		  , VHFHAQ9.Weight
		  , VHFHAQ9.IsRequired
		  , VHFHAQ9.NodeGuid
		  , VHFHAQ9.IsEnabled
		  , LEFT (VHFHAQ9.IsVisible, 4000) 
		  , VHFHAQ9.IsStaging
		  , VHFHAQ9.CodeName AS QuestionCodeName

			--,VHFHAQ9.NodeAliasPath

		  , VHFHAQ9.DocumentPublishedVersionHistoryID
		  , VHFHAA9.Value
		  , VHFHAA9.Points
		  , VHFHAA9.NodeGuid

			--ref: #47517

		  , VHFHAA9.IsEnabled
		  , VHFHAA9.CodeName
		  , VHFHAA9.UOM

			--,VHFHAA9.NodeAliasPath

		  , VHFHAA9.DocumentPublishedVersionHistoryID
		  , CASE
				WHEN CAST (HA.DocumentCreatedWhen AS date) = CAST (HA.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HA.DocumentCreatedWhen
		  , HA.DocumentModifiedWhen
		  , HA.NodeGuid AS CmsTreeNodeGuid

			--WDM 08.07.2014

		  , HA.NodeGUID AS HANodeGUID
		  , NULL AS SiteLastModified
		  , NULL AS Account_ItemModifiedWhen

			--, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen

		  , NULL AS Campaign_DocumentModifiedWhen
		  , HA.DocumentModifiedWhen AS Assessment_DocumentModifiedWhen
		  , VHFHAMJ.DocumentModifiedWhen AS Module_DocumentModifiedWhen
		  , VHFHARCJ.DocumentModifiedWhen AS RiskCategory_DocumentModifiedWhen
		  , VHFHARAJ.DocumentModifiedWhen AS RiskArea_DocumentModifiedWhen
		  , VHFHAQ.DocumentModifiedWhen AS Question_DocumentModifiedWhen
		  , VHFHAA.DocumentModifiedWhen AS Answer_DocumentModifiedWhen
		  , HAMCQ.AllowMultiSelect
		  , ''SID09'' AS LocID
	   FROM

	 --dbo.View_CMS_Tree_Joined AS VCTJ
	 --INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
	 --INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
	 --Campaign links Client which links to Assessment
	 --INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID	--Note: 

	 View_HFit_HealthAssessment_Joined AS HA WITH (NOLOCK) 
		 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ
			 ON HA.NodeID = VHFHAMJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ
			 ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ
			 ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ
			 ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA
			 ON VHFHAQ.NodeID = VHFHAA.NodeParentID

	 --matrix level 1 questiongroup
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
	 --Branching Level 1 Question 

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3
			 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3
			 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

	 --Matrix Level 2 Question Group
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID
	 --Matrix branching level 1 question group
	 --INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
	 --INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID
	 --Branching level 2 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4
			 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4
			 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

	 --Branching level 3 Question Group
	 --select count(*) from dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ5
			 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA5
			 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID

	 --Branching level 4 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ6
			 ON VHFHAA5.NodeID = VHFHAQ6.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA6
			 ON VHFHAQ6.NodeID = VHFHAA6.NodeParentID

	 --Branching level 5 Question Group

		 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ9
			 ON VHFHAA6.NodeID = VHFHAQ9.NodeParentID
		 INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA9
			 ON VHFHAQ9.NodeID = VHFHAA9.NodeParentID
		 LEFT OUTER JOIN View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS HAMCQ
			 ON VHFHAQ.Nodeguid = HAMCQ.Nodeguid
			AND HAMCQ.DocumentCulture = ''en-US''
	   WHERE VHFHAQ.DocumentCulture = ''en-us''
		 AND (VHFHAA.DocumentCulture = ''en-us''
		   OR VHFHAA.DocumentCulture IS NULL) 

			 --WDM 08.12.2014		

		 AND VHFHARCJ.DocumentCulture = ''en-us''
		 AND VHFHARAJ.DocumentCulture = ''en-us''
		 AND VHFHAMJ.DocumentCulture = ''en-us''

			 --WDM 08.12.2014	

		 AND HA.DocumentCulture = ''en-us''

			 --WDM 08.12.2014		

		 AND VHFHAA9.NodeGuid IS NOT NULL;

--ref: #47517

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_HealthAssesmentDeffinition found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_HealthAssesmentDeffinitionCustom') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_HealthAssesmentDeffinitionCustom , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--GRANT SELECT
--	ON [dbo].[view_EDW_HealthAssesmentDeffinitionCustom]
--	TO [EDWReader_PRD]
--GO

--***********************************************************************************************
-- 09.11.2014 : (wdm) Verified DATES to resolve EDW last mod date issue
--***********************************************************************************************
CREATE VIEW [dbo].[view_EDW_HealthAssesmentDeffinitionCustom]
AS
	--8/8/2014 - DocGUID changes, NodeGuid
	--8/8/2014 - Generated corrected view in DEV
	--8/10/2014 - added WHERE to limit to English language
	--09.11.2014 - WDM : Added date fields to facilitate Last Mod Date determination
	SELECT 
		cs.SiteGUID
		, HFA.AccountCD		--WDM 08.07.2014
		, HA.NodeID AS HANodeID		--WDM 08.07.2014
		, HA.NodeName AS HANodeName		--WDM 08.07.2014
		, HA.DocumentID AS HADocumentID		--WDM 08.07.2014
		, HA.NodeSiteID AS HANodeSiteID		--WDM 08.07.2014
		, HA.DocumentPublishedVersionHistoryID AS HADocPubVerID		--WDM 08.07.2014
		, VHFHAMJ.Title AS ModTitle
		--Per EDW Team, HTML text is truncated to 4000 bytes - we''ll just do it here
		, dbo.udf_StripHTML(left(left(VHFHAMJ.IntroText,4000),4000)) AS IntroText
		, VHFHAMJ.DocumentGuid AS ModDocGuid	--, VHFHAMJ.DocumentID AS ModDocID	--WDM 08.07.2014
		, VHFHAMJ.Weight AS ModWeight
		, VHFHAMJ.IsEnabled AS ModIsEnabled
		, VHFHAMJ.CodeName AS ModCodeName
		, VHFHAMJ.DocumentPublishedVersionHistoryID AS ModDocPubVerID
		, VHFHARCJ.Title AS RCTitle
		, VHFHARCJ.Weight AS RCWeight
		, VHFHARCJ.DocumentGuid AS RCDocumentGUID	--, VHFHARCJ.DocumentID AS RCDocumentID	--WDM 08.07.2014
		, VHFHARCJ.IsEnabled AS RCIsEnabled
		, VHFHARCJ.CodeName AS RCCodeName
		, VHFHARCJ.DocumentPublishedVersionHistoryID AS RCDocPubVerID
		, VHFHARAJ.Title AS RATytle
		, VHFHARAJ.Weight AS RAWeight
		, VHFHARAJ.DocumentGuid AS RADocumentGuid	--, VHFHARAJ.DocumentID AS RADocumentID	--WDM 08.07.2014
		, VHFHARAJ.IsEnabled AS RAIsEnabled
		, VHFHARAJ.CodeName AS RACodeName
		, VHFHARAJ.ScoringStrategyID AS RAScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID AS RADocPubVerID
		, VHFHAQ.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ.Title,4000)) AS QuesTitle
		, VHFHAQ.Weight AS QuesWeight
		, VHFHAQ.IsRequired AS QuesIsRequired

		, VHFHAQ.DocumentGuid AS QuesDocumentGuid	--, VHFHAQ.DocumentID AS QuesDocumentID	--WDM 08.07.2014
		
		, VHFHAQ.IsEnabled AS QuesIsEnabled
		, left(VHFHAQ.IsVisible,4000) AS QuesIsVisible
		, VHFHAQ.IsStaging AS QuesIsSTaging
		, VHFHAQ.CodeName AS QuestionCodeName
		, VHFHAQ.DocumentPublishedVersionHistoryID AS QuesDocPubVerID
		, VHFHAA.Value AS AnsValue
		, VHFHAA.Points AS AnsPoints
		
		, VHFHAA.DocumentGuid AS AnsDocumentGuid	--, VHFHAA.DocumentID AS AnsDocumentID	--WDM 08.07.2014
		
		, VHFHAA.IsEnabled AS AnsIsEnabled
		, VHFHAA.CodeName AS AnsCodeName
		, VHFHAA.UOM AS AnsUOM
		, VHFHAA.DocumentPublishedVersionHistoryID AS AnsDocPUbVerID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
			THEN ''I''
			ELSE ''U''
		END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014 ADDED TO the returned Columns
	 
		, CS.SiteLastModified
		, hfa.ItemModifiedWhen as Account_ItemModifiedWhen
		, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
FROM
		dbo.View_CMS_Tree_Joined AS VCTJ
		INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
		INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 
		--Campaign links Client which links to Assessment
		INNER JOIN dbo.View_HFit_HACampaign_Joined as c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 
		INNER JOIN View_HFit_HealthAssessment_Joined as HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
		--WDM 08.07.2014
		INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID		
		INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
		INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
		LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID
		where VCTJ.DocumentCulture = ''en-us''	--WDM 08.07.2014
				AND VHFHAMJ.NodeName = ''Custom''
UNION ALL
--WDM Retrieve Matrix Level 1 Question Group
	SELECT
		cs.SiteGUID
		, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		, dbo.udf_StripHTML(left(left(VHFHAMJ.IntroText,4000),4000)) AS IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ2.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ2.Title,4000)) AS QuesTitle
		, VHFHAQ2.Weight
		, VHFHAQ2.IsRequired
		, VHFHAQ2.DocumentGUID
		, VHFHAQ2.IsEnabled
		, left(VHFHAQ2.IsVisible,4000)
		, VHFHAQ2.IsStaging
		, VHFHAQ2.CodeName AS QuestionCodeName
       --,VHFHAQ2.NodeAliasPath
		, VHFHAQ2.DocumentPublishedVersionHistoryID
		, VHFHAA2.Value
		, VHFHAA2.Points
		, VHFHAA2.DocumentGUID
		, VHFHAA2.IsEnabled
		, VHFHAA2.CodeName
		, VHFHAA2.UOM
       --,VHFHAA2.NodeAliasPath
		, VHFHAA2.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
	 
		, CS.SiteLastModified
		, hfa.ItemModifiedWhen as Account_ItemModifiedWhen
		, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
FROM
  dbo.View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID
--matrix level 1 questiongroup
	INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
	INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID
where VCTJ.DocumentCulture = ''en-us''	--WDM 08.07.2014
				AND VHFHAMJ.NodeName = ''Custom''

UNION ALL
--WDM Retrieve Branching Level 1 Question and Matrix Level 1 Question Group
	SELECT
		cs.SiteGUID
		, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ3.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ3.Title,4000)) AS QuesTitle
		, VHFHAQ3.Weight
		, VHFHAQ3.IsRequired
		, VHFHAQ3.DocumentGUID
		, VHFHAQ3.IsEnabled
		, left(VHFHAQ3.IsVisible,4000)
		, VHFHAQ3.IsStaging
		, VHFHAQ3.CodeName AS QuestionCodeName
       --,VHFHAQ3.NodeAliasPath
		, VHFHAQ3.DocumentPublishedVersionHistoryID
		, VHFHAA3.Value
		, VHFHAA3.Points
		, VHFHAA3.DocumentGUID
		, VHFHAA3.IsEnabled
		, VHFHAA3.CodeName
		, VHFHAA3.UOM
       --,VHFHAA3.NodeAliasPath
		, VHFHAA3.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
 
		, CS.SiteLastModified
		, hfa.ItemModifiedWhen as Account_ItemModifiedWhen
		, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
FROM
  dbo.View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

--matrix level 1 questiongroup
--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

--Branching Level 1 Question 
	INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
	LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID
where VCTJ.DocumentCulture = ''en-us''	--WDM 08.07.2014
				AND VHFHAMJ.NodeName = ''Custom''

UNION ALL
--WDM Retrieve Branching Level 1 Question and Matrix Level 2 Question Group
	SELECT
		cs.SiteGUID
		, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ7.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ7.Title,4000)) AS QuesTitle
		, VHFHAQ7.Weight
		, VHFHAQ7.IsRequired
		, VHFHAQ7.DocumentGUID
		, VHFHAQ7.IsEnabled
		, left(VHFHAQ7.IsVisible,4000)
		, VHFHAQ7.IsStaging
		, VHFHAQ7.CodeName AS QuestionCodeName
       --,VHFHAQ7.NodeAliasPath
		, VHFHAQ7.DocumentPublishedVersionHistoryID
		, VHFHAA7.Value
		, VHFHAA7.Points
		, VHFHAA7.DocumentGUID
		, VHFHAA7.IsEnabled
		, VHFHAA7.CodeName
		, VHFHAA7.UOM
       --,VHFHAA7.NodeAliasPath
		, VHFHAA7.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
 
		, CS.SiteLastModified
		, hfa.ItemModifiedWhen as Account_ItemModifiedWhen
		, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
FROM
 dbo.View_CMS_Tree_Joined AS VCTJ
 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

--matrix level 1 questiongroup
--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

--Branching Level 1 Question 
	INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
--LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

--Matrix Level 2 Question Group
	INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
	INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID
where VCTJ.DocumentCulture = ''en-us''	--WDM 08.07.2014
				AND VHFHAMJ.NodeName = ''Custom''

UNION ALL
	--****************************************************
	--WDM 6/25/2014 Retrieve the Branching level 1 Question Group
	--THE PROBLEM LIES HERE in this part of query : 1:40 minute
	-- Added two perf indexes to the first query: 25 Sec
	--****************************************************
	SELECT
		cs.SiteGUID
		, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ8.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ8.Title,4000)) AS QuesTitle
		, VHFHAQ8.Weight
		, VHFHAQ8.IsRequired
		, VHFHAQ8.DocumentGUID
		, VHFHAQ8.IsEnabled
		, left(VHFHAQ8.IsVisible,4000)
		, VHFHAQ8.IsStaging
		, VHFHAQ8.CodeName AS QuestionCodeName
       --,VHFHAQ8.NodeAliasPath
		, VHFHAQ8.DocumentPublishedVersionHistoryID
		, VHFHAA8.Value
		, VHFHAA8.Points
		, VHFHAA8.DocumentGUID
		, VHFHAA8.IsEnabled
		, VHFHAA8.CodeName
		, VHFHAA8.UOM
       --,VHFHAA8.NodeAliasPath
		, VHFHAA8.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
	
		, CS.SiteLastModified
		, hfa.ItemModifiedWhen as Account_ItemModifiedWhen
		, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
FROM
  dbo.View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

			--matrix level 1 questiongroup
			--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
			--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

			--Branching Level 1 Question 
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
			--LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

			--Matrix Level 2 Question Group
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
			INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

			--Matrix branching level 1 question group
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
			INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID
where VCTJ.DocumentCulture = ''en-us''	--WDM 08.07.2014
				AND VHFHAMJ.NodeName = ''Custom''

UNION ALL
	--****************************************************
	--WDM 6/25/2014 Retrieve the Branching level 2 Question Group
	--THE PROBLEM LIES HERE in this part of query : 1:48  minutes
	--With the new indexes: 29 Secs
	--****************************************************
	SELECT
		cs.SiteGUID
		, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ4.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ4.Title,4000)) AS QuesTitle
		, VHFHAQ4.Weight
		, VHFHAQ4.IsRequired
		, VHFHAQ4.DocumentGUID
		, VHFHAQ4.IsEnabled
		, left(VHFHAQ4.IsVisible,4000)
		, VHFHAQ4.IsStaging
		, VHFHAQ4.CodeName AS QuestionCodeName
       --,VHFHAQ4.NodeAliasPath
		, VHFHAQ4.DocumentPublishedVersionHistoryID
		, VHFHAA4.Value
		, VHFHAA4.Points
		, VHFHAA4.DocumentGUID
		, VHFHAA4.IsEnabled
		, VHFHAA4.CodeName
		, VHFHAA4.UOM
       --,VHFHAA4.NodeAliasPath
		, VHFHAA4.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
 
		, CS.SiteLastModified
		, hfa.ItemModifiedWhen as Account_ItemModifiedWhen
		, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
FROM
  dbo.View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

			--matrix level 1 questiongroup
			--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
			--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

			--Branching Level 1 Question 
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
			LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

			--Matrix Level 2 Question Group
			--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
			--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

			--Matrix branching level 1 question group
			--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
			--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

			--Branching level 2 Question Group
			INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
			INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID
where VCTJ.DocumentCulture = ''en-us''	--WDM 08.07.2014
				AND VHFHAMJ.NodeName = ''Custom''

UNION ALL
--WDM 6/25/2014 Retrieve the Branching level 3 Question Group
	SELECT
		cs.SiteGUID
		, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ5.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ5.Title,4000)) AS QuesTitle
		, VHFHAQ5.Weight
		, VHFHAQ5.IsRequired
		, VHFHAQ5.DocumentGUID
		, VHFHAQ5.IsEnabled
		, left(VHFHAQ5.IsVisible,4000)
		, VHFHAQ5.IsStaging
		, VHFHAQ5.CodeName AS QuestionCodeName
       --,VHFHAQ5.NodeAliasPath
		, VHFHAQ5.DocumentPublishedVersionHistoryID
		, VHFHAA5.Value
		, VHFHAA5.Points
		, VHFHAA5.DocumentGUID
		, VHFHAA5.IsEnabled
		, VHFHAA5.CodeName
		, VHFHAA5.UOM
       --,VHFHAA5.NodeAliasPath
		, VHFHAA5.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
 
		, CS.SiteLastModified
		, hfa.ItemModifiedWhen as Account_ItemModifiedWhen
		, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
FROM
  dbo.View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

		--matrix level 1 questiongroup
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

		--Branching Level 1 Question 
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

		--Matrix Level 2 Question Group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

		--Matrix branching level 1 question group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

		--Branching level 2 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

		--Branching level 3 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ5 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA5 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID
where VCTJ.DocumentCulture = ''en-us''	--WDM 08.07.2014
				AND VHFHAMJ.NodeName = ''Custom''

UNION ALL
--WDM 6/25/2014 Retrieve the Branching level 4 Question Group
	SELECT
		cs.SiteGUID
		, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ6.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ6.Title,4000)) AS QuesTitle
		, VHFHAQ6.Weight
		, VHFHAQ6.IsRequired
		, VHFHAQ6.DocumentGUID
		, VHFHAQ6.IsEnabled
		, left(VHFHAQ6.IsVisible,4000)
		, VHFHAQ6.IsStaging
		, VHFHAQ6.CodeName AS QuestionCodeName
       --,VHFHAQ6.NodeAliasPath
		, VHFHAQ6.DocumentPublishedVersionHistoryID
		, VHFHAA6.Value
		, VHFHAA6.Points
		, VHFHAA6.DocumentGUID
		, VHFHAA6.IsEnabled
		, VHFHAA6.CodeName
		, VHFHAA6.UOM
       --,VHFHAA6.NodeAliasPath
		, VHFHAA6.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
 
		, CS.SiteLastModified
		, hfa.ItemModifiedWhen as Account_ItemModifiedWhen
		, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
FROM
  dbo.View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

		--matrix level 1 questiongroup
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

		--Branching Level 1 Question 
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

		--Matrix Level 2 Question Group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

		--Matrix branching level 1 question group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

		--Branching level 2 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

		--Branching level 3 Question Group
		--select count(*) from dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ5 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA5 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID

		--Branching level 4 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ6 ON VHFHAA5.NodeID = VHFHAQ6.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA6 ON VHFHAQ6.NodeID = VHFHAA6.NodeParentID
where VCTJ.DocumentCulture = ''en-us''	--WDM 08.07.2014
				AND VHFHAMJ.NodeName = ''Custom''

UNION ALL
	--WDM 6/25/2014 Retrieve the Branching level 5 Question Group
	SELECT
		cs.SiteGUID
		, HFA.AccountCD
		, HA.NodeID		--WDM 08.07.2014
		, HA.NodeName		--WDM 08.07.2014
		, HA.DocumentID		--WDM 08.07.2014
		, HA.NodeSiteID		--WDM 08.07.2014
       --,VCTJ.NodeAliasPath
		, HA.DocumentPublishedVersionHistoryID		--WDM 08.07.2014
		, VHFHAMJ.Title
		, dbo.udf_StripHTML(left(VHFHAMJ.IntroText,4000)) AS IntroText
		, VHFHAMJ.DocumentGUID
		, VHFHAMJ.Weight
		, VHFHAMJ.IsEnabled
		, VHFHAMJ.CodeName
       --,VHFHAMJ.NodeAliasPath
		, VHFHAMJ.DocumentPublishedVersionHistoryID
		, VHFHARCJ.Title
		, VHFHARCJ.Weight
		, VHFHARCJ.DocumentGUID
		, VHFHARCJ.IsEnabled
		, VHFHARCJ.CodeName
       --,VHFHARCJ.NodeAliasPath
		, VHFHARCJ.DocumentPublishedVersionHistoryID
		, VHFHARAJ.Title
		, VHFHARAJ.Weight
		, VHFHARAJ.DocumentGUID
		, VHFHARAJ.IsEnabled
		, VHFHARAJ.CodeName
       --,VHFHARAJ.NodeAliasPath
		, VHFHARAJ.ScoringStrategyID
		, VHFHARAJ.DocumentPublishedVersionHistoryID
		, VHFHAQ9.QuestionType
		, dbo.udf_StripHTML(left(VHFHAQ9.Title,4000)) AS QuesTitle
		, VHFHAQ9.Weight
		, VHFHAQ9.IsRequired
		, VHFHAQ9.DocumentGUID
		, VHFHAQ9.IsEnabled
		, left(VHFHAQ9.IsVisible,4000)
		, VHFHAQ9.IsStaging
		, VHFHAQ9.CodeName AS QuestionCodeName
       --,VHFHAQ9.NodeAliasPath
		, VHFHAQ9.DocumentPublishedVersionHistoryID
		, VHFHAA9.Value
		, VHFHAA9.Points
		, VHFHAA9.DocumentGUID
		, VHFHAA9.IsEnabled
		, VHFHAA9.CodeName
		, VHFHAA9.UOM
       --,VHFHAA9.NodeAliasPath
		, VHFHAA9.DocumentPublishedVersionHistoryID
		, CASE	WHEN CAST(VCTJ.DocumentCreatedWhen AS DATE) = CAST(vctj.DocumentModifiedWhen AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, VCTJ.DocumentCreatedWhen
		, VCTJ.DocumentModifiedWhen
		, VCTJ.NodeGuid as CmsTreeNodeGuid	--WDM 08.07.2014
 
		, CS.SiteLastModified
		, hfa.ItemModifiedWhen as Account_ItemModifiedWhen
		, c.DocumentModifiedWhen as Campaign_DocumentModifiedWhen
		, HA.DocumentModifiedWhen as Assessment_DocumentModifiedWhen
		, VHFHAMJ.DocumentModifiedWhen as Module_DocumentModifiedWhen
		, VHFHARCJ.DocumentModifiedWhen as RiskCategory_DocumentModifiedWhen
		, VHFHARAJ.DocumentModifiedWhen as RiskArea_DocumentModifiedWhen
		, VHFHAQ.DocumentModifiedWhen as Question_DocumentModifiedWhen
		, VHFHAA.DocumentModifiedWhen as Answer_DocumentModifiedWhen
FROM
  dbo.View_CMS_Tree_Joined AS VCTJ

 INNER JOIN dbo.CMS_Site AS CS ON VCTJ.NodeSiteID = cs.SiteID
 INNER JOIN HFit_Account hfa WITH(NOLOCK) ON cs.SiteID = hfa.SiteID
 INNER JOIN dbo.View_HFit_HACampaign_Joined c WITH(NOLOCK) ON VCTJ.NodeID = c.NodeParentID
 INNER JOIN View_HFit_HealthAssessment_Joined HA WITH (NOLOCK) ON c.HealthAssessmentID = HA.DocumentID
 INNER JOIN dbo.View_HFit_HealthAssesmentModule_Joined AS VHFHAMJ ON HA.NodeID = VHFHAMJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskCategory_Joined AS VHFHARCJ ON VHFHAMJ.DocumentNodeID = VHFHARCJ.NodeParentID
 INNER JOIN dbo.View_HFit_HealthAssesmentRiskArea_Joined AS VHFHARAJ ON VHFHARCJ.DocumentNodeID = VHFHARAJ.NodeParentID
 INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ ON VHFHARAJ.DocumentNodeID = VHFHAQ.NodeParentID
 LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA ON VHFHAQ.NodeID = VHFHAA.NodeParentID

		--matrix level 1 questiongroup
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ2 ON VHFHAQ.NodeID = VHFHAQ2.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA2 ON VHFHAQ2.NodeID = VHFHAA2.NodeParentID

		--Branching Level 1 Question 
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ3 ON VHFHAA.NodeID = VHFHAQ3.NodeParentID
		LEFT OUTER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA3 ON VHFHAQ3.NodeID = VHFHAA3.NodeParentID

		--Matrix Level 2 Question Group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ7 ON VHFHAQ3.NodeID = VHFHAQ7.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA7 ON VHFHAQ7.NodeID = VHFHAA7.NodeParentID

		--Matrix branching level 1 question group
		--INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ8 ON VHFHAA7.NodeID = VHFHAQ8.NodeParentID
		--INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA8 ON VHFHAQ8.NodeID = VHFHAA8.NodeParentID

		--Branching level 2 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ4 ON VHFHAA3.NodeID = VHFHAQ4.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4 ON VHFHAQ4.NodeID = VHFHAA4.NodeParentID

		--Branching level 3 Question Group
		--select count(*) from dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA4
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ5 ON VHFHAA4.NodeID = VHFHAQ5.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA5 ON VHFHAQ5.NodeID = VHFHAA5.NodeParentID

		--Branching level 4 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ6 ON VHFHAA5.NodeID = VHFHAQ6.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA6 ON VHFHAQ6.NodeID = VHFHAA6.NodeParentID

		--Branching level 5 Question Group
		INNER JOIN dbo.View_EDW_HealthAssesmentQuestions AS VHFHAQ9 ON VHFHAA6.NodeID = VHFHAQ9.NodeParentID
		INNER JOIN dbo.View_EDW_HealthAssesmentAnswers AS VHFHAA9 ON VHFHAQ9.NodeID = VHFHAA9.NodeParentID
where VCTJ.DocumentCulture = ''en-us''	--WDM 08.07.2014
				AND VHFHAMJ.NodeName = ''Custom''




';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_HealthAssesmentDeffinitionCustom found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'View_EDW_HealthAssesmentQuestions') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW View_EDW_HealthAssesmentQuestions , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
create VIEW [dbo].[View_EDW_HealthAssesmentQuestions]

AS 
--**********************************************************************************
--09.11.2014 (wdm) Added the DocumentModifiedWhen to facilitate the EDW need to 
--		determine the last mod date of a record.
--10.17.2014 (wdm)
-- view_EDW_HealthAssesmentDeffinition calls 
-- View_EDW_HealthAssesmentQuestions which calls
-- View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined
--		and two other JOINED views.
--View view_EDW_HealthAssesmentDeffinition has a filter on document culture of ''EN-US''
--		which limits the retured data to Engoish only.
--Today, John found a number of TITLES in view_EDW_HealthAssesmentDeffinition that were Spanish.
--The problem seems to come from sevel levels of nesting causing intersection data to seep through 
--the EN-US filter if placed at the highest level of a set of nested views.
--I took the filter and applied it to all the joined views within View_EDW_HealthAssesmentQuestions 
--		and the issue seems to have resolved itself.
--10.17.2014 (wdm) Added a filter "DocumentCulture" - the issue appears to be 
--			caused in view view_EDW_HealthAssesmentDeffinition becuase
--			the FILTER at that level on EN-US allows a portion of the intersection 
--			data to be missed for whatever reason. Adding the filter at this level
--			of the nesting seems to omit the non-english titles found by John Croft.
--**********************************************************************************
SELECT 
	VHFHAMCQJ.ClassName AS QuestionType,
	VHFHAMCQJ.Title,
	VHFHAMCQJ.Weight,
	VHFHAMCQJ.IsRequired,
	VHFHAMCQJ.QuestionImageLeft,
	VHFHAMCQJ.QuestionImageRight,
	VHFHAMCQJ.NodeGUID,	
	VHFHAMCQJ.DocumentCulture,
	VHFHAMCQJ.IsEnabled,
	VHFHAMCQJ.IsVisible,
	VHFHAMCQJ.IsStaging,
	VHFHAMCQJ.CodeName,
	VHFHAMCQJ.QuestionGroupCodeName,
	VHFHAMCQJ.NodeAliasPath,
	VHFHAMCQJ.DocumentPublishedVersionHistoryID,
	VHFHAMCQJ.NodeLevel,
	VHFHAMCQJ.NodeOrder,
	VHFHAMCQJ.NodeID,
	VHFHAMCQJ.NodeParentID,
	VHFHAMCQJ.NodeLinkedNodeID, 
	0 AS DontKnowEnabled, 
	'''' AS DontKnowLabel,
	(select pp.NodeOrder from dbo.CMS_Tree pp inner join dbo.CMS_Tree p on p.NodeParentID = pp.NodeID where p.NodeID = VHFHAMCQJ.NodeParentID) AS ParentNodeOrder
	,VHFHAMCQJ.DocumentGuid
	,VHFHAMCQJ.DocumentModifiedWhen	--(WDM) 09.11.2014 added to facilitate determining document last mod date 
FROM dbo.View_HFit_HealthAssesmentMultipleChoiceQuestion_Joined AS VHFHAMCQJ WITH(NOLOCK)
where VHFHAMCQJ.DocumentCulture = ''en-US''   --(WDM) 10.19.2014 added to filter at this level of nesting

UNION ALL 
SELECT 
	VHFHAMQJ.ClassName AS QuestionType,
	VHFHAMQJ.Title,
	VHFHAMQJ.Weight,
	VHFHAMQJ.IsRequired,
	VHFHAMQJ.QuestionImageLeft,
	VHFHAMQJ.QuestionImageRight,
	VHFHAMQJ.NodeGUID,
	VHFHAMQJ.DocumentCulture,
	VHFHAMQJ.IsEnabled,
	VHFHAMQJ.IsVisible,
	VHFHAMQJ.IsStaging,
	VHFHAMQJ.CodeName,
	VHFHAMQJ.QuestionGroupCodeName,
	VHFHAMQJ.NodeAliasPath,
	VHFHAMQJ.DocumentPublishedVersionHistoryID,
	VHFHAMQJ.NodeLevel,
	VHFHAMQJ.NodeOrder,
	VHFHAMQJ.NodeID,
	VHFHAMQJ.NodeParentID,
	VHFHAMQJ.NodeLinkedNodeID,
	0 AS DontKnowEnabled, 
	'''' AS DontKnowLabel,
		(select pp.NodeOrder from dbo.CMS_Tree pp inner join dbo.CMS_Tree p on p.NodeParentID = pp.NodeID where p.NodeID = VHFHAMQJ.NodeParentID) AS ParentNodeOrder
	,VHFHAMQJ.DocumentGuid
	,VHFHAMQJ.DocumentModifiedWhen	--(WDM) 09.11.2014 added to facilitate determining document last mod date 
FROM dbo.View_HFit_HealthAssesmentMatrixQuestion_Joined AS VHFHAMQJ WITH(NOLOCK)
where VHFHAMQJ.DocumentCulture = ''en-US''   --(WDM) 10.19.2014 added to filter at this level of nesting

UNION ALL 
SELECT 
	VHFHAFFJ.ClassName AS QuestionType,
	VHFHAFFJ.Title,
	VHFHAFFJ.Weight,
	VHFHAFFJ.IsRequired,
	VHFHAFFJ.QuestionImageLeft,
	'''' AS QuestionImageRight,
	VHFHAFFJ.NodeGUID,
	VHFHAFFJ.DocumentCulture,
	VHFHAFFJ.IsEnabled,
	VHFHAFFJ.IsVisible,
	VHFHAFFJ.IsStaging,
	VHFHAFFJ.CodeName,
	VHFHAFFJ.QuestionGroupCodeName,
	VHFHAFFJ.NodeAliasPath,
	VHFHAFFJ.DocumentPublishedVersionHistoryID,
	VHFHAFFJ.NodeLevel,
	VHFHAFFJ.NodeOrder,
	VHFHAFFJ.NodeID,
	VHFHAFFJ.NodeParentID,
	VHFHAFFJ.NodeLinkedNodeID,
	VHFHAFFJ.DontKnowEnabled,
	VHFHAFFJ.DontKnowLabel,
	(select pp.NodeOrder from dbo.CMS_Tree pp inner join dbo.CMS_Tree p on p.NodeParentID = pp.NodeID where p.NodeID = VHFHAFFJ.NodeParentID) AS ParentNodeOrder
	,VHFHAFFJ.DocumentGuid
	,VHFHAFFJ.DocumentModifiedWhen	--(WDM) 09.11.2014 added to facilitate determining document last mod date 
FROM dbo.View_HFit_HealthAssessmentFreeForm_Joined AS VHFHAFFJ WITH(NOLOCK)
where VHFHAFFJ.DocumentCulture = ''en-US''   --(WDM) 10.19.2014 added to filter at this level of nesting

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: View_EDW_HealthAssesmentQuestions found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_HealthAssessment_Staged') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_HealthAssessment_Staged , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
create view [dbo].[view_EDW_HealthAssessment_Staged]
as
--****************************************************************************
--09/04/2014 WDM
--The view Health Assessment runs poorly. This view/table is created as 
--as a staging table allowing the data to already exist when the EDW needs it.
--This is the view that pulls data from the staging table (EDW_HealthAssessment) 
--allowing the EDW to launch a much faster start when processing Health 
--Assessment data.
--****************************************************************************

SELECT [UserStartedItemID]
      ,[HealthAssesmentUserStartedNodeGUID]
      ,[UserID]
      ,[UserGUID]
      ,[HFitUserMpiNumber]
      ,[SiteGUID]
      ,[AccountID]
      ,[AccountCD]
      ,[HAStartedDt]
      ,[HACompletedDt]
      ,[UserModuleItemId]
      ,[UserModuleCodeName]
      ,[HAModuleNodeGUID]
      ,[CMSNodeGuid]
      ,[HAModuleVersionID]
      ,[UserRiskCategoryItemID]
      ,[UserRiskCategoryCodeName]
      ,[HARiskCategoryNodeGUID]
      ,[HARiskCategoryVersionID]
      ,[UserRiskAreaItemID]
      ,[UserRiskAreaCodeName]
      ,[HARiskAreaNodeGUID]
      ,[HARiskAreaVersionID]
      ,[UserQuestionItemID]
      ,[Title]
      ,[HAQuestionGuid]
      ,[UserQuestionCodeName]
      ,[HAQuestionDocumentID]
      ,[HAQuestionVersionID]
      ,[HAQuestionNodeGUID]
      ,[UserAnswerItemID]
      ,[HAAnswerNodeGUID]
      ,[HAAnswerVersionID]
      ,[UserAnswerCodeName]
      ,[HAAnswerValue]
      ,[HAModuleScore]
      ,[HARiskCategoryScore]
      ,[HARiskAreaScore]
      ,[HAQuestionScore]
      ,[HAAnswerPoints]
      ,[PointResults]
      ,[UOMCode]
      ,[HAScore]
      ,[ModulePreWeightedScore]
      ,[RiskCategoryPreWeightedScore]
      ,[RiskAreaPreWeightedScore]
      ,[QuestionPreWeightedScore]
      ,[QuestionGroupCodeName]
      ,[ChangeType]
      ,[IsProfessionallyCollected]
      ,[ItemCreatedWhen]
      ,[ItemModifiedWhen]
      ,[HARiskCategory_ItemModifiedWhen]
      ,[HAUserRiskArea_ItemModifiedWhen]
      ,[HAUserQuestion_ItemModifiedWhen]
      ,[HAUserAnswers_ItemModifiedWhen]
  FROM [dbo].[EDW_HealthAssessment]
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_HealthAssessment_Staged found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_HealthAssessmentDefinition_Staged') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_HealthAssessmentDefinition_Staged , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
create view [dbo].[view_EDW_HealthAssessmentDefinition_Staged]
as
--****************************************************************************
--09/04/2014 WDM
--The view Health Assessment Definition runs very poorly. This view/table is 
--created as as a staging table allowing the data to already exist when the 
--EDW needs it. This is the view that data from the staging table 
--(EDW_HealthAssessmentDefinition) allowing the EDW to launch a much faster 
--start when processing Health Assessment Definition data.
--****************************************************************************
SELECT [SiteGuid]
      ,[AccountCD]
      ,[HANodeID]
      ,[HANodeName]
      ,[HADocumentID]
      ,[HANodeSiteID]
      ,[HADocPubVerID]
      ,[ModTitle]
      ,[IntroText]
      ,[ModDocGuid]
      ,[ModWeight]
      ,[ModIsEnabled]
      ,[ModCodeName]
      ,[ModDocPubVerID]
      ,[RCTitle]
      ,[RCWeight]
      ,[RCDocumentGUID]
      ,[RCIsEnabled]
      ,[RCCodeName]
      ,[RCDocPubVerID]
      ,[RATytle]
      ,[RAWeight]
      ,[RADocumentGuid]
      ,[RAIsEnabled]
      ,[RACodeName]
      ,[RAScoringStrategyID]
      ,[RADocPubVerID]
      ,[QuestionType]
      ,[QuesTitle]
      ,[QuesWeight]
      ,[QuesIsRequired]
      ,[QuesDocumentGuid]
      ,[QuesIsEnabled]
      ,[QuesIsVisible]
      ,[QuesIsSTaging]
      ,[QuestionCodeName]
      ,[QuesDocPubVerID]
      ,[AnsValue]
      ,[AnsPoints]
      ,[AnsDocumentGuid]
      ,[AnsIsEnabled]
      ,[AnsCodeName]
      ,[AnsUOM]
      ,[AnsDocPUbVerID]
      ,[ChangeType]
      ,[DocumentCreatedWhen]
      ,[DocumentModifiedWhen]
      ,[CmsTreeNodeGuid]
      ,[HANodeGUID]
  FROM [dbo].[EDW_HealthAssessmentDefinition]

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_HealthAssessmentDefinition_Staged found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_HealthInterestDetail') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_HealthInterestDetail , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
CREATE VIEW [dbo].[view_EDW_HealthInterestDetail]
AS
	SELECT
		HI.UserID
		,U.UserGUID
		,US.HFitUserMpiNumber
		,S.SiteGUID
		,HI.CoachingHealthInterestID

		,HA1.CoachingHealthAreaID AS FirstHealthAreaID
		,HA1.NodeID AS FirstNodeID
		,HA1.NodeGuid AS FirstNodeGuid
		,HA1.DocumentName AS FirstHealthAreaName
		,HA1.HealthAreaDescription AS FirstHealthAreaDescription
		,HA1.CodeName AS FirstCodeName
	
		,HA2.CoachingHealthAreaID AS SecondHealthAreaID
		,HA2.NodeID AS SecondNodeID
		,HA2.NodeGuid AS SecondNodeGuid
		,HA2.DocumentName AS SecondHealthAreaName
		,HA2.HealthAreaDescription AS SecondHealthAreaDescription
		,HA2.CodeName AS SecondCodeName
	
		,HA3.CoachingHealthAreaID AS ThirdHealthAreaID
		,HA3.NodeID AS ThirdNodeID
		,HA3.NodeGuid AS ThirdNodeGuid
		,HA3.DocumentName AS ThirdHealthAreaName
		,HA3.HealthAreaDescription AS ThirdHealthAreaDescription
		,HA3.CodeName AS ThirdCodeName

		,HI.ItemCreatedWhen
		,HI.ItemModifiedWhen
	FROM
		HFit_CoachingHealthInterest AS HI
		JOIN CMS_User AS U ON HI.UserID = U.UserID
		JOIN CMS_UserSettings AS US ON HI.UserID = US.UserSettingsUserID
		JOIN CMS_UserSite AS US1 ON HI.UserID = US1.UserID
		JOIN CMS_Site AS S ON US1.SiteID = S.SiteID
		LEFT JOIN View_HFit_CoachingHealthArea_Joined AS HA1 ON HI.FirstInterest = HA1.NodeID
			AND HA1.DocumentCulture = ''en-us''
		LEFT JOIN View_HFit_CoachingHealthArea_Joined AS HA2 ON HI.SecondInterest = HA2.NodeID	
			AND HA2.DocumentCulture = ''en-us''
		LEFT JOIN View_HFit_CoachingHealthArea_Joined AS HA3 ON HI.ThirdInterest = HA3.NodeID
			AND HA3.DocumentCulture = ''en-us''
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_HealthInterestDetail found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_HealthInterestList') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_HealthInterestList , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
CREATE VIEW [dbo].[view_EDW_HealthInterestList]
AS
	SELECT
		CHA.CoachingHealthAreaID AS HealthAreaID
		,CHA.NodeID
		,CHA.NodeGuid
		,A.AccountCD
		,CHA.NodeName AS HealthAreaName
		,CHA.HealthAreaDescription
		,CHA.CodeName
		,CHA.DocumentCreatedWhen
		,CHA.DocumentModifiedWhen
	FROM
		View_HFit_CoachingHealthArea_Joined AS CHA
		JOIN HFit_Account AS A ON A.SiteID = CHA.NodeSiteID
	WHERE DocumentCulture = ''en-us''
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_HealthInterestList found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_Participant') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_Participant , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '

--*********************************************************************************************
--WDM Reviewed 8/6/2014 for needed updates, none required
--09.11.2014 (wdm) added date fields to facilitate EDW determination of last mod date 
--*********************************************************************************************
create VIEW [dbo].[view_EDW_Participant]
AS
	SELECT
		cus.HFitUserMpiNumber
		, cu.UserID
		, cu.UserGUID
		, CS.SiteGUID
		, hfa.AccountID
		, hfa.AccountCD
		, cus.HFitUserPreferredMailingAddress
		, cus.HFitUserPreferredMailingCity
		, cus.HFitUserPreferredMailingState
		, cus.HFitUserPreferredMailingPostalCode
		, cus.HFitCoachingEnrollDate
		, cus.HFitUserAltPreferredPhone
		, cus.HFitUserAltPreferredPhoneExt
		, cus.HFitUserAltPreferredPhoneType
		, cus.HFitUserPreferredPhone
		, cus.HFitUserPreferredFirstName
		, CASE	WHEN CAST(cu.UserCreated AS DATE) = CAST(cu.UserLastModified AS DATE)
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		, cu.UserCreated
		, cu.UserLastModified
		, HFA.ItemModifiedWhen as Account_ItemModifiedWhen	--wdm: 09.11.2014 added to view
	FROM
		dbo.CMS_User AS CU
	INNER JOIN dbo.CMS_UserSite AS CUS2 WITH ( NOLOCK ) ON CU.UserID = CUS2.UserID
	INNER JOIN dbo.HFit_Account AS HFA WITH ( NOLOCK ) ON cus2.SiteID = hfa.SiteID
	INNER JOIN dbo.CMS_Site AS CS WITH ( NOLOCK ) ON CUS2.SiteID = CS.SiteID
	INNER JOIN dbo.CMS_UserSettings AS CUS WITH ( NOLOCK ) ON CU.UserID = CUS.UserSettingsUserID







';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_Participant found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_RewardAwardDetail') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_RewardAwardDetail , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW dbo.view_EDW_RewardAwardDetail
AS

	 --*************************************************************************************************
	 --WDM Reviewed 8/6/2014 for needed updates, none required
	 --09.11.2014 : (wdm) reviewed for EDW last mod date and the view is OK as is
	 --11.19.2014 : added language to verify returned data
	 --02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription
	 --*************************************************************************************************

	 SELECT DISTINCT
			cu.UserGUID
		  , cs.SiteGUID
		  , cus.HFitUserMpiNumber
		  , RL_Joined.RewardLevelID
		  , HFRAUD.AwardDisplayName
		  , HFRAUD.RewardValue
		  , HFRAUD.ThresholdNumber
		  , HFRAUD.UserNotified
		  , HFRAUD.IsFulfilled
		  , hfa.AccountID
		  , HFA.AccountCD
		  , CASE
				WHEN CAST (HFRAUD.ItemCreatedWhen AS date) = CAST (HFRAUD.ItemModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , HFRAUD.ItemCreatedWhen
		  , HFRAUD.ItemModifiedWhen
		  , RL_Joined.DocumentCulture
		  , HFRAUD.CultureCode
		  , RL_Joined.LevelName
		  , RL_Joined.LevelHeader
		  , RL_Joined.GroupHeadingText
		  , RL_Joined.GroupHeadingDescription
	   FROM dbo.HFit_RewardsAwardUserDetail AS HFRAUD
				INNER JOIN dbo.View_HFit_RewardLevel_Joined AS RL_Joined
					ON hfraud.RewardLevelNodeId = RL_Joined.NodeID
				   AND RL_Joined.DocumentCulture = ''en-US''
				   AND HFRAUD.CultureCode = ''en-US''
				INNER JOIN dbo.CMS_User AS CU
					ON hfraud.UserId = cu.UserID
				INNER JOIN dbo.CMS_UserSite AS CUS2
					ON cu.UserID = cus2.UserID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cus2.SiteID = HFA.SiteID
				INNER JOIN dbo.CMS_Site AS CS
					ON CUS2.SiteID = CS.SiteID
				INNER JOIN dbo.CMS_UserSettings AS CUS
					ON cu.UserID = cus.UserSettingsUserID;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_RewardAwardDetail found - passed check.') ;
--*****************************************************************************
     GO
--drop view View_EDW_RewardProgram_Joined
--*****************************************************************************
     if not exists (select name from sys.views where name = 'View_EDW_RewardProgram_Joined') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW View_EDW_RewardProgram_Joined , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--This view is created in place of View_Hfit_RewardProgram_Joined so that 
--Document Culture can be taken into consideration. 
CREATE VIEW [dbo].[View_EDW_RewardProgram_Joined] AS 
SELECT View_CMS_Tree_Joined.*, HFit_RewardProgram.* 
	FROM View_CMS_Tree_Joined 
	INNER JOIN HFit_RewardProgram 
		ON View_CMS_Tree_Joined.DocumentForeignKeyValue = HFit_RewardProgram.[RewardProgramID] 
WHERE ClassName = ''HFit.RewardProgram''
AND View_CMS_Tree_Joined.documentculture = ''en-US''
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: View_EDW_RewardProgram_Joined found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_RewardsDefinition') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_RewardsDefinition , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW dbo.view_EDW_RewardsDefinition
AS

	 --02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription

	 SELECT DISTINCT
			cs.SiteGUID
		  , HFA.AccountID
		  , hfa.AccountCD
		  , RewardProgramID
		  , RewardProgramName
		  , RewardProgramPeriodStart
		  , RewardProgramPeriodEnd
		  , ProgramDescription
		  , RewardGroupID
		  , GroupName
		  , RewardContactGroups
		  , RewardGroupPeriodStart
		  , RewardGroupPeriodEnd
		  , RewardLevelID
		  , Level
		  , RewardLevelTypeLKPName
		  , RewardLevelPeriodStart
		  , RewardLevelPeriodEnd
		  , FrequencyMenu
		  , AwardDisplayName
		  , AwardType
		  , AwardThreshold1
		  , AwardThreshold2
		  , AwardThreshold3
		  , AwardThreshold4
		  , AwardValue1
		  , AwardValue2
		  , AwardValue3
		  , AwardValue4
		  , CompletionText
		  , ExternalFulfillmentRequired
		  , RewardHistoryDetailDescription
		  , VHFRAJ.RewardActivityID
		  , VHFRAJ.ActivityName
		  , VHFRAJ.ActivityFreqOrCrit
		  , VHFRAJ.RewardActivityPeriodStart
		  , VHFRAJ.RewardActivityPeriodEnd
		  , VHFRAJ.RewardActivityLKPID
		  , VHFRAJ.ActivityPoints
		  , VHFRAJ.IsBundle
		  , VHFRAJ.IsRequired
		  , VHFRAJ.MaxThreshold
		  , VHFRAJ.AwardPointsIncrementally
		  , VHFRAJ.AllowMedicalExceptions
		  , VHFRAJ.BundleText
		  , RewardTriggerID
		  , HFLRT.RewardTriggerDynamicValue
		  , TriggerName
		  , RequirementDescription
		  , VHFRTPJ.RewardTriggerParameterOperator
		  , VHFRTPJ.Value
		  , vhfrtpj.ParameterDisplayName
		  , CASE
				WHEN CAST (VHFRPJ.DocumentCreatedWhen AS date) = CAST (VHFRPJ.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , VHFRPJ.DocumentCreatedWhen
		  , VHFRPJ.DocumentModifiedWhen
		  , RL_Joined.LevelName
		  , RL_Joined.LevelHeader
		  , RL_Joined.GroupHeadingText
		  , RL_Joined.GroupHeadingDescription
	   FROM dbo.View_HFit_RewardProgram_Joined AS VHFRPJ
				INNER JOIN dbo.View_HFit_RewardGroup_Joined AS VHFRGJ
					ON VHFRPJ.NodeID = VHFRGJ.NodeParentID
				INNER JOIN dbo.View_HFit_RewardLevel_Joined AS RL_Joined
					ON VHFRGJ.NodeID = RL_Joined.NodeParentID
				INNER JOIN dbo.HFit_LKP_RewardLevelType AS HFLRLT
					ON RL_Joined.LevelType = HFLRLT.RewardLevelTypeLKPID
				INNER JOIN dbo.View_HFit_RewardActivity_Joined AS VHFRAJ
					ON RL_Joined.NodeID = VHFRAJ.NodeParentID
				INNER JOIN dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ
					ON VHFRAJ.NodeID = VHFRTJ.NodeParentID
				INNER JOIN dbo.View_HFit_RewardTriggerParameter_Joined AS VHFRTPJ
					ON vhfrtj.nodeid = vhfrtpj.nodeparentid
				INNER JOIN dbo.HFit_LKP_RewardTrigger AS HFLRT
					ON VHFRTJ.RewardTriggerLKPID = HFLRT.RewardTriggerLKPID
				INNER JOIN dbo.CMS_Site AS CS
					ON VHFRPJ.NodeSiteID = cs.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_RewardsDefinition found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_RewardTriggerParameters') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_RewardTriggerParameters , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--GRANT SELECT
--	ON [dbo].[view_EDW_RewardTriggerParameters]
--	TO [EDWReader_PRD]
--GO
--********************************************************************************************************
--09.11.2014 : (wdm) Verified last mod date available to EDW - RewardTriggerParameter_DocumentModifiedWhen
--11.17.2014 : (wdm) John C. found that Spanish was being brought across in TriggerName and 
--				ParameterDisplayName. Found that View_HFit_RewardTrigger_Joined has no way to limit the 
--				returned data to Spanish. Created a new view, View_EDW_RewardProgram_Joined, and provided 
--				a FILTER on Document Culture. The, added Launguage fitlers as: 
--					where VHFRTJ.DocumentCulture = ''en-US'' AND VHFRTPJ.DocumentCulture = ''en-US''
--				This appears to have eliminated the Spanish.
--********************************************************************************************************

CREATE VIEW dbo.view_EDW_RewardTriggerParameters
AS

	 --8/7/2014 - added and commented out DocumentGuid and NodeGuid in case needed later
	 --8/8/2014 - Generated corrected view in DEV (WDM)

	 SELECT DISTINCT
			cs.SiteGUID
		  , VHFRTJ.RewardTriggerID
		  , VHFRTJ.TriggerName
		  , HFLRTPO.RewardTriggerParameterOperatorLKPDisplayName
		  , VHFRTPJ.ParameterDisplayName
		  , VHFRTPJ.RewardTriggerParameterOperator
		  , VHFRTPJ.Value
		  , hfa.AccountID
		  , hfa.AccountCD
		  , CASE
				WHEN CAST (VHFRTJ.DocumentCreatedWhen AS date) = CAST (VHFRTJ.DocumentModifiedWhen AS date) 
				THEN ''I''
				ELSE ''U''
			END AS ChangeType
		  , VHFRTJ.DocumentGuid

			--WDM Added 8/7/2014 in case needed

		  , VHFRTJ.NodeGuid

			--WDM Added 8/7/2014 in case needed

		  , VHFRTJ.DocumentCreatedWhen
		  , VHFRTJ.DocumentModifiedWhen
		  , VHFRTPJ.DocumentModifiedWhen AS RewardTriggerParameter_DocumentModifiedWhen
		  , VHFRTPJ.documentculture AS documentculture_VHFRTPJ
		  , VHFRTJ.documentculture AS documentculture_VHFRTJ
	   FROM dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ

	 --dbo.[View_EDW_RewardProgram_Joined] AS VHFRTJ 		

				INNER JOIN dbo.View_HFit_RewardTriggerParameter_Joined AS VHFRTPJ
					ON vhfrtj.NodeID = VHFRTPJ.NodeParentID
				INNER JOIN dbo.HFit_LKP_RewardTriggerParameterOperator AS HFLRTPO
					ON VHFRTPJ.RewardTriggerParameterOperator = HFLRTPO.RewardTriggerParameterOperatorLKPID
				INNER JOIN dbo.CMS_Site AS CS
					ON VHFRTJ.NodeSiteID = cs.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs.SiteID = HFA.SiteID
	   WHERE VHFRTJ.DocumentCulture = ''en-US''
		 AND VHFRTPJ.DocumentCulture = ''en-US'';
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_RewardTriggerParameters found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_RewardUserDetail') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_RewardUserDetail , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW dbo.view_EDW_RewardUserDetail
AS
	 SELECT DISTINCT

	 --02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription

			cu.UserGUID
   , CS2.SiteGUID
   , cus2.HFitUserMpiNumber
   , VHFRAJ.RewardActivityID
   , VHFRPJ.RewardProgramName
   , VHFRPJ.RewardProgramID
   , VHFRPJ.RewardProgramPeriodStart
   , VHFRPJ.RewardProgramPeriodEnd
   , VHFRPJ.DocumentModifiedWhen AS RewardModifiedDate
   , VHFRGJ.GroupName
   , VHFRGJ.RewardGroupID
   , VHFRGJ.RewardGroupPeriodStart
   , VHFRGJ.RewardGroupPeriodEnd
   , VHFRGJ.DocumentModifiedWhen AS RewardGroupModifieDate
   , RL_Joined.Level
   , HFLRLT.RewardLevelTypeLKPName
   , RL_Joined.DocumentModifiedWhen AS RewardLevelModifiedDate
   , HFRULD.LevelCompletedDt
   , HFRULD.LevelVersionHistoryID
   , RL_Joined.RewardLevelPeriodStart
   , RL_Joined.RewardLevelPeriodEnd
   , VHFRAJ.ActivityName
   , HFRUAD.ActivityPointsEarned
   , HFRUAD.ActivityCompletedDt
   , HFRUAD.ActivityVersionID
   , HFRUAD.ItemModifiedWhen AS RewardActivityModifiedDate
   , VHFRAJ.RewardActivityPeriodStart
   , VHFRAJ.RewardActivityPeriodEnd
   , VHFRAJ.ActivityPoints
   , HFRE.UserAccepted
   , HFRE.UserExceptionAppliedTo
   , HFRE.ItemModifiedWhen AS RewardExceptionModifiedDate
   , VHFRTJ.TriggerName
   , VHFRTJ.RewardTriggerID
   , HFLRT2.RewardTriggerLKPDisplayName
   , HFLRT2.RewardTriggerDynamicValue
   , HFLRT2.ItemModifiedWhen AS RewardTriggerModifiedDate
   , HFLRT.RewardTypeLKPName
   , HFA.AccountID
   , HFA.AccountCD
   , CASE
		 WHEN CAST (HFRULD.ItemCreatedWhen AS date) = CAST (HFRULD.ItemModifiedWhen AS date) 
		 THEN ''I''
		 ELSE ''U''
	 END AS ChangeType
   , HFRULD.ItemCreatedWhen
   , HFRULD.ItemModifiedWhen
   , RL_Joined.LevelName
   , RL_Joined.LevelHeader
   , RL_Joined.GroupHeadingText
   , RL_Joined.GroupHeadingDescription
	   FROM dbo.View_HFit_RewardProgram_Joined AS VHFRPJ
				LEFT OUTER JOIN dbo.View_HFit_RewardGroup_Joined AS VHFRGJ
					ON VHFRPJ.NodeID = VHFRGJ.NodeParentID
				LEFT OUTER JOIN dbo.View_HFit_RewardLevel_Joined AS RL_Joined
					ON VHFRGJ.NodeID = RL_Joined.NodeParentID
				LEFT OUTER JOIN dbo.HFit_LKP_RewardType AS HFLRT
					ON RL_Joined.AwardType = HFLRT.RewardTypeLKPID
				LEFT OUTER JOIN dbo.HFit_LKP_RewardLevelType AS HFLRLT
					ON RL_Joined.LevelType = HFLRLT.RewardLevelTypeLKPID
				INNER JOIN dbo.HFit_RewardsUserLevelDetail AS HFRULD
					ON RL_Joined.NodeID = HFRULD.LevelNodeID
				INNER JOIN dbo.CMS_User AS CU
					ON hfruld.UserID = cu.UserID
				INNER JOIN dbo.CMS_UserSite AS CUS
					ON CU.UserID = CUS.UserID
				INNER JOIN dbo.CMS_Site AS CS2
					ON CUS.SiteID = CS2.SiteID
				INNER JOIN dbo.HFit_Account AS HFA
					ON cs2.SiteID = HFA.SiteID
				INNER JOIN dbo.CMS_UserSettings AS CUS2
					ON cu.UserID = cus2.UserSettingsUserID
				LEFT OUTER JOIN dbo.View_HFit_RewardActivity_Joined AS VHFRAJ
					ON RL_Joined.NodeID = VHFRAJ.NodeParentID
				INNER JOIN dbo.HFit_RewardsUserActivityDetail AS HFRUAD
					ON VHFRAJ.NodeID = HFRUAD.ActivityNodeID
				LEFT OUTER JOIN dbo.View_HFit_RewardTrigger_Joined AS VHFRTJ
					ON VHFRAJ.NodeID = VHFRTJ.NodeParentID
				LEFT OUTER JOIN dbo.HFit_LKP_RewardTrigger AS HFLRT2
					ON VHFRTJ.RewardTriggerLKPID = HFLRT2.RewardTriggerLKPID
				LEFT OUTER JOIN dbo.HFit_RewardException AS HFRE
					ON HFRE.RewardActivityID = VHFRAJ.RewardActivityID
				   AND HFRE.UserID = cu.UserID;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_RewardUserDetail found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_RewardUserLevel') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_RewardUserLevel , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW view_EDW_RewardUserLevel
AS

	 --***************************************************************************************************
	 --Changes:
	 --01.20.2015 - (WDM) Added RL_Joined.nodeguid to satisfy #38393
	 --02.03.2015 : LevelName, LevelHeader, GroupHeadingText, GroupHeadingDescription, SiteGuid
	 --***************************************************************************************************

	 SELECT DISTINCT
			us.UserId
		  , dl.LevelCompletedDt
		  , RL_Joined.NodeName AS LevelName
		  , s.SiteName
		  , RL_Joined.nodeguid
		  , s.SiteGuid
		  , RL_Joined.LevelHeader
		  , RL_Joined.GroupHeadingText
		  , RL_Joined.GroupHeadingDescription
	   FROM HFit_RewardsUserLevelDetail AS dl
				INNER JOIN View_HFit_RewardLevel_Joined AS RL_Joined
					ON RL_Joined.NodeId = dl.LevelNodeId
				JOIN CMS_UserSite AS us
					ON us.UserId = dl.UserId
				JOIN CMS_Site AS s
					ON s.SiteId = us.SiteId;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_RewardUserLevel found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_ScreeningsFromTrackers') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_ScreeningsFromTrackers , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '
--********************************************************************************************************
--09.11.2014 : (wdm) Verified last mod date available to EDW 
--********************************************************************************************************
CREATE VIEW [dbo].[view_EDW_ScreeningsFromTrackers]

AS

SELECT
	t.userid
	, t.EventDate
	, t.TrackerCollectionSourceID
	, t.ItemCreatedBy
	, t.ItemCreatedWhen
	, t.ItemModifiedBy
	, t.ItemModifiedWhen
FROM
	(
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerBloodPressure
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerBloodSugarAndGlucose
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerBMI
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerBodyFat
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerBodyMeasurements
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerCardio
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerCholesterol
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerDailySteps
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerFlexibility
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerFruits
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerHbA1c
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerHeight
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerHighFatFoods
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerHighSodiumFoods
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerInstance_Tracker
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerMealPortions
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerMedicalCarePlan
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerRegularMeals
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerRestingHeartRate
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerShots
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerSitLess
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerSleepPlan
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerStrength
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerStress
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerStressManagement
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerSugaryDrinks
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerSugaryFoods
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerTests
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerTobaccoFree
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerVegetables
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerWater
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerWeight
		UNION ALL
		SELECT
			userid
			, eventdate
			, TrackerCollectionSourceID
			, ItemCreatedBy
			, ItemCreatedWhen
			, ItemModifiedBy
			, ItemModifiedWhen
		FROM
			HFit_TrackerWholeGrains
	) as T
INNER JOIN dbo.HFit_TrackerCollectionSource AS HFTCS ON t.TrackerCollectionSourceID = HFTCS.TrackerCollectionSourceID
WHERE HFTCS.isProfessionallyCollected = 1


';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_ScreeningsFromTrackers found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_SmallStepResponses') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_SmallStepResponses , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW dbo.view_EDW_SmallStepResponses
AS

	 --********************************************************************************************************
	 --02.13.2014 : (Sowmiya Venkiteswaran) : Updated the view to include  the fields:
	 --AccountCD, SiteGUID,SSOutcomeMessage as info. text,
	 -- Small Steps Program Info( HACampaignNodeGUID,HACampaignName,HACampaignStartDate,HACampaignEndDate)
	 -- HAUserStartedRecord Info (HAStartedDate,HACompletedDate,HAStartedMode,HACompletedMode)
	 -- Added filters by document culture and replacing HTML quote with a SQL single quote
	 --********************************************************************************************************
	 --02.23.2014 : (Dale Miller & Sowmiya V) : Performance tuning - removed the following WHERE clause and 
	 --			incorporated them into the JOIN statements for perfoamnce enhancement.
	 -- WHERE vwOutcome.DocumentCulture = ''en-US'' AND vwCamp.DocumentCulture = ''en-US'';
	 --********************************************************************************************************
	 --02.23.2014 : (Dale Miller & Sowmiya V) : Performance tuning
	 --	Prod1, 2 and 3 Labs - Incorporated doc. culture to the Joins
	 -- 1 - executed DBCC dropcleanbuffers everytime
	 -- 2 - Tested REPLACE against No REPLACE, insignificant perf. hit.
	 -- Test Controls:
	 -- Prod1 Lab - NO SQL DISTINCT - 184311 ( rows) - 14 (seconds) 
	 -- Prod1 Lab - WITH SQL DISTINCT - 184311 ( rows) - 32 (seconds) 
	 -- Prod2 Lab - NO SQL DISTINCT -  81120( rows) -  10(seconds) 
	 -- Prod2 Lab - WITH SQL DISTINCT - 81120 ( rows) -  22(seconds) 
	 -- Prod3 Lab - NO SQL DISTINCT - 136763 ( rows) - 10 (seconds) 
	 -- Prod3 Lab - WITH SQL DISTINCT - 136763 ( rows) -  21(seconds)  
	 --02.24.2015 (SV) - Added column SSHealthAssesmentUserStartedItemID per request from John C.
	 --********************************************************************************************************

	 SELECT
			ss.UserID
		  , acct.AccountCD
		  , ste.SiteGUID
		  , ss.ItemID AS SSItemID
		  , ss.ItemCreatedBy AS SSItemCreatedBy
		  , ss.ItemCreatedWhen AS SSItemCreatedWhen
		  , ss.ItemModifiedBy AS SSItemModifiedBy
		  , ss.ItemModifiedWhen AS SSItemModifiedWhen
		  , ss.ItemOrder AS SSItemOrder
		  , ss.ItemGUID AS SSItemGUID
		  , ss.HealthAssesmentUserStartedItemID AS SSHealthAssesmentUserStartedItemID
		  , ss.OutComeMessageGUID AS SSOutcomeMessageGuid
		  , REPLACE (vwOutcome.Message, ''&#39;'', '''''''') AS SSOutcomeMessage
		  , usrstd.HACampaignNodeGUID
		  , vwCamp.Name AS HACampaignName
		  , vwCamp.CampaignStartDate AS HACampaignStartDate
		  , vwCamp.CampaignEndDate AS HACampaignEndDate
		  , usrstd.HAStartedDt AS HAStartedDate
		  , usrstd.HACompletedDt AS HACompletedDate
		  , usrstd.HAStartedMode
		  , usrstd.HACompletedMode
	   FROM dbo.Hfit_SmallStepResponses AS ss
				JOIN HFit_HealthAssesmentUserStarted AS usrstd
					ON usrstd.UserID = ss.UserID
				   AND usrstd.ItemID = ss.HealthAssesmentUserStartedItemID
				JOIN View_HFit_HACampaign_Joined AS vwCamp
					ON vwCamp.NodeGuid = usrstd.HACampaignNodeGUID
				   AND vwCamp.DocumentCulture = ''en-US''
				JOIN View_HFit_OutComeMessages_Joined AS vwOutcome
					ON vwOutcome.NodeGUID = ss.OutComeMessageGUID
				   AND vwOutcome.DocumentCulture = ''en-US''
				JOIN CMS_UserSite AS usrste
					ON usrste.UserID = ss.UserID
				JOIN CMS_Site AS ste
					ON ste.SiteID = usrste.SiteID
				JOIN HFit_Account AS acct
					ON acct.SiteID = usrste.SiteID;
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_SmallStepResponses found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_TrackerCompositeDetails') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_TrackerCompositeDetails , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = 'CREATE VIEW dbo.view_EDW_TrackerCompositeDetails
AS

	 --************************************************************************************************************************************
	 -- NOTES:
	 --************************************************************************************************************************************
	 --WDM 6/26/2014
	 --This view is needed by EDW in order to process the Tracker tables'' data.
	 --As of now, the Tracker tables are representative of objects and that would cause 
	 --	large volumes of ETL to be devloped and maintained. 
	 --This view represents a columnar representation of all tracker tables in a Key/Value pair representation.
	 --Each tracker table to be processed into the EDW must be represented in this view.
	 --ALL new tracker tables need only be entered once using the structure contained within this view
	 --	and the same EDW ETL should be able to process it.
	 --If there is a change to the strucuture of any one query in this view, then all have to be modified 
	 --	to be support the change.
	 --Column TrackerNameAggregratetable (AggregateTableName) will be NULL if the Tracker is not a member 
	 --		of the DISPLAYED Trackers. This allows us to capture all trackers, displayed or not.
	 --7/29/2014
	 --ISSUE: HFit_TrackerBMI,  HFit_TrackerCholesterol, and HFit_TrackerHeight are not in the HFIT_Tracker
	 --		table. This causes T.IsAvailable, T.IsCustom, T.UniqueName to be NULL. 
	 --		This raises the need for the Tracker Definition Table.
	 --NOTE: It is a goal to keep this view using BASE tables in order to gain max performance. Nested views will 
	 --		be avoided here if possible.
	 --**************** SPECIFIC TRACKER DATA **********************
	 --**************** on 7/29/2014          **********************
	 --Tracker GUID or Unique ID across all DB Instances (ItemGuid)
	 --Tracker NodeID (we use it for the External ID for Audit and error Triage)  (John: can use ItemID in this case)
	 --Tracker Table Name or Value Group Name (e.g. Body Measurements) - Categorization (TrackerNameAggregateTable)
	 --Tracker Column Unique Name ( In English)  Must be consistent across all DB Instances  ([UniqueName] will be 
	 --		the TABLE NAME if tracker name not found in the HFIT_Tracker table)
	 --Tracker Column Description (In English) (???)
	 --Tracker Column Data Type (e.g. Character, Numeric, Date, Bit or Yes/No)  so that we can set up the answer type
	 --	NULLS accepted for No Answer?	(KEY1, KEY2, VAL1, VAL2, etc)
	 --Tracker Active flag (IsAvailable will be null if tracker name not found in the HFIT_Tracker table)
	 --Tracker Unit of Measure (character) (Currently, the UOM is supplied in the view based on the table and type of Tracker)
	 --Tracker Insert Date ([ItemCreatedWhen])
	 --Tracker Last Update Date ([ItemModifiedWhen])
	 --NOTE: Convert all numerics to floats 7/30/2104 John/Dale
	 --****************************************************************************************************************************
	 -- 12.23.2014 - Added the Vendor ID and Vendor name to the view via the HFit_LKP_TrackerVendor table
	 -- 12.25.2014 - Tested the view to see that it returned the correct VendorID description
	 --************************************************************************************************************************************
	 --USE:
	 --select * from view_EDW_TrackerCompositeDetails where EventDate between ''2013-11-01 15:02:00.000'' and ''2013-12-01 15:02:00.000''
	 --Set statistics IO ON
	 --GO

	 SELECT
			''HFit_TrackerBloodPressure'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''mm/Hg'' AS UOM
		  , ''Systolic'' AS KEY1
		  , CAST (Systolic AS float) AS VAL1
		  , ''Diastolic'' AS KEY2
		  , CAST (Diastolic AS float) AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , ISNULL (T.UniqueName, ''bp'') AS UniqueName
		  , ISNULL (T.UniqueName, ''bp'') AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBloodPressure AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerBloodPressure''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerBloodSugarAndGlucose'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''mmol/L'' AS UOM
		  , ''Units'' AS KEY1
		  , CAST (Units AS float) AS VAL1
		  , ''FastingState'' AS KEY2
		  , CAST (FastingState AS float) AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , ISNULL (T.UniqueName, ''glucose'') AS UniqueName
		  , ISNULL (T.UniqueName, ''glucose'') AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBloodSugarAndGlucose AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerBloodSugarAndGlucose''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerBMI'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''kg/m2'' AS UOM
		  , ''BMI'' AS KEY1
		  , CAST (BMI AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , 0 AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , TT.ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , ISNULL (T.UniqueName, ''HFit_TrackerBMI'') AS UniqueName
		  , ISNULL (T.UniqueName, ''HFit_TrackerBMI'') AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBMI AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerBMI''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerBodyFat'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''PCT'' AS UOM
		  , ''Value'' AS KEY1
		  , CAST ([Value] AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , 0 AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemModifiedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , ISNULL (T.UniqueName, ''HFit_TrackerBodyFat'') AS UniqueName
		  , ISNULL (T.UniqueName, ''HFit_TrackerBodyFat'') AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBodyFat AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerBodyFat''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION

	 --******************************************************************************

	 SELECT
			''HFit_TrackerBodyMeasurements'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Inch'' AS UOM
		  , ''WaistInches'' AS KEY1
		  , CAST (WaistInches AS float) AS VAL1
		  , ''HipInches'' AS KEY2
		  , CAST (HipInches AS float) AS VAL2
		  , ''ThighInches'' AS KEY3
		  , CAST (ThighInches AS float) AS VAL3
		  , ''ArmInches'' AS KEY4
		  , CAST (ArmInches AS float) AS VAL4
		  , ''ChestInches'' AS KEY5
		  , CAST (ChestInches AS float) AS VAL5
		  , ''CalfInches'' AS KEY6
		  , CAST (CalfInches AS float) AS VAL6
		  , ''NeckInches'' AS KEY7
		  , CAST (NeckInches AS float) AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemModifiedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerBodyMeasurements AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerBodyMeasurements''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID

	 --******************************************************************************

	 UNION
	 SELECT
			''HFit_TrackerCardio'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA'' AS UOM
		  , ''Minutes'' AS KEY1
		  , CAST (Minutes AS float) AS VAL1
		  , ''Distance'' AS KEY2
		  , CAST (Distance AS float) AS VAL2
		  , ''DistanceUnit'' AS KEY3
		  , CAST (DistanceUnit AS float) AS VAL3
		  , ''Intensity'' AS KEY4
		  , CAST (Intensity AS float) AS VAL4
		  , ''ActivityID'' AS KEY5
		  , CAST (ActivityID AS float) AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemModifiedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerCardio AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerCardio''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerCholesterol'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''mg/dL'' AS UOM
		  , ''HDL'' AS KEY1
		  , CAST (HDL AS float) AS VAL1
		  , ''LDL'' AS KEY2
		  , CAST (LDL AS float) AS VAL2
		  , ''Total'' AS KEY3
		  , CAST (Total AS float) AS VAL3
		  , ''Tri'' AS KEY4
		  , CAST (Tri AS float) AS VAL4
		  , ''Ratio'' AS KEY5
		  , CAST (Ratio AS float) AS VAL5
		  , ''Fasting'' AS KEY6
		  , CAST (Fasting AS float) AS VAL6
		  , ''VLDL'' AS VLDL
		  , CAST (VLDL AS float) AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , ISNULL (T.UniqueName, ''HFit_TrackerCholesterol'') AS UniqueName
		  , ISNULL (T.UniqueName, ''HFit_TrackerCholesterol'') AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerCholesterol AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerCholesterol''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerDailySteps'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Step'' AS UOM
		  , ''Steps'' AS KEY1
		  , CAST (Steps AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , ISNULL (T.UniqueName, ''HFit_TrackerDailySteps'') AS UniqueName
		  , ISNULL (T.UniqueName, ''HFit_TrackerDailySteps'') AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerDailySteps AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerDailySteps''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerFlexibility'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Y/N'' AS UOM
		  , ''HasStretched'' AS KEY1
		  , CAST (HasStretched AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''Activity'' AS TXTKEY1
		  , Activity AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerFlexibility AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerFlexibility''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerFruits'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''CUP(8oz)'' AS UOM
		  , ''Cups'' AS KEY1
		  , CAST (Cups AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerFruits AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerFruits''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerHbA1c'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''mmol/mol'' AS UOM
		  , ''Value'' AS KEY1
		  , CAST ([Value] AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerHbA1c AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerHbA1c''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerHeight'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''inch'' AS UOM
		  , ''Height'' AS KEY1
		  , Height AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , TT.ItemOrder
		  , TT.ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , ISNULL (T.UniqueName, ''HFit_TrackerHeight'') AS UniqueName
		  , ISNULL (T.UniqueName, ''HFit_TrackerHeight'') AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerHeight AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerHeight''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerHighFatFoods'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Occurs'' AS UOM
		  , ''Times'' AS KEY1
		  , CAST (Times AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerHighFatFoods AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerHighFatFoods''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerHighSodiumFoods'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Occurs'' AS UOM
		  , ''Times'' AS KEY1
		  , CAST (Times AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerHighSodiumFoods AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerHighSodiumFoods''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerInstance_Tracker'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Y/N'' AS UOM
		  , ''TrackerDefID'' AS KEY1
		  , CAST (TrackerDefID AS float) AS VAL1
		  , ''YesNoValue'' AS KEY2
		  , CAST (YesNoValue AS float) AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerInstance_Tracker AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerInstance_Tracker''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerMealPortions'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA-portion'' AS UOM
		  , ''Portions'' AS KEY1
		  , CAST (Portions AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerMealPortions AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerMealPortions''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerMedicalCarePlan'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Y/N'' AS UOM
		  , ''FollowedPlan'' AS KEY1
		  , CAST (FollowedPlan AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerMedicalCarePlan AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerMedicalCarePlan''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerRegularMeals'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Occurs'' AS UOM
		  , ''Units'' AS KEY1
		  , CAST (Units AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerRegularMeals AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerRegularMeals''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerRestingHeartRate'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''BPM'' AS UOM
		  , ''HeartRate'' AS KEY1
		  , CAST (HeartRate AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerRestingHeartRate AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerRestingHeartRate''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerShots'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Y/N'' AS UOM
		  , ''FluShot'' AS KEY1
		  , CAST (FluShot AS float) AS VAL1
		  , ''PneumoniaShot'' AS KEY2
		  , CAST (PneumoniaShot AS float) AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , TT.ItemOrder
		  , TT.ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerShots AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerShots''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerSitLess'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Occurs'' AS UOM
		  , ''Times'' AS KEY1
		  , CAST (Times AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerSitLess AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerSitLess''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerSleepPlan'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''HR'' AS UOM
		  , ''DidFollow'' AS KEY1
		  , CAST (DidFollow AS float) AS VAL1
		  , ''HoursSlept'' AS KEY2
		  , HoursSlept AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''Techniques'' AS TXTKEY1
		  , Techniques AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerSleepPlan AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerSleepPlan''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerStrength'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Y/N'' AS UOM
		  , ''HasTrained'' AS KEY1
		  , CAST (HasTrained AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''Activity'' AS TXTKEY1
		  , Activity AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerStrength AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerStrength''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerStress'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''gradient'' AS UOM
		  , ''Intensity'' AS KEY1
		  , CAST (Intensity AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''Awareness'' AS TXTKEY1
		  , Awareness AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerStress AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerStress''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerStressManagement'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''gradient'' AS UOM
		  , ''HasPracticed'' AS KEY1
		  , CAST (HasPracticed AS float) AS VAL1
		  , ''Effectiveness'' AS KEY2
		  , CAST (Effectiveness AS float) AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''Activity'' AS TXTKEY1
		  , Activity AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerStressManagement AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerStressManagement''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerSugaryDrinks'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''OZ'' AS UOM
		  , ''Ounces'' AS KEY1
		  , CAST (Ounces AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerSugaryDrinks AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerSugaryDrinks''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerSugaryFoods'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA-portion'' AS UOM
		  , ''Portions'' AS KEY1
		  , CAST (Portions AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerSugaryFoods AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerSugaryFoods''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerTests'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA'' AS UOM
		  , ''PSATest'' AS KEY1
		  , CAST (PSATest AS float) AS VAL1
		  , ''OtherExam'' AS KEY1
		  , CAST (OtherExam AS float) AS VAL2
		  , ''TScore'' AS KEY3
		  , CAST (TScore AS float) AS VAL3
		  , ''DRA'' AS KEY4
		  , CAST (DRA AS float) AS VAL4
		  , ''CotinineTest'' AS KEY5
		  , CAST (CotinineTest AS float) AS VAL5
		  , ''ColoCareKit'' AS KEY6
		  , CAST (ColoCareKit AS float) AS VAL6
		  , ''CustomTest'' AS KEY7
		  , CAST (CustomTest AS float) AS VAL7
		  , ''TSH'' AS KEY8
		  , CAST (TSH AS float) AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''CustomDesc'' AS TXTKEY1
		  , CustomDesc AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , TT.ItemOrder
		  , TT.ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerTests AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerTests''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerTobaccoFree'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''Y/N'' AS UOM
		  , ''WasTobaccoFree'' AS KEY1
		  , CAST (WasTobaccoFree AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''QuitAids'' AS TXTKEY1
		  , QuitAids AS TXTVAL1
		  , ''QuitMeds'' AS TXTKEY2
		  , QuitMeds AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerTobaccoFree AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerTobaccoFree''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerVegetables'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''CUP(8oz)'' AS UOM
		  , ''Cups'' AS KEY1
		  , CAST (Cups AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerVegetables AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerVegetables''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerWater'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''OZ'' AS UOM
		  , ''Ounces'' AS KEY1
		  , CAST (Ounces AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerWater AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerWater''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerWeight'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''LBS'' AS UOM
		  , ''Value'' AS KEY1
		  , [Value] AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerWeight AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerWeight''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerWholeGrains'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , CollectionSourceName_Internal
		  , CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA-serving'' AS UOM
		  , ''Servings'' AS KEY1
		  , CAST (Servings AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , NULL AS VendorID

			--VENDOR.ItemID as VendorID

		  , NULL AS VendorName

	 --VENDOR.VendorName

	   FROM dbo.HFit_TrackerWholeGrains AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerWholeGrains''

	 --left outer join HFit_LKP_TrackerVendor as VENDOR on TT.VendorID = VENDOR.ItemID

	 UNION
	 SELECT
			''HFit_TrackerShots'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , NULL AS CollectionSourceName_Internal
		  , NULL AS CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA'' AS UOM
		  , ''FluShot'' AS KEY1
		  , CAST (FluShot AS float) AS VAL1
		  , ''PneumoniaShot'' AS KEY2
		  , CAST (PneumoniaShot AS float) AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerShots AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerShots''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerTests'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , NULL AS CollectionSourceName_Internal
		  , NULL AS CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA'' AS UOM
		  , ''PSATest'' AS KEY1
		  , CAST (PSATest AS float) AS VAL1
		  , ''OtherExam'' AS KEY2
		  , CAST (OtherExam AS float) AS VAL2
		  , ''TScore'' AS KEY3
		  , CAST (TScore AS float) AS VAL3
		  , ''DRA'' AS KEY4
		  , CAST (DRA AS float) AS VAL4
		  , ''CotinineTest'' AS KEY5
		  , CAST (CotinineTest AS float) AS VAL5
		  , ''ColoCareKit'' AS KEY6
		  , CAST (ColoCareKit AS float) AS VAL6
		  , ''CustomTest'' AS KEY7
		  , CAST (CustomTest AS float) AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , NULL AS IsProcessedForHa
		  , ''CustomDesc'' AS TXTKEY1
		  , CustomDesc AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  , VENDOR.ItemID AS VendorID
		  , VENDOR.VendorName
	   FROM dbo.HFit_TrackerTests AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerTests''
				LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
					ON TT.VendorID = VENDOR.ItemID
	 UNION
	 SELECT
			''HFit_TrackerCotinine'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , NULL AS CollectionSourceName_Internal
		  , NULL AS CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA'' AS UOM
		  , ''NicotineAssessment'' AS KEY1
		  , CAST (NicotineAssessment AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  ,

			--VENDOR.ItemID AS VendorID ,
			--VENDOR.VendorName,

			NULL AS VendorID
		  , NULL AS VendorName
	   FROM dbo.HFit_TrackerCotinine AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerTests''

	 --LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
	 --	ON TT.VendorID = VENDOR.ItemID;

	 UNION
	 SELECT
			''HFit_TrackerPreventiveCare'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , NULL AS CollectionSourceName_Internal
		  , NULL AS CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA'' AS UOM
		  , ''PreventiveCare'' AS KEY1
		  , CAST (PreventiveCare AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  ,

			--VENDOR.ItemID AS VendorID ,
			--VENDOR.VendorName,

			NULL AS VendorID
		  , NULL AS VendorName
	   FROM dbo.HFit_TrackerPreventiveCare AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerTests''

	 --LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
	 --	ON TT.VendorID = VENDOR.ItemID;

	 UNION
	 SELECT
			''HFit_TrackerTobaccoAttestation'' AS TrackerNameAggregateTable
		  , TT.ItemID
		  , EventDate
		  , TT.IsProfessionallyCollected
		  , TT.TrackerCollectionSourceID
		  , Notes
		  , TT.UserID
		  , NULL AS CollectionSourceName_Internal
		  , NULL AS CollectionSourceName_External
		  , ''MISSING'' AS EventName
		  , ''NA'' AS UOM
		  , ''TobaccoAttestation'' AS KEY1
		  , CAST (TobaccoAttestation AS float) AS VAL1
		  , ''NA'' AS KEY2
		  , NULL AS VAL2
		  , ''NA'' AS KEY3
		  , NULL AS VAL3
		  , ''NA'' AS KEY4
		  , NULL AS VAL4
		  , ''NA'' AS KEY5
		  , NULL AS VAL5
		  , ''NA'' AS KEY6
		  , NULL AS VAL6
		  , ''NA'' AS KEY7
		  , NULL AS VAL7
		  , ''NA'' AS KEY8
		  , NULL AS VAL8
		  , ''NA'' AS KEY9
		  , NULL AS VAL9
		  , ''NA'' AS KEY10
		  , NULL AS VAL10
		  , TT.ItemCreatedBy
		  , TT.ItemCreatedWhen
		  , TT.ItemModifiedBy
		  , TT.ItemModifiedWhen
		  , IsProcessedForHa
		  , ''NA'' AS TXTKEY1
		  , NULL AS TXTVAL1
		  , ''NA'' AS TXTKEY2
		  , NULL AS TXTVAL2
		  , ''NA'' AS TXTKEY3
		  , NULL AS TXTVAL3
		  , NULL AS ItemOrder
		  , NULL AS ItemGuid
		  , C.UserGuid
		  , PP.MPI
		  , PP.ClientCode
		  , S.SiteGUID
		  , ACCT.AccountID
		  , ACCT.AccountCD
		  , T.IsAvailable
		  , T.IsCustom
		  , T.UniqueName
		  , T.UniqueName AS ColDesc
		  ,

			--VENDOR.ItemID AS VendorID ,
			--VENDOR.VendorName,

			NULL AS VendorID
		  , NULL AS VendorName
	   FROM dbo.HFit_TrackerTobaccoAttestation AS TT
				INNER JOIN dbo.CMS_User AS C
					ON C.UserID = TT.UserID
				INNER JOIN dbo.hfit_ppteligibility AS PP
					ON TT.UserID = PP.userID
				INNER JOIN dbo.HFit_Account AS ACCT
					ON PP.ClientCode = ACCT.AccountCD
				INNER JOIN dbo.CMS_Site AS S
					ON ACCT.SiteID = S.SiteID
				INNER JOIN dbo.HFit_TrackerCollectionSource AS TC
					ON TC.TrackerCollectionSourceID = TT.TrackerCollectionSourceID
				LEFT OUTER JOIN dbo.HFIT_Tracker AS T
					ON T.AggregateTableName = ''HFit_TrackerTests'';

--LEFT OUTER JOIN HFit_LKP_TrackerVendor AS VENDOR
--	ON TT.VendorID = VENDOR.ItemID;

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_TrackerCompositeDetails found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_TrackerMetadata') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_TrackerMetadata , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '

CREATE View [dbo].[view_EDW_TrackerMetadata]
as
--******************************************************************************************************
--TableName - this is the CMS_CLASS ClassName and is used to identify the needed metadata. 
--ColumnName - Each Class has a set of columns. This is the name of the column as contained
--				within the CLASS.
--AttrName - The name of the attribute as it applies to the column (e.g. column type 
--				describes the datatype of the column (ColName) within the CLASS (ClassName).
--AttrVal - the value assigned to the AttrName.
--CreatedDate - the date this row of metadata was created.
--LastModifiedDate - the date this row of metadata was last changed in the Tracker_EDW_Metadata table.
--ID - An identity field within the Tracker_EDW_Metadata table.
--ClassLastModified - The last date the CLASS within CMS_CLASS was changed.
--09.11.2014 : (wdm) Verified last mod date available to EDW 
--******************************************************************************************************
SELECT TableName, ColName, AttrName, AttrVal, CreatedDate, LastModifiedDate, ID, CMS_CLASS.ClassLastModified
FROM     Tracker_EDW_Metadata
join CMS_CLASS on CMS_CLASS.ClassName = TableName


';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_TrackerMetadata found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_TrackerShots') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_TrackerShots , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '--********************************************************************************************************
--09.11.2014 : (wdm) Verified last mod date available to EDW 
--********************************************************************************************************
CREATE VIEW [dbo].[view_EDW_TrackerShots]
AS
	SELECT
		HFTS.UserID
		, cus.UserSettingsUserGUID
		, CUS.HFitUserMpiNumber
		, CS.SiteID
		, cs.SiteGUID
		, HFTS.ItemID
		, HFTS.EventDate
		, HFTS.IsProfessionallyCollected
		, HFTS.TrackerCollectionSourceID
		, HFTS.Notes
		, HFTS.FluShot
		, HFTS.PneumoniaShot
		, HFTS.ItemCreatedWhen
		, HFTS.ItemModifiedWhen
		, HFTS.ItemGUID
	FROM
		dbo.HFit_TrackerShots AS HFTS
	INNER JOIN dbo.HFit_PPTEligibility AS HFPE WITH ( NOLOCK ) ON HFTS.UserID = HFPE.UserID
	INNER JOIN dbo.CMS_UserSettings AS CUS WITH ( NOLOCK ) ON HFTS.UserID = cus.UserSettingsUserID
	INNER JOIN dbo.CMS_UserSite AS CUS2 WITH ( NOLOCK ) ON cus.UserSettingsUserID = cus2.UserID
	INNER JOIN dbo.CMS_Site AS CS WITH ( NOLOCK ) ON cus2.SiteID = CS.SiteID
	INNER JOIN dbo.HFit_Account AS HFA WITH ( NOLOCK ) ON CS.SiteID = HFA.SiteID

';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_TrackerShots found - passed check.') ;
--*****************************************************************************
     GO

--*****************************************************************************
     if not exists (select name from sys.views where name = 'view_EDW_TrackerTests') 
     BEGIN
          PRINT ('**************************************************') ;
          PRINT ('* ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ') ;
          PRINT ('* MISSING VIEW view_EDW_TrackerTests , created. ') ;
          PRINT ('**************************************************') ;
          DECLARE @MSQL as nvarchar(max) = '' ;
          Set @MSQL = '

--********************************************************************************************************
--09.11.2014 : (wdm) Verified last mod date available to EDW 
--********************************************************************************************************
CREATE VIEW [dbo].[view_EDW_TrackerTests]
AS
	SELECT
		HFTT.UserID
		, cus.UserSettingsUserGUID
		, CUS.HFitUserMpiNumber
		, CS.SiteID
		, cs.SiteGUID
		, HFTT.EventDate
		, HFTT.IsProfessionallyCollected
		, HFTT.TrackerCollectionSourceID
		, HFTT.Notes
		, HFTT.PSATest
		, HFTT.OtherExam
		, HFTT.TScore
		, HFTT.DRA
		, HFTT.CotinineTest
		, HFTT.ColoCareKit
		, HFTT.CustomTest
		, HFTT.CustomDesc
		, HFTT.TSH
		, HFTT.ItemCreatedWhen
		, HFTT.ItemModifiedWhen
		, HFTT.ItemGUID
	FROM
		dbo.HFit_TrackerTests AS HFTT
	INNER JOIN dbo.HFit_PPTEligibility AS HFPE WITH ( NOLOCK ) ON HFTT.UserID = HFPE.UserID
	INNER JOIN dbo.CMS_UserSettings AS CUS WITH ( NOLOCK ) ON HFTT.UserID = cus.UserSettingsUserID
	INNER JOIN dbo.CMS_UserSite AS CUS2 WITH ( NOLOCK ) ON cus.UserSettingsUserID = cus2.UserID
	INNER JOIN dbo.CMS_Site AS CS WITH ( NOLOCK ) ON cus2.SiteID = CS.SiteID
	INNER JOIN dbo.HFit_Account AS HFA WITH ( NOLOCK ) ON CS.SiteID = HFA.SiteID
';
          EXEC (@MSQL);
     END
     ELSE
          PRINT ('VIEW: view_EDW_TrackerTests found - passed check.') ;
--*****************************************************************************
     GO

--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;





--Test Cases
--exec IVP_DataValidation 'view_EDW_RewardUserDetail' ;
--exec IVP_DataValidation 'view_EDW_SmallStepResponses' 
--exec IVP_DataValidation 'view_EDW_Coaches';
--go

GO
PRINT 'Executing C:\Users\wmiller\Documents\SQL Server Management Studio\HFit_Rewrite\CurrentWork\IVP_Views.sql ';
GO
PRINT 'Creating procedure IVP_DataValidation';
GO
IF EXISTS (SELECT
				  name
			 FROM sys.procedures
			 WHERE name = 'IVP_DataValidation') 
	BEGIN
		DROP PROCEDURE
			 IVP_DataValidation;
	END;
GO
CREATE PROCEDURE IVP_DataValidation @vname AS nvarchar (250) 
AS

	 --02.23.2015 (WDM) - Started development if the IVP procedure.
	 --02.24.2015 (WDM) - Completed and generated the procedure in the different environments.

	 BEGIN
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_II')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_II;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_III')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_III;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_V')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_V;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF NOT EXISTS (SELECT
							   name
						  FROM sys.views
						  WHERE name = @vname) 
			 BEGIN
				 PRINT '<><><><><><><><><><><><><><><><><><><><><><><><><>';
				 PRINT 'ERROR ERROR ERROR ERROR ERROR ERROR ERROR ERROR ';
				 PRINT '<><><><><><><><><><><><><><><><><><><><><><><><><>';
				 PRINT ' ';
				 PRINT 'ERROR: ' + @vname + ' is missing.';
				 PRINT '<><><><><><><><><><><><><><><><><><><><><><><><><>';
				 RETURN;
			 END;
		 DECLARE @iTotal AS int = 0;
		 DECLARE @mysql AS nvarchar (2000) = '';
		 DECLARE @ProcStartTime AS datetime = GETDATE () ;
		 DECLARE @StartTime AS datetime = GETDATE () ;
		 DECLARE @EndTime AS datetime = GETDATE () ;
		 DECLARE @ETime AS nvarchar (200) = '';
		 DECLARE @CurrSvr nvarchar (250) = (SELECT
												   @@servername) ;
		 DECLARE @CurrDB nvarchar (250) = (SELECT
												  DB_NAME ()) ;
		 SET NOCOUNT ON;

		 --select count(*) as cnt into IVP_Temp_II from view_EDW_SmallStepResponses

		 PRINT '**************************************************************************************';
		 PRINT 'Veryfying Data From: ' + @vname + ' on server ' + @CurrSvr + ' within DB: ' + @CurrDB;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_II')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_II;
			 END;

		 --select count(*) as cnt into IVP_Temp_II from view_EDW_Coaches;		

		 SET @mysql = 'select count(*) as cnt into IVP_Temp_II from ' + @vname;
		 EXEC (@mysql) ;
		 DECLARE @rowcount int = (SELECT TOP (1) 
										 cnt
									FROM IVP_Temp_II) ;
		 SET @EndTime = GETDATE () ;

		 --hours over 24, minutes,  seconds, milliseconds

		 SET @ETime = (SELECT
							  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
		 PRINT 'TOTAL Records in ' + @vname + ': ' + CAST (@rowcount AS nvarchar (50)) + '.';
		 PRINT 'Execution Time: ' + @ETime;

		 --********************************************

		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_III')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_III;
			 END;
		 SET @StartTime = GETDATE () ;
		 SET @mysql = 'select top 100 * into IVP_Temp_III from ' + @vname;
		 EXEC (@mysql) ;
		 SET @EndTime = GETDATE () ;

		 --hours over 24, minutes,  seconds, milliseconds

		 SET @ETime = (SELECT
							  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
		 PRINT '-------------------';
		 PRINT 'Execution Time to Select 100 Rows into TEMP TABLE: ' + @ETime;

		 --********************************************

		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF @rowcount > 1000
			 BEGIN
				 SET @StartTime = GETDATE () ;
				 SET @mysql = 'select top 1000 * into IVP_Temp_IV from ' + @vname;
				 EXEC (@mysql) ;
				 SET @EndTime = GETDATE () ;

				 --hours over 24, minutes,  seconds, milliseconds

				 SET @ETime = (SELECT
									  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
				 PRINT '-------------------';
				 PRINT 'Execution Time to Select 1,000 Rows into TEMP TABLE: ' + @ETime;
			 END;

		 --********************************************

		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_V')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_V;
			 END;
		 IF @rowcount > 10000
			 BEGIN
				 SET @StartTime = GETDATE () ;
				 SET @mysql = 'select top 10000 * into IVP_Temp_V from ' + @vname;
				 EXEC (@mysql) ;
				 SET @EndTime = GETDATE () ;

				 --hours over 24, minutes,  seconds, milliseconds

				 SET @ETime = (SELECT
									  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
				 PRINT '-------------------';
				 PRINT 'Execution Time to Select 10,000 Rows into TEMP TABLE: ' + @ETime;
			 END;

		 --********************************************

		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF @rowcount > 100000
			 BEGIN
				 SET @StartTime = GETDATE () ;
				 SET @mysql = 'select top 100000 * into IVP_Temp_IV from ' + @vname;
				 EXEC (@mysql) ;
				 SET @EndTime = GETDATE () ;

				 --hours over 24, minutes,  seconds, milliseconds

				 SET @ETime = (SELECT
									  CAST (CAST (CAST (@EndTime AS float) - CAST (@StartTime AS float) AS int) * 24 + DATEPART (hh, @EndTime - @StartTime) AS varchar (10)) + ':' + RIGHT ('0' + CAST (DATEPART (mi, @EndTime - @StartTime) AS varchar (2)) , 2) + ':' + RIGHT ('0' + CAST (DATEPART (ss, @EndTime - @StartTime) AS varchar (2)) , 2) + '.' + RIGHT ('0' + CAST (DATEPART (ms, @EndTime - @StartTime) AS varchar (2)) , 2)) ;
				 PRINT '-------------------';
				 PRINT 'Execution Time to Select 100,000 Rows into TEMP TABLE: ' + @ETime;
			 END;
		 PRINT '**************************************************************************************';
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_II')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_II;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_III')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_III;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_V')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_V;
			 END;
		 IF EXISTS (SELECT
						   name
					  FROM sysobjects
					  WHERE ID = OBJECT_ID (N'IVP_Temp_IV')) 
			 BEGIN
				 DROP TABLE
					  IVP_Temp_IV;
			 END;
		 SET NOCOUNT OFF;
	 END;
GO
PRINT 'CREATED procedure IVP_DataValidation';
GO--**************
print('END: ' + cast(getdate() as nvarchar(50)));
print('@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-@-');
print'***************************************************************' ;
print('START: ' + cast(getdate() as nvarchar(50)));
--**************

--SET ANSI_NULLS ON;
--SET ANSI_PADDING ON;
--SET ANSI_WARNINGS ON;
--SET ARITHABORT ON;
--SET CONCAT_NULL_YIELDS_NULL ON;
--SET NUMERIC_ROUNDABORT OFF;
--SET QUOTED_IDENTIFIER ON;






GO
Print ('***********************************************') ;
Print ('Starting the EDW DATA Views IVP: ' + cast(getdate() as nvarchar(50))) ;
Print ('***********************************************') ;
go
--select 'exec IVP_DataValidation ''' + name + ''';' + char(10) + char(13) +'GO'  from sys.views where name like '%EDW%' order by name;
exec IVP_DataValidation 'view_EDW_Awards';

GO
exec IVP_DataValidation 'view_EDW_BioMetrics';

GO
exec IVP_DataValidation 'view_EDW_BiometricViewRejectCriteria';

GO
exec IVP_DataValidation 'view_EDW_ClientCompany';

GO
exec IVP_DataValidation 'view_EDW_Coaches';

GO
exec IVP_DataValidation 'view_EDW_CoachingDefinition';

GO
exec IVP_DataValidation 'view_EDW_CoachingDetail';

--GO
--exec IVP_DataValidation 'view_EDW_EDW_TEST_DEL_DelAudit';

GO
exec IVP_DataValidation 'view_EDW_Eligibility';

GO
exec IVP_DataValidation 'view_EDW_EligibilityHistory';

GO
exec IVP_DataValidation 'view_EDW_HealthAssesment';

GO
exec IVP_DataValidation 'View_EDW_HealthAssesmentAnswers';

GO
exec IVP_DataValidation 'view_EDW_HealthAssesmentClientView';

GO
exec IVP_DataValidation 'view_EDW_HealthAssesmentDeffinition';

GO
exec IVP_DataValidation 'view_EDW_HealthAssesmentDeffinitionCustom';

GO
exec IVP_DataValidation 'View_EDW_HealthAssesmentQuestions';

GO
exec IVP_DataValidation 'view_EDW_HealthAssessment_Staged';

GO
exec IVP_DataValidation 'view_EDW_HealthAssessmentDefinition_Staged';

GO
exec IVP_DataValidation 'view_EDW_HealthInterestDetail';

GO
exec IVP_DataValidation 'view_EDW_HealthInterestList';

GO
exec IVP_DataValidation 'view_EDW_Participant';

GO
exec IVP_DataValidation 'view_EDW_RewardAwardDetail';

GO
exec IVP_DataValidation 'View_EDW_RewardProgram_Joined';

GO
exec IVP_DataValidation 'view_EDW_RewardsDefinition';

GO
exec IVP_DataValidation 'view_EDW_RewardTriggerParameters';

GO
exec IVP_DataValidation 'view_EDW_RewardUserDetail';

GO
exec IVP_DataValidation 'view_EDW_RewardUserLevel';

GO
exec IVP_DataValidation 'view_EDW_ScreeningsFromTrackers';

GO
exec IVP_DataValidation 'view_EDW_SmallStepResponses';

GO
exec IVP_DataValidation 'view_EDW_TrackerCompositeDetails';

GO
exec IVP_DataValidation 'view_EDW_TrackerMetadata';

GO
exec IVP_DataValidation 'view_EDW_TrackerShots';

GO
exec IVP_DataValidation 'view_EDW_TrackerTests';

GO
Print ('***********************************************') ;
Print ('ENDING the EDW DATA Views IVP: ' + cast(getdate() as nvarchar(50))) ;
Print ('***********************************************') ;

GO

--START ENDING THE IVP
GO

DECLARE @DBNAME nvarchar(100);
declare @ServerName nvarchar(80);
set @ServerName = (SELECT @@SERVERNAME ) ;
set @DBNAME = (SELECT DB_NAME() AS [Current Database]);

print ('--');
print ('*************************************************************************************************************');
print ('IVP Processing complete - please check for errors: on database ' + @DBNAME + ' : ON SERVER : '+ @ServerName + ' ON ' + cast(getdate() as nvarchar(50)));
print ('*************************************************************************************************************');
  --  
GO 
print('***** FROM: TheEnd.sql'); 
GO 
