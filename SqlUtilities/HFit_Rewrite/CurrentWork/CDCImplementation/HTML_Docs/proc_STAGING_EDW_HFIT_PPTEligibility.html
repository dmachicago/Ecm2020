<html lang="en">
<head>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<META name="Generator" content="Visustin">
<META name="description" content="T-SQL flow chart saved by Aivosto Visustin (www.aivosto.com).">
<META name="keywords" content="T-SQL, flow graph, diagram">

<title>T-SQL flow chart: proc_STAGING_EDW_HFIT_PPTEligibility.sql</title>

<style type="text/css">
<!--
BODY      { margin: 0; }
TEXTAREA  { background: #ffffcc; font-size: 8pt; }
A:link, A:visited { color: blue; }
TR.bar    { background: white; font-family: Verdana, Arial, Sans-Serif; font-size: 70%; }
TR TD     { padding: 0; background: white; }
TR.bar TD { padding: 2px 5px 2px 5px; background: #ccccff; }
-->
</style>

<script type="text/javascript">
<!--
function hidecode(id) { 
  if (id.style.display=="none") {
    id.style.display="";
    hidelink.innerHTML="Hide code";
  } else {
    id.style.display="none";
    hidelink.innerHTML="Show code";
  }
}
-->
</script>
</head>


<body scroll=no>

<table width="100%" height="100%" cellspacing="0" cellpadding="0" border="0">

<tr height="100%"><td id="#upper" colspan="2">
 <iframe name="pic" width="100%" height="100%" src="proc_STAGING_EDW_HFIT_PPTEligibility.png" frameborder="0" title="T-SQL flow chart: proc_STAGING_EDW_HFIT_PPTEligibility.sql">
  <a href="proc_STAGING_EDW_HFIT_PPTEligibility.png"><img src="proc_STAGING_EDW_HFIT_PPTEligibility.png" height="100%" title="T-SQL flow chart: proc_STAGING_EDW_HFIT_PPTEligibility.sql"></a>
 </iframe>
</td></tr>

<tr id="sourcecode"><td colspan="2">
<textarea rows=15 readonly=yes style="width:100%; border-width:0;">
-- USE KenticoCMS_PRD_1
/*-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select top 100 * from HFIT_PPTEligibility
update HFIT_PPTEligibility set UserNickNAme = null where UserSettingsID in (select top 100 UserSettingsID from HFIT_PPTEligibility order by UserSettingsID desc) and UserNickName is null
*/

GO
-- use KenticoCMS_Prod1

/*---------------------------------------
Developer  : W. Dale Miller
05.28.2015 : WDM - completed unit testing
*/

GO
PRINT 'creating proc_STAGING_EDW_HFIT_PPTEligibility';
PRINT GETDATE () ;
GO

IF EXISTS ( SELECT
       name
       FROM sys.procedures
       WHERE name = 'proc_STAGING_EDW_HFIT_PPTEligibility')
 BEGIN
   PRINT 'UPDATING proc_STAGING_EDW_HFIT_PPTEligibility';
   DROP PROCEDURE
     proc_STAGING_EDW_HFIT_PPTEligibility;
 END;

GO

-- exec proc_STAGING_EDW_HFIT_PPTEligibility

CREATE PROCEDURE proc_STAGING_EDW_HFIT_PPTEligibility (
  @ReloadAll AS int = 0)
AS
BEGIN
 SET NOCOUNT ON;
 DECLARE
 @iTotal AS bigint = 0;

 EXEC @iTotal = proc_QuickRowCount 'STAGING_HFIT_PPTEligibility';

 IF @iTotal &lt;= 1
   BEGIN
    SET @Reloadall = 1;
   END;

 BEGIN

   IF @ReloadAll IS NULL
    BEGIN
      SET @ReloadAll = 0;
    END;

   DECLARE
   @RecordID AS uniqueidentifier = NEWID () ;
   DECLARE
   @CT_DateTimeNow AS datetime = GETDATE () ;
   DECLARE
   @CT_NAME AS nvarchar ( 50) = 'proc_STAGING_EDW_HFIT_PPTEligibility';
   EXEC proc_EDW_CT_ExecutionLog_Update @RecordID , @CT_NAME , @CT_DateTimeNow , 0 , 'I';

   IF @ReloadAll = 1
    BEGIN
      PRINT 'RELOADING ALL Change Tracking HFIT_PPTEligibility records';
      EXEC proc_Create_Table_STAGING_HFIT_PPTEligibility ;
      PRINT 'RELOAD COMPLETE';
    END;
   ELSE
    BEGIN
      EXEC proc_CT_HFIT_PPTEligibility_AddNewRecs ;
      EXEC proc_CT_HFIT_PPTEligibility_AddUpdatedRecs ;
      EXEC proc_HFIT_PPTEligibility_AddDeletedRecs ;
    END;

 END;
END;

GO
PRINT 'CREATED proc_STAGING_EDW_HFIT_PPTEligibility';
PRINT GETDATE () ;
GO

</textarea>
</td></tr>

<tr class="bar">
 <td align="left"><a href="javascript:hidecode(sourcecode);" id="hidelink">Hide code</a></td>
 <td align="right"><a href="http://www.aivosto.com/visustin.html">Visustin flow chart for T-SQL</a></td></tr>
</table>

</body>
</html>
